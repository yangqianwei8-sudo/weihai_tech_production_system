{% extends "delivery_customer/base.html" %}
{% load static %}

{% block title %}åˆ é™¤äº¤ä»˜è®°å½• - ç»´æµ·ç§‘æŠ€ä¿¡æ¯åŒ–ç®¡ç†å¹³å°{% endblock %}

{% block breadcrumb_items %}
<li class="breadcrumb-item"><a href="{% url 'delivery_pages:report_delivery' %}">æ”¶å‘ç®¡ç†</a></li>
<li class="breadcrumb-item"><a href="{% url 'delivery_pages:delivery_list' %}">äº¤ä»˜è®°å½•</a></li>
<li class="breadcrumb-item"><a href="{% url 'delivery_pages:delivery_detail' delivery.id %}">{{ delivery.delivery_number }}</a></li>
<li class="breadcrumb-item active" aria-current="page">åˆ é™¤</li>
{% endblock %}

{% block content %}
<div class="container-fluid">
    
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="mb-1">ğŸ—‘ï¸ åˆ é™¤äº¤ä»˜è®°å½•</h2>
            <p class="text-muted mb-0">è¯·ç¡®è®¤æ˜¯å¦åˆ é™¤æ­¤äº¤ä»˜è®°å½•</p>
        </div>
        <div>
            <a href="{% url 'delivery_pages:delivery_detail' delivery.id %}" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left"></i> è¿”å›è¯¦æƒ…
            </a>
        </div>
    </div>

    <div class="alert alert-warning mb-4" role="alert">
        <h5 class="alert-heading"><i class="bi bi-exclamation-triangle"></i> è­¦å‘Š</h5>
        <p class="mb-0">åˆ é™¤æ“ä½œä¸å¯æ¢å¤ï¼åˆ é™¤åå°†åŒæ—¶åˆ é™¤ä»¥ä¸‹å†…å®¹ï¼š</p>
        <ul class="mb-0 mt-2">
            <li>äº¤ä»˜è®°å½•åŸºæœ¬ä¿¡æ¯</li>
            <li>æ‰€æœ‰å…³è”çš„äº¤ä»˜æ–‡ä»¶</li>
            <li>æ‰€æœ‰è·Ÿè¸ªè®°å½•</li>
            <li>æ‰€æœ‰å®¢æˆ·åé¦ˆ</li>
        </ul>
    </div>

    <div class="info-card mb-4">
        <div class="info-card-header">
            <h5 class="info-card-title">äº¤ä»˜è®°å½•ä¿¡æ¯</h5>
        </div>
        <div class="info-card-body">
            <div class="info-grid info-grid-2">
                <div class="info-item">
                    <span class="info-label">äº¤ä»˜å•å·</span>
                    <span class="info-value info-value-bold">{{ delivery.delivery_number }}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">äº¤ä»˜æ ‡é¢˜</span>
                    <span class="info-value">{{ delivery.title }}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">äº¤ä»˜çŠ¶æ€</span>
                    <span class="status-badge {{ delivery.status }}">{{ delivery.get_status_display }}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">åˆ›å»ºæ—¶é—´</span>
                    <span class="info-value">{{ delivery.created_at|date:"Y-m-d H:i" }}</span>
                </div>
                {% if delivery.project %}
                <div class="info-item">
                    <span class="info-label">å…³è”é¡¹ç›®</span>
                    <span class="info-value">{{ delivery.project.project_number }} - {{ delivery.project.name }}</span>
                </div>
                {% endif %}
                {% if delivery.client %}
                <div class="info-item">
                    <span class="info-label">å…³è”å®¢æˆ·</span>
                    <span class="info-value">{{ delivery.client.name }}</span>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <form method="post" id="deleteForm">
        {% csrf_token %}
        <div class="info-card mb-4">
            <div class="info-card-header">
                <h5 class="info-card-title">åˆ é™¤åŸå› </h5>
            </div>
            <div class="info-card-body">
                <div class="info-item info-item-full-width">
                    <label class="info-label">åˆ é™¤åŸå› ï¼ˆå¯é€‰ï¼‰</label>
                    <textarea name="delete_reason" class="form-control" rows="3" placeholder="è¯·è¾“å…¥åˆ é™¤åŸå› ï¼ˆå¯é€‰ï¼‰"></textarea>
                </div>
            </div>
        </div>

        <div class="d-flex justify-content-end gap-2 mb-4">
            <a href="{% url 'delivery_pages:delivery_detail' delivery.id %}" class="btn btn-outline-secondary">
                <i class="bi bi-x-circle"></i> å–æ¶ˆ
            </a>
            <button type="submit" class="btn btn-danger" onclick="return confirmDelete()">
                <i class="bi bi-trash"></i> ç¡®è®¤åˆ é™¤
            </button>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
function confirmDelete() {
    const confirmed = confirm('ç¡®å®šè¦åˆ é™¤äº¤ä»˜è®°å½• "{{ delivery.delivery_number }}" å—ï¼Ÿ\n\næ­¤æ“ä½œä¸å¯æ¢å¤ï¼');
    if (confirmed) {
        document.getElementById('deleteForm').submit();
    }
    return false;
}
</script>
{% endblock %}
