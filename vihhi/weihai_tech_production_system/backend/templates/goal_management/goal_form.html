{% extends "shared/create_form_base.html" %}
{% load static %}

{% block form_title %}创建战略目标{% endblock %}
{% block form_subtitle %}请填写目标基本信息{% endblock %}

{% block form_fields %}
  {# 基本信息 - 每行5个字段 #}
  <div class="row mb-3 form-row-5">
    <div class="col-5-fields form-field-wrapper">
      <label for="{{ form.name.id_for_label }}" class="form-label">
        {{ form.name.label }}
        {% if form.name.field.required %}<span class="text-danger">*</span>{% endif %}
      </label>
      {{ form.name }}
      {% if form.name.errors %}
      <div class="text-danger small">{{ form.name.errors }}</div>
      {% endif %}
    </div>

    <div class="col-5-fields form-field-wrapper">
      <label for="{{ form.level.id_for_label }}" class="form-label">
        {{ form.level.label }}
        {% if form.level.field.required %}<span class="text-danger">*</span>{% endif %}
      </label>
      {{ form.level }}
      {% if form.level.errors %}
      <div class="text-danger small">{{ form.level.errors }}</div>
      {% endif %}
    </div>

    <div class="col-5-fields form-field-wrapper">
      <label for="{{ form.goal_type.id_for_label }}" class="form-label">
        {{ form.goal_type.label }}
        {% if form.goal_type.field.required %}<span class="text-danger">*</span>{% endif %}
      </label>
      {{ form.goal_type }}
      {% if form.goal_type.errors %}
      <div class="text-danger small">{{ form.goal_type.errors }}</div>
      {% endif %}
    </div>

    <div class="col-5-fields form-field-wrapper">
      <label for="{{ form.goal_period.id_for_label }}" class="form-label">
        {{ form.goal_period.label }}
        {% if form.goal_period.field.required %}<span class="text-danger">*</span>{% endif %}
      </label>
      {{ form.goal_period }}
      {% if form.goal_period.errors %}
      <div class="text-danger small">{{ form.goal_period.errors }}</div>
      {% endif %}
    </div>

    <div class="col-5-fields form-field-wrapper">
      <label for="{{ form.status.id_for_label }}" class="form-label">
        {{ form.status.label }}
        {% if form.status.field.required %}<span class="text-danger">*</span>{% endif %}
      </label>
      {{ form.status }}
      {% if form.status.errors %}
      <div class="text-danger small">{{ form.status.errors }}</div>
      {% endif %}
    </div>
  </div>

  {# 目标指标 - 每行5个字段 #}
  <div class="row mb-3 form-row-5">
    <div class="col-5-fields form-field-wrapper">
      <label for="{{ form.indicator_name.id_for_label }}" class="form-label">
        {{ form.indicator_name.label }}
        {% if form.indicator_name.field.required %}<span class="text-danger">*</span>{% endif %}
      </label>
      {{ form.indicator_name }}
      {% if form.indicator_name.errors %}
      <div class="text-danger small">{{ form.indicator_name.errors }}</div>
      {% endif %}
    </div>

    <div class="col-5-fields form-field-wrapper">
      <label for="{{ form.indicator_type.id_for_label }}" class="form-label">
        {{ form.indicator_type.label }}
        {% if form.indicator_type.field.required %}<span class="text-danger">*</span>{% endif %}
      </label>
      {{ form.indicator_type }}
      {% if form.indicator_type.errors %}
      <div class="text-danger small">{{ form.indicator_type.errors }}</div>
      {% endif %}
    </div>

    <div class="col-5-fields form-field-wrapper">
      <label for="{{ form.indicator_unit.id_for_label }}" class="form-label">
        {{ form.indicator_unit.label }}
      </label>
      {{ form.indicator_unit }}
      {% if form.indicator_unit.errors %}
      <div class="text-danger small">{{ form.indicator_unit.errors }}</div>
      {% endif %}
    </div>

    <div class="col-5-fields form-field-wrapper">
      <label for="{{ form.target_value.id_for_label }}" class="form-label">
        {{ form.target_value.label }}
        {% if form.target_value.field.required %}<span class="text-danger">*</span>{% endif %}
      </label>
      {{ form.target_value }}
      {% if form.target_value.errors %}
      <div class="text-danger small">{{ form.target_value.errors }}</div>
      {% endif %}
    </div>

    <div class="col-5-fields form-field-wrapper">
      <label for="{{ form.current_value.id_for_label }}" class="form-label">
        {{ form.current_value.label }}
      </label>
      {{ form.current_value }}
      {% if form.current_value.errors %}
      <div class="text-danger small">{{ form.current_value.errors }}</div>
      {% endif %}
    </div>
  </div>

  {# 目标描述 - 多行文本，占据整行 #}
  <div class="row mb-3">
    <div class="col-12 form-field-wrapper">
      <label for="{{ form.description.id_for_label }}" class="form-label">
        {{ form.description.label }}
      </label>
      {{ form.description }}
      {% if form.description.errors %}
      <div class="text-danger small">{{ form.description.errors }}</div>
      {% endif %}
    </div>
  </div>

  <div class="row mb-3">
    <div class="col-12 form-field-wrapper">
      <label for="{{ form.background.id_for_label }}" class="form-label">
        {{ form.background.label }}
      </label>
      {{ form.background }}
      {% if form.background.errors %}
      <div class="text-danger small">{{ form.background.errors }}</div>
      {% endif %}
    </div>
  </div>

  <div class="row mb-3">
    <div class="col-12 form-field-wrapper">
      <label for="{{ form.significance.id_for_label }}" class="form-label">
        {{ form.significance.label }}
      </label>
      {{ form.significance }}
      {% if form.significance.errors %}
      <div class="text-danger small">{{ form.significance.errors }}</div>
      {% endif %}
    </div>
  </div>

  {# 权重设置 - 每行5个字段 #}
  <div class="row mb-3 form-row-5">
    <div class="col-5-fields form-field-wrapper">
      <label for="{{ form.weight.id_for_label }}" class="form-label">
        {{ form.weight.label }}
      </label>
      {{ form.weight }}
      {% if form.weight.errors %}
      <div class="text-danger small">{{ form.weight.errors }}</div>
      {% endif %}
    </div>
  </div>

  {# 权重说明 - 多行文本，占据整行 #}
  <div class="row mb-3">
    <div class="col-12 form-field-wrapper">
      <label for="{{ form.weight_description.id_for_label }}" class="form-label">
        {{ form.weight_description.label }}
      </label>
      {{ form.weight_description }}
      {% if form.weight_description.errors %}
      <div class="text-danger small">{{ form.weight_description.errors }}</div>
      {% endif %}
    </div>
  </div>

  {# 时间信息 - 每行5个字段 #}
  <div class="row mb-3 form-row-5">
    <div class="col-5-fields form-field-wrapper">
      <label for="{{ form.start_date.id_for_label }}" class="form-label">
        {{ form.start_date.label }}
        {% if form.start_date.field.required %}<span class="text-danger">*</span>{% endif %}
      </label>
      {{ form.start_date }}
      {% if form.start_date.errors %}
      <div class="text-danger small">{{ form.start_date.errors }}</div>
      {% endif %}
    </div>

    <div class="col-5-fields form-field-wrapper">
      <label for="{{ form.end_date.id_for_label }}" class="form-label">
        {{ form.end_date.label }}
        {% if form.end_date.field.required %}<span class="text-danger">*</span>{% endif %}
      </label>
      {{ form.end_date }}
      {% if form.end_date.errors %}
      <div class="text-danger small">{{ form.end_date.errors }}</div>
      {% endif %}
    </div>
  </div>

  {# 关联信息 - 每行5个字段 #}
  <div class="row mb-3 form-row-5">
    <div class="col-5-fields form-field-wrapper">
      <label for="{{ form.parent_goal.id_for_label }}" class="form-label">
        {{ form.parent_goal.label }}
      </label>
      {{ form.parent_goal }}
      {% if form.parent_goal.errors %}
      <div class="text-danger small">{{ form.parent_goal.errors }}</div>
      {% endif %}
    </div>
  </div>

  {# 多选字段 - 占据整行 #}
  <div class="row mb-3">
    <div class="col-12 form-field-wrapper">
      <label for="{{ form.participants.id_for_label }}" class="form-label">
        {{ form.participants.label }}
      </label>
      {{ form.participants }}
      {% if form.participants.errors %}
      <div class="text-danger small">{{ form.participants.errors }}</div>
      {% endif %}
    </div>
  </div>

  <div class="row mb-3">
    <div class="col-12 form-field-wrapper">
      <label for="{{ form.related_projects.id_for_label }}" class="form-label">
        {{ form.related_projects.label }}
      </label>
      {{ form.related_projects }}
      {% if form.related_projects.errors %}
      <div class="text-danger small">{{ form.related_projects.errors }}</div>
      {% endif %}
    </div>
  </div>

  {# 备注 - 多行文本，占据整行 #}
  <div class="row mb-3">
    <div class="col-12 form-field-wrapper">
      <label for="{{ form.notes.id_for_label }}" class="form-label">
        {{ form.notes.label }}
      </label>
      {{ form.notes }}
      {% if form.notes.errors %}
      <div class="text-danger small">{{ form.notes.errors }}</div>
      {% endif %}
    </div>
  </div>
{% endblock %}

{% block form_actions %}
  <button type="submit" class="btn btn-primary">创建</button>
  <a href="{% url 'plan_pages:strategic_goal_list' %}" class="btn btn-secondary">取消</a>
{% endblock %}

{% block module_extra_js %}
{{ block.super }}
<script src="{% static 'js/goal_form_date_calculator.js' %}"></script>
{% endblock %}
