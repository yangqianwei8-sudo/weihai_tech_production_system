{% extends "archive_management/base.html" %}
{% load static %}

{% block title %}é¡¹ç›®å½’æ¡£è¯¦æƒ… - æ¡£æ¡ˆç®¡ç†{% endblock %}

{% block breadcrumb_items %}
<li class="breadcrumb-item"><a href="{% url 'archive_management:project_archive_list' %}">é¡¹ç›®å½’æ¡£</a></li>
<li class="breadcrumb-item active" aria-current="page">è¯¦æƒ…</li>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="card">
        <div class="card-header">
            <h3>ğŸ“‹ é¡¹ç›®å½’æ¡£è¯¦æƒ…ï¼š{{ archive.archive_number }}</h3>
            <div>
                <a href="{% url 'archive_management:project_archive_list' %}" class="btn btn-light btn-sm">è¿”å›åˆ—è¡¨</a>
            </div>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <h5 class="mb-3">åŸºæœ¬ä¿¡æ¯</h5>
                    <table class="table table-bordered">
                        <tr>
                            <th style="width: 120px;">å½’æ¡£ç¼–å·</th>
                            <td>{{ archive.archive_number }}</td>
                        </tr>
                        <tr>
                            <th>é¡¹ç›®åç§°</th>
                            <td>{{ archive.project.project_name|default:"-" }}</td>
                        </tr>
                        <tr>
                            <th>é¡¹ç›®ç¼–å·</th>
                            <td>{{ archive.project.project_number|default:"-" }}</td>
                        </tr>
                        <tr>
                            <th>å½’æ¡£çŠ¶æ€</th>
                            <td>
                                <span class="status-badge status-{{ archive.status }}">
                                    {{ archive.get_status_display }}
                                </span>
                            </td>
                        </tr>
                        <tr>
                            <th>å½’æ¡£åŸå› </th>
                            <td>{{ archive.archive_reason|default:"-" }}</td>
                        </tr>
                        <tr>
                            <th>å½’æ¡£è¯´æ˜</th>
                            <td>{{ archive.archive_description|default:"-" }}</td>
                        </tr>
                    </table>
                </div>
                <div class="col-md-6">
                    <h5 class="mb-3">å½’æ¡£ä¿¡æ¯</h5>
                    <table class="table table-bordered">
                        <tr>
                            <th style="width: 120px;">ç”³è¯·äºº</th>
                            <td>{{ archive.applicant.username }}</td>
                        </tr>
                        <tr>
                            <th>ç”³è¯·æ—¶é—´</th>
                            <td>{{ archive.applied_time|date:"Y-m-d H:i" }}</td>
                        </tr>
                        {% if archive.executor %}
                        <tr>
                            <th>æ‰§è¡Œäºº</th>
                            <td>{{ archive.executor.username }}</td>
                        </tr>
                        <tr>
                            <th>æ‰§è¡Œæ—¶é—´</th>
                            <td>{{ archive.executed_time|date:"Y-m-d H:i" }}</td>
                        </tr>
                        {% endif %}
                        {% if archive.confirmed_by %}
                        <tr>
                            <th>ç¡®è®¤äºº</th>
                            <td>{{ archive.confirmed_by.username }}</td>
                        </tr>
                        <tr>
                            <th>ç¡®è®¤æ—¶é—´</th>
                            <td>{{ archive.confirmed_time|date:"Y-m-d H:i" }}</td>
                        </tr>
                        {% endif %}
                        <tr>
                            <th>åˆ›å»ºæ—¶é—´</th>
                            <td>{{ archive.created_time|date:"Y-m-d H:i" }}</td>
                        </tr>
                    </table>
                </div>
            </div>

            <!-- å½’æ¡£æ–‡æ¡£åˆ—è¡¨ -->
            {% if documents %}
            <div class="mt-4">
                <h5 class="mb-3">å½’æ¡£æ–‡æ¡£</h5>
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>æ–‡æ¡£ç¼–å·</th>
                                <th>æ–‡æ¡£åç§°</th>
                                <th>æ–‡æ¡£ç±»å‹</th>
                                <th>åˆ†ç±»</th>
                                <th>çŠ¶æ€</th>
                                <th>ä¸Šä¼ äºº</th>
                                <th>ä¸Šä¼ æ—¶é—´</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for doc in documents %}
                            <tr>
                                <td>{{ doc.document_number }}</td>
                                <td>{{ doc.document_name }}</td>
                                <td>{{ doc.get_document_type_display }}</td>
                                <td>{{ doc.category.name|default:"-" }}</td>
                                <td>
                                    <span class="status-badge status-{{ doc.status }}">
                                        {{ doc.get_status_display }}
                                    </span>
                                </td>
                                <td>{{ doc.uploaded_by.username }}</td>
                                <td>{{ doc.uploaded_time|date:"Y-m-d H:i" }}</td>
                                <td>
                                    <a href="{% url 'archive_management:project_document_detail' doc.pk %}" class="btn btn-sm btn-outline-primary">æŸ¥çœ‹</a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            {% else %}
            <div class="mt-4">
                <p class="text-muted">æš‚æ— å½’æ¡£æ–‡æ¡£</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

