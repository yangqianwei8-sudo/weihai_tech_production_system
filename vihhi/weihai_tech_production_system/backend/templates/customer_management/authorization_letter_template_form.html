{% extends "customer_management/base.html" %}

{% block title %}{{ page_title }} - ç»´æµ·ç§‘æŠ€ä¿¡æ¯åŒ–ç®¡ç†å¹³å°{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <div class="center-hero mb-4">
        <div style="position: relative; z-index: 1;">
            <h1 style="font-size: 28px; font-weight: 700; margin: 0 0 8px 0;">{{ page_title }}</h1>
            <p style="font-size: 14px; opacity: 0.9; margin: 0;">{{ description }}</p>
        </div>
    </div>

    <form method="post" class="form-card" enctype="multipart/form-data">
        {% csrf_token %}
        
        <div class="form-section">
            <h5>åŸºæœ¬ä¿¡æ¯</h5>
            <div class="row">
                <div class="col-md-6">
                    <label class="form-label required-field">æ¨¡æ¿åç§°</label>
                    {{ form.template_name }}
                    {% if form.template_name.errors %}
                        <div class="text-danger small">{{ form.template_name.errors }}</div>
                    {% endif %}
                </div>
                <div class="col-md-3">
                    <label class="form-label required-field">æ¨¡æ¿ç±»å‹</label>
                    {{ form.template_type }}
                    {% if form.template_type.errors %}
                        <div class="text-danger small">{{ form.template_type.errors }}</div>
                    {% endif %}
                </div>
                <div class="col-md-3">
                    <label class="form-label">çŠ¶æ€</label>
                    {{ form.status }}
                    {% if form.status.errors %}
                        <div class="text-danger small">{{ form.status.errors }}</div>
                    {% endif %}
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-md-12">
                    <label class="form-label">æ¨¡æ¿åˆ†ç±»</label>
                    {{ form.category }}
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-md-12">
                    <label class="form-label">æ¨¡æ¿è¯´æ˜</label>
                    {{ form.description }}
                </div>
            </div>
        </div>

        <div class="form-section">
            <h5>æ¨¡æ¿æ–‡ä»¶</h5>
            <div class="row">
                <div class="col-md-12">
                    <label class="form-label">æ¨¡æ¿æ–‡ä»¶</label>
                    {{ form.template_file }}
                    {% if form.template_file.errors %}
                        <div class="text-danger small">{{ form.template_file.errors }}</div>
                    {% endif %}
                    <small class="form-text text-muted">
                        æ”¯æŒä¸Šä¼  Word (.doc, .docx)ã€PDF (.pdf)ã€Excel (.xls, .xlsx)ã€PowerPoint (.ppt, .pptx) æ ¼å¼æ–‡ä»¶ï¼Œæ–‡ä»¶å¤§å°ä¸è¶…è¿‡ 50MB
                    </small>
                </div>
            </div>
            {% if not is_create and template.template_file %}
            <div class="row mt-3">
                <div class="col-md-12">
                    <div class="card border-info">
                        <div class="card-body">
                            <h6 class="card-title">ğŸ“ å½“å‰æ¨¡æ¿æ–‡ä»¶</h6>
                            <p class="card-text mb-2">
                                <strong>æ–‡ä»¶åï¼š</strong>{{ template.template_file_name|default:template.template_file.name }}<br>
                                {% if template.template_file_size %}
                                <strong>æ–‡ä»¶å¤§å°ï¼š</strong>{{ template.template_file_size|filesizeformat }}<br>
                                {% endif %}
                            </p>
                            <div class="btn-group" role="group">
                                <a href="{% url 'business_pages:authorization_letter_template_file_preview' template.id %}" 
                                   target="_blank" 
                                   class="btn btn-sm btn-outline-primary">
                                    <i class="bi bi-eye"></i> é¢„è§ˆ
                                </a>
                                <a href="{% url 'business_pages:authorization_letter_template_file_download' template.id %}" 
                                   class="btn btn-sm btn-outline-success">
                                    <i class="bi bi-download"></i> ä¸‹è½½
                                </a>
                            </div>
                            <small class="text-muted d-block mt-2">
                                ä¸Šä¼ æ–°æ–‡ä»¶å°†æ›¿æ¢å½“å‰æ–‡ä»¶
                            </small>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>

        <!-- æäº¤æŒ‰é’® -->
        <div class="d-flex justify-content-end gap-2 mt-4">
            <button type="submit" class="btn btn-primary">ä¿å­˜</button>
            <a href="{% url 'business_pages:authorization_letter_template_list' %}" class="btn btn-secondary">å–æ¶ˆ</a>
        </div>
    </form>
</div>
{% endblock %}

