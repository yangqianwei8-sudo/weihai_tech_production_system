{% extends "customer_management/_base.html" %}
{% load static %}

{% block cm_title %}商机列表{% endblock %}
{% block cm_subtitle %}<span class="pm-subtitle">查看和管理所有商机</span>{% endblock %}

{% block cm_actions %}
{% if can_create %}
<a href="{% url 'business_pages:opportunity_create' %}" class="list-btn list-btn-primary">
  创建商机
</a>
{% endif %}
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/common.css' %}">
<link rel="stylesheet" href="{% static 'css/components/list_layout.css' %}">
<style>
    .list-page-container {
        padding: 12px !important;
        gap: 8px !important;
    }
</style>
{% endblock %}

{% block cm_content %}
<div class="list-page-container">
    <div class="list-page-header">
        <h2 class="mb-0">商机列表</h2>
        <p class="text-muted mb-0 mt-1">查看和管理所有商机</p>
    </div>
    
    {% include "customer_management/_partials/_opportunity_stats.html" %}
    
    {% include "customer_management/_partials/_opportunity_filters.html" %}
    
    <div class="list-page-action-bar card mb-3">
        <div class="card-body py-2">
            <div class="d-flex justify-content-end align-items-center">
                <div>
                    <span class="text-muted small">共 {{ page_obj.paginator.count|default:0 }} 条记录</span>
                </div>
            </div>
        </div>
    </div>
    
    {% include "customer_management/_partials/_opportunity_table.html" %}
</div>
{% endblock %}
