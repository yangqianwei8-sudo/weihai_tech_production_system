{% extends "shared/list_page_base.html" %}
{% load static %}

{% block pm_title %}{{ page_title|default:"ä¸šåŠ¡å§”æ‰˜ä¹¦" }}{% endblock pm_title %}
{% block pm_subtitle %}æŸ¥çœ‹å’Œç®¡ç†æ‰€æœ‰ä¸šåŠ¡å§”æ‰˜ä¹¦{% endblock pm_subtitle %}

{% block pm_actions %}
{% if can_create %}
<a href="{% url 'business_pages:authorization_letter_create' %}" class="list-btn list-btn-primary">æ–°å¢ä¸šåŠ¡å§”æ‰˜ä¹¦</a>
{% endif %}
{% endblock pm_actions %}

{% block list_table_rows %}
{% for letter in page_obj %}
      <tr>
        <td><code>{{ letter.letter_number|default:"æœªç¼–å·" }}</code></td>
        <td>{{ letter.project_name }}</td>
        <td>{{ letter.client_name }}</td>
        <td>{{ letter.trustee_name }}</td>
        <td style="text-align: right;">{% if letter.provisional_price %}Â¥{{ letter.provisional_price|floatformat:2 }}{% else %}--{% endif %}</td>
        <td>{{ letter.letter_date|date:"Y-m-d" }}</td>
        <td>
          <span class="badge bg-secondary">{{ letter.get_status_display }}</span>
        </td>
        <td>
          {% if letter.opportunity %}
          <a href="{% url 'opportunity_pages:opportunity_detail' letter.opportunity.id %}">
            {{ letter.opportunity.name }}
          </a>
          {% else %}
          <span class="text-muted">æœªå…³è”</span>
          {% endif %}
        </td>
        <td>{{ letter.created_by.get_full_name|default:letter.created_by.username }}</td>
        <td>
          <div class="list-page-table-actions">
            <a href="{% url 'business_pages:authorization_letter_detail' letter.id %}" class="action-view" title="æŸ¥çœ‹">
              <i class="bi bi-eye"></i>
            </a>
            {% if letter.can_edit %}
            <span class="action-separator">|</span>
            <a href="{% url 'business_pages:authorization_letter_edit' letter.id %}" class="action-edit" title="ç¼–è¾‘">
              <i class="bi bi-pencil"></i>
            </a>
            {% endif %}
            {% if letter.can_delete %}
            <span class="action-separator">|</span>
            <a href="{% url 'business_pages:authorization_letter_delete' letter.id %}" class="action-delete" title="åˆ é™¤">
              <i class="bi bi-trash"></i>
            </a>
            {% endif %}
          </div>
        </td>
        {% if column_settings_btn|default:False %}<td></td>{% endif %}
      </tr>
      {% empty %}
      <tr>
        <td colspan="{% if column_settings_btn|default:False %}11{% else %}10{% endif %}" class="list-empty">
          <div class="list-empty-icon">ğŸ“‹</div>
          <div class="list-empty-text">æš‚æ— å§”æ‰˜ä¹¦æ•°æ®</div>
          {% block list_empty_hint %}
          <p class="text-muted" style="font-size: 0.9rem; margin-top: 8px;">è¯·åˆ›å»ºç¬¬ä¸€ä¸ªå§”æ‰˜ä¹¦å¼€å§‹ä½¿ç”¨</p>
          {% endblock list_empty_hint %}
        </td>
      </tr>
      {% endfor %}
{% endblock list_table_rows %}

{% block list_table_headers %}
<th>å§”æ‰˜ä¹¦ç¼–å·</th>
<th>é¡¹ç›®åç§°</th>
<th>å§”æ‰˜å•ä½</th>
<th>æœåŠ¡å•ä½</th>
<th>æš‚å®šä»·æ¬¾</th>
<th>å§”æ‰˜æ—¥æœŸ</th>
<th>çŠ¶æ€</th>
<th>å…³è”å•†æœº</th>
<th>åˆ›å»ºäºº</th>
<th>æ“ä½œ</th>
{% endblock list_table_headers %}

