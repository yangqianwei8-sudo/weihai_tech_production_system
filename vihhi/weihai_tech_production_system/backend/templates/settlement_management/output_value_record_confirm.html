{% extends "shared/module_base.html" %}

{% block title %}{{ page_title }} - 维海科技信息化管理平台{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <div class="card">
        <div class="card-header">
            <h3>{{ page_title }}</h3>
        </div>
        <div class="card-body">
            <div class="mb-4">
                <h5>产值记录详情</h5>
                <table class="table">
                    <tr>
                        <th>项目编号</th>
                        <td>{{ record.project.project_number }}</td>
                        <th>项目名称</th>
                        <td>{{ record.project.name }}</td>
                    </tr>
                    <tr>
                        <th>产值阶段</th>
                        <td>{{ record.stage.name }}</td>
                        <th>里程碑</th>
                        <td>{{ record.milestone.name }}</td>
                    </tr>
                    <tr>
                        <th>事件</th>
                        <td>{{ record.event.name }}</td>
                        <th>责任人</th>
                        <td>{{ record.responsible_user.get_full_name|default:record.responsible_user.username }}</td>
                    </tr>
                    <tr>
                        <th>计取基数</th>
                        <td>{{ record.base_amount|floatformat:2 }}</td>
                        <th>计算产值</th>
                        <td class="text-primary fw-bold">{{ record.calculated_value|floatformat:2 }}</td>
                    </tr>
                    <tr>
                        <th>阶段比例</th>
                        <td>{{ record.stage_percentage }}%</td>
                        <th>里程碑比例</th>
                        <td>{{ record.milestone_percentage }}%</td>
                    </tr>
                    <tr>
                        <th>事件比例</th>
                        <td>{{ record.event_percentage }}%</td>
                        <th>计算时间</th>
                        <td>{{ record.calculated_time|date:"Y-m-d H:i" }}</td>
                    </tr>
                </table>
            </div>

            <form method="post">
                {% csrf_token %}
                <div class="mb-3">
                    <button type="submit" class="btn btn-primary">确认产值</button>
                    <a href="{% url 'settlement_pages:output_value_record_list' %}" class="btn btn-outline-secondary">返回</a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
