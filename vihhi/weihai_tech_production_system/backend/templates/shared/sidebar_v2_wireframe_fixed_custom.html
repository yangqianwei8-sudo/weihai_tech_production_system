{% load static %}

<aside class="vh-sb" aria-label="左侧栏（全屏固定）">
  <!-- 顶部标题区域 -->
  <div class="vh-sb__top">
    <div class="vh-sb__topInner">
      <div class="vh-sb__titleWrap">
        <div class="vh-sb__title">{% block sidebar_title %}计划管理{% endblock %}</div>
        <div class="vh-sb__sub">{% block sidebar_subtitle %}Plan Management{% endblock %}</div>
      </div>
    </div>
  </div>

  <!-- 导航菜单区域 -->
  <nav class="vh-sb__nav" role="navigation" aria-label="主导航菜单">
    {% if plan_menu or module_sidebar_nav %}
      {% with menu_items=plan_menu|default:module_sidebar_nav %}
        {% for item in menu_items %}
          {% if item.children %}
            <!-- 父级菜单项 -->
            <div class="vh-sb__parent" role="group" aria-label="{{ item.label }}">
              <a href="{% if item.url %}{{ item.url }}{% else %}#{% endif %}" 
                 class="vh-sb__item vh-sb__item--parent {% if item.active %}is-active{% endif %}"
                 {% if item.active %}aria-current="page"{% endif %}
                 aria-expanded="false">
                <span class="vh-sb__icon" aria-hidden="true">{{ item.icon|default:"▢" }}</span>
                <span class="vh-sb__label">{{ item.label }}</span>
              </a>
              <div class="vh-sb__children" role="group" aria-label="{{ item.label }} 子菜单">
                {% for child in item.children %}
                  <a href="{% if child.url %}{{ child.url }}{% else %}#{% endif %}" 
                     class="vh-sb__child {% if child.active %}is-active{% endif %}"
                     {% if child.active %}aria-current="page"{% endif %}>
                    <span class="vh-sb__icon" aria-hidden="true">{{ child.icon|default:"·" }}</span>
                    <span class="vh-sb__label">{{ child.label }}</span>
                  </a>
                {% endfor %}
              </div>
            </div>
          {% else %}
            <!-- 单级菜单项 -->
            <a href="{% if item.url %}{{ item.url }}{% else %}#{% endif %}" 
               class="vh-sb__item {% if item.active %}is-active{% endif %}"
               {% if item.active %}aria-current="page"{% endif %}>
              <span class="vh-sb__icon" aria-hidden="true">{{ item.icon|default:"▢" }}</span>
              <span class="vh-sb__label">{{ item.label }}</span>
              {% if item.badge %}
                <span class="vh-sb__badge {% if item.badge == 'dot' %}vh-sb__badge--dot{% endif %}" aria-label="通知数量">
                  {{ item.badge }}
                </span>
              {% endif %}
            </a>
          {% endif %}
        {% endfor %}
      {% endwith %}
    {% else %}
      <!-- 默认菜单项（当没有菜单数据时） -->
      <div class="vh-sb__item is-active" aria-current="page">
        <span class="vh-sb__icon" aria-hidden="true">▣</span>
        <span class="vh-sb__label">计划首页</span>
      </div>
    {% endif %}
  </nav>

  <!-- 底部操作区域 -->
  <div class="vh-sb__bottom" role="toolbar" aria-label="侧边栏操作">
    <button type="button" class="vh-sb__mini" aria-label="打开帮助页面">
      帮助
    </button>
    <button type="button" class="vh-sb__mini" aria-label="打开设置页面">
      设置
    </button>
    <button type="button" class="vh-sb__mini" aria-label="提交反馈">
      反馈
    </button>
  </div>
</aside>
