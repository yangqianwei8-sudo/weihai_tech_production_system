{% extends "plan_management/_base.html" %}
{% load static %}

{% block pm_title %}å®¡æ‰¹è°ƒæ•´ç”³è¯·{% endblock %}
{% block pm_subtitle %}<span class="pm-subtitle">{{ plan.name }}</span>{% endblock %}

{% block pm_actions %}
<a href="{% url 'plan_pages:plan_adjustment_list' %}" class="list-btn">
  è¿”å›åˆ—è¡¨
</a>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/components/list_layout.css' %}">
{% endblock %}

{% block pm_content %}
<div class="detail-card">
  <div class="detail-card-title">ğŸ“‹ è°ƒæ•´ç”³è¯·ä¿¡æ¯</div>
  <div class="detail-info-grid">
    <div class="detail-info-item">
      <div class="detail-info-label">è®¡åˆ’ç¼–å·</div>
      <div class="detail-info-value">{{ plan.plan_number }}</div>
    </div>
    <div class="detail-info-item">
      <div class="detail-info-label">è®¡åˆ’åç§°</div>
      <div class="detail-info-value">{{ plan.name }}</div>
    </div>
    <div class="detail-info-item">
      <div class="detail-info-label">ç”³è¯·äºº</div>
      <div class="detail-info-value">{% if adjustment.created_by %}{{ adjustment.created_by.get_full_name|default:adjustment.created_by.username }}{% else %}-{% endif %}</div>
    </div>
    <div class="detail-info-item">
      <div class="detail-info-label">ç”³è¯·æ—¶é—´</div>
      <div class="detail-info-value">{{ adjustment.created_time|date:"Y-m-d H:i" }}</div>
    </div>
    <div class="detail-info-item">
      <div class="detail-info-label">åŸæˆªæ­¢æ—¶é—´</div>
      <div class="detail-info-value">{{ adjustment.original_end_time|date:"Y-m-d H:i" }}</div>
    </div>
    <div class="detail-info-item">
      <div class="detail-info-label">æ–°æˆªæ­¢æ—¶é—´</div>
      <div class="detail-info-value"><strong>{{ adjustment.new_end_time|date:"Y-m-d H:i" }}</strong></div>
    </div>
  </div>
</div>

<div class="detail-card" style="margin-top: 20px;">
  <div class="detail-card-title">ğŸ“ è°ƒæ•´åŸå› </div>
  <div style="padding: 16px; font-size: 12px; color: #333333; line-height: 1.6;">
    {{ adjustment.adjustment_reason|linebreaks }}
  </div>
</div>

<div class="detail-card" style="margin-top: 20px;">
  <div class="detail-card-title">ğŸ“„ è°ƒæ•´å†…å®¹</div>
  <div style="padding: 16px; font-size: 12px; color: #333333; line-height: 1.6;">
    {{ adjustment.adjustment_content|linebreaks }}
  </div>
</div>

<form method="post" style="margin-top: 20px;">
  {% csrf_token %}
  <div class="detail-card">
    <div class="detail-card-title">âœ… å®¡æ‰¹æ„è§</div>
    <div style="padding: 16px;">
      <textarea name="approval_notes" rows="4" class="form-control" placeholder="è¯·è¾“å…¥å®¡æ‰¹æ„è§ï¼ˆå¯é€‰ï¼‰"></textarea>
    </div>
  </div>
  
  <div style="margin-top: 20px; display: flex; justify-content: flex-end; gap: 12px;">
    <a href="{% url 'plan_pages:plan_adjustment_list' %}" class="list-btn">å–æ¶ˆ</a>
    <button type="submit" class="list-btn list-btn-primary">æ‰¹å‡†ç”³è¯·</button>
  </div>
</form>
{% endblock %}
