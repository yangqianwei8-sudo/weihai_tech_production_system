# Generated by Django 4.2.7 on 2025-12-02 12:32

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('production_management', '0001_initial'),
        ('delivery_customer', '0002_rename_delivery_fe_deliver_idx_delivery_fe_deliver_0bd1fe_idx_and_more'),
    ]

    operations = [
        migrations.AlterField(
            model_name='deliveryrecord',
            name='project',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='delivery_records', to='production_management.project', verbose_name='关联项目'),
        ),
        migrations.AlterField(
            model_name='deliveryrecord',
            name='status',
            field=models.CharField(choices=[('draft', '草稿'), ('submitted', '已报送'), ('pending_approval', '待审核'), ('approving', '审核中'), ('approved', '审核通过'), ('rejected', '审核驳回'), ('in_transit', '运输中'), ('delivered', '已送达'), ('sent', '已发送'), ('received', '已接收'), ('confirmed', '已确认'), ('feedback_received', '已反馈'), ('archived', '已归档'), ('failed', '发送失败'), ('cancelled', '已取消'), ('overdue', '已逾期')], db_index=True, default='draft', max_length=20, verbose_name='状态'),
        ),
        migrations.CreateModel(
            name='OutgoingDocument',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('document_number', models.CharField(db_index=True, max_length=50, unique=True, verbose_name='发文编号')),
                ('title', models.CharField(max_length=200, verbose_name='文件标题')),
                ('recipient', models.CharField(max_length=200, verbose_name='收文单位')),
                ('recipient_contact', models.CharField(blank=True, max_length=100, verbose_name='联系人')),
                ('recipient_phone', models.CharField(blank=True, max_length=20, verbose_name='联系电话')),
                ('recipient_address', models.TextField(blank=True, verbose_name='收文地址')),
                ('document_date', models.DateField(blank=True, null=True, verbose_name='文件日期')),
                ('send_date', models.DateField(blank=True, null=True, verbose_name='发文日期')),
                ('document_type', models.CharField(blank=True, max_length=50, verbose_name='文件类型')),
                ('content', models.TextField(blank=True, verbose_name='文件内容')),
                ('summary', models.TextField(blank=True, verbose_name='摘要')),
                ('status', models.CharField(choices=[('draft', '草稿'), ('reviewing', '审核中'), ('approved', '已批准'), ('sent', '已发出'), ('completed', '已完成'), ('archived', '已归档')], db_index=True, default='draft', max_length=20, verbose_name='状态')),
                ('priority', models.CharField(choices=[('low', '低'), ('normal', '普通'), ('high', '高'), ('urgent', '紧急')], default='normal', max_length=20, verbose_name='优先级')),
                ('review_notes', models.TextField(blank=True, verbose_name='审核意见')),
                ('reviewed_at', models.DateTimeField(blank=True, null=True, verbose_name='审核时间')),
                ('send_method', models.CharField(blank=True, help_text='如：快递、邮件、送达等', max_length=50, verbose_name='发送方式')),
                ('sent_at', models.DateTimeField(blank=True, null=True, verbose_name='发送时间')),
                ('attachment', models.FileField(blank=True, null=True, upload_to='outgoing_documents/%Y/%m/%d/', verbose_name='附件')),
                ('notes', models.TextField(blank=True, verbose_name='备注')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='创建时间')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新时间')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_outgoing_documents', to=settings.AUTH_USER_MODEL, verbose_name='创建人')),
                ('reviewer', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='reviewed_outgoing_documents', to=settings.AUTH_USER_MODEL, verbose_name='审核人')),
                ('sender', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='sent_outgoing_documents', to=settings.AUTH_USER_MODEL, verbose_name='发送人')),
            ],
            options={
                'verbose_name': '发文',
                'verbose_name_plural': '发文',
                'db_table': 'outgoing_document',
                'ordering': ['-send_date', '-created_at'],
                'indexes': [models.Index(fields=['status', '-send_date'], name='outgoing_do_status_eb633a_idx'), models.Index(fields=['reviewer', '-created_at'], name='outgoing_do_reviewe_34eaba_idx')],
            },
        ),
        migrations.CreateModel(
            name='IncomingDocument',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('document_number', models.CharField(db_index=True, max_length=50, unique=True, verbose_name='收文编号')),
                ('title', models.CharField(max_length=200, verbose_name='文件标题')),
                ('sender', models.CharField(max_length=200, verbose_name='发文单位')),
                ('sender_contact', models.CharField(blank=True, max_length=100, verbose_name='联系人')),
                ('sender_phone', models.CharField(blank=True, max_length=20, verbose_name='联系电话')),
                ('document_date', models.DateField(blank=True, null=True, verbose_name='文件日期')),
                ('receive_date', models.DateField(blank=True, null=True, verbose_name='收文日期')),
                ('document_type', models.CharField(blank=True, max_length=50, verbose_name='文件类型')),
                ('content', models.TextField(blank=True, verbose_name='文件内容')),
                ('summary', models.TextField(blank=True, verbose_name='摘要')),
                ('status', models.CharField(choices=[('draft', '草稿'), ('registered', '已登记'), ('processing', '处理中'), ('completed', '已完成'), ('archived', '已归档')], db_index=True, default='draft', max_length=20, verbose_name='状态')),
                ('priority', models.CharField(choices=[('low', '低'), ('normal', '普通'), ('high', '高'), ('urgent', '紧急')], default='normal', max_length=20, verbose_name='优先级')),
                ('handle_notes', models.TextField(blank=True, verbose_name='处理意见')),
                ('completed_at', models.DateTimeField(blank=True, null=True, verbose_name='完成时间')),
                ('attachment', models.FileField(blank=True, null=True, upload_to='incoming_documents/%Y/%m/%d/', verbose_name='附件')),
                ('notes', models.TextField(blank=True, verbose_name='备注')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='创建时间')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新时间')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_incoming_documents', to=settings.AUTH_USER_MODEL, verbose_name='创建人')),
                ('handler', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='handled_incoming_documents', to=settings.AUTH_USER_MODEL, verbose_name='处理人')),
            ],
            options={
                'verbose_name': '收文',
                'verbose_name_plural': '收文',
                'db_table': 'incoming_document',
                'ordering': ['-receive_date', '-created_at'],
                'indexes': [models.Index(fields=['status', '-receive_date'], name='incoming_do_status_bd66cf_idx'), models.Index(fields=['handler', '-created_at'], name='incoming_do_handler_6dfeec_idx')],
            },
        ),
        migrations.CreateModel(
            name='ExpressCompany',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(db_index=True, help_text='如：顺丰、圆通等', max_length=100, unique=True, verbose_name='快递公司名称')),
                ('code', models.CharField(blank=True, help_text='快递100等API使用的代码', max_length=50, verbose_name='快递公司代码')),
                ('alias', models.CharField(blank=True, help_text='多个别名用逗号分隔，如：顺丰速运,SF', max_length=200, verbose_name='别名')),
                ('contact_phone', models.CharField(blank=True, max_length=20, verbose_name='联系电话')),
                ('contact_email', models.EmailField(blank=True, max_length=255, verbose_name='联系邮箱')),
                ('website', models.URLField(blank=True, max_length=255, verbose_name='官网')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='禁用后不会在创建交付时显示', verbose_name='是否启用')),
                ('is_default', models.BooleanField(default=False, help_text='设为默认后，创建快递交付时自动选中', verbose_name='是否默认')),
                ('sort_order', models.IntegerField(db_index=True, default=0, help_text='数字越小越靠前', verbose_name='排序')),
                ('notes', models.TextField(blank=True, verbose_name='备注')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='创建时间')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新时间')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_express_companies', to=settings.AUTH_USER_MODEL, verbose_name='创建人')),
            ],
            options={
                'verbose_name': '快递公司',
                'verbose_name_plural': '快递公司',
                'db_table': 'express_company',
                'ordering': ['sort_order', 'name'],
                'indexes': [models.Index(fields=['is_active', 'sort_order'], name='express_com_is_acti_bc9bb7_idx'), models.Index(fields=['is_default', '-created_at'], name='express_com_is_defa_b13d38_idx')],
            },
        ),
        migrations.CreateModel(
            name='DeliveryApproval',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('approval_level', models.IntegerField(default=1, help_text='多级审核时使用，数字越大级别越高', verbose_name='审核级别')),
                ('result', models.CharField(choices=[('pending', '待审核'), ('approved', '审核通过'), ('rejected', '审核驳回')], db_index=True, default='pending', max_length=20, verbose_name='审核结果')),
                ('comment', models.TextField(blank=True, verbose_name='审核意见')),
                ('approval_time', models.DateTimeField(blank=True, db_index=True, null=True, verbose_name='审核时间')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='创建时间')),
                ('approver', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='delivery_approvals', to=settings.AUTH_USER_MODEL, verbose_name='审核人')),
                ('delivery_record', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='approvals', to='delivery_customer.deliveryrecord', verbose_name='交付记录')),
                ('transferred_from', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='delivery_transferred_approvals', to=settings.AUTH_USER_MODEL, verbose_name='转交人')),
                ('transferred_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='received_approvals', to=settings.AUTH_USER_MODEL, verbose_name='转交至')),
            ],
            options={
                'verbose_name': '交付审核',
                'verbose_name_plural': '交付审核',
                'db_table': 'delivery_approval',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['delivery_record', '-created_at'], name='delivery_ap_deliver_37615c_idx'), models.Index(fields=['approver', '-created_at'], name='delivery_ap_approve_aedf41_idx'), models.Index(fields=['result', '-created_at'], name='delivery_ap_result_2c3815_idx')],
            },
        ),
    ]
