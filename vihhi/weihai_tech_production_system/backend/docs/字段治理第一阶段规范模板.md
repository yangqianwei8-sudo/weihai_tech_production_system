# 字段治理第一阶段规范模板

> **适用范围**：全系统各模块  
> **治理阶段**：第一阶段（只梳理、标记、定型，不重构）  
> **创建时间**：2025-01-XX

---

## 一、治理目标

明确每个字段的：
1. **业务含义**：字段在业务中的实际作用
2. **参与判断**：字段在哪些业务逻辑中作为"裁决依据"
3. **是否可直接修改**：字段是否允许业务直接修改，还是必须通过特定流程

---

## 二、字段分类标准

### 2.1 输入字段（用户可直接修改）

**定义**：用户可在表单中直接编辑的字段，用于业务输入

**特点**：
- ✅ 允许用户直接修改
- ✅ 通常用于业务内容输入
- ✅ 修改不需要特殊流程

**示例**：
- 名称、描述、内容等文本字段
- 用户输入的业务数据

---

### 2.2 管理字段（必须通过特定流程修改）

**定义**：涉及业务规则，必须通过特定流程或服务层修改的字段

**特点**：
- ⚠️ 必须通过特定流程修改
- ⚠️ 通常涉及业务规则和状态管理
- ⚠️ 修改需要权限或审批

**示例**：
- `status`：必须通过状态机或裁决器
- `end_time`：建议通过调整申请流程
- `progress`：建议通过进度记录流程

---

### 2.3 系统字段（系统自动管理）

**定义**：完全由系统管理，用户不可直接修改的字段

**特点**：
- ❌ 系统自动生成/计算
- ❌ 用户不可直接修改
- ❌ 通常用于系统内部管理

**示例**：
- 编号、创建时间、更新时间
- 自动计算的字段（如完成率、周期天数）

---

### 2.4 证据字段（一旦写入即为事实记录）

**定义**：用于业务追溯和裁决，一旦写入即为事实记录的字段

**特点**：
- ❌ 一旦写入即为事实记录
- ❌ 不建议修改、不建议删除
- ❌ 用于业务追溯和裁决

**示例**：
- 日志记录（状态日志、操作日志）
- 证据记录（不作为记录、调整记录）
- 决策记录（审批记录、裁决记录）

---

## 三、字段—业务关系表模板

### 3.1 主模型字段表

| 字段 | 所属模型 | 业务含义 | 参与判断 | 是否可直接修改 | 备注 |
|------|---------|---------|---------|--------------|------|
| `field_name` | ModelName | 字段的业务含义 | 字段在哪些业务逻辑中作为裁决依据 | ✅/⚠️/❌ | 其他说明 |

**字段说明**：
- **字段**：字段名称
- **所属模型**：字段所属的 Django 模型
- **业务含义**：字段在业务中的实际作用
- **参与判断**：字段在哪些业务逻辑中作为"裁决依据"（如：逾期判断、完成判定、状态裁决等）
- **是否可直接修改**：
  - ✅：用户可直接修改（输入字段）
  - ⚠️：必须通过特定流程修改（管理字段）
  - ❌：系统自动管理，不可修改（系统字段）
- **备注**：其他需要说明的内容

---

### 3.2 证据模型字段表

对于证据模型（日志、记录等），需要单独列出：

| 字段 | 业务含义 | 参与判断 | 是否可直接修改 | 备注 |
|------|---------|---------|--------------|------|
| `field_name` | 字段的业务含义 | 字段在哪些业务逻辑中作为裁决依据 | ✅/⚠️/❌ | 其他说明 |

**证据属性**：✅ 证据字段，一旦写入即为事实记录，不可修改/不建议修改、不可删除/不建议删除

---

## 四、关键业务判断中的字段使用

对于每个关键业务判断，需要明确：

### 4.1 [业务判断名称]

**使用字段**：`field1`、`field2`

**判断逻辑**：
```python
# 代码示例或伪代码
if field1 > threshold:
    # 判断逻辑
```

**业务含义**：该判断的业务含义

---

## 五、字段修改约束总结

### 5.1 不可修改的字段

- `field1`：原因说明
- `field2`：原因说明

---

### 5.2 必须通过特定流程修改的字段

- `field1`：必须通过 `ServiceName.method()` 修改
- `field2`：必须通过 `ModelName` 申请流程

---

### 5.3 创建后不建议修改的字段

- `field1`：原因说明
- `field2`：原因说明

---

## 六、使用说明

### 6.1 如何填写字段—业务关系表

1. **业务含义**：
   - 不是字段的技术说明，而是业务作用
   - 例如：不是"存储计划名称"，而是"计划名称，用于标识和展示"

2. **参与判断**：
   - 明确字段在哪些业务逻辑中作为"裁决依据"
   - 例如："逾期判断、不作为检测"、"完成判定、裁决依据"

3. **是否可直接修改**：
   - ✅：用户可直接修改（输入字段）
   - ⚠️：必须通过特定流程修改（管理字段）
   - ❌：系统自动管理，不可修改（系统字段）

4. **备注**：
   - 字段的特殊说明
   - 例如：格式要求、取值范围、关联关系等

---

### 6.2 如何识别关键业务判断

关键业务判断通常包括：
- 状态转换判断（如：是否可以从 A 状态转换到 B 状态）
- 完成判定（如：是否已完成）
- 逾期判断（如：是否已逾期）
- 不作为检测（如：是否存在不作为）
- 责任界定（如：责任人是谁）
- 权限判断（如：是否有权限执行操作）

---

### 6.3 如何识别证据字段

证据字段通常包括：
- 日志记录（状态日志、操作日志）
- 证据记录（不作为记录、调整记录）
- 决策记录（审批记录、裁决记录）

**判断标准**：
- 一旦写入即为事实记录
- 用于业务追溯和裁决
- 不建议修改、不建议删除

---

## 七、维护说明

1. **本文档为第一阶段治理成果**，只做梳理、标记、定型，不做重构
2. **后续如有字段变更**，请及时更新对应模块的字段—业务关系表
3. **P3 阶段进行字段重构时**，可基于字段—业务关系表进行规划
4. **新字段添加时**，请按照本模板格式补充字段—业务关系

---

## 八、示例参考

参考文档：
- `plan_management/docs/字段治理第一阶段-字段业务关系表.md`

---

**文档版本**：v1.0  
**最后更新**：2025-01-XX  
**维护人**：架构负责人
