# 维海科技信息化管理平台 - 功能结构总览

**文档版本**：v6.1（系统管理优化版）  
**更新日期**：2025-01-XX  
**系统架构**：Django后端渲染 + RESTful API  
**维护者**：维海科技开发团队

---

## 📋 系统总体架构

### 导航结构
```
┌─────────────────────────────────────────────────────────────┐
│                    工作台（Dashboard）                      │
│        导航、通知、待办、数据统计                            │
└─────────────────────────────────────────────────────────────┘
                            │
        ┌───────────────────┼───────────────────┐
        │                   │                   │
        │                   │                   │
    ┌───▼────┐  ┌───────────▼────────┐  ┌───────▼────┐
    │ 业务   │  │      管理          │  │   系统     │
    │ 模块   │  │      模块          │  │   模块     │
    └────────┘  └───────────────────┘  └────────────┘
```

### 页面布局结构
进入功能模块后，页面布局如下：
```
┌──────────┬────────────────────────────────────────────────┤
│          │                                                   │
│  左侧    │  中间上部区域：筛选区                             │
│  导航栏  │  （筛选条件、搜索框、快捷操作等）                 │
│  （本    ├────────────────────────────────────────────────┤
│  功能    │                                                   │
│  空间    │  中间下部区域：列表区                             │
│  导航    │  （数据列表、表格、卡片等）                       │
│  栏）    │                                                   │
│          │                                                   │
└──────────┴────────────────────────────────────────────────┘
```

---

## 🔄 项目状态流转逻辑

### 功能定位
- **状态**：✅ 已完成（基础功能）
- **说明**：本文档详细描述了项目在不同模块间和模块内部的状态流转逻辑，包括状态定义、流转条件、触发操作、权限控制等。这是系统核心业务逻辑的重要组成部分。

### 一、项目状态体系

#### 1.1 项目主状态（PROJECT_STATUS）

项目主状态用于标识项目在整个生命周期中的主要阶段：

| 状态代码 | 状态名称 | 说明 | 所属模块 |
|---------|---------|------|---------|
| `draft` | 草稿 | 立项信息创建但未提交 | 商机管理 |
| `waiting_receive` | 待接收 | 立项完成，移交至生产管理，等待项目负责人接收 | 生产管理 |
| `configuring` | 配置中 | 项目负责人已接收，正在进行项目配置（团队配置、任务准备等） | 生产管理 |
| `waiting_start` | 待开工 | 项目配置完成，等待开工 | 生产管理 |
| `in_progress` | 进行中 | 项目已开工，正在执行中 | 生产管理 |
| `suspended` | 暂停 | 项目暂停（可恢复） | 生产管理 |
| `completed` | 已完工 | 项目生产工作已完成，等待结算 | 生产管理 |
| `waiting_settlement` | 待结算 | 项目已完工，已启动结算流程（自动触发） | 结算管理 |
| `settled` | 已结算 | 项目结算已完成 | 结算管理 |
| `archived` | 已归档 | 项目结算完成、复盘完成，已归档到档案管理模块（自动触发） | 档案管理 |
| `cancelled` | 已取消 | 项目被取消（不可恢复） | 各模块 |

#### 1.2 项目启动状态（LAUNCH_STATUS）

项目启动状态用于标识项目在生产准备阶段的具体状态，是项目主状态在生产准备阶段的细化补充。

**启动状态与主状态的对应关系：**
- **待商务移交** (`handover_pending`)：对应主状态"立项已审批" → "待接收"
- **待图纸上传** (`awaiting_drawings`)：对应主状态"配置中"
- **预审中** (`precheck_in_progress`)：对应主状态"配置中"
- **待补充资料** (`changes_requested`)：对应主状态"配置中"
- **待开工通知** (`ready_to_start`)：对应主状态"待开工"
- **已开工** (`started`)：对应主状态"进行中"

**启动状态详细说明：**

| 状态代码 | 状态名称 | 说明 | 触发条件 | 对应主状态 |
|---------|---------|------|---------|-----------|
| `handover_pending` | 待商务移交 | 立项完成，等待商务移交 | 立项审批通过后 | 立项已审批 → 待接收 |
| `awaiting_drawings` | 待图纸上传 | 等待上传优化前图纸/资料 | 项目接收后 | 配置中 |
| `precheck_in_progress` | 预审中 | 图纸/资料预审中 | 图纸上传后 | 配置中 |
| `changes_requested` | 待补充资料 | 预审未通过，需补充资料 | 预审驳回后 | 配置中 |
| `ready_to_start` | 待开工通知 | 预审通过，等待发布开工通知 | 预审通过后 | 待开工 |
| `started` | 已开工 | 已发布开工通知，项目正式开工 | 开工通知发布后 | 进行中 |

#### 1.3 项目流程步骤（FLOW_STEPS）

项目流程步骤用于标识项目在生产执行阶段的具体步骤，是项目主状态在生产执行阶段的细化补充。

**流程步骤与主状态的对应关系：**
- **等待资料上传** (`pending_documents`)：对应主状态"配置中"，启动状态"待图纸上传"
- **资料预审** (`precheck`)：对应主状态"配置中"，启动状态"预审中"
- **开工通知** (`start_notice`)：对应主状态"待开工"，启动状态"待开工通知"
- **意见编制** (`opinions`)：对应主状态"进行中"，启动状态"已开工"
- **内部审核** (`internal_review`)：对应主状态"进行中"，启动状态"已开工"
- **待推送** (`ready_to_push`)：对应主状态"进行中"，启动状态"已开工"
- **报告已推送** (`pushed`)：对应主状态"进行中"，启动状态"已开工"

**流程步骤详细说明：**

| 步骤代码 | 步骤名称 | 说明 | 所属阶段 | 对应主状态 | 对应启动状态 |
|---------|---------|------|---------|-----------|-------------|
| `pending_documents` | 等待资料上传 | 等待上传优化前资料 | 生产准备 | 配置中 | 待图纸上传 |
| `precheck` | 资料预审 | 资料预审中 | 生产准备 | 配置中 | 预审中 |
| `start_notice` | 开工通知 | 发布开工通知 | 生产准备 | 待开工 | 待开工通知 |
| `opinions` | 意见编制 | 专业工程师编制意见 | 生产执行 | 进行中 | 已开工 |
| `internal_review` | 内部审核 | 专业负责人和项目负责人审核 | 生产执行 | 进行中 | 已开工 |
| `ready_to_push` | 待推送 | 审核通过，准备推送交付 | 生产执行 | 进行中 | 已开工 |
| `pushed` | 报告已推送 | 报告已推送至收发管理 | 生产执行 | 进行中 | 已开工 |

### 二、项目状态流转逻辑

#### 2.1 项目主状态流转图

```
┌─────────────────────────────────────────────────────────────┐
│              项目主状态流转图                                │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  1. 立项阶段（商机管理模块）                                │
│     ┌──────────┐                                            │
│     │  草稿    │                                            │
│     └────┬─────┘                                            │
│          │ 提交立项                                          │
│          ↓                                                   │
│     ┌──────────────────┐                                    │
│     │  待立项审批      │                                    │
│     └────┬─────────────┘                                    │
│          │                                                  │
│          ├──→ 审批通过                                       │
│          │     ↓                                            │
│          │  ┌──────────────────┐                           │
│          │  │  立项已审批      │                           │
│          │  └────┬─────────────┘                           │
│          │       │ 移交生产管理                              │
│          │       ↓                                           │
│          │  ┌──────────────────┐                           │
│          │  │  待接收          │                           │
│          │  └──────────────────┘                           │
│          │                                                  │
│          └──→ 审批驳回                                       │
│                ↓                                            │
│            ┌──────────────────┐                            │
│            │  立项审批已驳回  │                            │
│            └────┬─────────────┘                            │
│                 │ 修改后重新提交                             │
│                 └──→ 返回"待立项审批"                        │
│                                                             │
│  2. 生产准备阶段（生产管理模块）                            │
│     ┌──────────────────┐                                    │
│     │  待接收          │                                    │
│     └────┬─────────────┘                                    │
│          │ 项目负责人接收                                    │
│          ↓                                                   │
│     ┌──────────────────┐                                    │
│     │  配置中          │                                    │
│     └────┬─────────────┘                                    │
│          │ 项目配置完成                                      │
│          ↓                                                   │
│     ┌──────────────────┐                                    │
│     │  待开工          │                                    │
│     └────┬─────────────┘                                    │
│          │ 发布开工通知                                      │
│          ↓                                                   │
│                                                             │
│  3. 生产执行阶段（生产管理模块）                            │
│     ┌──────────────────┐                                    │
│     │  进行中          │                                    │
│     └────┬─────────────┘                                    │
│          │                                                  │
│          ├──→ 项目暂停                                       │
│          │     ↓                                            │
│          │  ┌──────────────────┐                           │
│          │  │  暂停            │                           │
│          │  └────┬─────────────┘                           │
│          │       │ 恢复项目                                  │
│          │       └──→ 返回"进行中"                          │
│          │                                                  │
│          └──→ 项目完成                                       │
│                ↓                                            │
│            ┌──────────────────┐                            │
│            │  已完工          │                            │
│            └────┬─────────────┘                            │
│                 │ 自动触发                                  │
│                 ↓                                            │
│                                                             │
│  4. 结算阶段（结算管理模块）                                │
│     ┌──────────────────┐                                    │
│     │  待结算          │（自动触发）                        │
│     └────┬─────────────┘                                    │
│          │ 结算完成                                          │
│          ↓                                                   │
│     ┌──────────────────┐                                    │
│     │  已结算          │                                    │
│     └────┬─────────────┘                                    │
│          │ 自动触发                                          │
│          ↓                                                   │
│                                                             │
│  5. 项目收尾阶段（档案管理模块）                            │
│     ┌──────────────────┐                                    │
│     │  已归档          │（自动触发）                        │
│     └──────────────────┘                                    │
│                                                             │
│  6. 异常状态                                                │
│     ┌──────────────────┐                                    │
│     │  已取消          │（任何阶段都可能取消）              │
│     └──────────────────┘                                    │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 三、关键状态流转规则

#### 3.1 商机管理模块状态流转

**商机状态流转**：
- **潜在客户 → 初步接触 → 需求确认 → 方案报价 → 商务谈判 → 赢单/输单**

**立项状态流转**（赢单后）：
- **草稿 → 待立项审批**：商务经理提交立项申请
- **待立项审批 → 立项已审批**：审批流程完成，审批通过（系统自动）
- **待立项审批 → 立项审批已驳回**：审批流程中任一节点驳回
- **立项已审批 → 待接收**：商务经理完成立项，移交生产管理

#### 3.2 生产管理模块状态流转

- **待接收 → 配置中**：项目负责人接收项目
- **配置中 → 待开工**：项目配置完成（团队配置、任务准备、图纸预审通过）
- **待开工 → 进行中**：发布开工通知
- **进行中 → 暂停**：项目负责人暂停项目
- **暂停 → 进行中**：项目负责人恢复项目
- **进行中 → 已完工**：项目负责人确认项目完成
- **已完工 → 待结算**：**自动触发**（满足条件后系统自动触发）

#### 3.3 结算管理模块状态流转

- **待结算 → 已结算**：结算定案完成（需审批）

#### 3.4 档案管理模块状态流转

- **已结算 → 已归档**：**自动触发**（满足条件后系统自动触发）

#### 3.5 异常状态流转

- **任意状态 → 已取消**：取消项目（需审批）

### 四、状态流转权限控制

#### 4.1 状态流转权限矩阵

| 状态流转 | 操作人 | 权限要求 | 是否需要审批 |
|---------|--------|---------|-------------|
| 草稿 → 待立项审批 | 商务经理 | 商务经理角色 | 是（立项审批） |
| 待立项审批 → 立项已审批 | 审批人 | 审批权限 | 是（审批流程） |
| 待立项审批 → 立项审批已驳回 | 审批人 | 审批权限 | 是（审批流程） |
| 立项已审批 → 待接收 | 商务经理 | 商务经理角色 | 否 |
| 赢单 → 草稿（立项） | 商务经理 | 商务经理角色 | 否（自动创建） |
| 待接收 → 配置中 | 项目负责人 | 项目负责人角色 | 否 |
| 配置中 → 待开工 | 项目负责人 | 项目负责人角色 | 否 |
| 待开工 → 进行中 | 项目负责人 | 项目负责人角色 | 否 |
| 进行中 → 暂停 | 项目负责人 | 项目负责人角色 | 否 |
| 暂停 → 进行中 | 项目负责人 | 项目负责人角色 | 否 |
| 进行中 → 已完工 | 项目负责人 | 项目负责人角色 | 否 |
| 已完工 → 待结算 | 系统自动 | 系统自动 | 否（自动触发） |
| 待结算 → 已结算 | 结算负责人 | 结算管理权限 | 是（结算审批） |
| 已结算 → 已归档 | 系统自动 | 系统自动 | 否（自动触发） |
| 任意状态 → 已取消 | 项目负责人/管理员 | 项目负责人角色/管理员权限 | 是（取消审批） |

#### 4.2 状态流转审批流程

需要审批的状态流转包括：
1. **立项审批**：草稿 → 待立项审批 → 立项已审批/立项审批已驳回
2. **结算审批**：待结算 → 已结算
3. **项目取消审批**：任意状态 → 已取消

审批流程在"系统管理" → "系统设置" → "审批流程引擎配置"中配置。

### 五、状态流转记录与通知

#### 5.1 状态流转记录

每次状态流转都会记录以下信息：
- 流转前状态、流转后状态、流转时间、操作人、流转原因、流转备注、关联数据

#### 5.2 状态流转通知

关键状态流转会触发特别通知：
- **立项审批通过**：通知商务经理、项目负责人
- **项目已接收**：通知商务经理、项目团队成员
- **项目已开工**：通知项目团队成员
- **项目已完工**：通知项目团队成员、结算负责人
- **结算完成**：通知项目负责人、项目团队成员
- **项目已归档**：通知项目负责人、项目团队成员、档案管理员

### 六、详细说明

关于项目状态流转逻辑的详细说明，包括：
- 详细的状态流转规则
- 启动状态流转规则
- 流程步骤流转规则
- 权限控制详细说明
- 状态流转记录与审计
- 状态流转通知机制
- 状态流转异常处理
- 状态流转配置

请参考独立的《项目状态流转逻辑方案.md》文档。

---

## 🏠 工作台（Dashboard）

### 功能定位
- **状态**：✅ 已完成（基础功能）
- **说明**：系统首页，作为所有模块的统一入口和概览。主要功能包括：导航、通知、待办、数据统计（区分员工、部门经理、高管呈现不同的数据统计）

### 主要功能

#### 1. 导航功能
- **功能模块入口**：工作台提供19个功能模块的入口卡片，点击进入对应的功能空间
- **快速导航**：支持快捷键快速跳转到常用模块
- **模块分类**：按业务模块、管理模块、系统模块分类展示
- **报表管理入口**（✅ 已配置，2025-01-30）：
  - **工作台左侧菜单**：在 `backend/core/views.py` 的 `HOME_NAV_STRUCTURE` 中已配置报表管理入口
  - **配置位置**：`HOME_NAV_STRUCTURE` 列表（第71行）
  - **配置代码**：
    ```python
    {'label': '报表管理', 'icon': '📊', 'url_name': 'report_pages:report_list', 'permission': 'report_management.view'}
    ```
  - **权限控制**：通过 `permission` 字段（`report_management.view`）控制报表管理入口的可见性
  - **自动同步**：`HOME_NAV_STRUCTURE` 中的菜单项会自动同步到各功能模块的顶部导航菜单
  - **显示位置**：工作台左侧菜单中，位于"计划管理"之后
  - **顶部菜单**：各功能模块页面顶部导航菜单中自动显示"📊 报表管理"入口

#### 2. 通知功能
- **通知中心**：统一管理所有系统通知
- **通知类型**：
  - 系统通知（系统消息、公告等）
  - 任务通知（任务分配、任务提醒等）
  - 审批通知（待审批、审批结果等）
  - 业务通知（项目状态变更、交付提醒等）
- **通知展示**：
  - 通知列表（按时间倒序）
  - 未读通知数量提示
  - 通知分类筛选
  - 通知搜索功能
- **通知操作**：
  - 标记已读/未读
  - 批量标记已读
  - 删除通知
  - 通知详情查看

#### 3. 待办功能
- **待办事项列表**：统一展示所有待办事项
- **待办类型**：
  - 待审批事项（客户审批、合同审批等）
  - 待处理任务（项目任务、生产任务等）
  - 待回复事项（意见回复、客户反馈等）
  - 待接收事项（项目接收、交付接收等）
- **待办展示**：
  - 待办列表（按优先级和截止时间排序）
  - 待办数量统计
  - 待办分类筛选
  - 待办搜索功能
- **待办操作**：
  - 快速处理待办
  - 跳转到待办详情
  - 标记完成
  - 延期提醒

#### 4. 数据统计功能
**说明**：根据用户角色（员工、部门经理、高管）呈现不同的数据统计内容。工作台采用卡片式布局，支持拖拽排序和自定义显示。

**数据权限规则**：
```
┌─────────────────────────────────────────────────────────────┐
│              工作台数据权限规则体系                            │
├─────────────────────────────────────────────────────────────┤
│ 1. 数据可见范围                                              │
│    ├── 员工角色：仅可见个人相关数据                          │
│    ├── 部门经理：可见部门所有数据 + 个人数据                 │
│    └── 高管角色：可见公司所有数据                            │
│                                                             │
│ 2. 数据计算规则                                              │
│    ├── 个人数据：直接统计个人相关数据                        │
│    ├── 部门数据：汇总部门所有员工的数据                      │
│    └── 公司数据：汇总公司所有部门的数据                      │
│                                                             │
│ 3. 数据权限继承                                              │
│    ├── 部门经理：继承员工权限 + 部门管理权限                 │
│    └── 高管：继承部门经理权限 + 公司管理权限                 │
└─────────────────────────────────────────────────────────────┘
```

**详细数据权限规则**：

##### 4.0.1 员工角色数据权限
- **数据可见范围**：
  - **项目数据**：仅可见本人参与的项目（作为项目负责人、专业负责人、专业工程师、项目成员）
  - **任务数据**：仅可见分配给本人的任务（作为任务负责人、任务执行人）
  - **产值数据**：仅可见本人的产值（作为产值责任人）
  - **客户数据**：仅可见本人负责的客户（作为客户负责人、客户跟进人）
  - **商机数据**：仅可见本人负责的商机（作为商机负责人、商机跟进人）
  - **结算数据**：仅可见本人参与的项目结算（作为结算负责人、结算参与人）
  - **回款数据**：仅可见本人负责的回款（作为回款负责人、回款跟进人）
  - **考勤数据**：仅可见本人的考勤记录
  - **计划数据**：仅可见本人创建或参与的计划（作为计划负责人、计划参与人）
  - **待办数据**：仅可见本人的待办事项（作为审批人、任务执行人、事项负责人）
  - **通知数据**：仅可见发送给本人的通知
- **数据计算规则**：
  - **项目统计**：统计本人参与的项目数量（进行中、待开工、已完成）
  - **任务统计**：统计分配给本人的任务数量（待处理、进行中、已完成）
  - **产值统计**：统计本人的产值（本月产值、累计产值、产值排名）
  - **客户统计**：统计本人负责的客户数量（总客户、活跃客户）
  - **商机统计**：统计本人负责的商机数量（总商机、进行中商机）
  - **考勤统计**：统计本人的考勤数据（出勤天数、请假天数、加班天数、出勤率）
  - **计划统计**：统计本人创建或参与的计划数量（进行中、已完成、完成率）
- **数据权限说明**：
  - 员工角色只能查看和操作个人相关数据
  - 无法查看其他员工的数据（除非有特殊权限）
  - 无法查看部门整体数据
  - 无法查看公司整体数据

##### 4.0.2 部门经理角色数据权限
- **数据可见范围**：
  - **个人数据**：可见本人的所有数据（继承员工权限）
  - **部门项目数据**：可见本部门所有员工参与的项目（部门内所有项目）
  - **部门任务数据**：可见本部门所有员工的任务（部门内所有任务）
  - **部门产值数据**：可见本部门所有员工的产值（部门内所有产值）
  - **部门客户数据**：可见本部门所有员工负责的客户（部门内所有客户）
  - **部门商机数据**：可见本部门所有员工负责的商机（部门内所有商机）
  - **部门结算数据**：可见本部门所有员工参与的项目结算（部门内所有结算）
  - **部门回款数据**：可见本部门所有员工负责的回款（部门内所有回款）
  - **部门人员数据**：可见本部门所有员工的基本信息、考勤、产值等
  - **部门考勤数据**：可见本部门所有员工的考勤记录
  - **部门计划数据**：可见本部门所有员工创建或参与的计划（部门内所有计划）
  - **部门待办数据**：可见本部门所有员工的待办事项（部门内所有待办）
  - **部门通知数据**：可见发送给本部门所有员工的通知
- **数据计算规则**：
  - **部门项目统计**：汇总本部门所有员工参与的项目数量（进行中、待开工、已完成）
  - **部门任务统计**：汇总本部门所有员工的任务数量（待处理、进行中、已完成）
  - **部门产值统计**：汇总本部门所有员工的产值（本月产值、累计产值、人均产值）
  - **部门客户统计**：汇总本部门所有员工负责的客户数量（总客户、活跃客户）
  - **部门商机统计**：汇总本部门所有员工负责的商机数量（总商机、进行中商机）
  - **部门人员统计**：统计本部门员工数量（总人数、在岗人数、请假人数、出勤率）
  - **部门考勤统计**：汇总本部门所有员工的考勤数据（出勤天数、请假天数、加班天数、出勤率）
  - **部门计划统计**：汇总本部门所有员工创建或参与的计划数量（进行中、已完成、完成率）
  - **部门效率统计**：计算部门效率指标（人均产值、任务完成率、项目完成率）
  - **部门排名统计**：计算部门在公司内的排名（产值排名、效率排名）
- **数据权限说明**：
  - 部门经理可以查看和操作个人数据（继承员工权限）
  - 部门经理可以查看本部门所有员工的数据（部门管理权限）
  - 部门经理无法查看其他部门的数据（除非有特殊权限）
  - 部门经理无法查看公司整体数据（除非有特殊权限）

##### 4.0.3 高管角色数据权限
- **数据可见范围**：
  - **个人数据**：可见本人的所有数据（继承员工权限）
  - **部门数据**：可见所有部门的数据（继承部门经理权限）
  - **公司项目数据**：可见公司所有项目（所有部门的所有项目）
  - **公司任务数据**：可见公司所有任务（所有部门的所有任务）
  - **公司产值数据**：可见公司所有产值（所有部门的所有产值）
  - **公司客户数据**：可见公司所有客户（所有部门的所有客户）
  - **公司商机数据**：可见公司所有商机（所有部门的所有商机）
  - **公司结算数据**：可见公司所有结算（所有部门的所有结算）
  - **公司回款数据**：可见公司所有回款（所有部门的所有回款）
  - **公司人员数据**：可见公司所有员工的基本信息、考勤、产值等
  - **公司考勤数据**：可见公司所有员工的考勤记录
  - **公司计划数据**：可见公司所有计划（所有部门的所有计划）
  - **公司待办数据**：可见公司所有待办事项（所有部门的所有待办）
  - **公司通知数据**：可见公司所有通知
  - **公司财务数据**：可见公司所有财务数据（收入、成本、利润等）
  - **公司风险数据**：可见公司所有风险数据（项目风险、进度风险、质量风险、成本风险、回款风险等）
  - **公司战略数据**：可见公司所有战略目标数据（年度目标、目标达成率等）
- **数据计算规则**：
  - **公司项目统计**：汇总公司所有部门的所有项目数量（项目总数、进行中、已完成、待开工）
  - **公司任务统计**：汇总公司所有部门的所有任务数量（任务总数、待处理、进行中、已完成）
  - **公司产值统计**：汇总公司所有部门的所有产值（总产值、累计产值、各阶段产值分布、各部门产值分布）
  - **公司销售统计**：汇总公司所有部门的所有销售数据（销售金额、累计销售、销售趋势）
  - **公司回款统计**：汇总公司所有部门的所有回款数据（回款金额、累计回款、回款率）
  - **公司收入统计**：汇总公司所有收入数据（营业收入、服务费收入、其他收入）
  - **公司成本统计**：汇总公司所有成本数据（人力成本、项目成本、其他成本）
  - **公司利润统计**：计算公司利润数据（利润总额、利润率、利润趋势）
  - **公司人员统计**：统计公司所有员工数量（总人数、各部门人数分布、人均产值）
  - **公司考勤统计**：汇总公司所有员工的考勤数据（出勤天数、请假天数、加班天数、出勤率）
  - **公司计划统计**：汇总公司所有计划数量（计划总数、计划完成率、目标达成率）
  - **公司效率统计**：计算公司效率指标（人均产值、任务完成率、项目完成率）
  - **公司排名统计**：计算各部门排名（产值排名、效率排名）
- **数据权限说明**：
  - 高管可以查看和操作个人数据（继承员工权限）
  - 高管可以查看所有部门的数据（继承部门经理权限）
  - 高管可以查看公司整体数据（公司管理权限）
  - 高管可以查看公司所有财务数据、风险数据、战略数据
  - 高管拥有最高数据权限，可以查看系统所有数据

**数据权限继承规则**：
- **员工 → 部门经理**：部门经理继承员工的所有数据权限，并增加部门管理权限
- **部门经理 → 高管**：高管继承部门经理的所有数据权限，并增加公司管理权限
- **权限叠加**：高级角色拥有低级角色的所有权限，并增加额外的管理权限

**数据权限控制机制**：
- **基于角色的权限控制**：根据用户角色自动应用相应的数据权限规则
- **数据过滤**：系统自动过滤用户无权查看的数据
- **权限检查**：每次数据查询时自动检查用户权限
- **权限继承**：高级角色自动继承低级角色的权限
- **特殊权限**：支持为特定用户授予特殊权限（如跨部门查看权限）

### 工作台布局设计

#### 4.1 员工角色工作台布局

**布局结构**：
```
┌─────────────────────────────────────────────────────────────┐
│  顶部导航栏：Logo、通知中心、待办中心、个人中心              │
├─────────────────────────────────────────────────────────────┤
│  左侧区域（30%）          │  右侧区域（70%）                │
│                          │                                 │
│  📊 我的数据概览          │  📋 我的待办事项（列表）        │
│  ├─ 我的项目：5个        │  ├─ 待审批：3项                │
│  ├─ 我的任务：12个       │  ├─ 待处理：8项                │
│  ├─ 本月产值：¥50,000    │  ├─ 待回复：2项                │
│  └─ 本月考勤：22天       │  └─ 待接收：1项                │
│                          │                                 │
│  📈 我的产值统计          │  📊 我的项目进度（图表）        │
│  ├─ 本月产值：¥50,000    │  ├─ 进行中项目：3个            │
│  ├─ 累计产值：¥500,000   │  ├─ 待开工项目：1个            │
│  ├─ 产值排名：第5名      │  ├─ 已完成项目：1个            │
│  └─ 产值趋势：↑15%       │  └─ 项目进度分布图             │
│                          │                                 │
│  ⏰ 我的考勤统计          │  📝 我的任务列表（列表）        │
│  ├─ 本月出勤：22天       │  ├─ 待处理任务：5个            │
│  ├─ 本月请假：1天        │  ├─ 进行中任务：7个            │
│  ├─ 本月加班：5天        │  └─ 已完成任务：10个           │
│  └─ 出勤率：95%          │                                 │
│                          │                                 │
│  💼 我的业务统计          │  📢 最新通知（列表）            │
│  ├─ 我的客户：8个        │  ├─ 系统通知：2条              │
│  ├─ 我的商机：5个        │  ├─ 任务通知：3条              │
│  └─ 跟进记录：15条       │  └─ 审批通知：1条              │
│                          │                                 │
│  🎯 我的计划统计          │  📊 我的产值趋势（折线图）      │
│  ├─ 进行中计划：3个      │  └─ 近6个月产值趋势图          │
│  ├─ 已完成计划：10个     │                                 │
│  └─ 计划完成率：85%      │                                 │
└─────────────────────────────────────────────────────────────┘
```

**详细内容**：

##### 4.1.1 我的数据概览（左侧卡片组）
- **我的项目统计卡片**
  - 进行中项目：5个（点击查看详情）
  - 待开工项目：1个
  - 已完成项目：12个
  - 项目进度：平均完成度65%
- **我的任务统计卡片**
  - 待处理任务：5个（红色提醒）
  - 进行中任务：7个
  - 已完成任务：10个
  - 任务完成率：67%
- **我的产值统计卡片**
  - 本月产值：¥50,000（环比↑15%）
  - 累计产值：¥500,000
  - 产值排名：部门第5名
  - 产值趋势：近3个月趋势图（小图表）
- **我的考勤统计卡片**
  - 本月出勤：22天
  - 本月请假：1天
  - 本月加班：5天
  - 出勤率：95%（绿色）
- **我的业务统计卡片**
  - 我的客户：8个（活跃客户：5个）
  - 我的商机：5个（进行中：3个）
  - 跟进记录：15条（本月）
- **我的计划统计卡片**
  - 进行中计划：3个
  - 已完成计划：10个
  - 计划完成率：85%
  - 目标达成率：80%

##### 4.1.2 我的待办事项（右侧顶部）
- **待办事项列表**（按优先级和截止时间排序）
  - 待审批事项：3项（高优先级：1项）
    - 项目审批：1项（今日截止）
    - 产值审批：1项（明日截止）
    - 费用审批：1项（3日后截止）
  - 待处理任务：8项（高优先级：2项）
    - 图纸审核：2项（今日截止）
    - 意见回复：3项（明日截止）
    - 成果确认：3项（3日后截止）
  - 待回复事项：2项
    - 客户反馈：1项
    - 意见回复：1项
  - 待接收事项：1项
    - 项目接收：1项

##### 4.1.3 我的项目进度（右侧中部）
- **项目进度图表**
  - 进行中项目：3个（项目名称、进度百分比）
  - 待开工项目：1个
  - 已完成项目：1个
  - 项目进度分布图（饼图或柱状图）
- **项目进度趋势**
  - 近3个月项目完成趋势（折线图）
  - 项目延期预警（红色标记）

##### 4.1.4 我的任务列表（右侧中部）
- **任务列表**（按截止时间排序）
  - 待处理任务：5个（任务名称、截止时间、优先级）
  - 进行中任务：7个（任务名称、进度、预计完成时间）
  - 已完成任务：10个（任务名称、完成时间）

##### 4.1.5 最新通知（右侧中部）
- **通知列表**（按时间倒序，显示最新5条）
  - 系统通知：2条（未读：1条）
  - 任务通知：3条（未读：2条）
  - 审批通知：1条（未读：0条）

##### 4.1.6 我的产值趋势（右侧底部）
- **产值趋势图**（折线图）
  - 近6个月产值趋势
  - 产值预测（下月预测）
  - 产值目标线（目标产值对比）

#### 4.2 部门经理角色工作台布局

**布局结构**：
```
┌─────────────────────────────────────────────────────────────┐
│  顶部导航栏：Logo、通知中心、待办中心、个人中心              │
├─────────────────────────────────────────────────────────────┤
│  左侧区域（25%）          │  中间区域（50%）│右侧区域（25%）│
│                          │                │                │
│  📊 部门数据概览          │  📋 部门待办事项│  📈 部门产值统计│
│  ├─ 部门项目：15个       │  ├─ 待审批：8项│  ├─ 本月产值：  │
│  ├─ 部门任务：45个       │  ├─ 待处理：15项│  │  ¥500,000    │
│  ├─ 部门产值：¥500,000  │  ├─ 待回复：5项│  ├─ 累计产值：  │
│  └─ 部门人员：12人      │  └─ 待接收：2项│  │  ¥5,000,000  │
│                          │                │  └─ 产值排名：  │
│  👥 部门人员统计          │  📊 部门项目进度│  │  第2名        │
│  ├─ 总人数：12人        │  ├─ 进行中：10个│                │
│  ├─ 在岗：11人          │  ├─ 待开工：3个│  📉 部门效率统计│
│  ├─ 请假：1人           │  ├─ 已完成：2个│  ├─ 人均产值：  │
│  └─ 出勤率：92%         │  └─ 进度分布图│  │  ¥41,667     │
│                          │                │  ├─ 任务完成率：│
│  💼 部门业务统计          │  📝 部门任务分布│  │  85%         │
│  ├─ 部门客户：25个      │  ├─ 待处理：15个│  └─ 项目完成率：│
│  ├─ 部门商机：12个      │  ├─ 进行中：20个│  │  80%         │
│  └─ 销售金额：¥2,000,000│  └─ 已完成：10个│                │
│                          │                │  ⚠️ 部门风险预警│
│  📈 部门产值趋势         │  📢 部门通知    │  ├─ 延期项目：2个│
│  └─ 近6个月趋势图       │  └─ 最新5条通知 │  ├─ 风险项目：1个│
│                          │                │  └─ 质量预警：0个│
│  🎯 部门计划统计          │  📊 部门工作量分布│                │
│  ├─ 进行中计划：8个     │  └─ 各专业工作量│  📋 部门人员排名│
│  ├─ 已完成计划：20个    │                │  ├─ 产值排名：  │
│  └─ 计划完成率：88%     │                │  │  前5名人员   │
│                          │                │  └─ 效率排名：  │
│                          │                │  │  前5名人员   │
└─────────────────────────────────────────────────────────────┘
```

**详细内容**：

##### 4.2.1 部门数据概览（左侧卡片组）
- **部门项目统计卡片**
  - 进行中项目：10个（点击查看详情）
  - 待开工项目：3个
  - 已完成项目：2个
  - 项目进度：平均完成度70%
  - 延期项目：2个（红色预警）
- **部门任务统计卡片**
  - 待处理任务：15个（高优先级：5个）
  - 进行中任务：20个
  - 已完成任务：10个
  - 任务完成率：67%
- **部门产值统计卡片**
  - 本月产值：¥500,000（环比↑20%）
  - 累计产值：¥5,000,000
  - 产值排名：公司第2名
  - 产值趋势：近3个月趋势图（小图表）
- **部门人员统计卡片**
  - 总人数：12人
  - 在岗：11人
  - 请假：1人
  - 出勤率：92%
- **部门业务统计卡片**
  - 部门客户：25个（活跃客户：15个）
  - 部门商机：12个（进行中：8个）
  - 销售金额：¥2,000,000（本月）
- **部门计划统计卡片**
  - 进行中计划：8个
  - 已完成计划：20个
  - 计划完成率：88%
  - 目标达成率：85%

##### 4.2.2 部门待办事项（中间顶部）
- **待办事项列表**（按优先级和截止时间排序）
  - 待审批事项：8项（高优先级：3项）
    - 项目审批：3项
    - 产值审批：2项
    - 费用审批：3项
  - 待处理任务：15项（高优先级：5项）
    - 图纸审核：5项
    - 意见回复：6项
    - 成果确认：4项
  - 待回复事项：5项
  - 待接收事项：2项

##### 4.2.3 部门项目进度（中间中部）
- **项目进度图表**
  - 进行中项目：10个（项目名称、进度百分比、负责人）
  - 待开工项目：3个
  - 已完成项目：2个
  - 项目进度分布图（饼图或柱状图）
- **项目进度趋势**
  - 近3个月项目完成趋势（折线图）
  - 项目延期预警（红色标记）

##### 4.2.4 部门任务分布（中间中部）
- **任务分布图表**
  - 待处理任务：15个（按专业/人员分布）
  - 进行中任务：20个
  - 已完成任务：10个
  - 任务分布图（柱状图或饼图）

##### 4.2.5 部门工作量分布（中间底部）
- **工作量分布图表**
  - 各专业工作量统计（建筑、结构、给排水、电气、暖通）
  - 各人员工作量统计（工作量排名）
  - 工作量分布图（柱状图或热力图）

##### 4.2.6 部门产值统计（右侧顶部）
- **产值统计卡片**
  - 本月产值：¥500,000（环比↑20%）
  - 累计产值：¥5,000,000
  - 产值排名：公司第2名
  - 产值趋势：近6个月趋势图

##### 4.2.7 部门效率统计（右侧中部）
- **效率统计卡片**
  - 人均产值：¥41,667（部门平均）
  - 任务完成率：85%
  - 项目完成率：80%
  - 效率趋势：近3个月效率趋势图

##### 4.2.8 部门风险预警（右侧中部）
- **风险预警卡片**
  - 延期项目：2个（项目名称、延期天数）
  - 风险项目：1个（风险等级、风险类型）
  - 质量预警：0个
  - 成本预警：0个

##### 4.2.9 部门人员排名（右侧底部）
- **人员排名列表**
  - 产值排名：前5名人员（姓名、产值、排名）
  - 效率排名：前5名人员（姓名、效率、排名）
  - 工作量排名：前5名人员（姓名、工作量、排名）

#### 4.3 高管角色工作台布局

**布局结构**：
```
┌─────────────────────────────────────────────────────────────┐
│  顶部导航栏：Logo、通知中心、待办中心、个人中心              │
├─────────────────────────────────────────────────────────────┤
│  第一行：关键指标卡片（4列）                                │
│  [总产值] [总销售] [总回款] [总利润]                        │
├─────────────────────────────────────────────────────────────┤
│  第二行：业务概览（左侧60%）│ 财务概览（右侧40%）           │
│  📊 公司项目统计            │  💰 公司收入统计              │
│  ├─ 项目总数：50个         │  ├─ 营业收入：¥10,000,000   │
│  ├─ 进行中：30个           │  ├─ 服务费收入：¥8,000,000  │
│  ├─ 已完成：15个           │  ├─ 其他收入：¥2,000,000    │
│  └─ 项目进度分布图         │  └─ 收入趋势图               │
│                            │                              │
│  📈 公司产值统计            │  💸 公司成本统计              │
│  ├─ 总产值：¥5,000,000    │  ├─ 人力成本：¥3,000,000    │
│  ├─ 各阶段产值分布         │  ├─ 项目成本：¥2,000,000    │
│  └─ 产值趋势图             │  ├─ 其他成本：¥500,000     │
│                            │  └─ 成本趋势图               │
│  💼 公司销售统计            │  📊 公司利润分析              │
│  ├─ 销售金额：¥15,000,000 │  ├─ 利润总额：¥4,500,000    │
│  ├─ 销售趋势图             │  ├─ 利润率：45%             │
│  └─ 销售预测               │  └─ 利润趋势图               │
├─────────────────────────────────────────────────────────────┤
│  第三行：业务分析（左侧50%）│ 管理分析（右侧50%）          │
│  📋 客户分析                │  👥 人员分析                 │
│  ├─ 客户总数：100个        │  ├─ 总人数：50人             │
│  ├─ 活跃客户：60个         │  ├─ 各部门人数分布           │
│  ├─ 客户价值分布           │  ├─ 人均产值：¥100,000      │
│  └─ 客户趋势图             │  └─ 人员效率趋势图           │
│                            │                              │
│  🎯 商机分析                │  📈 产值分析                 │
│  ├─ 商机总数：30个         │  ├─ 各阶段产值分布           │
│  ├─ 转化率：60%            │  ├─ 各部门产值分布           │
│  ├─ 销售漏斗图             │  └─ 产值趋势预测             │
│  └─ 商机趋势图             │                              │
│                            │  🎯 计划分析                 │
│  📊 项目分析                │  ├─ 计划总数：50个          │
│  ├─ 项目进度分析           │  ├─ 计划完成率：85%          │
│  ├─ 项目质量分析           │  ├─ 目标达成率：80%         │
│  ├─ 项目成本分析           │  └─ 计划趋势图               │
│  └─ 项目效率分析           │                              │
├─────────────────────────────────────────────────────────────┤
│  第四行：风险预警（全宽）                                  │
│  ⚠️ 风险预警中心                                            │
│  ├─ 项目风险：5个（高风险：2个）                            │
│  ├─ 进度风险：3个（延期项目）                               │
│  ├─ 质量风险：1个                                          │
│  ├─ 成本风险：2个                                          │
│  ├─ 回款风险：3个（逾期回款）                               │
│  └─ 风险趋势图                                             │
├─────────────────────────────────────────────────────────────┤
│  第五行：战略目标（全宽）                                  │
│  🎯 战略目标概览                                            │
│  ├─ 年度目标：10个（完成率：80%）                           │
│  ├─ 财务目标：3个（完成率：85%）                            │
│  ├─ 市场目标：2个（完成率：75%）                            │
│  ├─ 运营目标：3个（完成率：80%）                            │
│  ├─ 创新目标：1个（完成率：70%）                            │
│  ├─ 人才目标：1个（完成率：90%）                            │
│  └─ 目标达成趋势图                                         │
└─────────────────────────────────────────────────────────────┘
```

**详细内容**：

##### 4.3.1 关键指标卡片（第一行）
- **总产值卡片**
  - 本月产值：¥5,000,000（环比↑25%）
  - 累计产值：¥50,000,000
  - 产值趋势：↑（绿色箭头）
  - 产值目标完成率：85%
- **总销售卡片**
  - 本月销售：¥15,000,000（环比↑30%）
  - 累计销售：¥150,000,000
  - 销售趋势：↑（绿色箭头）
  - 销售目标完成率：90%
- **总回款卡片**
  - 本月回款：¥12,000,000（环比↑20%）
  - 累计回款：¥120,000,000
  - 回款率：80%
  - 回款趋势：↑（绿色箭头）
- **总利润卡片**
  - 本月利润：¥4,500,000（环比↑35%）
  - 累计利润：¥45,000,000
  - 利润率：45%
  - 利润趋势：↑（绿色箭头）

##### 4.3.2 公司项目统计（第二行左侧）
- **项目统计卡片**
  - 项目总数：50个
  - 进行中项目：30个
  - 已完成项目：15个
  - 待开工项目：5个
  - 项目进度分布图（饼图）
- **项目进度分析**
  - 平均完成度：70%
  - 项目进度趋势图（折线图）
  - 延期项目：5个（红色预警）

##### 4.3.3 公司产值统计（第二行左侧）
- **产值统计卡片**
  - 总产值：¥5,000,000（本月）
  - 累计产值：¥50,000,000
  - 各阶段产值分布（转化阶段、合同阶段、生产阶段、结算阶段、回款阶段）
  - 产值趋势图（折线图，近12个月）

##### 4.3.4 公司销售统计（第二行左侧）
- **销售统计卡片**
  - 销售金额：¥15,000,000（本月）
  - 累计销售：¥150,000,000
  - 销售趋势图（折线图，近12个月）
  - 销售预测（下月预测）

##### 4.3.5 公司收入统计（第二行右侧）
- **收入统计卡片**
  - 营业收入：¥10,000,000（本月）
  - 服务费收入：¥8,000,000
  - 其他收入：¥2,000,000
  - 收入趋势图（折线图，近12个月）

##### 4.3.6 公司成本统计（第二行右侧）
- **成本统计卡片**
  - 人力成本：¥3,000,000（本月）
  - 项目成本：¥2,000,000
  - 其他成本：¥500,000
  - 成本趋势图（折线图，近12个月）

##### 4.3.7 公司利润分析（第二行右侧）
- **利润分析卡片**
  - 利润总额：¥4,500,000（本月）
  - 利润率：45%
  - 利润趋势图（折线图，近12个月）
  - 利润预测（下月预测）

##### 4.3.8 客户分析（第三行左侧）
- **客户统计卡片**
  - 客户总数：100个
  - 活跃客户：60个
  - 客户价值分布（VIP客户、重要客户、普通客户）
  - 客户趋势图（折线图，近12个月）

##### 4.3.9 商机分析（第三行左侧）
- **商机统计卡片**
  - 商机总数：30个
  - 转化率：60%
  - 销售漏斗图（潜在客户、初步接触、需求确认、方案报价、商务谈判、赢单）
  - 商机趋势图（折线图，近12个月）

##### 4.3.10 项目分析（第三行左侧）
- **项目分析卡片**
  - 项目进度分析（平均完成度、进度分布）
  - 项目质量分析（质量指标、质量趋势）
  - 项目成本分析（成本控制、成本趋势）
  - 项目效率分析（效率指标、效率趋势）

##### 4.3.11 人员分析（第三行右侧）
- **人员统计卡片**
  - 总人数：50人
  - 各部门人数分布（部门名称、人数、占比）
  - 人均产值：¥100,000
  - 人员效率趋势图（折线图，近12个月）

##### 4.3.12 产值分析（第三行右侧）
- **产值分析卡片**
  - 各阶段产值分布（转化阶段、合同阶段、生产阶段、结算阶段、回款阶段）
  - 各部门产值分布（部门名称、产值、占比）
  - 产值趋势预测（下月、下季度预测）

##### 4.3.13 计划分析（第三行右侧）
- **计划统计卡片**
  - 计划总数：50个
  - 计划完成率：85%
  - 目标达成率：80%
  - 计划趋势图（折线图，近12个月）

##### 4.3.14 风险预警中心（第四行全宽）
- **风险预警卡片**
  - 项目风险：5个（高风险：2个，中风险：2个，低风险：1个）
  - 进度风险：3个（延期项目：3个）
  - 质量风险：1个
  - 成本风险：2个
  - 回款风险：3个（逾期回款：3个）
  - 风险趋势图（折线图，近12个月）
  - 风险分布图（饼图，各类型风险占比）

##### 4.3.15 战略目标概览（第五行全宽）
- **战略目标统计卡片**
  - 年度目标：10个（完成率：80%）
  - 财务目标：3个（完成率：85%）
  - 市场目标：2个（完成率：75%）
  - 运营目标：3个（完成率：80%）
  - 创新目标：1个（完成率：70%）
  - 人才目标：1个（完成率：90%）
  - 目标达成趋势图（折线图，近12个月）
  - 目标分解树（树形图，公司目标→部门目标→团队目标）

### 工作台功能特性

#### 5.1 个性化定制
- **卡片拖拽排序**：支持拖拽调整卡片位置
- **卡片显示/隐藏**：支持自定义显示哪些卡片
- **卡片大小调整**：支持调整卡片大小（小、中、大）
- **布局保存**：保存个人布局设置

#### 5.2 数据刷新
- **自动刷新**：支持设置自动刷新频率（5分钟、10分钟、30分钟）
- **手动刷新**：支持手动刷新数据
- **刷新时间显示**：显示最后刷新时间

#### 5.3 数据钻取
- **点击查看详情**：点击卡片可跳转到对应的详细页面
- **数据关联**：支持查看关联数据
- **数据导出**：支持导出工作台数据

#### 5.4 响应式设计
- **自适应布局**：支持不同屏幕尺寸自适应
- **移动端优化**：移动端显示优化
- **打印支持**：支持打印工作台内容

### 导航结构
- **工作台导航**：工作台提供19个功能模块的入口卡片，点击进入对应的功能空间
- **功能空间布局**：
  - **左侧导航栏**：本功能空间的导航栏，显示该模块下的子功能菜单
  - **中间上部区域**：筛选区，包含筛选条件、搜索框、快捷操作等
  - **中间下部区域**：列表区，显示数据列表、表格、卡片等
  - **返回工作台**：通过左侧导航栏的"工作台"入口或系统Logo返回总工作台

### 报表统一管理原则（重要说明）
**⚠️ 报表功能统一管理原则**：
- **统一管理**：系统中所有功能模块的报表功能，全部统一纳入到"报表管理"模块（第17章）进行集中管理
- **统一入口**：各功能模块不再单独提供报表入口，所有报表统一从"报表管理"模块访问
- **统一分类**：报表按功能模块分类（客户管理、商机管理、生产管理等），在报表管理模块中通过"模块报表"菜单快速访问
- **统一权限**：报表查看权限在报表管理模块统一控制，各功能模块的权限设置自动同步到报表管理模块
- **统一导出**：所有报表的导出功能统一在报表管理模块完成，支持Excel、PDF、Word等格式
- **统一模板**：所有报表模板统一在报表管理模块管理，支持模板复用和标准化
- **统一分析**：所有报表的使用统计、数据分析、趋势分析统一在报表管理模块进行

**报表访问方式**：
- **主入口1：工作台左侧菜单**：工作台左侧导航菜单 > 报表管理（✅ 已配置在HOME_NAV_STRUCTURE中）
- **主入口2：各模块顶部菜单**：各功能模块页面顶部导航菜单 > 报表管理（✅ 已通过_build_full_top_nav函数自动生成）
- **模块报表**：报表管理模块 > 模块报表 > 选择功能模块
- **报表收藏**：报表管理模块 > 报表收藏 > 快速访问常用报表
- **报表搜索**：报表管理模块 > 报表列表 > 搜索框
- **快捷入口**：工作台数据统计卡片 > 点击"查看报表"按钮 > 跳转到报表管理模块

**各模块报表说明**：
- 各功能模块的统计卡片（如项目列表页面的统计卡片）保留在原模块页面，用于快速查看
- 所有详细报表（如项目进度报表、销售绩效报表等）统一纳入报表管理模块
- 各模块的报表功能说明中会标注"⚠️ 统一纳入报表管理模块"和报表访问入口

### 包含模块概览
工作台提供以下19个主要模块的入口和快速概览：

1. **客户管理** - 客户信息、客户线索、客户关系管理
2. **商机管理** - 商机跟踪、销售漏斗、报价管理
3. **合同管理** - 合同信息管理、合同文件管理、合同变更、合同审批、回款计划
4. **生产管理** - 项目执行、任务管理、进度跟踪
6. **收发管理** - 统一管理公司所有对外文件（项目文件、非项目文件）的交付、跟踪、反馈
7. **结算管理** - 项目结算、结算审核
8. **回款管理** - 回款计划、回款跟踪
9. **人事管理** - 员工信息、考勤管理、薪资管理
10. **行政管理** - 行政事务、办公用品、会议管理
11. **财务管理** - 财务核算、财务报表、财务分析
12. **产值管理** - 产值配置、产值计算
13. **计划管理** - 工作计划、计划执行
14. **档案管理** - 项目档案、文档归档、档案查询
15. **资源管理** - 资源标准、资源库、综合单价库
16. **风险管理** - 风险识别、风险评估、风险应对
17. **诉讼管理** - 诉讼案件管理、诉讼流程跟踪、诉讼费用管理
18. **报表管理** - 集中管理各个功能模块的报表（⚠️ 所有报表功能统一纳入此模块）
19. **标准管理** - 审图标准管理
20. **系统管理** - 系统设置（后台管理）和个人设置

---

## 📋 各功能模块左侧菜单设计

**说明**：功能空间的第一页即为该空间的列表页面，菜单不单独设计列表功能。点击菜单项进入对应功能页面，默认显示列表。

### 1. 商机管理模块左侧菜单
```
📁 商机管理（首页=商机列表）
├── 📋 商机备案
│   ├── ➕ 商机创建
│   ├── 💬 客户需求沟通
│   └── 📥 入库申请
├── 🔧 技术支持
│   ├── 📝 评估申请
│   ├── 📐 图纸评估
│   └── 🤝 技术沟通会
├── 💰 投标报价
│   ├── 📋 投标报价申请
│   ├── 📄 编制投标文件
│   └── 📤 递交投标文件
├── 🎯 商机成就
│   ├── 💼 商务洽谈登记
│   ├── 📈 商机预测
│   └── ✅ 赢单与输单
└── 💳 费用支付
    ├── 💰 投标保证金支付
    ├── 📄 标书费支付
    └── 🏢 招标代理费支付
```

**说明**：
- **商机备案**：商机创建、客户需求沟通、入库申请等商机前期备案工作
- **技术支持**：评估申请、图纸评估、技术沟通会等技术支持相关功能
- **投标报价**：投标报价申请、编制投标文件、递交投标文件等投标流程管理
- **商机成就**：商务洽谈登记、商机预测、赢单与输单等商机成果管理
- **费用支付**：投标保证金支付、标书费支付、招标代理费支付等投标相关费用管理
- 跟进记录功能在客户关系模块中已有，不再在商机管理菜单中重复显示

#### 1.2 菜单实现状态

**商机列表**（首页）：已实现，URL路由 `business_pages:opportunity_management`
- 功能：商机列表展示、筛选、搜索、分页、统计卡片
- 页面模板：`templates/customer_success/opportunity_list.html`
- 视图函数：`opportunity_management`

##### 📋 商机备案（一级菜单）

- ✅ **商机创建**（二级菜单）：已实现
  - URL路由：`business_pages:opportunity_create`
  - 页面模板：`templates/customer_success/opportunity_form.html`
  - 视图函数：`opportunity_create`
  - 功能：创建新商机，包含基本信息、项目信息、金额和概率等字段
  - 权限：`customer_success.opportunity.manage`

- ✅ **客户需求沟通**（二级菜单）：已实现
  - URL路由：`business_pages:opportunity_customer_requirement`
  - 页面模板：`templates/customer_success/opportunity_customer_requirement.html`
  - 视图函数：`opportunity_customer_requirement`
  - 功能：客户需求管理，查看商机相关的客户需求信息，商机列表展示、筛选、搜索、分页，重点展示项目信息和客户需求
  - 权限：`customer_success.opportunity.view`

- ⏳ **入库申请**（二级菜单）：功能待实现
  - URL路由：`business_pages:opportunity_warehouse_application`
  - 功能：商机入库申请管理，记录商机入库申请流程
  - 数据模型：待创建（入库申请相关模型）
  - 页面功能：入库申请列表、创建入库申请、审批流程等
  - 权限：`customer_success.opportunity.manage`

##### 🔧 技术支持（一级菜单）

- ⏳ **评估申请**（二级菜单）：功能待实现
  - URL路由：`business_pages:opportunity_evaluation_application`
  - 功能：技术评估申请管理，记录评估申请流程
  - 数据模型：待创建（评估申请相关模型）
  - 页面功能：评估申请列表、创建评估申请、审批流程等
  - 权限：`customer_success.opportunity.manage`

- ✅ **图纸评估**（二级菜单）：已实现占位页面（功能开发中）
  - URL路由：`business_pages:opportunity_drawing_evaluation`
  - 页面模板：`templates/customer_success/opportunity_drawing_evaluation.html`
  - 视图函数：`opportunity_drawing_evaluation`
  - 权限：`customer_success.opportunity.view`

- ✅ **技术沟通会**（二级菜单）：已实现占位页面（功能开发中）
  - URL路由：`business_pages:opportunity_tech_meeting`
  - 页面模板：`templates/customer_success/opportunity_tech_meeting.html`
  - 视图函数：`opportunity_tech_meeting`
  - 权限：`customer_success.opportunity.view`

##### 💰 投标报价（一级菜单）

- ✅ **投标报价申请**（二级菜单）：已实现（整合资源管理信息）
  - URL路由：`business_pages:opportunity_bidding_quotation`
  - 页面模板：`templates/customer_success/opportunity_bidding_quotation.html`
  - 视图函数：`opportunity_bidding_quotation`
  - 数据模型：`BiddingQuotation` - 投标报价记录模型
  - 功能：
    - ✅ 商机列表展示、筛选、搜索、分页
    - ✅ 整合技术标信息（从资源标准模块获取技术方案）
    - ✅ 整合商务标信息（报价、付款方式、服务承诺等）
    - ✅ 整合类似业绩（从项目管理模块获取已完成项目）
    - ✅ 整合人员证书（从人员管理模块获取员工证书、资格证书、执照等）
    - ✅ 整合公司证件（支持上传公司资质证书、营业执照等）
    - ✅ 投标文件管理（支持上传投标相关文件）
    - ✅ 投标资源查看（模态框展示所有投标资源信息）
  - 权限：`customer_success.opportunity.view`

- ⏳ **编制投标文件**（二级菜单）：功能待实现
  - URL路由：`business_pages:opportunity_bidding_document_preparation`
  - 功能：投标文件编制管理，记录投标文件编制流程和版本管理
  - 数据模型：待创建（投标文件相关模型）
  - 页面功能：投标文件列表、创建投标文件、文件版本管理、文件审核等
  - 权限：`customer_success.opportunity.manage`

- ⏳ **递交投标文件**（二级菜单）：功能待实现
  - URL路由：`business_pages:opportunity_bidding_document_submission`
  - 功能：投标文件递交管理，记录投标文件递交流程和状态跟踪
  - 数据模型：待创建（投标文件递交相关模型）
  - 页面功能：递交记录列表、创建递交记录、递交状态跟踪、递交确认等
  - 权限：`customer_success.opportunity.manage`

##### 🎯 商机成就（一级菜单）

- ✅ **商务洽谈登记**（二级菜单）：已实现
  - URL路由：`business_pages:opportunity_business_negotiation`、`business_pages:opportunity_business_negotiation_form`
  - 页面模板：`templates/customer_success/opportunity_business_negotiation.html`、`opportunity_business_negotiation_form.html`
  - 视图函数：`opportunity_business_negotiation`、`opportunity_business_negotiation_form`
  - 功能：商务洽谈记录列表、筛选、搜索、分页、创建/编辑商务洽谈表单
  - 权限：`customer_success.opportunity.view`

- ✅ **商机预测**（二级菜单）：已实现
  - URL路由：`business_pages:opportunity_sales_forecast`
  - 页面模板：`templates/customer_success/opportunity_sales_forecast.html`
  - 视图函数：`opportunity_sales_forecast`
  - 功能：销售预测分析、乐观/中性/保守预测、目标差距分析、图表展示
  - 权限：`customer_success.opportunity.view`

- ⏳ **赢单与输单**（二级菜单）：功能待实现
  - URL路由：`business_pages:opportunity_win_loss`
  - 功能：商机赢单与输单管理，记录商机最终结果和原因分析
  - 数据模型：待创建（赢单/输单相关模型）
  - 页面功能：赢单/输单记录列表、创建赢单/输单记录、原因分析、经验总结等
  - 权限：`customer_success.opportunity.manage`

##### 💳 费用支付（一级菜单）

- ⏳ **投标保证金支付**（二级菜单）：功能待实现
  - URL路由：`business_pages:opportunity_bid_bond_payment`
  - 功能：投标保证金支付管理，记录保证金支付申请、审批和支付流程
  - 数据模型：待创建（投标保证金支付相关模型）
  - 页面功能：保证金支付列表、创建支付申请、审批流程、支付确认等
  - 权限：`customer_success.opportunity.manage`

- ⏳ **标书费支付**（二级菜单）：功能待实现
  - URL路由：`business_pages:opportunity_tender_fee_payment`
  - 功能：标书费支付管理，记录标书费支付申请、审批和支付流程
  - 数据模型：待创建（标书费支付相关模型）
  - 页面功能：标书费支付列表、创建支付申请、审批流程、支付确认等
  - 权限：`customer_success.opportunity.manage`

- ⏳ **招标代理费支付**（二级菜单）：功能待实现
  - URL路由：`business_pages:opportunity_tender_agent_fee_payment`
  - 功能：招标代理费支付管理，记录招标代理费支付申请、审批和支付流程
  - 数据模型：待创建（招标代理费支付相关模型）
  - 页面功能：招标代理费支付列表、创建支付申请、审批流程、支付确认等
  - 权限：`customer_success.opportunity.manage`

#### 1.3 其他功能说明

- ⏳ **跟进记录**：已实现但不在菜单中显示（功能在客户关系模块中已有，避免重复）
  - 页面实现：`templates/customer_success/opportunity_followup_list.html`
  - 视图函数：`opportunity_followup_list`
  - URL路由：`business_pages:opportunity_followup_list`
  - 功能：跟进记录列表、筛选、搜索、分页
  - **说明**：跟进记录功能在客户关系模块中已有，商机管理模块中不再在菜单中显示，但功能保留（可通过URL直接访问）

- ✅ **商机备案**（原功能）：已实现页面（原功能保留，现归类到商机备案分组）
  - 页面实现：`templates/customer_success/opportunity_filing.html`、`opportunity_filing_form.html`
  - 视图函数：`opportunity_filing`、`opportunity_filing_form`
  - URL路由：`business_pages:opportunity_filing`、`business_pages:opportunity_filing_form`
  - 功能：商机备案列表、筛选、搜索、分页、创建/编辑备案表单

#### 1.4 菜单生成函数

**函数位置**：`backend/apps/customer_success/views_pages.py`

```python
def _build_opportunity_management_menu(permission_set, active_id=None):
    """
    生成商机管理模块左侧菜单
    
    参数:
        permission_set: 用户权限集合（set）
        active_id: 当前激活的菜单项ID
    
    返回:
        list: 菜单项列表，每个菜单项包含：
            - id: 菜单项ID
            - label: 菜单项标签
            - icon: 菜单项图标
            - url: 菜单项URL（如果有）
            - permission: 所需权限
            - active: 是否激活
            - children: 子菜单项列表（如果有）
    """
    from backend.core.views import _permission_granted
    from django.urls import reverse, NoReverseMatch
    
    menu = []
    
    for menu_group in OPPORTUNITY_MANAGEMENT_MENU:
        # 检查父菜单权限
        if not _permission_granted(menu_group.get('permission'), permission_set):
            continue
        
        # 处理子菜单
        children = []
        for child in menu_group.get('children', []):
            # 检查子菜单权限
            if not _permission_granted(child.get('permission'), permission_set):
                continue
            
            # 获取URL
            url_name = child.get('url_name')
            url = '#'
            if url_name:
                try:
                    url = reverse(url_name)
                except NoReverseMatch:
                    url = '#'
            
            # 检查是否激活
            is_active = child.get('id') == active_id
            
            children.append({
                'id': child.get('id'),
                'label': child.get('label'),
                'icon': child.get('icon'),
                'url': url,
                'active': is_active,
            })
        
        # 如果没有任何子菜单项，跳过该菜单组
        if not children:
            continue
        
        # 检查是否有激活的子菜单项
        has_active_child = any(child.get('active') for child in children)
        
        menu.append({
            'id': menu_group.get('id'),
            'label': menu_group.get('label'),
            'icon': menu_group.get('icon'),
            'children': children,
            'expanded': has_active_child,  # 如果有激活项，默认展开
        })
    
    return menu
```

**菜单使用说明**：
- 菜单项根据用户权限动态显示，无权限的菜单项不会显示
- 当前页面对应的菜单项会自动高亮显示（`active: true`）
- 如果子菜单中有激活项，父菜单组会自动展开（`expanded: true`）
- 菜单组支持手动折叠/展开操作

**页面设计规范**：
- 使用统一的样式模板（`common.css`）
- 列表页面使用列表页面布局模板（`list-page-container`）
- 详情页面使用信息卡片样式（`info-card`、`info-grid`）
- 表单页面使用表单卡片样式（`form-card`、`form-section`）
- 表单输入文本颜色：绿色 `#16A34A`
- 卡片标题颜色：红色 `#dc3545`
- 表格行距优化：缩小至70%

### 2. 合同管理模块左侧菜单
```
📁 合同管理（首页=合同列表）
├── 📋 业务委托书
│   ├── 📋 业务委托书列表
│   ├── ➕ 创建业务委托书
│   └── 📄 业务委托书模板
├── ✍️ 合同签署
│   ├── 📄 创建合同（显示所有状态的合同，列表页面右上角提供"+ 新增合同"按钮）
│   ├── ⚖️ 合同争议（显示争议状态的合同）
│   ├── 📝 合同定稿（显示定稿状态的合同）
│   ├── ✍️ 创建合同签署（仅显示我方签章和对方签章的合同）
│   └── 🔐 合同签章

├── 📊 合同执行
│   ├── 📋 履约跟踪
│   ├── 📝 合同变更
│   └── 📎 合同文件
└── ⚠️ 提醒与警报
    ├── 📅 到期提醒
    ├── 💰 付款提醒
    └── ⚠️ 风险预警
```

**说明**：
- **创建合同**：显示所有状态的合同，提供完整的合同管理视图，作为合同管理的主入口。列表页面右上角提供"+ 新增合同"按钮，用于创建新合同（遵循统一的设计模式：所有创建操作都通过列表页面的创建入口完成）
- **创建合同签署**：仅显示我方签章和对方签章状态的合同，专注于合同签署流程。列表页面右上角提供"+ 新增合同签署"按钮，用于创建新的合同签署
- **合同争议**：显示处于争议状态的合同（创建流程第二步），用于管理和解决合同争议问题
- **合同定稿**：显示已定稿状态的合同（创建流程第三步），合同定稿后可以进入签署流程
- **业务委托书**：一级菜单，管理正式合同签订前的业务委托书，包含业务委托书列表、创建业务委托书、业务委托书模板
- **合同签署**：一级菜单，合同签署流程管理，包含创建合同、合同争议、合同定稿、创建合同签署、合同签章
- **合同执行**：一级菜单，履约跟踪、合同变更、合同文件管理等合同执行过程中的管理功能
- **提醒与警报**：一级菜单，主动提醒合同到期、付款、履约节点等关键事项，风险预警
- ⚠️ **注意**：
  - **统一设计原则**：所有模块的创建操作都通过列表页面的创建入口完成，不在菜单中单独设置"创建"菜单项（参考计划管理、行政管理等模块的设计方式）
  - **合同状态流程**：
    - **创建合同流程**（三步）：合同草稿 → 合同争议 → 合同定稿
    - **合同签署流程**（两步）：我方签章 → 对方签章
    - **合同执行流程**：对方签章 → 已生效 → 执行中 → 已完成
  - 回款计划的实际管理在回款管理模块，合同管理模块仅提供关联查看功能
  - 合同详情页提供完整的合同信息查看和管理操作
  - 创建合同列表和创建合同签署列表使用不同的视图和模板，分别服务于不同的业务场景

**菜单实现状态**：

#### 📋 业务委托书分组

##### 📋 业务委托书列表
- **实现状态**：⏳ 待实现
- **URL路由**：`business_pages:authorization_letter_list` - `/business/authorization-letters/`
- **页面模板**：`templates/customer_success/authorization_letter_list.html`
- **视图函数**：`authorization_letter_list`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `list-page-container` 布局
- **功能列表**：
  - ⏳ **委托书列表展示**
    - 列表展示（分页，每页20条，按创建时间倒序）
    - 显示字段：委托书编号、委托书名称、委托方、受托方、委托金额、委托日期、状态、关联商机、创建人、创建时间
    - 表格列：委托书编号、委托书名称、委托方、受托方、委托金额、委托日期、状态、关联商机、操作
    - 统计卡片：委托书总数、已确认、待确认、已作废
  - ⏳ **筛选功能**
    - 状态筛选（草稿、已提交、已确认、已作废）
    - 委托方筛选（下拉选择）
    - 关联商机筛选（下拉选择）
    - 创建时间筛选（今天、本周、本月、自定义日期范围）
  - ⏳ **搜索功能**
    - 支持按委托书编号、委托书名称、委托方名称、受托方名称搜索
    - 支持选择搜索字段或全字段搜索
    - 实时搜索（500ms防抖）
  - ⏳ **批量操作**
    - 批量删除（仅草稿状态，需权限验证）
    - 批量导出（Excel格式，包含所有字段）
  - ⏳ **操作按钮**
    - 查看详情
    - 编辑（仅草稿状态）
    - 删除（仅草稿状态）
    - 转换为合同（已确认状态）
    - 状态流转（提交、确认、作废）

##### ➕ 创建业务委托书
- **实现状态**：⏳ 待实现
- **URL路由**：`business_pages:authorization_letter_create` - `/business/authorization-letters/create/`
- **页面模板**：`templates/customer_success/authorization_letter_form.html`
- **视图函数**：`authorization_letter_create`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `form-card`、`form-section` 组件
- **表单字段**（按逻辑分组）：
  - **📋 基本信息**
    - 委托书编号（自动生成，格式：VIH-AUTH-YYYY-NNNN，可选手动输入）
    - 委托书名称（必填，最大长度200字符）
    - 委托日期（必填，日期选择器，默认当前日期）
    - 委托书状态（默认"草稿"，下拉选择：草稿、已提交、已确认、已作废）
  - **👥 委托方信息**
    - 委托方名称（必填，支持从客户列表选择或手动输入）
    - 委托方联系人（可选）
    - 委托方联系方式（可选，电话、邮箱）
    - 委托方地址（可选）
  - **🏢 受托方信息**
    - 受托方名称（必填，默认我方公司名称）
    - 受托方联系人（可选）
    - 受托方联系方式（可选）
  - **📝 委托内容**
    - 服务内容（必填，文本域，支持富文本）
    - 服务范围（必填，文本域）
    - 服务要求（可选，文本域）
    - 服务标准（可选，文本域）
  - **💰 委托金额**
    - 委托金额（必填，数值输入，单位：元，支持小数点后2位）
    - 付款方式（可选，下拉选择：一次性付款、分期付款、按进度付款）
    - 付款条件（可选，文本域）
  - **📅 委托期限**
    - 开始日期（必填，日期选择器）
    - 结束日期（必填，日期选择器）
    - 委托期限（自动计算，结束日期-开始日期，单位：天）
  - **🔗 关联信息**
    - 关联商机（可选，下拉选择，支持搜索）
    - 关联项目（可选，下拉选择，支持搜索）
    - 备注（可选，文本域）
- **表单验证**：
  - 前端实时验证（必填字段、格式、日期范围等）
  - 后端完整验证（必填字段、格式、业务规则）
  - 委托书编号唯一性检查
  - 提交按钮加载状态提示
- **保存操作**：
  - 保存后委托书状态为"草稿"（draft）
  - 可随时编辑和删除
  - 保存后可提交确认

##### 📄 业务委托书模板
- **实现状态**：⏳ 待实现
- **URL路由**：`business_pages:authorization_letter_template_list` - `/business/authorization-letter-templates/`
- **页面模板**：`templates/customer_success/authorization_letter_template_list.html`
- **视图函数**：`authorization_letter_template_list`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `list-page-container` 布局
- **功能列表**：
  - ⏳ **模板列表展示**
    - 模板列表（分页，每页20条，按创建时间倒序）
    - 显示字段：模板名称、模板类型、模板分类、变量数量、使用次数、创建人、创建时间、操作
    - 模板分类筛选（按业务类型、合同类型分类）
    - 模板搜索（按模板名称、类型、关键词搜索）
  - ⏳ **模板创建/编辑**
    - URL路由：`business_pages:authorization_letter_template_create` - `/business/authorization-letter-templates/create/`
    - URL路由：`business_pages:authorization_letter_template_edit` - `/business/authorization-letter-templates/<id>/edit/`
    - 页面模板：`templates/customer_success/authorization_letter_template_form.html`
    - 表单字段：
      - 模板名称（必填）
      - 模板类型（必填，下拉选择：服务委托书、采购委托书等）
      - 模板分类（可选，下拉选择）
      - 模板内容（必填，富文本编辑器，支持变量定义，如：{委托方名称}、{委托金额}等）
      - 变量列表（自动提取模板中的变量，可编辑变量说明）
      - 模板说明（可选）
    - 样式文件：`{% static 'css/common.css' %}`
    - 页面布局：使用 `form-card`、`form-section` 组件
  - ⏳ **模板使用**
    - 从模板创建委托书（选择模板后，自动填充变量）
    - 模板变量填写（表单形式填写模板变量）
    - 委托书预览（实时预览生成的委托书内容）
  - ⏳ **模板版本管理**
    - 版本列表（显示所有版本）
    - 版本对比（对比不同版本的内容差异）
    - 版本恢复（恢复到指定版本）

#### ✍️ 合同签署分组

##### 📋 创建合同
- **实现状态**：✅ 已实现
- **URL路由**：`business_pages:contract_management_list` - `/business/contracts/management/`
- **页面模板**：`templates/customer_management/contract_management_list.html`
- **视图函数**：`contract_management_list`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `list-page-container` 布局（符合总体设计方案）
- **功能列表**：
  - ✅ **合同列表展示**
    - 列表展示（分页，每页20条，按创建时间倒序）
    - 显示字段：合同编号、合同名称、客户、关联项目、合同类型、状态、合同金额、已回款、未回款、签订日期、创建人、操作
    - 表格列：合同编号、合同名称、客户、关联项目、合同类型、状态、合同金额、已回款、未回款、签订日期、创建人、操作
    - 统计卡片：合同总数、草稿、待审核、已签署、已生效、执行中、已完成、合同总金额
    - ⚠️ **说明**：显示所有状态的合同，提供完整的合同管理视图
  - ✅ **筛选功能**
    - 状态筛选（全部状态：合同草稿、合同争议、合同定稿、我方签章、对方签章、已生效、执行中、已完成、已终止、已取消）
    - 合同类型筛选（下拉选择：框架合同、项目合同、补充协议、变更协议、终止协议、其他）
    - 客户筛选（下拉选择，支持搜索，限制显示100个活跃客户）
    - 签订日期筛选（日期范围选择：开始日期至结束日期）
  - ✅ **搜索功能**
    - 支持按合同编号、合同名称、客户名称、项目编号、项目名称搜索
    - 搜索框实时搜索（输入后点击搜索按钮）
  - ✅ **操作按钮**
    - 查看详情（所有状态）
    - 编辑（仅草稿状态，需权限：创建人或具有编辑权限）
    - **创建入口**：列表页面右上角提供"+ 新增合同"按钮（需创建权限），遵循统一的设计模式：所有创建操作都通过列表页面的创建入口完成，不在菜单中单独设置"创建"菜单项
  - ✅ **权限控制**
    - 创建权限：`customer_management.client.create`
    - 查看权限：`customer_management.client.view`
    - 编辑权限：创建人或具有`customer_management.client.edit`权限
    - 删除权限：创建人或具有`customer_management.client.delete`权限（仅草稿状态）

##### 📋 创建合同签署
- **实现状态**：✅ 已实现
- **URL路由**：`business_pages:contract_sign_list` - `/business/contracts/sign/`
- **页面模板**：`templates/customer_management/contract_list.html`
- **视图函数**：`contract_sign_list`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `list-page-container` 布局
- **功能列表**：
  - ✅ **合同签署列表展示**
    - 列表展示（分页，每页20条，按创建时间倒序）
    - 显示字段：合同编号、合同名称、客户、关联项目、合同类型、状态、合同金额、已回款、未回款、签订日期、操作
    - 仅显示状态为"我方签章"（party_b_signed）或"对方签章"（signed）的合同
    - 统计卡片：我方签章数量、对方签章数量、签署总数
  - ✅ **筛选功能**
    - 状态筛选（我方签章、对方签章）
    - 合同类型筛选（下拉选择）
    - 客户筛选（下拉选择，支持搜索）
    - 项目筛选（下拉选择，支持搜索）
  - ✅ **搜索功能**
    - 支持按合同编号、合同名称、客户名称、项目编号、项目名称搜索
  - ✅ **操作按钮**
    - 查看详情
    - 编辑（仅合同草稿状态，需权限）
    - 签署操作（我方签章、对方签章状态，需权限）
    - **创建入口**：列表页面右上角提供"+ 新增合同签署"按钮（需创建权限），点击后进入合同签署创建页面，创建的合同默认状态为"合同草稿"（创建流程第一步）

##### ➕ 创建合同签署
- **实现状态**：✅ 已实现
- **URL路由**：`business_pages:contract_sign_create` - `/business/contracts/sign/create/`
- **页面模板**：`templates/customer_management/contract_form.html`
- **视图函数**：`contract_sign_create`
- **功能特点**：
  - 专门用于合同签署流程的创建入口
  - 创建的合同默认状态为"合同草稿"（draft），进入创建流程第一步
  - 创建流程：合同草稿 → 合同争议 → 合同定稿 → 我方签章 → 对方签章
  - 创建成功后跳转到合同签署列表页面
  - 支持从业务委托书转换创建
  - 表单字段与普通合同创建相同，但默认状态不同

##### ➕ 创建合同
- **实现状态**：✅ 已实现
- **URL路由**：`business_pages:contract_create` - `/business/contracts/create/`
- **页面模板**：`templates/customer_success/contract_form.html`
- **视图函数**：`contract_create`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `form-card`、`form-section` 组件
- **表单字段**（按逻辑分组）：
  - **🔗 关联信息**
    - 关联项目（可选，下拉选择，支持搜索）
    - 关联客户（必填，下拉选择，支持搜索）
    - 主合同选择（可选，下拉选择，用于创建子合同）
    - 关联业务委托书（可选，下拉选择，基于委托书创建时自动关联）
  - **📋 基本信息**
    - 合同编号（自动生成，格式：VIH-CON-YYYY-NNNN，可选手动输入）
    - 合同名称（必填，最大长度200字符）
    - 合同类型（必填，下拉选择：服务合同、采购合同、销售合同等）
    - 合同状态（默认"合同草稿"，下拉选择：合同草稿、合同争议、合同定稿、我方签章、对方签章、已生效、执行中、已完成、已终止、已取消）
  - **💰 金额信息**
    - 合同金额含税（必填，数值输入，单位：元，支持小数点后2位）
    - 税率（必填，百分比输入，默认13%，支持小数点后2位）
    - 不含税金额（自动计算：含税金额 / (1 + 税率)）
    - 税额（自动计算：含税金额 - 不含税金额）
    - 已回款金额（只读，从回款管理模块同步，默认0）
    - 未回款金额（自动计算：合同金额 - 已回款金额）
    - 已结算金额（只读，从结算管理模块同步，默认0）
  - **📅 时间信息**
    - 签订日期（必填，日期选择器）
    - 生效日期（必填，日期选择器）
    - 开始日期（必填，日期选择器）
    - 结束日期（必填，日期选择器）
    - 期限（自动计算：结束日期-开始日期，单位：天）
  - **👥 双方信息**
    - 甲方名称（必填，文本输入）
    - 甲方联系人（可选）
    - 乙方名称（必填，文本输入，默认我方公司名称）
    - 乙方联系人（可选）
    - 签订人（可选，下拉选择用户）
    - 审批人（可选，下拉选择用户）
  - **📝 其他信息**
    - 合同描述（可选，文本域）
    - 备注（可选，文本域）
- **表单验证**：
  - 前端实时验证（必填字段、格式、日期范围等）
  - 后端完整验证（必填字段、格式、业务规则）
  - 合同编号唯一性检查
  - 提交按钮加载状态提示
- **保存操作**：
  - 保存后合同状态为"草稿"（draft）
  - 可随时编辑和删除
  - 保存后可提交审批
- **支持功能**：
  - 从模板创建（待实现）
  - 基于业务委托书创建（待实现）

##### 🔐 合同签章
- **实现状态**：⏳ 待实现
- **URL路由**：`business_pages:contract_sign_list` - `/business/contracts/sign/`
- **页面模板**：`templates/customer_success/contract_sign_list.html`
- **视图函数**：`contract_sign_list`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `list-page-container` 布局
- **功能列表**：
  - ⏳ **待签署列表**
    - 列表展示（分页，每页20条）
    - 显示字段：合同编号、合同名称、客户、签署状态、待签署人、操作
    - 标签页筛选：待我签署、待他人签署、已签署
    - 统计卡片：待我签署数量、待他人签署数量、已签署数量
  - ⏳ **发起签署**
    - URL路由：`business_pages:contract_sign_initiate` - `/business/contracts/<id>/sign/initiate/`
    - 页面模板：`templates/customer_success/contract_sign_initiate.html`
    - 视图函数：`contract_sign_initiate`
    - 功能：
      - 签署流程配置（配置签署人、签署顺序、签署位置）
      - 签署位置设置（在合同文件上设置签署位置）
      - 签署提醒设置（短信、邮件提醒）
      - 发起签署（调用e签宝API发起签署流程）
    - 第三方集成：e签宝电子签章服务
  - ⏳ **签署记录**
    - URL路由：`business_pages:contract_sign_record` - `/business/contracts/sign/record/`
    - 页面模板：`templates/customer_success/contract_sign_record.html`
    - 视图函数：`contract_sign_record`
    - 功能：
      - 签署记录列表（所有签署记录）
      - 签署详情（签署人、签署时间、签署位置、签署状态）
      - 签署文件下载（下载已签署的合同文件）
      - 签署证明下载（下载签署证明文件）
  - ⏳ **数字证书管理**
    - URL路由：`business_pages:contract_certificate_manage` - `/business/contracts/certificates/`
    - 页面模板：`templates/customer_success/contract_certificate_manage.html`
    - 视图函数：`contract_certificate_manage`
    - 功能：
      - 证书列表（所有数字证书）
      - 证书配置（添加、编辑、删除证书）
      - 证书查看（证书详情、有效期等）
    - 第三方集成：e签宝电子签章服务
  - ⏳ **存证查询**
    - URL路由：`business_pages:contract_evidence_query` - `/business/contracts/evidence/query/`
    - 页面模板：`templates/customer_success/contract_evidence_query.html`
    - 视图函数：`contract_evidence_query`
    - 功能：
      - 存证信息查询（查询合同存证信息）
      - 存证证明下载（下载存证证明文件）
    - 第三方集成：e签宝存证服务

#### 📊 合同执行分组

##### 📋 履约跟踪
- **实现状态**：⏳ 待实现
- **URL路由**：`business_pages:contract_performance_track` - `/business/contracts/performance/`
- **页面模板**：`templates/customer_success/contract_performance_track.html`
- **视图函数**：`contract_performance_track`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `list-page-container` 布局（合同列表）+ `info-card` 布局（履约详情）
- **数据模型**：待创建（ContractMilestone、ContractPerformance）
- **功能列表**：
  - ⏳ **履约节点列表**
    - 合同列表（分页，每页20条）
    - 显示字段：合同编号、合同名称、客户、履约状态、节点完成率、操作
    - 履约状态筛选（履约中、已完成、已逾期、已暂停）
    - 统计卡片：履约中合同数、已完成合同数、已逾期合同数、平均完成率
  - ⏳ **履约节点管理**
    - URL路由：`business_pages:contract_milestone_manage` - `/business/contracts/<id>/milestones/`
    - 页面模板：`templates/customer_success/contract_milestone_manage.html`
    - 视图函数：`contract_milestone_manage`
    - 功能：
      - 节点列表（关键节点、交付节点、验收节点等）
      - 节点添加（节点名称、节点类型、计划完成日期、节点描述）
      - 节点编辑（编辑节点信息）
      - 节点删除（删除节点）
      - 节点完成确认（确认节点完成状态、实际完成日期）
      - 节点进度跟踪（实时跟踪节点完成进度）
      - 节点逾期提醒（节点逾期时，自动提醒）
    - 页面布局：使用 `info-card`、`info-grid` 组件展示节点信息
  - ⏳ **履约情况记录**
    - URL路由：`business_pages:contract_performance_record` - `/business/contracts/<id>/performance/`
    - 页面模板：`templates/customer_success/contract_performance_record.html`
    - 视图函数：`contract_performance_record`
    - 功能：
      - 履约情况列表（补充协议、变更、违约事件等）
      - 履约情况添加（情况类型、情况描述、发生日期、处理情况）
      - 履约评价记录（履约评价、评价日期、评价人）
      - 履约情况统计（统计合同履约情况）
    - 页面布局：使用 `info-card`、`info-grid` 组件
  - ⏳ **收付款记录查看**
    - 功能：查看合同收付款记录（只读）
    - 数据来源：与财务管理模块对接
    - 显示字段：付款计划、实际付款情况、付款日期、付款状态
    - ⚠️ **说明**：收付款记录与财务管理模块对接，实际付款管理在财务管理模块

##### 📝 合同变更
- **实现状态**：✅ 已实现
- **URL路由**：`business_pages:contract_change_create` - `/business/contracts/<id>/changes/create/`
- **页面模板**：`templates/customer_success/contract_change_form.html`
- **视图函数**：`contract_change_create`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `form-card`、`form-section` 组件
- **表单字段**：
  - **变更类型**（必填，下拉选择：金额变更、期限变更、条款变更、双方变更、其他变更）
  - **变更原因**（必填，文本域）
  - **变更前内容**（可选，文本域）
  - **变更后内容**（必填，文本域）
  - **变更金额**（金额变更时必填，数值输入，单位：元）
  - **变更日期**（必填，日期选择器，默认当前日期）
  - **审批人**（可选，下拉选择用户）
  - **备注**（可选，文本域）
- **功能列表**：
  - ✅ **变更记录创建**（✅ 已实现）
    - 创建合同变更记录，记录合同变更历史
    - 金额变更自动更新合同金额（变更金额自动累加到合同金额）
    - 权限控制（需合同管理权限）
  - ✅ **变更记录列表展示**（✅ 已实现）
    - 变更记录列表（按创建时间倒序）
    - 变更信息展示（变更类型、变更原因、变更前后内容、变更金额、变更日期、审批人、创建人、创建时间）
  - ⏳ **变更记录编辑**（待实现）
  - ⏳ **变更记录删除**（待实现）
- **说明**：在合同详情页中操作，也可在履约跟踪中查看变更记录

##### 📎 合同文件
- **实现状态**：✅ 已实现
- **URL路由**：
  - `business_pages:contract_file_upload` - `/business/contracts/<id>/files/upload/`
  - `business_pages:contract_file_download` - `/business/contracts/files/<id>/download/`
  - `business_pages:contract_file_delete` - `/business/contracts/files/<id>/delete/`
- **页面模板**：`templates/customer_success/contract_file_form.html`
- **视图函数**：`contract_file_upload`、`contract_file_download`、`contract_file_delete`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `form-card`、`form-section` 组件（上传表单）+ `info-card` 组件（文件列表）
- **功能列表**：
  - ✅ **文件上传**（✅ 已实现）
    - 文件上传（支持多种文件格式：PDF、Word、Excel、图片等，最大10MB）
    - 文件类型选择（必填，下拉选择：原件、扫描件、附件、补充协议、变更协议、终止协议、其他文件）
    - 文件名称录入（必填，如果未填写则使用上传文件名）
    - 文件版本管理（版本号录入，默认1.0）
    - 文件描述录入（可选，文本域）
    - 文件大小自动计算（自动记录文件大小）
    - 上传人自动记录（当前登录用户）
    - 上传时间自动记录
    - 权限控制（需合同管理权限）
  - ✅ **文件下载**（✅ 已实现）
    - 文件下载（支持中文文件名）
    - 下载权限检查（需合同查看或管理权限）
    - 文件不存在提示
  - ✅ **文件删除**（✅ 已实现）
    - 文件删除（删除文件记录和实际文件）
    - 删除确认
    - 权限控制（需合同管理权限）
  - ✅ **文件列表展示**（✅ 已实现）
    - 文件列表（按上传时间倒序）
    - 文件信息展示（文件类型、文件名称、版本号、文件大小、上传人、上传时间）
    - 文件操作（下载、删除，权限控制）
- **说明**：在合同详情页中操作，也可在履约跟踪中查看文件列表

#### ⚠️ 提醒与警报分组

##### 📅 到期提醒
- **实现状态**：⏳ 待实现
- **URL路由**：`business_pages:contract_expiry_reminder` - `/business/contracts/reminders/expiry/`
- **页面模板**：`templates/customer_success/contract_expiry_reminder.html`
- **视图函数**：`contract_expiry_reminder`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `list-page-container` 布局
- **功能列表**：
  - ⏳ **到期提醒列表**
    - 列表展示（分页，每页20条）
    - 显示字段：合同编号、合同名称、客户、到期日期、剩余天数、提醒状态、操作
    - 标签页筛选：即将到期（30天内）、已到期、已续签
    - 统计卡片：即将到期数量、已到期数量、已续签数量
    - 排序：按到期日期升序（即将到期的优先显示）
  - ⏳ **续签提醒**
    - 续签提醒列表（需要续签的合同）
    - 续签操作（创建续签合同）
    - 续签记录（记录续签历史）
  - ⏳ **提醒设置**
    - URL路由：`business_pages:contract_reminder_settings` - `/business/contracts/reminders/settings/`
    - 页面模板：`templates/customer_success/contract_reminder_settings.html`
    - 视图函数：`contract_reminder_settings`
    - 功能：
      - 提醒时间设置（提前30天、提前15天、提前7天、提前1天）
      - 提醒方式设置（站内消息、邮件、短信）
      - 提醒规则自定义（用户可自定义提醒规则）
    - 页面布局：使用 `form-card`、`form-section` 组件

##### 💰 付款提醒
- **实现状态**：⏳ 待实现
- **URL路由**：`business_pages:contract_payment_reminder` - `/business/contracts/reminders/payment/`
- **页面模板**：`templates/customer_success/contract_payment_reminder.html`
- **视图函数**：`contract_payment_reminder`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `list-page-container` 布局
- **功能列表**：
  - ⏳ **付款提醒列表**
    - 列表展示（分页，每页20条）
    - 显示字段：合同编号、合同名称、客户、付款节点、计划付款日期、剩余天数、付款状态、操作
    - 标签页筛选：即将到期（30天内）、已到期、已完成
    - 统计卡片：即将到期数量、已到期数量、已完成数量
    - 排序：按计划付款日期升序（即将到期的优先显示）
  - ⏳ **付款提醒设置**
    - URL路由：`business_pages:contract_payment_reminder_settings` - `/business/contracts/reminders/payment/settings/`
    - 页面模板：`templates/customer_success/contract_payment_reminder_settings.html`
    - 视图函数：`contract_payment_reminder_settings`
    - 功能：
      - 提醒时间设置（提前30天、提前15天、提前7天、提前1天）
      - 提醒方式设置（站内消息、邮件、短信）
      - 提醒规则自定义（用户可自定义提醒规则）
    - 页面布局：使用 `form-card`、`form-section` 组件
  - ⚠️ **说明**：实际付款管理在回款管理模块，此处仅提供提醒功能

##### ⚠️ 风险预警
- **实现状态**：⏳ 待实现
- **URL路由**：`business_pages:contract_risk_warning` - `/business/contracts/risks/`
- **页面模板**：`templates/customer_success/contract_risk_warning.html`
- **视图函数**：`contract_risk_warning`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `list-page-container` 布局
- **功能列表**：
  - ⏳ **风险预警列表**
    - 列表展示（分页，每页20条）
    - 显示字段：合同编号、合同名称、客户、风险类型、风险等级、风险描述、发现时间、处理状态、操作
    - 风险类型筛选（异常付款、长期未履约、争议条款、合同逾期、其他）
    - 风险等级筛选（高风险、中风险、低风险）
    - 处理状态筛选（待处理、处理中、已处理、已忽略）
    - 统计卡片：高风险数量、中风险数量、低风险数量、待处理数量
  - ⏳ **风险等级评估**
    - 自动评估风险等级（高风险、中风险、低风险）
    - 评估维度：
      - 异常付款（付款逾期、付款金额异常）
      - 长期未履约（履约节点长期未完成）
      - 争议条款（合同存在争议条款）
      - 合同逾期（合同到期未续签）
    - 风险评分（0-100分，自动计算）
  - ⏳ **风险处理跟踪**
    - URL路由：`business_pages:contract_risk_handle` - `/business/contracts/risks/<id>/handle/`
    - 页面模板：`templates/customer_success/contract_risk_handle.html`
    - 视图函数：`contract_risk_handle`
    - 功能：
      - 风险处理记录（处理人、处理时间、处理措施、处理结果）
      - 风险处理状态更新（待处理、处理中、已处理、已忽略）
      - 风险处理跟踪（跟踪风险处理情况）
    - 页面布局：使用 `form-card`、`form-section` 组件
  - ⏳ **风险预警通知**
    - 提醒方式：站内消息、邮件、短信
    - 通知对象：合同负责人、商务经理、财务人员等
    - 通知规则：高风险立即通知，中风险每日通知，低风险每周通知

**页面设计规范**：

##### 样式文件调用规范
- **样式文件位置**：`backend/static/css/common.css`
- **模板中引用方式**：
  ```html
  {% load static %}
  <link rel="stylesheet" href="{% static 'css/common.css' %}">
  ```
- **必须调用的场景**：
  1. ✅ **所有列表页面**：必须调用 `common.css`，使用 `list-page-container` 布局
  2. ✅ **所有详情页面**：必须调用 `common.css`，使用 `info-card`、`info-grid`、`info-item` 组件
  3. ✅ **所有表单页面**：必须调用 `common.css`，使用 `form-card`、`form-section` 组件
  4. ✅ **所有新建/编辑页面**：必须调用 `common.css`，使用表单样式组件

##### 页面布局规范
- **列表页面布局**：
  - 使用 `list-page-container` 布局
  - 包含：页面标题、筛选栏、操作栏、数据表格、分页区域
  - 统计卡片使用 `info-card` 组件
  - 表格使用 Bootstrap Table 样式
  - 表格行距优化：缩小至70%
- **详情页面布局**：
  - 使用 `info-card`、`info-grid`、`info-item` 组件
  - 信息分组使用 `info-card` 容器
  - 信息项使用 `info-item` 组件，包含 `info-label` 和 `info-value`
  - 卡片标题颜色：红色 `#dc3545`
- **表单页面布局**：
  - 使用 `form-card`、`form-section` 组件
  - 表单字段按逻辑分组，使用 `form-section` 分组
  - 表单输入使用 Bootstrap Form 样式
  - 表单输入文本颜色：绿色 `#16A34A`
  - 卡片标题颜色：红色 `#dc3545`

##### 样式组件使用规范
- **信息卡片组件**：`.info-card`、`.info-card-header`、`.info-card-body`、`.info-card-title`
- **信息布局组件**：`.info-grid`、`.info-item`、`.info-label`、`.info-value`
- **表单组件**：`.form-card`、`.form-section`、`.form-group`、`.form-label`、`.form-control`
- **布局组件**：`.workspace-two-column`、`.workspace-content`、`.workspace-main`
- **列表组件**：`.list-page-container`、`.page-header`、`.filter-bar`、`.action-bar`

##### 交互功能规范
- ✅ 表单验证（HTML5原生验证 + Bootstrap样式）
- ✅ 筛选表单自动提交（500ms防抖）
- ✅ 实时搜索（500ms防抖）
- ✅ 批量选择功能
- ✅ 表格行悬停效果
- ✅ 删除确认对话框
- ✅ 金额自动计算（JavaScript实时计算）
- ✅ 日期自动计算（JavaScript实时计算）
- ✅ 合同编号自动生成（VIH-CON-YYYY-NNNN格式）
- ✅ 委托书编号自动生成（VIH-AUTH-YYYY-NNNN格式）

##### 响应式设计
- ✅ 左侧导航菜单（使用 `workspace-two-column` 布局）
- ✅ 主内容区域（使用 `workspace-content` 或 `workspace-main`）
- ✅ 响应式设计（移动端自动适配）
- ✅ 表格响应式（移动端横向滚动）

### 3. 生产管理模块左侧菜单
```
📁 生产管理（首页=项目列表）
├── ➕ 创建生产
├── 🏗️ 生产准备
├── 📐 图纸管理
├── 💡 意见管理
├── ✅ 内部校审
├── 💬 设计回复
├── 🤝 三方沟通
├── 🔄 跟踪改图
├── 🔍 返图核图
├── ✅ 成果确认
├── 📊 限额指标（过程优化）
├── 📰 每周快报（过程咨询）
└── 🔄 多轮审查（精细化审图）
```

### 5. 收发管理模块左侧菜单
```
📁 收发管理（首页=交付记录列表）
├── 📋 交付准备
│   ├── ➕ 交付创建
│   ├── 📝 文件准备
│   ├── ✅ 交付审核
│   └── 📰 每周快报（过程咨询）
├── 🚀 交付执行
│   ├── 📧 邮件发送
│   ├── 📦 快递寄送
│   └── 🚶 现场送达
├── 📊 交付跟踪
│   ├── 状态跟踪
│   ├── 物流跟踪
│   └── 签收跟踪
└── ✅ 交付确认
    ├── 收件确认
    ├── 签收确认
    ├── 成果确认
    ├── 客户反馈
    └── 满意度评价
```

### 6. 结算管理模块左侧菜单
```
📁 结算管理（首页=结算列表）
├── ➕ 结算创建
├── 📋 结算初审
├── 💬 初审回复
├── 🔄 结算对账
├── ⚖️ 争议解决
└── ✅ 结算定案
```

### 7. 回款管理模块左侧菜单
```
📁 回款管理（首页=回款计划列表）
├── ➕ 计划创建
├── 💰 回款跟踪
│   ├── ➕ 回款登记
│   ├── 📊 回款状态跟踪
│   └── 📝 跟踪记录
├── 🧾 发票管理
│   ├── ➕ 发票开具
│   ├── 📋 发票列表
│   ├── 🔗 发票关联
│   └── ⏰ 回款确认提醒
├── 📞 催收管理
│   ├── ➕ 催收任务
│   ├── 📋 催收记录
│   └── 📊 催收统计
├── 📈 回款预测
└── ⚠️ 风险预警
```

### 8. 人事管理模块左侧菜单
```
📁 人事管理（首页=员工列表）
├── 🏢 组织架构
│   ├── 部门管理
│   ├── 职位管理
│   └── 组织架构图
├── 👥 员工管理
│   ├── ➕ 员工创建
│   ├── 📋 员工列表
│   ├── 📁 员工档案
│   ├── 🔄 员工异动
│   │   ├── 入职管理
│   │   ├── 离职管理
│   │   ├── 调岗管理
│   │   └── 晋升管理
│   └── 📄 合同管理
├── 📝 招聘管理
│   ├── 招聘需求
│   ├── 招聘计划
│   ├── 简历管理
│   ├── 面试管理
│   ├── 录用管理
│   └── 招聘统计
├── ⏰ 考勤管理
│   ├── 考勤规则
│   ├── 考勤打卡
│   ├── 考勤记录
│   ├── 请假管理
│   ├── 加班管理
│   └── 考勤统计
├── 💵 薪资管理
│   ├── 薪资规则
│   ├── 薪资核算
│   ├── 薪资发放
│   └── 薪资统计
├── 📊 绩效考核
│   ├── 考核计划
│   ├── 考核执行
│   ├── 考核结果
│   └── 考核统计
├── 🎓 培训管理
│   ├── 培训计划
│   ├── 培训执行
│   ├── 培训记录
│   └── 培训统计
├── 🎁 福利管理
│   ├── 福利项目
│   ├── 福利发放
│   └── 福利统计
└── 🤝 员工关系
    ├── 员工沟通
    ├── 员工关怀
    ├── 员工活动
    ├── 员工投诉
    └── 员工建议
```

### 9. 行政管理模块左侧菜单
```
📁 行政管理（首页=行政事务列表）
├── 📋 行政事务
│   ├── ➕ 事务创建
│   ├── 📊 事务跟踪
│   └── 📈 事务统计
├── 📦 办公用品
│   ├── 采购管理
│   ├── 领用管理
│   ├── 库存管理
│   └── 用品分类
├── 🏢 会议管理
│   ├── ➕ 会议安排
│   ├── 会议室管理
│   ├── 会议记录
│   └── 会议统计
├── 🚗 车辆管理
│   ├── 车辆信息
│   ├── 用车申请
│   ├── 车辆调度
│   └── 车辆维护
├── 🏛️ 固定资产
│   ├── 资产信息
│   ├── 资产采购
│   ├── 资产领用
│   ├── 资产盘点
│   └── 资产折旧
├── 🔐 印章管理
│   ├── 印章信息
│   ├── 用印申请
│   ├── 用印审批
│   └── 用印记录
├── 🎫 接待管理
│   ├── 接待申请
│   ├── 接待安排
│   └── 接待记录
└── ✈️ 差旅管理
    ├── 差旅申请
    ├── 差旅审批
    ├── 差旅报销
    └── 差旅统计
```

### 9. 财务管理模块左侧菜单
```
📁 财务管理（首页=凭证列表）
├── 📊 财务核算
│   ├── 会计科目
│   ├── 凭证管理
│   └── 账簿管理
├── 💰 资金管理
│   ├── 银行账户
│   ├── 资金流水
│   ├── 资金调拨
│   └── 资金预测
├── 📋 预算管理
│   ├── 预算编制
│   ├── 预算执行
│   └── 预算分析
├── 💸 成本管理
│   ├── 成本核算
│   ├── 成本分析
│   └── 成本控制
├── 📝 往来账款
│   ├── 应收账款
│   ├── 应付账款
│   └── 对账管理
├── 📈 财务报表
│   ├── 资产负债表
│   ├── 利润表
│   ├── 现金流量表
│   └── 自定义报表
├── 📉 财务分析
└── 🧾 税务管理
    ├── 税务申报
    ├── 发票管理
    └── 税务统计
```

### 10. 产值管理模块左侧菜单
```
📁 产值管理（首页=产值列表）
├── ⚙️ 产值配置
│   ├── 产值阶段
│   ├── 产值里程碑
│   └── 产值事件
├── 💰 产值计算
│   ├── 自动计算
│   ├── 手动计算
│   └── 产值确认
├── 📋 产值查询
│   ├── 个人产值
│   ├── 项目产值
│   └── 部门产值
├── 📊 产值分析
│   ├── 产值趋势
│   ├── 产值对比
│   └── 产值排名
└── ✅ 产值审批
    ├── 产值审核
    └── 产值分配
```

### 11. 计划管理模块左侧菜单
```
📁 计划管理（首页=计划列表）
├── 🎯 战略目标
│   ├── 目标制定
│   ├── 目标分解
│   └── 目标跟踪
├── 📋 计划管理
│   ├── ➕ 计划创建
│   ├── 📊 计划分解
│   ├── 🔗 目标对齐
│   └── 📝 计划审批
├── ✅ 计划执行
│   ├── 执行跟踪
│   ├── 进度更新
│   └── 问题管理
└── 📈 计划分析
    ├── 完成分析
    ├── 目标达成
    └── 计划统计
```

**说明**：
- **战略目标**：一级菜单，管理公司战略目标，包括目标制定、目标分解、目标跟踪等功能
- **计划管理**：一级菜单，管理工作计划，包括计划创建、计划分解、目标对齐、计划审批等功能
- **计划执行**：一级菜单，跟踪计划执行情况，包括执行跟踪、进度更新、问题管理等功能
- **计划分析**：一级菜单，进行计划分析，包括完成分析、目标达成分析、计划统计等功能
- ⚠️ **注意**：
  - 计划必须关联战略目标，确保计划与战略目标的一致性
  - 计划执行进度会自动更新关联的战略目标进度
  - 计划完成会影响战略目标的达成评估

**菜单实现状态**：

#### 🎯 战略目标分组

##### 🎯 目标制定
- **实现状态**：✅ 已完成
- **URL路由**：`plan_pages:strategic_goal_list` - `/plan/strategic-goals/`
- **页面模板**：`templates/plan_management/strategic_goal_list.html`
- **视图函数**：`strategic_goal_list`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `list-page-container` 布局
- **功能列表**：
  - ⏳ **目标列表展示**
    - 列表展示（分页，每页20条，按创建时间倒序）
    - 显示字段：目标编号、目标名称、目标类型、目标周期、目标值、当前值、完成率、目标负责人、状态、创建时间
    - 表格列：目标编号、目标名称、目标类型、目标周期、目标值、当前值、完成率、负责人、状态、操作
    - 统计卡片：目标总数、执行中、已完成、已取消
  - ⏳ **筛选功能**
    - 状态筛选（制定中、已发布、执行中、已完成、已取消）
    - 目标类型筛选（财务目标、市场目标、运营目标、创新目标、人才目标、其他）
    - 目标周期筛选（年度目标、三年目标、五年目标）
    - 负责人筛选（下拉选择，支持搜索）
    - 创建时间筛选（今天、本周、本月、自定义日期范围）
  - ⏳ **搜索功能**
    - 支持按目标编号、目标名称、负责人名称搜索
    - 支持选择搜索字段或全字段搜索
    - 实时搜索（500ms防抖）
  - ⏳ **批量操作**
    - 批量删除（仅制定中状态，需权限验证）
    - 批量导出（Excel格式，包含所有字段）
  - ⏳ **操作按钮**
    - 查看详情
    - 编辑（仅制定中或已发布状态）
    - 删除（仅制定中状态，需检查是否有关联计划）
    - 目标分解
    - 目标跟踪
    - 状态流转（发布、启动、完成、取消）

##### ➕ 创建战略目标
- **实现状态**：✅ 已完成
- **URL路由**：`plan_pages:strategic_goal_create` - `/plan/strategic-goals/create/`
- **页面模板**：`templates/plan_management/strategic_goal_form.html`
- **视图函数**：`strategic_goal_create`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `form-card`、`form-section` 组件
- **表单字段**（按逻辑分组）：
  - **📋 基本信息**
    - 目标编号（自动生成，格式：GOAL-{YYYYMMDD}-{序列号}，可选手动输入）
    - 目标名称（必填，最大长度200字符）
    - 目标类型（必填，下拉选择：财务目标、市场目标、运营目标、创新目标、人才目标、其他）
    - 目标周期（必填，下拉选择：年度目标、三年目标、五年目标）
    - 目标状态（默认"制定中"，下拉选择：制定中、已发布、执行中、已完成、已取消）
  - **📊 目标指标**
    - 目标指标名称（必填，最大长度100字符）
    - 指标类型（必填，下拉选择：数值型、百分比型、布尔型、文本型）
    - 指标单位（可选，如：万元、%、个、次等）
    - 目标值（必填，数值输入，根据指标类型自动验证）
    - 当前值（可选，数值输入，默认0）
    - 完成率（自动计算：当前值/目标值*100%，百分比显示）
  - **👤 责任人信息**
    - 目标负责人（必填，下拉选择用户，支持搜索）
    - 参与人员（可选，多选用户）
    - 负责部门（可选，下拉选择部门）
  - **📝 目标描述**
    - 目标描述（必填，文本域，支持富文本，最大长度2000字符）
    - 目标背景（可选，文本域）
    - 目标意义（可选，文本域）
  - **⚖️ 权重设置**
    - 目标权重（必填，数值输入，范围0-100，支持小数点后2位）
    - 权重说明（可选，文本域）
  - **📅 时间信息**
    - 开始日期（必填，日期选择器）
    - 结束日期（必填，日期选择器）
    - 目标周期（自动计算，结束日期-开始日期，单位：天）
  - **🔗 关联信息**
    - 上级目标（可选，下拉选择，用于目标分解）
    - 关联项目（可选，多选项目）
    - 备注（可选，文本域）
- **表单验证**：
  - 前端实时验证（必填字段、格式、数值范围、日期范围等）
  - 后端完整验证（必填字段、格式、业务规则）
  - 目标编号唯一性检查
  - 权重总和检查（同一周期内所有目标权重总和不超过100）
  - 提交按钮加载状态提示
- **保存操作**：
  - 保存后目标状态为"制定中"（draft）
  - 可随时编辑和删除
  - 保存后可发布目标

##### 📊 目标分解
- **实现状态**：✅ 已完成
- **URL路由**：`plan_pages:strategic_goal_decompose` - `/plan/strategic-goals/<id>/decompose/`
- **页面模板**：`templates/plan_management/strategic_goal_decompose.html`
- **视图函数**：`strategic_goal_decompose`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `list-page-container` 布局，树形结构展示
- **功能列表**：
  - ⏳ **目标分解树展示**
    - 树形结构展示（支持展开/折叠）
    - 显示目标层级关系（公司目标 → 部门目标 → 团队目标 → 个人目标）
    - 显示目标基本信息（目标名称、目标值、当前值、完成率）
    - 显示目标状态（制定中、已发布、执行中、已完成、已取消）
  - ⏳ **目标分解操作**
    - 选择上级目标进行分解
    - 分解方式选择（按部门分解、按团队分解、按个人分解）
    - 分解比例设置（分解比例、分解方式）
    - 自动分解（根据分解规则自动创建下级目标）
    - 手动分解（手动创建下级目标）
  - ⏳ **部门目标创建**
    - 关联公司目标（必填，自动关联）
    - 部门选择（必填，下拉选择部门）
    - 部门目标值（必填，数值输入）
    - 部门目标指标（必填，继承上级目标指标）
    - 部门目标描述（可选）
  - ⏳ **团队目标创建**
    - 关联部门目标（必填，自动关联）
    - 团队选择（必填，下拉选择团队）
    - 团队目标值（必填，数值输入）
    - 团队目标指标（必填，继承上级目标指标）
    - 团队目标描述（可选）
  - ⏳ **个人目标创建**
    - 关联团队目标（必填，自动关联）
    - 员工选择（必填，下拉选择员工）
    - 个人目标值（必填，数值输入）
    - 个人目标指标（必填，继承上级目标指标）
    - 个人目标描述（可选）
  - ⏳ **目标对齐检查**
    - 自动检查下级目标是否与上级目标对齐
    - 对齐度评估（对齐度百分比）
    - 对齐度报告（对齐度分析报告）
    - 对齐度提升建议（提供对齐度提升建议）
  - ⏳ **目标分解关系展示**
    - 目标分解关系图（可视化展示目标分解关系）
    - 目标分解路径（显示目标分解路径）
    - 目标分解统计（统计各层级目标数量）

##### 📈 目标跟踪
- **实现状态**：✅ 已完成
- **URL路由**：`plan_pages:strategic_goal_track` - `/plan/strategic-goals/<id>/track/`
- **页面模板**：`templates/plan_management/strategic_goal_track.html`
- **视图函数**：`strategic_goal_track`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `info-card`、`info-grid` 组件
- **功能列表**：
  - ⏳ **目标进度更新**
    - 当前值更新（数值输入，更新目标当前值）
    - 完成率自动计算（当前值/目标值*100%）
    - 进度说明（文本域，记录进度更新说明）
    - 进度更新时间（自动记录）
    - 进度更新人（自动记录）
  - ⏳ **目标进度跟踪**
    - 进度时间线展示（展示目标进度变化时间线）
    - 进度变化记录（记录每次进度更新）
    - 进度趋势分析（分析进度变化趋势）
    - 进度预测（根据历史进度预测完成时间）
  - ⏳ **目标达成评估**
    - 达成率计算（自动计算目标达成率）
    - 达成评估（评估目标达成情况）
    - 达成时间预测（预测目标达成时间）
    - 达成可能性分析（分析目标达成可能性）
  - ⏳ **目标预警**
    - 进度预警（目标进度滞后预警）
    - 达成预警（目标达成风险预警）
    - 预警规则设置（设置预警阈值）
    - 预警通知（自动发送预警通知）
  - ⏳ **目标调整**
    - 目标调整申请（创建目标调整申请）
    - 调整原因（必填，文本域）
    - 调整内容（必填，文本域）
    - 调整审批流程（支持多级审批）
    - 调整执行（审批通过后执行调整）
  - ⏳ **目标完成确认**
    - 目标完成确认（确认目标已完成）
    - 完成时间记录（自动记录）
    - 完成评估（评估目标完成质量）
    - 完成总结（完成情况总结）

#### 📋 计划管理分组

##### 📋 计划列表
- **实现状态**：✅ 已完成
- **URL路由**：`plan_pages:plan_list` - `/plan/plans/`
- **页面模板**：`templates/plan_management/plan_list.html`
- **视图函数**：`plan_list`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `list-page-container` 布局
- **功能列表**：
  - ⏳ **计划列表展示**
    - 列表展示（分页，每页20条，按创建时间倒序）
    - 显示字段：计划编号、计划名称、计划类型、计划周期、关联战略目标、负责人、开始时间、结束时间、进度、状态、操作
    - 表格列：计划编号、计划名称、计划类型、计划周期、关联目标、负责人、时间范围、进度、状态、操作
    - 统计卡片：计划总数、执行中、已完成、已取消
  - ⏳ **筛选功能**
    - 状态筛选（草稿、待审批、审批中、已审批、执行中、已完成、已取消）
    - 计划类型筛选（个人计划、部门计划、公司计划、项目计划）
    - 计划周期筛选（日计划、周计划、月计划、季度计划、年计划）
    - 关联目标筛选（下拉选择战略目标）
    - 负责人筛选（下拉选择，支持搜索）
    - 创建时间筛选（今天、本周、本月、自定义日期范围）
  - ⏳ **搜索功能**
    - 支持按计划编号、计划名称、负责人名称搜索
    - 支持选择搜索字段或全字段搜索
    - 实时搜索（500ms防抖）
  - ⏳ **批量操作**
    - 批量删除（仅草稿状态，需权限验证）
    - 批量导出（Excel格式，包含所有字段）
  - ⏳ **操作按钮**
    - 查看详情
    - 编辑（仅草稿或待审批状态）
    - 删除（仅草稿状态）
    - 计划分解
    - 目标对齐
    - 提交审批（仅草稿状态）
    - 状态流转（需权限）

##### ➕ 计划创建
- **实现状态**：✅ 已完成
- **URL路由**：`plan_pages:plan_create` - `/plan/plans/create/`
- **页面模板**：`templates/plan_management/plan_form.html`
- **视图函数**：`plan_create`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `form-card`、`form-section` 组件
- **表单字段**（按逻辑分组）：
  - **📋 基本信息**
    - 计划编号（自动生成，格式：PLAN-{YYYYMMDD}-{序列号}，可选手动输入）
    - 计划名称（必填，最大长度200字符）
    - 计划类型（必填，下拉选择：个人计划、部门计划、公司计划、项目计划）
    - 计划周期（必填，下拉选择：日计划、周计划、月计划、季度计划、年计划）
    - 计划状态（默认"草稿"，下拉选择：草稿、待审批、审批中、已审批、执行中、已完成、已取消）
  - **🎯 关联战略目标**
    - 关联战略目标（必填，下拉选择，支持搜索）
    - 目标对齐检查（自动检查计划目标是否与战略目标对齐）
    - 对齐度评估（显示对齐度百分比）
    - 计划贡献度评估（评估计划对战略目标的贡献度）
  - **📝 计划内容**
    - 计划内容（必填，文本域，支持富文本，最大长度5000字符）
    - 计划目标（必填，文本域，最大长度1000字符）
    - 计划描述（可选，文本域）
  - **📅 时间信息**
    - 计划开始时间（必填，日期时间选择器）
    - 计划结束时间（必填，日期时间选择器）
    - 计划周期（自动计算，结束时间-开始时间，单位：天）
  - **👥 责任人信息**
    - 计划负责人（必填，下拉选择用户，支持搜索）
    - 参与人员（可选，多选用户）
    - 负责部门（可选，下拉选择部门）
  - **⚡ 优先级和预算**
    - 计划优先级（必填，下拉选择：高、中、低）
    - 计划预算（可选，数值输入，单位：元，支持小数点后2位）
  - **🔗 关联信息**
    - 关联项目（可选，下拉选择项目）
    - 父计划（可选，下拉选择，用于计划分解）
    - 备注（可选，文本域）
- **表单验证**：
  - 前端实时验证（必填字段、格式、日期范围等）
  - 后端完整验证（必填字段、格式、业务规则）
  - 计划编号唯一性检查
  - 目标对齐检查（检查计划目标是否与战略目标对齐）
  - 提交按钮加载状态提示
- **保存操作**：
  - 保存后计划状态为"草稿"（draft）
  - 可随时编辑和删除
  - 保存后可提交审批

##### 📊 计划分解
- **实现状态**：✅ 已完成
- **URL路由**：`plan_pages:plan_decompose` - `/plan/plans/<id>/decompose/`
- **页面模板**：`templates/plan_management/plan_decompose.html`
- **视图函数**：`plan_decompose`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `list-page-container` 布局，树形结构展示
- **功能列表**：
  - ⏳ **计划分解树展示**
    - 树形结构展示（支持展开/折叠）
    - 显示计划层级关系（父计划 → 子计划 → 任务）
    - 显示计划基本信息（计划名称、计划时间、进度、状态）
  - ⏳ **子计划创建**
    - 关联父计划（必填，自动关联）
    - 子计划名称（必填，最大长度200字符）
    - 子计划内容（必填，文本域）
    - 子计划目标（必填，文本域）
    - 子计划时间（必填，日期时间范围）
    - 子计划负责人（必填，下拉选择用户）
  - ⏳ **计划任务创建**
    - 关联计划（必填，自动关联）
    - 任务名称（必填，最大长度200字符）
    - 任务内容（必填，文本域）
    - 任务目标（必填，文本域）
    - 任务时间（必填，日期时间范围）
    - 任务负责人（必填，下拉选择用户）
  - ⏳ **计划对齐检查**
    - 自动检查子计划是否与父计划对齐
    - 对齐度评估（对齐度百分比）
    - 对齐度报告（对齐度分析报告）
  - ⏳ **计划分解关系展示**
    - 计划分解关系图（可视化展示计划分解关系）
    - 计划分解路径（显示计划分解路径）
    - 计划分解统计（统计各层级计划数量）

##### 🔗 目标对齐
- **实现状态**：✅ 已完成
- **URL路由**：`plan_pages:plan_goal_alignment` - `/plan/plans/<id>/goal-alignment/`
- **页面模板**：`templates/plan_management/plan_goal_alignment.html`
- **视图函数**：`plan_goal_alignment`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `info-card`、`info-grid` 组件
- **功能列表**：
  - ⏳ **目标对齐检查**
    - 自动检查计划目标与战略目标的对齐情况
    - 对齐度评估（对齐度百分比）
    - 对齐度分析（分析对齐度不足的原因）
  - ⏳ **对齐度报告**
    - 对齐度报告生成（自动生成对齐度报告）
    - 对齐度分析（分析计划目标与战略目标的对齐情况）
    - 对齐度趋势（分析对齐度变化趋势）
  - ⏳ **目标对齐调整**
    - 目标对齐调整（调整计划目标以提升对齐度）
    - 对齐度提升建议（提供对齐度提升建议）
    - 对齐度提升记录（记录对齐度提升历史）

##### 📝 计划审批
- **实现状态**：✅ 已完成
- **URL路由**：`plan_pages:plan_approval_list` - `/plan/plans/approval/`
- **页面模板**：`templates/plan_management/plan_approval_list.html`
- **视图函数**：`plan_approval_list`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `list-page-container` 布局
- **功能列表**：
  - ⏳ **计划审批列表**
    - 待审批计划列表（分页，每页20条）
    - 审批中计划列表（分页，每页20条）
    - 已审批计划列表（分页，每页20条）
    - 已拒绝计划列表（分页，每页20条）
  - ⏳ **计划审批流程**
    - 支持多级审批（审批流程在系统管理模块中配置）
    - 审批节点配置（配置审批节点和审批人）
    - 审批流程可视化（可视化展示审批流程）
  - ⏳ **计划审批操作**
    - 审批通过（审批通过操作）
    - 审批拒绝（审批拒绝操作）
    - 审批意见录入（必填，文本域）
    - 审批说明（可选，文本域）
  - ⏳ **审批记录**
    - 审批时间记录（自动记录）
    - 审批人记录（自动记录）
    - 审批意见记录（记录审批意见）
    - 审批历史记录（审批历史记录列表）

#### ✅ 计划执行分组

##### 📊 执行跟踪
- **实现状态**：✅ 已完成
- **URL路由**：`plan_pages:plan_execution_track` - `/plan/plans/<id>/execution/`
- **页面模板**：`templates/plan_management/plan_execution_track.html`
- **视图函数**：`plan_execution_track`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `info-card`、`info-grid` 组件
- **功能列表**：
  - ⏳ **执行计划列表**
    - 执行中计划列表（分页，每页20条）
    - 显示计划基本信息（计划名称、负责人、时间范围、进度）
    - 显示计划执行情况（执行记录数、问题数、完成情况）
  - ⏳ **执行进度更新**
    - 执行进度百分比更新（数值输入，范围0-100）
    - 进度说明（文本域，记录进度更新说明）
    - 进度更新时间（自动记录）
    - 进度更新人（自动记录）
  - ⏳ **执行情况录入**
    - 执行情况（文本域，记录执行情况）
    - 执行结果（文本域，记录执行结果）
    - 执行问题（文本域，记录执行问题）
    - 执行时间（自动记录）
    - 执行人（自动记录）
  - ⏳ **执行记录列表**
    - 执行记录列表（分页，每页20条）
    - 执行记录详情（显示执行记录详细信息）
    - 执行记录搜索（支持按时间、执行人搜索）
  - ⏳ **执行时间线展示**
    - 执行时间线（可视化展示执行时间线）
    - 执行里程碑（显示执行里程碑）
    - 执行节点（显示执行节点）

##### 📈 进度更新
- **实现状态**：✅ 已完成
- **URL路由**：`plan_pages:plan_progress_update` - `/plan/plans/<id>/progress/update/`
- **页面模板**：`templates/plan_management/plan_progress_update.html`
- **视图函数**：`plan_progress_update`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `form-card`、`form-section` 组件
- **功能列表**：
  - ⏳ **进度更新操作**
    - 进度百分比更新（数值输入，范围0-100）
    - 进度说明录入（文本域，必填）
    - 进度更新时间（自动记录）
    - 进度更新人（自动记录）
  - ⏳ **进度里程碑设置**
    - 进度里程碑设置（设置进度里程碑）
    - 里程碑名称（必填，最大长度100字符）
    - 里程碑进度（必填，数值输入，范围0-100）
    - 里程碑时间（必填，日期时间选择器）
    - 里程碑完成确认（确认里程碑完成）
  - ⏳ **进度预警**
    - 进度滞后预警（目标进度滞后预警）
    - 进度异常预警（进度异常预警）
    - 预警规则设置（设置预警阈值）
    - 预警通知（自动发送预警通知）
  - ⏳ **进度统计**
    - 进度统计（统计计划进度）
    - 进度趋势分析（分析进度变化趋势）
    - 进度预测（预测计划完成时间）

##### ⚠️ 问题管理
- **实现状态**：✅ 已完成
- **URL路由**：`plan_pages:plan_issue_list` - `/plan/plans/<id>/issues/`
- **页面模板**：`templates/plan_management/plan_issue_list.html`
- **视图函数**：`plan_issue_list`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `list-page-container` 布局
- **功能列表**：
  - ⏳ **问题记录创建**
    - 问题类型（必填，下拉选择：资源问题、时间问题、质量问题、其他问题）
    - 问题描述（必填，文本域，最大长度1000字符）
    - 问题影响（可选，文本域）
    - 问题级别（必填，下拉选择：一般、重要、紧急）
    - 问题负责人（必填，下拉选择用户）
  - ⏳ **问题处理**
    - 问题处理措施（文本域，记录处理措施）
    - 处理结果（文本域，记录处理结果）
    - 处理时间（自动记录）
    - 处理人（自动记录）
  - ⏳ **问题跟踪**
    - 问题跟踪（跟踪问题处理情况）
    - 问题状态更新（更新问题状态：待处理、处理中、已解决、已关闭）
    - 问题处理进度（显示问题处理进度）
  - ⏳ **问题列表**
    - 问题列表（分页，每页20条）
    - 问题详情（显示问题详细信息）
    - 问题搜索（支持按类型、级别、负责人搜索）
  - ⏳ **问题统计**
    - 问题数量统计（统计问题数量）
    - 问题类型统计（统计问题类型分布）
    - 问题处理效率统计（统计问题处理效率）

##### ✅ 计划完成情况
- **实现状态**：✅ 已完成
- **URL路由**：`plan_pages:plan_complete` - `/plan/plans/<id>/complete/`
- **页面模板**：`templates/plan_management/plan_complete.html`
- **视图函数**：`plan_complete`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `form-card`、`form-section` 组件
- **功能列表**：
  - ⏳ **计划完成标记**
    - 计划完成确认（确认计划已完成）
    - 完成时间记录（自动记录）
    - 完成人记录（自动记录）
  - ⏳ **完成情况总结**
    - 完成情况总结（文本域，必填，最大长度2000字符）
    - 完成成果（文本域，可选）
    - 完成经验（文本域，可选）
  - ⏳ **完成质量评估**
    - 完成质量评估（评估计划完成质量）
    - 质量评分（数值输入，范围0-100）
    - 质量评价（文本域，可选）
  - ⏳ **计划状态更新**
    - 计划状态更新（执行中 → 已完成）
    - 目标进度更新（关联战略目标进度自动更新）
    - 目标达成评估（目标达成评估、目标贡献度计算）

#### 📈 计划分析分组

##### 📊 完成分析
- **实现状态**：✅ 已完成
- **URL路由**：`plan_pages:plan_completion_analysis` - `/plan/analysis/completion/`
- **页面模板**：`templates/plan_management/plan_completion_analysis.html`
- **视图函数**：`plan_completion_analysis`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `info-card`、`info-grid` 组件，图表展示
- **功能列表**：
  - ⏳ **计划完成率分析**
    - 个人计划完成率（统计个人计划完成率）
    - 部门计划完成率（统计部门计划完成率）
    - 公司计划完成率（统计公司计划完成率）
    - 计划类型完成率（统计各类型计划完成率）
    - 完成率图表（可视化展示完成率）
  - ⏳ **计划完成时间分析**
    - 计划完成时间分析（分析计划完成时间）
    - 及时完成率（统计及时完成率）
    - 完成时间分布（分析完成时间分布）
  - ⏳ **计划完成质量分析**
    - 计划完成质量分析（分析计划完成质量）
    - 质量评分分布（分析质量评分分布）
    - 质量趋势分析（分析质量变化趋势）
  - ⏳ **计划完成趋势分析**
    - 计划完成趋势（分析计划完成趋势）
    - 完成率变化趋势（分析完成率变化趋势）
    - 趋势图表（可视化展示趋势）

##### 🎯 目标达成
- **实现状态**：✅ 已完成
- **URL路由**：`plan_pages:plan_goal_achievement` - `/plan/analysis/goal-achievement/`
- **页面模板**：`templates/plan_management/plan_goal_achievement.html`
- **视图函数**：`plan_goal_achievement`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `info-card`、`info-grid` 组件，图表展示
- **功能列表**：
  - ⏳ **目标达成率分析**
    - 战略目标达成率（统计战略目标达成率）
    - 目标达成情况（分析目标达成情况）
    - 达成率图表（可视化展示达成率）
  - ⏳ **计划对目标贡献度分析**
    - 计划对战略目标的贡献度分析（分析计划对战略目标的贡献度）
    - 贡献度排名（排名计划贡献度）
    - 贡献度图表（可视化展示贡献度）
  - ⏳ **目标对齐度分析**
    - 计划目标与战略目标的对齐度分析（分析对齐度）
    - 对齐度分布（分析对齐度分布）
    - 对齐度趋势（分析对齐度变化趋势）
  - ⏳ **目标达成趋势分析**
    - 目标达成趋势（分析目标达成趋势）
    - 达成率变化趋势（分析达成率变化趋势）
    - 趋势图表（可视化展示趋势）
  - ⏳ **目标达成报告**
    - 目标达成报告生成（自动生成目标达成报告）
    - 目标达成分析报告（生成目标达成分析报告）
    - 报告导出（支持Excel、PDF格式导出）

##### 📈 计划统计
- **实现状态**：✅ 已完成
- **URL路由**：`plan_pages:plan_statistics` - `/plan/analysis/statistics/`
- **页面模板**：`templates/plan_management/plan_statistics.html`
- **视图函数**：`plan_statistics`
- **样式文件**：`{% static 'css/common.css' %}`
- **页面布局**：使用 `info-card`、`info-grid` 组件，图表展示
- **功能列表**：
  - ⏳ **计划数量统计**
    - 总计划数（统计总计划数）
    - 各状态计划数（统计各状态计划数）
    - 各类型计划数（统计各类型计划数）
    - 数量统计图表（可视化展示数量统计）
  - ⏳ **计划完成率统计**
    - 个人计划完成率（统计个人计划完成率）
    - 部门计划完成率（统计部门计划完成率）
    - 公司计划完成率（统计公司计划完成率）
    - 计划类型完成率（统计各类型计划完成率）
  - ⏳ **计划执行效率统计**
    - 计划执行效率（统计计划执行效率）
    - 及时完成率（统计及时完成率）
    - 效率趋势分析（分析效率变化趋势）
  - ⏳ **计划与目标关联统计**
    - 关联战略目标的计划数量（统计关联战略目标的计划数量）
    - 目标对齐度统计（统计目标对齐度）
    - 关联度分析（分析计划与目标的关联度）
  - ⏳ **计划贡献度统计**
    - 计划对战略目标的贡献度统计（统计计划贡献度）
    - 贡献度排名（排名计划贡献度）
    - 贡献度趋势（分析贡献度变化趋势）
  - ⏳ **计划趋势分析**
    - 计划趋势分析（分析计划变化趋势）
    - 计划变化趋势（分析计划变化趋势）
    - 趋势图表（可视化展示趋势）

### 12. 档案管理模块左侧菜单
```
📁 档案管理（首页=档案列表）
├── 📄 项目档案
│   ├── ➕ 文档上传
│   ├── 📁 项目归档
│   ├── 📐 图纸归档
│   ├── 📦 交付归档
│   └── 🔍 项目档案查询
├── 📋 行政档案
│   ├── 档案分类
│   ├── 档案归档
│   ├── 档案借阅
│   ├── 档案归还
│   └── 档案销毁
├── 🗂️ 档案分类
│   ├── 分类管理
│   └── 分类规则
├── 📚 档案库管理
│   ├── 库房管理
│   ├── 位置管理
│   ├── 档案上架
│   └── 档案盘点
├── 🔐 档案安全
│   ├── 权限管理
│   ├── 访问控制
│   ├── 操作日志
│   └── 安全审计
├── 🔍 档案检索
│   ├── 全文检索
│   ├── 高级检索
│   └── 检索历史
├── 💾 档案数字化
│   ├── 数字化申请
│   ├── 数字化处理
│   └── 数字化成果
└── 📊 档案统计
    ├── 档案统计
    ├── 利用统计
    └── 保管统计
```

### 13. 资源管理模块左侧菜单
```
📁 资源管理（首页=资源列表）
├── 📏 资源标准
│   ├── ➕ 标准创建
│   ├── 📋 标准管理
│   └── 🔄 版本管理
├── 📚 资源库
│   ├── ➕ 资源上传
│   ├── 🗂️ 资源分类
│   ├── 🏷️ 标签管理
│   └── 🔍 资源检索
├── 👥 资源使用
│   ├── 使用申请
│   ├── 使用审批
│   └── 使用记录
├── 🔐 资源权限
│   ├── 权限管理
│   └── 访问控制
├── 💰 综合单价库
│   ├── ➕ 单价创建
│   ├── 📋 单价管理
│   └── 📝 单价申请处理
└── 📊 资源统计
    ├── 使用统计
    ├── 价值统计
    └── 趋势分析
```

### 14. 风险管理模块左侧菜单
```
📁 风险管理（首页=风险列表）
├── 🔍 风险识别
│   ├── ➕ 风险登记
│   ├── 📋 风险列表
│   └── 🏷️ 风险分类
├── 📊 风险评估
│   ├── 风险分析
│   ├── 风险等级
│   └── 风险矩阵
├── 🛡️ 风险应对
│   ├── ➕ 应对措施
│   ├── 📝 应对计划
│   └── 🔄 应对跟踪
├── ⚠️ 风险预警
│   ├── 预警规则
│   ├── 预警管理
│   └── 预警通知
├── 📈 风险监控
│   ├── 监控看板
│   ├── 监控报告
│   └── 监控统计
└── 📋 风险报告
    ├── 报告生成
    ├── 报告查看
    └── 报告导出
```

### 15. 诉讼管理模块左侧菜单
```
📁 诉讼管理（首页=诉讼案件列表）
├── 📋 案件管理
│   ├── ➕ 案件登记
│   ├── 📝 案件信息
│   └── 🏷️ 案件分类
├── ⚖️ 诉讼流程
│   ├── 立案管理
│   ├── 庭审管理
│   ├── 判决管理
│   └── 执行管理
├── 📄 诉讼文档
│   ├── 文档管理
│   ├── 证据管理
│   └── 文书管理
├── 💰 费用管理
│   ├── 费用登记
│   ├── 费用统计
│   └── 费用报销
├── 👥 人员管理
│   ├── 律师管理
│   ├── 法官管理
│   └── 当事人管理
├── 📅 时间管理
│   ├── 时间节点
│   ├── 提醒设置
│   └── 日历视图
└── 📊 案件统计
    ├── 案件统计
    ├── 费用统计
    └── 结果统计
```

### 16. 报表管理模块左侧菜单
```
📁 报表管理（首页=报表列表）
├── 📊 报表分类
│   ├── 分类管理
│   └── 分类规则
├── 📋 报表管理
│   ├── ➕ 报表创建
│   ├── 📝 报表配置
│   └── 🔄 报表更新
├── 👁️ 报表查看
│   ├── 报表预览
│   ├── 参数设置
│   └── 报表打印
├── 📥 报表导出
│   ├── Excel导出
│   ├── PDF导出
│   └── Word导出
├── ⭐ 报表收藏
│   ├── 收藏管理
│   └── 常用报表
├── 🔗 报表分享
│   ├── 分享管理
│   └── 分享记录
├── 📈 报表分析
│   ├── 使用统计
│   ├── 数据分析
│   └── 趋势分析
└── 📑 模块报表（按功能模块分类）
    ├── 👥 客户管理报表
    ├── 💼 商机管理报表
    ├── 🏗️ 生产管理报表
    ├── 📦 收发管理报表
    ├── 💰 结算管理报表
    ├── 💵 回款管理报表
    ├── 📊 产值管理报表
    ├── 👤 人事管理报表
    ├── 🏢 行政管理报表
    ├── 💳 财务管理报表
    ├── 📅 计划管理报表
    ├── 📚 档案管理报表
    ├── 🛠️ 资源管理报表
    ├── ⚠️ 风险管理报表
    └── 📋 综合报表
```

**菜单说明**：
- **报表列表**：首页，展示所有报表，支持按模块、分类、类型筛选
- **模块报表**：按功能模块分类展示报表，快速访问各模块的报表
- **报表收藏**：个人收藏的常用报表，快速访问
- **报表分析**：报表使用统计和数据分析，集成在报表列表页面中

### 17. 标准管理模块左侧菜单
```
📁 标准管理（首页=标准列表）
└── 📋 审图标准
    └── ➕ 标准上传
```

### 18. 系统管理模块左侧菜单
```
📁 系统管理（首页=系统设置）
├── ⚙️ 系统设置（后台管理）
│   ├── 👥 用户管理
│   ├── 🎭 角色管理
│   ├── 🔐 权限管理
│   ├── 🏢 部门管理
│   ├── 💼 岗位管理
│   ├── ⚙️ 系统配置
│   │   ├── 系统参数
│   │   ├── 数据字典
│   │   └── 操作日志
│   └── 🔄 审批流程配置
│       ├── 流程模板
│       ├── 审批节点
│       └── 业务节点配置
└── 👤 个人设置
    ├── 个人资料
    ├── 账号设置
    └── 密码修改
```

---

## 📊 功能模块详细列表

### 1. 客户管理
- **状态**：✅ 已完成（核心功能）
- **完成度**：85%
- **最后更新**：2025-01-30
- **实现说明**：核心功能已完成，客户信息管理、审批流程已实现；客户线索管理、客户关系管理、拜访管理等功能的页面模板已创建，但视图函数和URL路由待实现

**模块定位**：
客户管理模块是CRM系统的核心模块，负责管理客户全生命周期，从线索获取、客户创建到客户维护的全流程管理。模块与商机管理（含立项）、生产管理等模块紧密关联，形成完整的业务闭环。

**业务价值**：
1. **客户信息统一管理**：集中管理客户基础信息、企业信息、法律风险信息等，为业务决策提供数据支撑
2. **客户分级管理**：通过自动评分和分级，实现客户的精细化管理和资源优化配置
3. **客户关系维护**：通过拜访管理、跟进记录等功能，提升客户服务质量
4. **数据统计分析**：提供客户多维度统计分析，支持经营决策

**与其他模块的关联**：
- **商机管理**：客户关联商机，商机转化为项目后关联客户
- **生产管理**：项目与客户关联

**代码文件位置**：
- 模型定义：`backend/apps/customer_success/models.py`
- 页面视图：`backend/apps/customer_success/views_pages.py`
- REST API视图：`backend/apps/customer_success/views.py`
- URL路由：`backend/apps/customer_success/urls_pages.py`、`backend/apps/customer_success/urls.py`
- 页面模板：`backend/templates/customer_success/`
- 表单定义：`backend/apps/customer_success/forms.py`
- 服务层：`backend/apps/customer_success/services/`

**技术实现细节**：
- ✅ 启信宝API集成（企业信息查询、法律风险查询）
  - API端点：`/api/customer/search-company/` - 企业模糊搜索
  - API端点：`/api/customer/get-company-detail/` - 获取企业详细信息
  - API端点：`/api/customer/get-legal-risk/` - 获取企业法律风险信息
  - API端点：`/api/customer/verify-credit-code/` - 验证统一社会信用代码
- ✅ 客户评分和分级自动计算算法
  - 评分维度：合作历史（0-25分）、项目规模（0-20分）、付款信誉（0-15分）、战略价值（0-10分）
  - 分级规则：战略客户（≥80分）、核心客户（≥60分）、潜力客户（≥40分）、常规客户（≥20分）、培育客户（≥10分）、观察客户（<10分）
  - 自动计算：在客户保存时自动计算评分和分级（模型save方法）
- ✅ 审批流程引擎集成（工作流引擎）
  - 客户审批流程代码：`customer_management_approval`
  - 审批节点：部门经理审批 → 总经理审批
- ✅ 状态流转管理
  - 商机状态流转：模型方法 `get_valid_transitions()` 和 `transition_to()`
  - 状态流转日志自动记录
- ✅ 权限控制（基于权限码系统）
  - 权限码：`customer_success.manage` - 客户管理权限
  - 权限码：`customer_success.opportunity.view` - 商机查看权限
  - 权限码：`customer_success.opportunity.view_all` - 查看所有商机权限
  - 权限码：`customer_success.opportunity.create` - 商机创建权限
  - 权限码：`customer_success.opportunity.edit` - 商机编辑权限
  - 权限码：`customer_success.opportunity.delete` - 商机删除权限
- ✅ 关联关系检查（删除前检查）
  - 客户删除：检查关联的项目、商机、联系人
- ✅ 数据统计分析（聚合查询）
  - 使用 Django ORM 的 `aggregate()` 和 `annotate()` 方法
  - 统计维度：客户总数、活跃客户、VIP客户等

**已知问题和待优化**：
- ⚠️ 客户联系人管理功能暂未完全实现（模型已创建，视图函数待实现）
- ⚠️ 客户线索管理的视图函数和URL路由被注释，待实现
- ⚠️ 客户关系管理的视图函数和URL路由被注释，待实现
- ⚠️ 拜访管理的视图函数和URL路由被注释，待实现
- ✅ 已修复：`customer_edit` 和 `customer_delete` 函数中的缩进错误
- ✅ 已修复：重复导入问题

**后续计划**：
1. 实现客户联系人管理的完整功能（列表、创建、编辑、删除）
2. 实现客户线索管理的视图函数和URL路由
3. 实现客户关系管理的视图函数和URL路由
4. 实现拜访管理的视图函数和URL路由

**⚠️ 样式模板调用提示**：
- ✅ 所有模板必须调用 `{% static 'css/common.css' %}`
- ✅ 列表页面使用 `list-page-container` 布局和 `info-card` 组件
- ✅ 详情页面使用 `info-card`、`info-grid`、`info-item` 组件
- ✅ 表单页面使用 `form-card`、`form-section` 组件

**数据模型**：
- ✅ `Client` - 客户模型（`backend/apps/customer_success/models.py`）
- ✅ `ClientContact` - 客户联系人模型
- ✅ `ClientProject` - 客户项目关联模型

**API接口**（REST API）：
- ✅ `/api/customer/clients/` - 客户列表/创建/详情/编辑/删除（ViewSet）
- ✅ `/api/customer/clients/statistics/` - 客户统计信息
- ✅ `/api/customer/verify-credit-code/` - 验证统一社会信用代码
- ✅ `/api/customer/search-company/` - 企业模糊搜索（启信宝API集成）
- ✅ `/api/customer/get-company-detail/` - 获取企业详细信息（启信宝API集成）
- ✅ `/api/customer/get-legal-risk/` - 获取企业法律风险信息（启信宝API集成）
- ✅ `/api/customer/check-duplicate/` - 检查客户是否重复
- ✅ `/api/customer/find-by-phone/` - 根据电话查询关联客户

#### 1.1 客户信息管理
**实现状态**：✅ 已实现（2025-01-30）

**页面实现**：
- ✅ 客户列表页：`templates/customer_success/customer_list.html`
- ✅ 客户详情页：`templates/customer_success/customer_detail.html`
- ✅ 客户创建/编辑页：`templates/customer_success/customer_form.html`
- ✅ 客户删除确认页：`templates/customer_success/customer_delete.html`
- ✅ 客户审批提交页：`templates/customer_success/customer_submit_approval.html`

**视图函数**：
- ✅ `customer_list` - 客户列表（支持搜索、筛选、分页）
- ✅ `customer_detail` - 客户详情（显示关联项目、商机、联系人）
- ✅ `customer_create` - 创建客户（重定向到客户列表，实际创建通过弹窗表单）
- ✅ `customer_edit` - 编辑客户
- ✅ `customer_delete` - 删除客户（需检查关联关系）
- ✅ `customer_submit_approval` - 提交客户审批

**URL路由**：
- ✅ `business_pages:customer_list` - `/business/customers/`
- ✅ `business_pages:customer_create` - `/business/customers/create/`
- ✅ `business_pages:customer_detail` - `/business/customers/<id>/`
- ✅ `business_pages:customer_edit` - `/business/customers/<id>/edit/`
- ✅ `business_pages:customer_delete` - `/business/customers/<id>/delete/`
- ✅ `business_pages:customer_submit_approval` - `/business/customers/<id>/submit-approval/`

**功能列表**：
- ✅ **客户列表**（✅ 已实现页面）
  - ✅ 客户列表展示（分页，每页10条，按创建时间倒序）
  - ✅ 客户筛选（客户等级、客户类型、信用等级、活跃状态）
  - ✅ 客户搜索（客户名称、统一信用代码，实时搜索）
  - ✅ 客户统计卡片（客户总数、活跃客户、VIP客户）
  - ✅ 表格列：客户名称、统一信用代码、客户等级、客户类型、信用等级、状态、创建时间、操作
  - ✅ 操作按钮：查看、编辑（需权限）
  - ✅ 创建客户按钮（权限控制，使用弹窗表单）
- ✅ **客户创建**（✅ 已实现弹窗表单）
  - ✅ 基本信息录入（客户名称、统一信用代码）
  - ✅ 启信宝API集成（输入客户名称后自动搜索并填充企业信息）
    - ✅ 企业搜索API（`/api/customer/search-company/`）
    - ✅ 企业详情API（`/api/customer/get-company-detail/`）
    - ✅ 法律风险API（`/api/customer/get-legal-risk/`）
    - ✅ 自动填充字段：法定代表人、成立日期、注册资本（万元）、联系电话、邮箱、地址
  - ✅ 法律风险信息自动获取
    - ✅ 司法案件数量
    - ✅ 被执行人数量
    - ✅ 终本案件数量
    - ✅ 限制高消费数量
    - ✅ 法律风险等级（自动计算：低风险/中低风险/中风险/中高风险/高风险/未知）
  - ✅ 客户分类设置（客户等级、客户分级、客户类型、信用等级）
  - ✅ 联系信息录入（联系人、职务、电话）
  - ✅ 客户评分自动计算（0-100分，基于合作历史、项目规模、付款信誉、战略价值）
    - 合作历史（0-25分）：5个以上项目=25分，3-4个项目=15分，1-2个项目=8分
    - 项目规模（0-20分）：1000万以上=20分，500-1000万=12分，100-500万=6分
    - 付款信誉（0-15分）：回款率≥95%=15分，≥80%=10分，≥60%=5分
    - 战略价值（0-10分）：政府单位或VIP客户=10分，重要客户=6分，一般客户=3分
  - ✅ 客户分级自动计算（战略/核心/潜力/常规/培育/观察）
    - 战略客户：评分≥80分
    - 核心客户：评分≥60分
    - 潜力客户：评分≥40分
    - 常规客户：评分≥20分
    - 培育客户：评分≥10分
    - 观察客户：评分<10分
  - ✅ 重复检查（客户名称、统一信用代码，API：`/api/customer/check-duplicate/`）
  - ✅ 电话关联检查（API：`/api/customer/find-by-phone/`）
- ✅ **客户详情查看**（✅ 已实现页面）
  - ✅ 基本信息展示（客户名称、统一信用代码，使用info-card样式）
  - ✅ 企业信息展示（从启信宝获取：法定代表人、成立日期、注册资本、联系电话、邮箱、地址）
  - ✅ 法律风险信息展示（风险等级、司法案件数量、被执行人数量、终本案件数量、限制高消费数量）
  - ✅ 客户分类信息展示（客户等级、客户分级、客户类型、信用等级、所属行业、所属区域、客户来源）
  - ✅ 财务信息展示（客户评分、健康度评分）
  - ✅ 关联项目列表（显示最近10个项目，包含项目编号、项目名称、服务类型、项目经理）
  - ✅ 关联商机列表（显示最近10个商机，包含商机编号、商机名称、负责商务、商机状态）
  - ✅ 关联联系人列表（显示最近10个联系人，主要联系人优先显示）
  - ✅ 审批信息展示（审批状态、审批记录、审批历史）
  - ✅ 操作按钮（编辑、删除、提交审批，权限控制）
- ✅ **客户编辑**（✅ 已实现页面）
  - ✅ 基本信息编辑（客户名称、统一信用代码）
  - ✅ 企业信息编辑（法定代表人、成立日期、注册资本、联系电话、邮箱、地址）
  - ✅ 法律风险信息编辑（司法案件数量、被执行人数量、终本案件数量、限制高消费数量、法律风险等级）
  - ✅ 分类信息编辑（客户等级、客户分级、客户类型、信用等级、所属行业、所属区域、客户来源）
  - ✅ 联系信息编辑（联系人、职务、电话）
  - ✅ 状态信息编辑（是否活跃）
  - ✅ 客户描述编辑
  - ✅ 权限控制（需 `customer_success.manage` 权限）
- ✅ **客户删除**（✅ 已实现页面）
  - ✅ 客户删除（需检查关联关系：项目、商机、联系人）
  - ✅ 关联关系检查（显示关联数量，如有关联则阻止删除）
  - ✅ 权限控制（需 `customer_success.manage` 权限）
  - ✅ 删除确认页面（显示关联信息）
- ✅ **客户审批流程**（✅ 已实现）
  - ✅ 提交审批（与审批流程引擎集成，流程代码：`customer_management_approval`）
  - ✅ 审批状态跟踪（显示当前审批状态、审批进度）
  - ✅ 审批历史查看（显示所有审批记录：审批人、审批层级、审批结果、审批意见、审批时间）
  - ✅ 审批节点：部门经理审批 → 总经理审批
  - ✅ 权限控制（需 `customer_success.manage` 权限）

#### 1.2 客户线索
**实现状态**：⏳ 部分实现（页面模板已创建，视图函数待实现）

**功能说明**：客户线索管理包括线索列表、线索池和客户公海三个部分，实现从线索获取到客户转化的全流程管理。

**数据模型**：
- ✅ `CustomerLead` - 客户线索模型
- ✅ `LeadFollowUp` - 客户线索跟进记录模型

##### 1.2.1 线索列表
**实现状态**：⏳ 部分实现（页面模板已创建，视图函数待实现）

**页面模板**（已创建但未实现视图函数）：
- ✅ `templates/customer_success/customer_lead_list.html`
- ✅ `templates/customer_success/customer_lead_detail.html`
- ✅ `templates/customer_success/customer_lead_form.html`
- ✅ `templates/customer_success/customer_lead_delete.html`
- ✅ `templates/customer_success/customer_lead_claim.html`
- ✅ `templates/customer_success/customer_lead_followup_form.html`

**URL路由**（已定义但被注释，待实现视图函数）：
- ⏳ `business_pages:customer_lead_list` - `/business/customer-leads/`
- ⏳ `business_pages:customer_lead_create` - `/business/customer-leads/create/`
- ⏳ `business_pages:customer_lead_detail` - `/business/customer-leads/<id>/`
- ⏳ `business_pages:customer_lead_edit` - `/business/customer-leads/<id>/edit/`
- ⏳ `business_pages:customer_lead_delete` - `/business/customer-leads/<id>/delete/`
- ⏳ `business_pages:customer_lead_claim` - `/business/customer-leads/<id>/claim/`

**功能列表**：
- ✅ **线索列表**
  - 线索列表展示（分页）
  - 统计卡片（总数、未处理、已转化、转化率、今日新增、本周新增）
  - 多字段搜索（公司名称、联系人、电话）
  - 自定义显示列（支持拖动排序、显示/隐藏，本地存储）
  - 自定义筛选字段（支持启用/禁用、拖动排序，本地存储）
  - 表格列排序（联系人、公司名称、实际跟进时间、未跟进天数）
  - 筛选功能（跟进状态、线索来源、负责人、创建时间）
  - 批量操作（分配、删除、更新状态、转化）
  - 数据导出（CSV、XLSX）
- ✅ **线索创建**
  - 线索基本信息录入（公司名称、联系人、电话、线索来源）
  - 统一社会信用代码录入（可选）
  - 启信宝API集成（输入公司名称后自动填充）
    - 统一社会信用代码
    - 企业详细信息（法定代表人、成立日期、注册资本、联系电话、邮箱、地址）
    - 法律风险信息（司法案件数量、被执行人数量、终本案件数量、限制高消费数量、法律风险等级）
  - 客户分类信息设置（客户分级、客户类型）
  - 自动转化为客户功能（输入统一社会信用代码后自动创建客户）
- ✅ **线索详情查看**
  - 基本信息展示
  - 企业信息展示（从启信宝获取）
  - 法律风险信息展示
  - 客户分类信息展示
  - 跟进记录列表（按时间倒序）
  - 快速操作按钮（认领、编辑、添加跟进、转化为客户）
- ✅ **线索编辑**
  - 基本信息编辑
  - 企业信息编辑
  - 分类信息编辑
- ✅ **线索删除**
  - 线索删除（需检查关联关系）
- ✅ **线索认领**
  - 未分配线索认领
  - 更新负责人
- ✅ **线索批量操作**
  - 批量分配负责人
  - 批量删除
  - 批量更新状态
  - 批量转化为客户
- ✅ **线索统计**
  - 统计卡片（总数、未处理、已转化、转化率、今日新增、本周新增）
  - 跟进状态分布图表（Chart.js）
  - 线索来源分布图表（Chart.js）
  - 负责人分布统计

##### 1.2.2 线索池
**实现状态**：⏳ 部分实现（页面模板已创建，视图函数待实现）

**页面模板**（已创建但未实现视图函数）：
- ✅ `templates/customer_success/customer_lead_pool.html`

**URL路由**（已定义但被注释，待实现视图函数）：
- ⏳ `business_pages:customer_lead_pool` - `/business/customer-lead-pool/`

**功能列表**：
- ✅ **线索池列表**
  - 未分配线索列表（responsible_user为空）
  - 线索认领功能
  - 线索筛选（线索来源、跟进状态、创建时间）
  - 线索搜索（公司名称、联系人、电话）
  - 批量认领

##### 1.2.3 客户公海
**实现状态**：⏳ 部分实现（页面模板已创建，视图函数待实现）

**页面模板**（已创建但未实现视图函数）：
- ✅ `templates/customer_success/customer_public_sea.html`
- ✅ `templates/customer_success/customer_public_sea_claim.html`

**URL路由**（已定义但被注释，待实现视图函数）：
- ⏳ `business_pages:customer_public_sea` - `/business/customer-public-sea/`
- ⏳ `business_pages:customer_public_sea_claim` - `/business/customer-public-sea/<id>/claim/`

**功能列表**：
- ✅ **客户公海列表**
  - 公海客户列表（未分配或已释放的客户）
  - 客户筛选
  - 客户搜索
- ✅ **客户认领**
  - 客户认领功能
  - 更新负责人

#### 1.3 客户人员
**实现状态**：⏳ 待实现（数据模型已创建，视图函数和页面待实现）

**功能说明**：客户人员管理包括人员列表和人员变更两个部分，实现客户联系人信息的统一管理和变更记录。

##### 1.3.1 人员列表
**实现状态**：⏳ 待实现（数据模型已创建，视图函数和页面待实现）

**数据模型**：
- ✅ `ClientContact` - 客户联系人模型（已实现）
  - 关联客户
  - 联系人信息（姓名、职位、部门、手机、电话、邮箱、微信）
  - 主要联系人标记
  - 备注信息

**URL路由**（已定义但被注释，待实现视图函数）：
- ⏳ `business_pages:contact_management` - `/business/contacts/`
- ⏳ `business_pages:contact_create` - `/business/contacts/create/`
- ⏳ `business_pages:contact_detail` - `/business/contacts/<id>/`
- ⏳ `business_pages:contact_edit` - `/business/contacts/<id>/edit/`
- ⏳ `business_pages:contact_delete` - `/business/contacts/<id>/delete/`
- ⏳ `business_pages:contact_set_primary` - `/business/contacts/<id>/set-primary/`

**功能列表**：
- ⏳ **人员列表**（待实现）
  - ⏳ 人员列表展示（分页，按客户分组或全局列表）
  - ⏳ 客户筛选（按客户筛选联系人）
  - ⏳ 人员搜索（姓名、职位、电话、邮箱）
  - ⏳ 主要联系人标记（主要联系人优先显示）
  - ⏳ 联系人创建（在客户详情页创建，独立创建页待实现）
  - ⏳ 联系人详情查看（显示联系人详细信息）
  - ⏳ 联系人编辑（独立编辑页待实现）
  - ⏳ 联系人删除（独立删除功能待实现）
  - ⏳ 主要联系人设置（设置为主要联系人功能待实现）

##### 1.3.2 人员变更
**实现状态**：⏳ 待实现

**功能列表**：
- ⏳ **人员变更记录**（待实现）
  - ⏳ 变更记录列表（显示联系人信息变更历史）
  - ⏳ 变更类型（新增、修改、离职、转岗等）
  - ⏳ 变更内容记录（变更前后对比）
  - ⏳ 变更时间记录
  - ⏳ 变更操作人记录

#### 1.4 客户关系
**实现状态**：✅ 部分实现（部分功能已实现，部分功能待实现）

**功能说明**：客户关系管理包括关系列表、拜访计划、拜访签到与跟进记录、客户关系升级四个部分，实现客户关系维护的全流程管理。

##### 1.4.1 关系列表
**实现状态**：⏳ 部分实现（页面模板已创建，视图函数待实现）

**页面模板**（已创建但未实现视图函数）：
- ✅ `templates/customer_success/customer_relationship.html`
- ✅ `templates/customer_success/customer_relationship_detail.html`
- ✅ `templates/customer_success/customer_relationship_form.html`

**数据模型**：
- ✅ `CustomerRelationship` - 客户关系记录模型

**URL路由**（已定义但被注释，待实现视图函数）：
- ⏳ `business_pages:customer_relationship` - `/business/customer-relationship/`
- ⏳ `business_pages:customer_relationship_create` - `/business/customer-relationship/create/`
- ⏳ `business_pages:customer_relationship_detail` - `/business/customer-relationship/<id>/`
- ⏳ `business_pages:customer_relationship_edit` - `/business/customer-relationship/<id>/edit/`

**功能列表**：
- ✅ **关系列表**
  - 关系记录列表（按关系日期倒序）
  - 关系类型筛选（客户拜访、电话沟通、会议、邮件沟通、微信沟通、其他）
  - 客户筛选
  - 关联商机筛选
- ✅ **关系创建**
  - 关联客户选择
  - 关系类型选择
  - 关系标题录入
  - 关系内容录入
  - 关系日期设置
  - 地点录入
  - 参与人员录入
  - 下一步行动录入
  - 下次行动日期设置
  - 关联商机选择（可选）
- ✅ **关系详情查看**
  - 关系信息展示
  - 关联客户信息
  - 关联商机信息
- ✅ **关系编辑**
  - 关系信息编辑
  - 关联信息编辑

##### 1.4.2 拜访计划
**实现状态**：⏳ 部分实现（数据模型已创建，页面模板和视图函数待实现）

**数据模型**：
- ✅ `VisitPlan` - 拜访计划模型（已实现）

**URL路由**（已定义但被注释，待实现视图函数）：
- ⏳ `business_pages:visit_plan` - `/business/visit-plan/`
- ⏳ `business_pages:visit_plan_create` - `/business/visit-plan/create/`
- ⏳ `business_pages:visit_plan_detail` - `/business/visit-plan/<id>/`
- ⏳ `business_pages:visit_plan_edit` - `/business/visit-plan/<id>/edit/`
- ⏳ `business_pages:visit_plan_complete` - `/business/visit-plan/<id>/complete/`

**功能列表**：
- ✅ **拜访计划列表**
  - 计划列表展示（按计划日期排序）
  - 计划状态筛选（已计划、进行中、已完成、已取消）
  - 客户筛选
  - 关联商机筛选
- ✅ **拜访计划创建**
  - 关联客户选择
  - 计划日期设置
  - 计划标题录入
  - 拜访目的录入
  - 拜访地点录入
  - 参与人员录入
  - 关联商机选择（可选）
- ✅ **拜访计划详情查看**
  - 计划信息展示
  - 关联客户信息
  - 关联商机信息
  - 签到记录列表
- ✅ **拜访计划编辑**
  - 计划信息编辑
- ✅ **拜访计划完成**
  - 标记计划完成
  - 更新计划状态

##### 1.4.3 拜访签到与跟进记录
**实现状态**：✅ 部分实现（客户跟进记录已实现，拜访签到和线索跟进记录待实现）

**数据模型**：
- ✅ `VisitCheckin` - 拜访签到模型（已实现）
- ✅ `OpportunityFollowUp` - 商机跟进记录模型（已实现）
- ✅ `LeadFollowUp` - 客户线索跟进记录模型（已实现）

**已实现的视图函数**：
- ✅ `opportunity_followup_create` - 创建商机跟进记录（✅ 已实现）

**页面实现**：
- ✅ 商机跟进记录创建页：`templates/customer_success/opportunity_followup_form.html`

**URL路由**（部分已定义但被注释，待实现视图函数）：
- ✅ `business_pages:opportunity_followup_create` - `/business/opportunities/<id>/followup/create/`
- ⏳ `business_pages:visit_checkin` - `/business/visit-checkin/`
- ⏳ `business_pages:visit_checkin_create` - `/business/visit-checkin/create/`
- ⏳ `business_pages:visit_checkin_detail` - `/business/visit-checkin/<id>/`
- ⏳ 客户跟进记录相关路由（待实现）
- ⏳ 线索跟进记录相关路由（待实现，URL已被注释）

**功能列表**：

**拜访签到功能**：
- ✅ **拜访签到列表**
  - 签到记录列表（按签到时间倒序）
  - 客户筛选
  - 签到人筛选
- ✅ **拜访签到创建**
  - 关联拜访计划选择（可选）
  - 关联客户选择
  - 签到时间设置（自动获取当前时间）
  - 签到地点录入（支持GPS定位）
  - 经纬度记录（可选）
  - 备注录入
- ✅ **拜访签到详情查看**
  - 签到信息展示
  - 关联客户信息
  - 关联拜访计划信息
  - 地图位置展示（如有经纬度）

**跟进记录功能**：
- ✅ **客户跟进记录创建**（✅ 部分实现）
  - ✅ 关联商机跟进记录创建（已实现）
  - ✅ 关联商机选择（自动关联当前商机）
  - ✅ 跟进时间设置（默认当天）
  - ✅ 跟进方式选择（电话沟通、上门拜访、线上会议、邮件沟通、其他）
  - ✅ 参与人员录入
  - ✅ 跟进内容录入（必填）
  - ✅ 客户反馈录入
  - ✅ 下一步计划录入
  - ✅ 预计下次跟进时间设置
  - ✅ 权限控制（需有查看权限）
  - ⏳ 关联客户跟进记录创建（待实现）
- ✅ **跟进记录列表**（✅ 部分实现）
  - ✅ 商机跟进记录列表（在商机详情页显示最近10条跟进记录，按跟进时间倒序排列）
  - ⏳ 客户跟进记录列表（待实现）
  - ⏳ 线索跟进记录列表（待实现）
- ⏳ **线索跟进记录创建**（待实现）
  - ⏳ 关联线索选择
  - ⏳ 跟进时间设置
  - ⏳ 跟进方式选择
  - ⏳ 跟进内容录入
- ⏳ **跟进记录编辑**（待实现）
  - ⏳ 跟进信息编辑（仅创建人或管理员可编辑）
- ⏳ **跟进记录删除**（待实现）
  - ⏳ 跟进记录删除（仅创建人或管理员可删除）

##### 1.4.4 客户关系升级
**实现状态**：⏳ 待实现

**功能说明**：客户关系升级是指客户对接人、推动人或决策人的关系等级管理，用于跟踪和提升与关键联系人的关系深度。

**数据模型**（待创建）：
- ⏳ `CustomerRelationshipLevel` - 客户关系等级模型（待实现）

**URL路由**（待实现）：
- ⏳ `business_pages:customer_relationship_level` - `/business/customer-relationship-level/`
- ⏳ `business_pages:customer_relationship_level_create` - `/business/customer-relationship-level/create/`
- ⏳ `business_pages:customer_relationship_level_detail` - `/business/customer-relationship-level/<id>/`
- ⏳ `business_pages:customer_relationship_level_edit` - `/business/customer-relationship-level/<id>/edit/`
- ⏳ `business_pages:customer_relationship_level_upgrade` - `/business/customer-relationship-level/<id>/upgrade/`

**关系等级定义**：
- **初步沟通**：初次接触，建立基本联系
- **需求沟通**：了解客户需求，进行初步需求分析
- **认可**：客户对产品或服务表示认可
- **认同**：客户对方案或公司表示认同，建立信任关系
- **外部合伙人**：客户成为外部合作伙伴，关系深度最高

**功能列表**：
- ⏳ **关系等级列表**
  - 关系等级记录列表（按更新时间倒序）
  - 客户筛选
  - 联系人角色筛选（对接人、推动人、决策人）
  - 关系等级筛选（初步沟通、需求沟通、认可、认同、外部合伙人）
  - 关联商机筛选
- ⏳ **关系等级创建**
  - 关联客户选择（必填）
  - 联系人信息录入（姓名、职位、联系方式）
  - 联系人角色选择（对接人、推动人、决策人）
  - 初始关系等级设置（默认：初步沟通）
  - 关系建立日期设置
  - 关联商机选择（可选）
  - 备注录入
- ⏳ **关系等级详情查看**
  - 关系等级信息展示
  - 联系人信息展示
  - 关联客户信息
  - 关联商机信息
  - 关系等级变更历史记录
- ⏳ **关系等级升级**
  - 当前关系等级显示
  - 目标关系等级选择（只能向更高等级升级）
  - 升级原因录入
  - 升级日期设置
  - 升级备注录入
  - 关系等级变更历史记录
- ⏳ **关系等级编辑**
  - 联系人信息编辑
  - 关联信息编辑
  - 备注编辑

---

### 2. 商机管理
- **状态**：✅ 已完成（核心功能）
- **完成度**：90%
- **说明**：核心功能已完成，基础管理页面已实现（列表、详情、创建、编辑、删除），状态流转和跟进记录管理已实现，快速报价工具、销售漏斗分析、销售预测、过程指标仪表盘、销售绩效报表和输单分析已实现
- **最后更新**：2025-01-30
- **实现说明**：已根据总体设计方案完成基础管理功能的页面实现，包括列表、详情、创建、编辑、删除、状态流转、跟进记录管理等核心功能。所有页面均正确调用样式模板（common.css），使用统一的布局和组件样式。报价管理功能已通过API实现，页面展示已优化。

**⚠️ 样式模板调用提示**：
- ✅ 所有模板必须调用 `{% static 'css/common.css' %}`
- ✅ 列表页面使用 `list-page-container` 布局和 `info-card` 组件
- ✅ 详情页面使用 `info-card`、`info-grid`、`info-item` 组件
- ✅ 表单页面使用 `form-card`、`form-section` 组件

#### 2.1 商机基础管理
**实现状态**：✅ 已实现（2025-01-30）
**页面实现**：
- ✅ 商机列表页：`templates/customer_success/opportunity_list.html`
- ✅ 商机详情页：`templates/customer_success/opportunity_detail.html`
- ✅ 商机创建/编辑页：`templates/customer_success/opportunity_form.html`
- ✅ 商机删除确认页：`templates/customer_success/opportunity_delete.html`
**视图函数**：
- ✅ `opportunity_management` - 商机列表
- ✅ `opportunity_detail` - 商机详情
- ✅ `opportunity_create` - 创建商机
- ✅ `opportunity_edit` - 编辑商机
- ✅ `opportunity_delete` - 删除商机
**URL路由**：
- ✅ `business_pages:opportunity_management` - `/business/opportunities/`
- ✅ `business_pages:opportunity_create` - `/business/opportunities/create/`
- ✅ `business_pages:opportunity_detail` - `/business/opportunities/<id>/`
- ✅ `business_pages:opportunity_edit` - `/business/opportunities/<id>/edit/`
- ✅ `business_pages:opportunity_delete` - `/business/opportunities/<id>/delete/`

**功能列表**：
- ✅ **商机列表**（✅ 已实现页面）
  - ✅ 商机列表展示（分页，每页10条）
  - ✅ 商机状态筛选（潜在客户、初步接触、需求确认、方案报价、商务谈判、赢单、输单、已取消）
  - ✅ 商机搜索（商机编号、商机名称、项目名称、客户名称）
  - ✅ 关联客户筛选
  - ✅ 负责商务筛选
  - ✅ 紧急程度筛选（普通、紧急、特急）
  - ✅ 标签页切换（全部、我负责的）
  - ✅ 统计卡片展示（总商机数、预计金额、加权金额、本月新增）
  - ✅ 批量操作（批量选择、批量删除）
  - ✅ 表格列：商机名称、商机编号、关联客户、负责商务、商机状态、预计金额、成功概率、加权金额、紧急程度、预计签约时间、创建时间、操作
  - ✅ 预计签约时间筛选（已实现日期范围筛选）
- ✅ **商机创建**（✅ 已实现页面）
  - ✅ 基本信息录入（商机名称、关联客户、负责商务、商机状态）
  - ✅ 项目信息录入（项目名称、项目地址、项目业态、建筑面积、图纸阶段）
  - ✅ 金额信息录入（预计金额，必填）
  - ✅ 成功概率设置（10%、30%、50%、70%、90%，必填）
  - ✅ 加权金额自动计算（预计金额 × 成功概率，JavaScript实时计算）
  - ✅ 时间信息设置（预计签约时间、紧急程度）
  - ✅ 商机描述录入
  - ✅ 商机编号自动生成（OPP-YYYY-NNNN，模型save方法实现）
  - ✅ 表单验证（前端HTML5验证 + 后端数据验证）
  - ✅ 错误提示（字段级错误信息展示）
- ✅ **商机详情查看**（✅ 已实现页面）
  - ✅ 基本信息展示（使用info-card样式，红色标题）
  - ✅ 项目信息展示（空值显示"未填写"）
  - ✅ 金额信息展示（预计金额、成功概率、加权金额，数字右对齐）
  - ✅ 状态信息展示（状态徽章、紧急程度徽章）
  - ✅ 审批信息展示（审批状态、审批人、审批时间、审批意见，已实现）
  - ✅ 赢单/输单信息展示（实际签约金额、合同编号、赢单原因/输单原因，已实现）
  - ✅ 健康度评分展示（API已实现，页面展示已实现）
  - ✅ 跟进记录列表（显示最近10条，支持空状态）
  - ✅ 报价记录列表（显示最近10条，支持空状态）
  - ✅ 关联客户信息（链接到客户详情页）
  - ✅ 操作按钮（编辑、删除、打印）
- ✅ **商机编辑**
  - 基本信息编辑
  - 项目信息编辑
  - 金额信息编辑
  - 时间信息编辑
  - 描述信息编辑
- ✅ **商机删除**
  - 商机删除（需检查关联关系）
- ✅ **商机状态流转**
  - 状态流转（潜在客户→初步接触→需求确认→方案报价→商务谈判→赢单/输单）
  - 状态流转记录
  - 状态流转权限控制

#### 2.2 商机跟进管理
**实现状态**：✅ 部分实现（2025-01-30）
**功能列表**：
- ✅ **跟进记录创建**（✅ 已实现页面）
  - ✅ 跟进时间设置
  - ✅ 跟进方式选择（电话沟通、上门拜访、线上会议、邮件沟通、其他）
  - ✅ 跟进内容录入
  - ✅ 客户反馈录入
  - ✅ 下一步计划录入
  - ✅ 预计下次跟进时间设置
  - **页面实现**：`templates/customer_success/opportunity_followup_form.html`
  - **视图函数**：`opportunity_followup_create`
  - **URL路由**：`business_pages:opportunity_followup_create`
- ⏳ **跟进记录编辑**（待实现）
  - ⏳ 跟进信息编辑（仅创建人或管理员可编辑）
- ⏳ **跟进记录删除**（待实现）
  - ⏳ 跟进记录删除（仅创建人或管理员可删除）
- ✅ **跟进记录列表**（✅ 已实现）
  - ✅ 跟进记录列表（按跟进时间倒序，在详情页显示最近10条）
  - ⏳ 跟进方式筛选（待实现独立筛选页面）
  - ⏳ 跟进时间筛选（待实现独立筛选页面）

#### 2.3 商机报价管理
**实现状态**：✅ 部分实现（API已实现，页面展示已优化）
**功能列表**：
- ⏳ **报价创建**（待实现页面）
  - ⏳ 报价基本信息录入
  - ⏳ 报价明细录入
  - ⏳ 报价金额计算
  - ⏳ 报价有效期设置
  - ⏳ 报价文件上传
  - ⏳ 报价模式选择（7种模式）
  - ⏳ 模式参数配置（JSON格式）
  - ⏳ 封顶费设置（可选）
  - **说明**：报价计算引擎已实现，页面创建功能待实现
- ⏳ **报价详情查看**（待实现页面）
  - ⏳ 报价信息展示
  - ⏳ 报价明细展示
  - ⏳ 报价文件下载
  - ⏳ 报价计算过程展示
  - **说明**：在商机详情页已显示报价记录列表，详情页面待实现
- ⏳ **报价编辑**（待实现页面）
  - ⏳ 报价信息编辑
  - ⏳ 报价明细编辑
  - ⏳ 报价模式修改
  - **说明**：报价编辑功能待实现
- ✅ **报价计算引擎**（✅ 已实现）
  - **7种报价模式支持**：
    1. **纯费率模式**：服务费 = 节省金额 × 费率（可选封顶费）
    2. **基本费+费率模式**：服务费 = 基本费 + (节省金额 × 费率)（可选封顶费）
    3. **包干价模式**：服务费 = 固定金额（可选封顶费）
    4. **分段累进模式**：按节省金额区间分段计算费率（可选封顶费）
    5. **最低节省+费率模式**：设定最低节省门槛，超过后按费率计费（可选封顶费）
    6. **绩效挂钩模式**：服务费 = 基础服务费 + 绩效奖金（可选封顶费）
    7. **混合计价模式**：组合使用多种计价方式（可选总封顶费）
  - 报价金额自动计算
  - 计算过程详细展示
  - 封顶费自动应用
- ✅ **报价版本管理**
  - 多版本报价（初稿/客户/最终）
  - 报价对比功能
  - 版本追溯
- ✅ **快速报价工具**（✅ 已实现）
  - ✅ 快速报价计算器（支持7种模式）
    - 报价模式选择界面
    - 模式参数动态配置
    - 实时计算服务费
    - 计算过程详细展示
    - 封顶费自动应用
  - ⏳ 报价模板管理（保存和复用，待实现）
  - ⏳ 历史报价对比（待实现）

#### 2.4 商机分析（部分完成）
**功能列表**：
- ✅ **商机仪表盘**（✅ 已实现）
  - ✅ 商机概览统计（总商机数、活跃商机数、加权金额、赢单数量）
  - ✅ 商机状态分布（各状态商机数量和金额统计）
  - ✅ 商机金额统计（预计金额、加权金额、实际签约金额）
  - ✅ 权限过滤（根据用户权限显示不同范围的数据）
- ✅ **销售漏斗分析**（✅ 已实现）
  - **API接口**：`opportunity_funnel_analysis_api`（✅ 已实现）
  - **页面视图**：`opportunity_funnel_analysis`（✅ 已实现）
  - **漏斗阶段**：
    - 潜在客户（10%）
    - 初步接触（30%）
    - 需求确认（50%）
    - 方案报价（70%）
    - 商务谈判（90%）
    - 赢单（100%）
  - **关键指标**：
    - ✅ 各阶段商机数量统计
    - ✅ 各阶段商机金额统计（预计金额、加权金额）
    - ✅ 阶段转化率计算（下一阶段商机数 / 当前阶段商机数 × 100%）
    - ✅ 整体转化率（赢单数 / 初步接触数 × 100%）
    - ✅ 平均跟进周期（各阶段平均耗时，单位：天，已在过程指标仪表盘中实现）
  - **可视化展示**：
    - ✅ 漏斗图展示（已实现）
    - ✅ 阶段详情列表（已实现）
    - ✅ 时间范围筛选（已实现）
    - ✅ 商务经理筛选（已实现）
    - ✅ 转化率趋势图（已实现，使用Chart.js展示最近6个月转化率趋势）
- ✅ **销售预测**（✅ 已实现）
  - **API接口**：`opportunity_sales_forecast_api`（✅ 已实现）
  - **页面视图**：`opportunity_sales_forecast`（✅ 已实现）
  - **预测模型**：
    - 月度销售预测 = 加权金额 × 历史转化率 × 时间系数
    - 预测基础数据：活跃商机数、加权金额、历史转化率、预计签约时间
  - **预测结果**：
    - ✅ 乐观预测（65%概率）
    - ✅ 中性预测（50%概率）
    - ✅ 保守预测（35%概率）
  - **目标差距分析**：
    - ✅ 月度目标对比（已实现）
    - ✅ 预测缺口计算（已实现）
    - ✅ 改进建议（已实现，基于预测缺口自动生成）
- ✅ **过程指标仪表盘**（已实现）
  - **核心指标**（基于系统自动采集数据，不依赖人工填报）：
    - **跟进及时率**：最近30天有跟进的商机占比
      - 数据来源：系统自动记录跟进时间
    - **平均跟进间隔**：商机平均跟进间隔天数
      - 数据来源：系统自动计算跟进记录间隔
    - **商机信息完整度**：已填必填字段数 / 总必填字段数 × 100%
      - 数据来源：系统自动检查字段完整性
  - **展示内容**：
    - ✅ 商机健康度分布（高/中/低健康度统计）
    - ✅ 商机质量评分分布（A/B/C/D级统计）
    - ✅ 跟进及时性统计（跟进及时率、平均跟进间隔、超期未跟进提醒）
    - ✅ 信息完整度统计（平均信息完整度）
    - ✅ 待办提醒（超期未跟进、今日待跟进、待提交报价）
- ✅ **销售绩效报表**（已实现）
  - **⚠️ 报表统一管理说明**：销售绩效报表统一纳入"报表管理"模块（17.报表管理）进行集中管理，在报表管理模块中通过"模块报表 > 商机管理报表"访问
  - **报表类型**：
    - ✅ 销售业绩统计（总商机数、赢单数量、赢单金额、赢单率）
    - ✅ 销售排名（按加权金额排名，显示商机数、预计金额、加权金额、赢单数、赢单金额）
    - ✅ 阶段转化率分析（各阶段转化率统计）
    - ✅ 个人商机跟进统计（当筛选特定经理时显示：总商机数、活跃商机、赢单数量、跟进记录数、平均跟进次数）
    - ✅ 销售趋势分析（最近6个月：新增商机数、赢单数、赢单金额）
    - ⏳ 目标完成进度（月度/季度/年度目标完成率，待实现）
    - ⏳ 商机客户分析报表（行业分布、新老客户对比，待实现）
  - **报表访问入口**：
    - 主入口：报表管理模块 > 模块报表 > 商机管理报表 > 销售绩效报表
    - 快捷入口：报表管理模块 > 报表收藏 > 销售绩效报表（需先收藏）
  - **筛选功能**：
    - ✅ 时间范围筛选（开始日期、结束日期）
    - ✅ 商务经理筛选
  - **自定义看板**：
    - ⏳ 商务经理工作台（今日重点关注、我的商机概览、快速操作，待实现）
    - ⏳ 商务总监看板（团队绩效概览、团队商机分布、审批待办、销售漏斗，待实现）

#### 2.5 商机智能功能（API已实现）
**功能列表**：
- ✅ **商机健康度评估**（API已实现）
  - **评估模型**：商机健康度 = Σ(维度得分 × 权重)
  - **评估维度**：
    1. **跟进及时性**（权重25%）：基于预计下次跟进时间，评估跟进计划的执行情况
    2. **信息完整性**（权重20%）：评估商机必填字段的完整程度
    3. **客户互动频次**（权重20%）：基于最近30天跟进次数评估客户互动情况
    4. **阶段推进速度**（权重35%）：评估各阶段停留时间，与平均周期对比
  - **健康度等级**：
    - 🔴 **高风险**：<60分（需立即关注，触发预警通知）
    - 🟡 **一般**：60-80分（需要改进）
    - 🟢 **健康**：>80分（正常推进）
  - **API接口**：`/api/customer/opportunities/<id>/health-score/`
- ✅ **智能行动建议**（API已实现）
  - **推荐规则**（基于结构化数据，不依赖NLP）：
    1. **阶段超期提醒**：商机在某个阶段停留时间超过平均周期
    2. **信息不完整提醒**：商机必填字段缺失
    3. **跟进不及时提醒**：超过预计跟进时间未跟进
  - **建议类型**：
    - 立即提交方案
    - 完善必填信息
    - 立即安排跟进
    - 更新跟进计划
  - **API接口**：`/api/customer/opportunities/<id>/action-suggestions/`
- ✅ **商机质量评分**（API已实现）
  - **评分模型**：商机质量评分 = Σ(维度得分 × 权重)
  - **评分维度**：
    1. **客户资质**（权重35%）：客户规模、客户信用、合作历史、法律风险
    2. **项目靠谱程度**（权重40%）：项目阶段、预算确认、时间紧迫性、项目信息完整度
    3. **竞争环境**（权重25%）：竞争激烈度、我方优势、价格敏感度
  - **质量等级**：
    - **A级商机**：≥80分（重点投入，优先跟进）
    - **B级商机**：60-79分（正常跟进，保持节奏）
    - **C级商机**：40-59分（观察维护，适度投入）
    - **D级商机**：<40分（低优先级，资源有限时暂停）
  - **API接口**：`/api/customer/opportunities/<id>/quality-score/`

#### 2.6 销售活动
**功能列表**：
- ✅ **销售活动日历**（占位）
  - 活动日历展示（月视图/周视图/日视图）
  - 活动列表展示
  - 活动提醒（提前1小时/提前1天）
- ✅ **销售活动创建**（占位）
  - 活动类型选择（客户拜访、电话沟通、会议、邮件沟通、其他）
  - 活动标题录入
  - 活动时间设置（开始时间、结束时间）
  - 活动地点设置
  - 关联客户/商机选择
  - 活动描述录入
  - 活动完成确认（自动/手动）
- ✅ **销售活动API**
  - 活动列表API
  - 活动创建API
  - 活动更新API
  - 活动删除API
  - 活动统计分析（按类型、按客户、按时间）

#### 2.7 商机审批流程（✅ 已实现）
**功能列表**：
- ✅ **审批流程引擎集成**
  - 使用通用审批流程引擎（WorkflowEngine）
  - 支持配置化审批流程
  - 支持多级审批
- ✅ **分级审批机制**
  - **审批规则**（基于预计金额）：
    - 预计金额 < 20万 → 商务部经理审批
    - 20万 ≤ 预计金额 < 100万 → 商务总监审批
    - 预计金额 ≥ 100万 → 总经理审批
  - ⏳ 根据金额自动选择审批流程（待实现）
- ✅ **审批内容**
  - 客户资质和信誉（法律风险评估）
  - ⏳ 项目可行性分析（待实现）
  - ⏳ 报价合理性（待实现）
  - ⏳ 资源匹配度（待实现）
  - ⏳ 风险识别与应对（待实现）
- ✅ **审批流程配置**
  - 创建"商机审批流程"模板
  - 配置审批节点（根据金额范围）
  - 设置审批人（角色/部门/用户）
  - 配置审批规则（全部通过/任意通过/多数通过）

#### 2.8 赢单/输单管理（✅ 已实现）
**功能列表**：
- ✅ **赢单处理**
  - 赢单信息录入（实际签约金额、签约日期、合同编号、服务开始时间）
  - 赢单原因分析（技术方案优势、价格竞争力、客户关系良好、品牌影响力等）
  - 重要经验记录
  - 商机状态变更为"赢单"
  - 手动创建立项流程（通过按钮触发，避免自动集成阻塞）
- ✅ **输单分析**
  - 输单原因分类（价格因素、技术方案不匹配、竞争对手优势、客户预算调整、客户内部决策变化等）
  - 详细分析（竞争对手信息、客户反馈、改进建议）
  - ✅ 输单原因统计（已实现，基于关键词分析）
  - ✅ 输单趋势分析（已实现，最近6个月趋势）
  - ✅ 输单金额统计（已实现）
  - ✅ 输单率计算（已实现）
  - ✅ 最近输单商机列表（已实现）
  - ⏳ 竞争对手分析（待实现，需要更详细的竞争对手信息）

#### 2.9 系统集成设计
**功能列表**：
- ✅ **与审批流程引擎集成**
  - 使用通用审批流程引擎
  - 支持配置化审批流程
  - 支持多级审批

#### 2.11 页面设计和样式规范（✅ 已实现，2025-01-30）

**⚠️ 重要提示：所有功能模块开发时必须调用样式模板文件，避免重复定义样式**

##### 2.10.1 样式模板文件调用规范

**样式模板文件位置**：
- 文件路径：`backend/static/css/common.css`
- 模板中引用方式：`{% load static %}` 然后在 `{% block extra_css %}` 或 `<head>` 中添加：
  ```html
  <link rel="stylesheet" href="{% static 'css/common.css' %}">
  ```

**必须调用的场景**：
1. ✅ **所有列表页面**：必须调用 `common.css`，使用 `list-page-container` 布局
2. ✅ **所有详情页面**：必须调用 `common.css`，使用 `info-card`、`info-grid`、`info-item` 组件
3. ✅ **所有表单页面**：必须调用 `common.css`，使用 `form-card`、`form-section` 组件
4. ✅ **所有新建/编辑页面**：必须调用 `common.css`，使用表单样式组件

**样式模板提供的核心组件**：
- **信息卡片组件**：`.info-card`、`.info-card-header`、`.info-card-body`、`.info-card-title`
- **信息布局组件**：`.info-grid`、`.info-item`、`.info-label`、`.info-value`
- **表单组件**：`.form-card`、`.form-section`、`.form-group`、`.form-label`、`.form-control`
- **布局组件**：`.workspace-two-column`、`.workspace-content`、`.workspace-main`
- **列表组件**：`.list-page-container`、`.page-header`、`.filter-bar`、`.action-bar`

**样式变量系统**：
- 使用 CSS 变量统一管理颜色、间距、字体等设计令牌
- 变量定义在 `common.css` 的 `:root` 中
- 开发时优先使用变量，避免硬编码值

**设计规范**：
- ✅ 使用统一的样式模板（`common.css`）
- ✅ 列表页面使用列表页面布局模板（`list-page-container`）
- ✅ 详情页面使用信息卡片样式（`info-card`、`info-grid`、`info-item`）
- ✅ 表单页面使用表单卡片样式（`form-card`、`form-section`）
- ✅ 表单输入文本颜色：绿色 `#16A34A`
- ✅ 卡片标题颜色：红色 `#dc3545`
- ✅ 表格行距优化：缩小至70%
- ✅ 表头列设置按钮样式：黄色 `#FFC107`

**布局结构**：
- ✅ 左侧导航菜单（使用 `workspace-two-column` 布局）
- ✅ 主内容区域（使用 `workspace-content` 或 `workspace-main`）
- ✅ 响应式设计（移动端自动适配）

**交互功能**：
- ✅ 加权金额自动计算（JavaScript实时计算）
- ✅ 表单验证（HTML5原生验证 + Bootstrap样式）
- ✅ 筛选表单自动提交（500ms防抖）
- ✅ 批量选择功能
- ✅ 表格行悬停效果
- ✅ 删除确认对话框

**参考文档**：
- 商机管理专项设计方案（v2.2）
- 样式模板统一方案（`docs/样式模板统一方案.md`）

- ✅ **与外部系统集成**
  - ✅ **启信宝API集成**（已实现）
    - 企业信息查询（模糊搜索）
    - 统一信用代码验证
    - 法律风险信息获取（司法案件数量、被执行人数量、终本案件数量、限制高消费数量）
    - 法律风险等级自动判断
  - ⏳ **日历系统集成**（待实现）
    - 跟进计划同步到日历
    - 提醒商务经理及时跟进
    - 团队日程协调
    - 支持导出到 Google Calendar / Outlook
    - 支持 iCal 格式

#### 2.10 权限与安全设计（✅ 已实现）
**功能列表**：
- ✅ **角色权限管理**
  - **权限矩阵**：
    | 功能 | 商务经理 | 商务部经理 | 商务总监 | 总经理 |
    |------|----------|------------|----------|--------|
    | 查看分配商机 | ✅ | ✅ | ✅ | ✅ |
    | 查看全部商机 | ❌ | ✅ | ✅ | ✅ |
    | 创建商机 | ✅ | ✅ | ✅ | ✅ |
    | 编辑商机 | ✅（自己的） | ✅ | ✅ | ✅ |
    | 删除商机 | ✅（自己的） | ✅ | ✅ | ✅ |
    | 记录跟进 | ✅ | ✅ | ✅ | ✅ |
    | 提交审批 | ✅ | ✅ | ✅ | ✅ |
    | 审批商机 | ❌ | ✅ | ✅ | ✅ |
    | 销售数据分析 | ❌ | ✅ | ✅ | ✅ |
    | 团队绩效管理 | ❌ | ❌ | ✅ | ✅ |
    | 系统配置 | ❌ | ❌ | ❌ | ✅ |
- ✅ **数据权限**
  - **数据隔离规则**：
    - 商务经理：只能查看分配给自己的商机
    - 商务部经理：可以查看本部门所有商机
    - 商务总监：可以查看所有商机
    - 总经理：可以查看所有商机
- ✅ **数据安全保护**
  - 商机信息加密存储（Django默认）
  - 操作日志完整记录（Django Admin）
  - 数据访问权限控制（Django权限系统）
  - 定期数据备份（数据库备份）
  - ⏳ 敏感信息脱敏显示（待实现）

---

### 3. 合同管理
- **状态**：✅ 部分完成（核心功能）
- **完成度**：60%
- **最后更新**：2025-01-27
- **实现说明**：核心功能部分完成，包括合同CRUD操作、状态管理、文件管理、变更管理、审批流程集成等。业务委托书管理、合同模板库、在线签署、履约跟踪、提醒警报等功能待实现。

**模块定位**：
合同管理模块是商务流程的核心环节，负责管理从业务委托书到正式合同签订、执行、履约的全生命周期。模块覆盖合同起草、模板管理、在线签署、履约跟踪等完整流程，连接商机管理（含立项）、结算管理等模块，形成完整的商务闭环。合同管理不仅记录合同基本信息，还提供智能起草、电子签署、履约监控、风险预警等全流程管理能力。

**业务价值**：
1. **合同全生命周期管理**：从业务委托书到正式合同，从起草到签署，从执行到履约，全流程数字化管理
2. **合同模板标准化**：提供结构化模板库，支持智能起草和版本控制，确保合同规范性和合规性
3. **在线签署与存证**：集成电子签名服务，实现具有法律效力的在线签署，数字证书存证确保不可篡改
4. **履约执行跟踪**：自动提取合同关键节点，监控履约情况，记录收付款情况，确保合同执行到位
5. **风险预警与控制**：通过审批流程、状态管理、主动提醒和风险预警，控制合同风险，确保合规性
6. **数据统计分析**：提供合同多维度统计分析，支持经营决策

**与其他模块的关联与整合**：

##### 3.1 与商机管理的整合
- **数据流向**：商机赢单后，可基于商机信息创建合同
- **关联关系**：
  - 合同可关联到对应的商机（通过项目间接关联）
  - 合同编号可记录到商机的赢单信息中
- **业务流程**：
  - 商机状态为"赢单"后，商务经理可创建合同
  - 合同创建时可选择关联的商机
- **数据同步**：
  - 合同金额自动同步到商机的实际签约金额
  - 合同签订日期记录到商机的签约日期

##### 3.2 与商机管理（立项）的整合
- **数据流向**：合同创建后，可在商机赢单后立项时关联合同信息
- **关联关系**：
  - 立项时可选择关联的合同
  - 合同金额信息自动带到立项中
- **业务流程**：
  - 商机赢单后创建立项时，可以选择已创建的合同
  - 合同金额自动计算到项目的合同金额字段
- **数据同步**：
  - 项目合同金额从合同金额字段自动获取
  - 合同编号显示在项目详情中

##### 3.3 与生产管理的整合
- **数据流向**：项目执行过程中可查看关联的合同信息
- **关联关系**：
  - 项目详情页显示关联的合同信息
  - 项目列表可筛选关联的合同
- **业务流程**：
  - 项目执行过程中可查看合同条款和金额
  - 合同变更时影响项目的合同金额
- **数据同步**：
  - 合同金额变更时，关联项目的合同金额自动更新

##### 3.4 与结算管理的整合
- **数据流向**：结算时可关联合同，进行合同结算
- **关联关系**：
  - 结算单可选择关联的合同（合同结算类型）
  - 结算金额可关联到合同的结算金额
- **业务流程**：
  - 创建合同结算时选择关联的合同
  - 结算金额累计到合同的已结算金额
- **数据同步**：
  - 合同结算后，合同的已结算金额自动更新
  - 结算单号记录到合同的结算记录中

##### 3.5 与回款管理的整合
- **数据流向**：合同创建后，回款管理模块可基于合同创建回款计划
- **关联关系**：
  - 回款管理模块中的回款计划可关联到具体的合同
  - 回款记录确认后，自动更新合同的已回款金额（通过回款管理模块）
- **业务流程**：
  - 合同创建后，在回款管理模块中创建商务合同回款计划
  - 回款计划完成后，回款管理模块自动更新合同已回款金额
  - 合同详情页可查看关联的回款计划（只读，实际管理在回款管理模块）
- **数据同步**：
  - 回款管理模块回款后，自动同步到合同的已回款金额
  - 合同未回款金额 = 合同金额 - 已回款金额（自动计算）
  - 合同履约节点完成时，可触发回款管理模块的回款提醒
- **说明**：
  - ⚠️ **重要**：回款计划的实际管理功能在回款管理模块中实现
  - 合同管理模块仅提供合同信息查看和关联回款计划的查看功能
  - 回款计划的创建、编辑、删除等操作在回款管理模块中完成

##### 3.6 与收发管理的整合
- **数据流向**：合同文件可通过收发管理模块进行交付
- **关联关系**：
  - 合同文件可以作为非项目文件进行交付
  - 交付记录可关联到合同
- **业务流程**：
  - 合同文件上传后，可创建交付记录
  - 交付完成后，文件自动归档到档案管理
- **数据同步**：
  - 合同文件交付状态同步到合同文件管理

##### 3.7 与档案管理的整合
- **数据流向**：合同文件交付完成后，自动归档到档案管理
- **关联关系**：
  - 合同文件自动归档为合同档案
  - 档案可关联到具体的合同
- **业务流程**：
  - 合同文件交付完成后，自动推送到档案管理模块
  - 档案管理中可查看合同的归档文件
- **数据同步**：
  - 归档状态同步到合同文件管理

##### 3.8 与审批流程引擎的整合
- **数据流向**：合同创建后可提交审批流程
- **关联关系**：
  - 合同审批流程通过工作流引擎管理
  - 审批记录关联到合同
- **业务流程**：
  - 合同创建后，状态为"草稿"
  - 提交审批后，状态流转至"待审核"或"审核中"
  - 审批通过后，状态流转至"已签订"
  - 审批驳回后，状态恢复为"草稿"
- **数据同步**：
  - 审批状态实时同步到合同状态
  - 审批记录显示在合同详情页

##### 3.9 与风险管理的整合
- **数据流向**：合同风险可关联到风险管理模块
- **关联关系**：
  - 风险管理中的合同风险可关联到具体合同
  - 合同详情可查看关联的风险信息
- **业务流程**：
  - 创建合同风险时，选择关联的合同
  - 合同详情页显示关联的风险列表
  - 风险等级影响合同的执行状态

##### 3.10 与诉讼管理的整合
- **数据流向**：合同纠纷可关联到诉讼管理模块
- **关联关系**：
  - 诉讼案件可关联到具体合同（合同纠纷类型）
  - 合同详情可查看关联的诉讼案件
- **业务流程**：
  - 创建合同纠纷案件时，选择关联的合同
  - 合同状态为"争议"时，可自动关联到诉讼管理
  - 诉讼案件详情显示关联的合同信息

**代码文件位置**：
- 模型定义：`backend/apps/production_management/models.py`（BusinessContract、BusinessPaymentPlan）
- 辅助模型：`backend/apps/customer_success/models.py`（ContractFile、ContractChange、ContractApproval、ContractStatusLog）
- 页面视图：`backend/apps/customer_success/views_pages.py`
- URL路由：`backend/apps/customer_success/urls_pages.py`
- 页面模板：`backend/templates/customer_success/contract_*.html`
- 表单定义：`backend/apps/customer_success/forms.py`

**技术实现细节**：
- ✅ 合同编号自动生成（VIH-CON-YYYY-NNNN格式）
  - 格式：VIH-CON-年份-序号（如：VIH-CON-2025-0001）
  - 编号全局唯一
  - 在合同保存时自动生成（如果未提供）
- ✅ 金额自动计算
  - 不含税金额 = 含税金额 / (1 + 税率)
  - 税额 = 含税金额 - 不含税金额
  - 已回款金额：从回款管理模块同步（只读，实际管理在回款管理模块）
  - 未回款金额 = 合同金额 - 已回款金额（自动计算，基于回款管理模块同步的数据）
- ✅ 状态流转管理
  - 9种合同状态：草稿、待审核、审核中、已签订、已生效、执行中、已完成、已终止、已取消
  - 状态流转规则：通过 `get_valid_transitions()` 方法定义
  - 状态流转日志自动记录
- ✅ 审批流程引擎集成（工作流引擎）
  - 合同审批流程代码：`contract_approval`（待配置）
  - 审批节点：部门经理审批 → 总经理审批（可配置）
- ✅ 权限控制（基于权限码系统）
  - 当前使用：`customer_management.client.edit` - 合同管理权限（临时）
  - 计划使用：`customer_success.contract.view` - 合同查看权限
  - 计划使用：`customer_success.contract.create` - 合同创建权限
  - 计划使用：`customer_success.contract.edit` - 合同编辑权限
  - 计划使用：`customer_success.contract.delete` - 合同删除权限
  - 计划使用：`customer_success.contract.approve` - 合同审批权限
- ✅ 关联关系检查（删除前检查）
  - 合同删除：检查关联的项目、文件、变更记录、子合同、业务委托书
  - ⚠️ 注意：回款计划在回款管理模块管理，删除合同时不检查回款计划（由回款管理模块处理）
- ✅ 数据统计分析（聚合查询）
  - 使用 Django ORM 的 `aggregate()` 和 `annotate()` 方法
  - 统计维度：合同总数、合同总额、已签订数量、履约完成率等
  - ⚠️ 注意：回款相关统计在回款管理模块，合同管理模块仅提供合同基本信息统计

**已知问题和待优化**：
- ⚠️ 权限管理使用临时方案（使用客户管理权限），需要创建独立的合同管理权限项
- ⚠️ BusinessContract引用customer_management.Client（跨模块依赖），需要明确Client模型归属
- ⚠️ ContractFile等模型仍在customer_success中，但引用production_management.BusinessContract，代码组织需要优化
- ⚠️ 业务委托书管理功能待实现（数据模型和界面）
- ⚠️ 合同模板库功能待实现（模板管理、智能起草、版本控制）
- ⚠️ 在线签署功能待实现（e签宝集成、数字证书、存证）
- ⚠️ 履约跟踪功能待实现（关键节点监控、收付款管理、履约情况记录）
- ⚠️ 提醒与警报功能待实现（主动提醒、风险预警）
- ⚠️ 合同统计报表功能待实现（建议统一纳入报表管理模块）

**后续计划**：
1. **创建独立的合同管理权限项**
   - 定义合同管理相关权限码
   - 更新权限检查逻辑
2. **实现业务委托书管理功能**
   - 创建BusinessAuthorizationLetter模型
   - 实现委托书CRUD功能
   - 实现委托书转换为合同功能
3. **实现合同模板库功能**
   - 创建ContractTemplate和ContractTemplateVersion模型
   - 实现模板管理、智能起草、版本控制功能
4. **集成在线签署功能**
   - 集成e签宝电子签名服务
   - 实现数字证书管理和存证功能
5. **实现履约跟踪功能**
   - 创建ContractMilestone和ContractPerformance模型
   - 实现关键节点监控、收付款管理、履约情况记录
6. **实现提醒与警报功能**
   - 实现主动提醒功能（到期、付款、履约节点等）
   - 实现风险预警功能（异常付款、长期未履约、争议条款等）
7. **优化数据模型依赖关系**
   - 明确Client模型归属
   - 统一合同相关模型的模块归属
8. **添加合同统计报表功能**
   - 统一纳入报表管理模块

**⚠️ 样式模板调用提示**：
- ✅ 所有模板必须调用 `{% static 'css/common.css' %}`
- ✅ 列表页面使用 `list-page-container` 布局和 `info-card` 组件
- ✅ 详情页面使用 `info-card`、`info-grid`、`info-item` 组件
- ✅ 表单页面使用 `form-card`、`form-section` 组件

**数据模型**：
- ✅ `BusinessContract` - 商务合同模型（`backend/apps/production_management/models.py`）
- ⚠️ `BusinessPaymentPlan` - 回款计划模型（`backend/apps/production_management/models.py`）
  - **说明**：回款计划的实际管理在回款管理模块，合同管理模块仅查看关联的回款计划
- ✅ `ContractFile` - 合同文件模型（`backend/apps/customer_success/models.py`）
- ✅ `ContractChange` - 合同变更模型（`backend/apps/customer_success/models.py`）
- ✅ `ContractApproval` - 合同审批模型（`backend/apps/customer_success/models.py`）
- ✅ `ContractStatusLog` - 状态日志模型（`backend/apps/customer_success/models.py`）
- ⏳ `BusinessAuthorizationLetter` - 业务委托书模型（待创建）
- ⏳ `ContractTemplate` - 合同模板模型（待创建）
- ⏳ `ContractTemplateVersion` - 合同模板版本模型（待创建）
- ⏳ `ContractMilestone` - 合同里程碑模型（待创建）
- ⏳ `ContractPerformance` - 履约情况记录模型（待创建）

#### 3.1 合同信息管理
**实现状态**：✅ 已实现（2025-01-27）

**页面实现**：
- ✅ 合同列表页：`templates/customer_success/contract_list.html`
- ✅ 合同详情页：`templates/customer_success/contract_detail.html`
- ✅ 合同创建/编辑页：`templates/customer_success/contract_form.html`
- ✅ 合同文件上传页：`templates/customer_success/contract_file_form.html`
- ✅ 合同变更表单页：`templates/customer_success/contract_change_form.html`
- ✅ 合同审批提交页：`templates/customer_success/contract_submit_approval.html`

**视图函数**：
- ✅ `contract_management` - 合同列表（支持搜索、筛选、分页）
- ✅ `contract_detail` - 合同详情（显示关联数据、关联回款计划查看、文件、变更记录等）
- ✅ `contract_create` - 创建合同
- ✅ `contract_edit` - 编辑合同（仅草稿状态可编辑）
- ✅ `contract_delete` - 删除合同（需检查关联关系）
- ✅ `contract_status_transition` - 合同状态流转
- ✅ `contract_file_upload` - 上传合同文件
- ✅ `contract_file_download` - 下载合同文件
- ✅ `contract_file_delete` - 删除合同文件
- ✅ `contract_change_create` - 创建合同变更
- ✅ `contract_submit_approval` - 提交合同审批

**URL路由**：
- ✅ `business_pages:contract_management` - `/business/contracts/`
- ✅ `business_pages:contract_create` - `/business/contracts/create/`
- ✅ `business_pages:contract_detail` - `/business/contracts/<id>/`
- ✅ `business_pages:contract_edit` - `/business/contracts/<id>/edit/`
- ✅ `business_pages:contract_delete` - `/business/contracts/<id>/delete/`
- ✅ `business_pages:contract_status_transition` - `/business/contracts/<id>/transition/`
- ✅ `business_pages:contract_file_upload` - `/business/contracts/<id>/files/upload/`
- ✅ `business_pages:contract_file_download` - `/business/contracts/files/<id>/download/`
- ✅ `business_pages:contract_file_delete` - `/business/contracts/files/<id>/delete/`
- ✅ `business_pages:contract_change_create` - `/business/contracts/<id>/changes/create/`
- ✅ `business_pages:contract_submit_approval` - `/business/contracts/<id>/submit-approval/`

**功能列表**：
- ✅ **合同列表**（✅ 已实现）
  - ✅ 合同列表展示（分页，每页20条，按创建时间倒序）
  - ✅ 合同筛选（状态、类型、客户、项目）
  - ✅ 合同搜索（合同编号、合同名称、客户名称、项目编号、项目名称）
  - ✅ 合同统计卡片（合同总数、合同总额、已签订、履约中）
  - ✅ 表格列：合同编号、合同名称、客户、关联项目、合同类型、状态、合同金额、签订日期、操作
    - ⚠️ **说明**：已回款、未回款信息在回款管理模块查看，合同列表不显示
  - ✅ 操作按钮：查看、编辑（需权限）
  - ✅ 创建合同按钮（权限控制）
- ✅ **合同创建**（✅ 已实现）
  - ✅ 关联信息录入（关联项目、关联客户、主合同选择）
  - ✅ 基本信息录入（合同编号自动生成、合同名称、合同类型、合同状态）
  - ✅ 金额信息录入（合同金额含税、税率、不含税金额自动计算、税额自动计算）
  - ✅ 时间信息录入（签订日期、生效日期、开始日期、结束日期、期限自动计算）
  - ✅ 双方信息录入（甲方名称、甲方联系人、乙方名称、乙方联系人、签订人、审批人）
  - ✅ 其他信息录入（合同描述、备注）
  - ✅ 合同编号自动生成（VIH-CON-YYYY-NNNN格式）
  - ✅ 金额自动计算（不含税金额、税额、未回款金额）
  - ✅ 期限自动计算（结束日期-开始日期）
- ✅ **合同详情查看**（✅ 已实现）
  - ✅ 基本信息展示（合同编号、合同名称、合同类型、合同状态）
  - ✅ 关联信息展示（关联项目、关联客户、主合同/子合同、关联业务委托书）
  - ✅ 金额信息展示（含税金额、不含税金额、税额、已回款金额、未回款金额、已结算金额）
    - ⚠️ **说明**：已回款金额从回款管理模块同步（只读），实际回款管理在回款管理模块
  - ✅ 时间信息展示（签订日期、生效日期、开始日期、结束日期、期限）
  - ✅ 双方信息展示（甲方信息、乙方信息、签订人、审批人）
  - ✅ 关联回款计划查看（只读，显示关联的回款计划列表，包括阶段名称、计划金额、计划日期、实际金额、实际日期、状态）
    - ⚠️ **说明**：回款计划的实际管理在回款管理模块，合同详情页仅提供查看功能
    - ⚠️ **操作**：点击"管理回款计划"跳转到回款管理模块
  - ✅ 合同文件列表（显示所有合同文件，包括文件类型、文件名称、版本号、上传人、上传时间）
  - ✅ 审批记录列表（显示所有审批记录，包括审批人、审批层级、审批结果、审批意见、审批时间）
  - ✅ 变更记录列表（显示所有变更记录，包括变更类型、变更原因、变更前后内容、变更金额、变更日期）
  - ✅ 履约情况记录（显示履约里程碑、履约节点完成情况、履约评价）
  - ✅ 子合同列表（显示所有子合同，包括补充协议、变更协议等）
  - ✅ 状态流转日志（显示所有状态变更历史，包括原状态、目标状态、操作人、操作时间、备注）
  - ✅ 可流转状态列表（显示当前状态可以流转到的状态列表）
  - ✅ 状态流转操作（支持状态流转，需权限）
  - ✅ 操作按钮（编辑、删除、提交审批、上传文件、创建变更、发起签署、查看履约，权限控制）
- ✅ **合同编辑**（✅ 已实现）
  - ✅ 合同信息编辑（仅草稿状态可编辑）
  - ✅ 所有字段支持编辑
  - ✅ 权限控制（需合同管理权限）
- ✅ **合同删除**（✅ 已实现）
  - ✅ 合同删除（需检查关联关系：子合同、回款计划、文件、变更记录）
  - ✅ 关联关系检查（显示关联数量，如有关联则阻止删除）
  - ✅ 权限控制（需合同管理权限）
  - ✅ 删除确认
- ✅ **合同状态流转**（✅ 已实现）
  - ✅ 状态流转逻辑（通过 `get_valid_transitions()` 方法定义流转规则）
  - ✅ 状态合法性检查（检查是否可以流转到目标状态）
  - ✅ 状态流转日志记录（记录状态变更历史）
  - ✅ 状态流转操作（支持添加备注说明）
  - ✅ 权限控制（需合同管理权限）

#### 3.2 合同文件管理
**实现状态**：✅ 已实现（2025-01-27）

**功能列表**：
- ✅ **文件上传**（✅ 已实现）
  - ✅ 文件上传（支持多种文件格式：PDF、Word、Excel、图片等）
  - ✅ 文件类型选择（原件、扫描件、附件、补充协议、变更协议、终止协议、其他文件）
  - ✅ 文件名称录入（必填，如果未填写则使用上传文件名）
  - ✅ 文件版本管理（版本号录入，默认1.0）
  - ✅ 文件描述录入（可选）
  - ✅ 文件大小自动计算（自动记录文件大小）
  - ✅ 上传人自动记录（当前登录用户）
  - ✅ 上传时间自动记录
  - ✅ 权限控制（需合同管理权限）
- ✅ **文件下载**（✅ 已实现）
  - ✅ 文件下载（支持中文文件名）
  - ✅ 下载权限检查（需合同查看或管理权限）
  - ✅ 文件不存在提示
- ✅ **文件删除**（✅ 已实现）
  - ✅ 文件删除（删除文件记录和实际文件）
  - ✅ 删除确认
  - ✅ 权限控制（需合同管理权限）
- ✅ **文件列表展示**（✅ 已实现）
  - ✅ 文件列表（按上传时间倒序）
  - ✅ 文件信息展示（文件类型、文件名称、版本号、文件大小、上传人、上传时间）
  - ✅ 文件操作（下载、删除，权限控制）

#### 3.3 合同变更管理
**实现状态**：✅ 已实现（2025-01-27）

**功能列表**：
- ✅ **变更记录创建**（✅ 已实现）
  - ✅ 变更类型选择（金额变更、期限变更、条款变更、双方变更、其他变更）
  - ✅ 变更原因录入（必填）
  - ✅ 变更前内容录入（可选）
  - ✅ 变更后内容录入（必填）
  - ✅ 变更金额录入（金额变更时必填）
  - ✅ 变更日期设置（默认当前日期）
  - ✅ 审批人记录（可选）
  - ✅ 备注录入（可选）
  - ✅ 创建人自动记录（当前登录用户）
  - ✅ 创建时间自动记录
  - ✅ 金额变更自动更新合同金额（变更金额自动累加到合同金额）
  - ✅ 权限控制（需合同管理权限）
- ✅ **变更记录列表展示**（✅ 已实现）
  - ✅ 变更记录列表（按创建时间倒序）
  - ✅ 变更信息展示（变更类型、变更原因、变更前后内容、变更金额、变更日期、审批人、创建人、创建时间）
- ⏳ **变更记录编辑**（待实现）
- ⏳ **变更记录删除**（待实现）

#### 3.4 合同审批流程
**实现状态**：✅ 已实现（2025-01-27）

**功能列表**：
- ✅ **提交审批**（✅ 已实现）
  - ✅ 提交审批（与审批流程引擎集成）
  - ✅ 状态检查（只有草稿或待审核状态的合同才能提交审批）
  - ✅ 审批流程检查（检查是否已有正在进行的审批）
  - ✅ 工作流引擎集成（通过工作流引擎启动审批流程）
  - ✅ 提交后状态更新（状态流转至"待审核"或"审核中"）
  - ✅ 权限控制（需合同管理权限）
- ✅ **审批状态跟踪**（✅ 已实现）
  - ✅ 审批实例查询（通过工作流引擎查询审批实例）
  - ✅ 审批记录展示（显示所有审批记录：审批人、审批节点、审批结果、审批意见、审批时间）
  - ✅ 审批进度显示（显示当前审批进度）
- ✅ **审批记录管理**（✅ 已实现）
  - ✅ 审批记录模型（ContractApproval）
  - ✅ 多级审批支持（审批层级配置）
  - ✅ 审批结果记录（通过、驳回、待审核）
  - ✅ 审批意见记录
  - ✅ 审批时间记录

#### 3.5 业务委托书管理
**实现状态**：⏳ 待实现

**功能说明**：管理正式合同签订前的业务委托书，用于记录客户委托公司提供服务的初步意向和基本信息。

**数据模型**：
- ⏳ `BusinessAuthorizationLetter` - 业务委托书模型（待创建）

**功能列表**：
- ⏳ **委托书创建**（待实现）
  - ⏳ 委托书基本信息录入（委托书编号、委托书名称、委托日期）
  - ⏳ 委托方信息录入（委托方名称、联系人、联系方式）
  - ⏳ 受托方信息录入（受托方名称、联系人、联系方式）
  - ⏳ 委托内容录入（服务内容、服务范围、服务要求）
  - ⏳ 委托金额录入（委托金额、付款方式）
  - ⏳ 委托期限录入（开始日期、结束日期）
  - ⏳ 委托书状态管理（草稿、已提交、已确认、已作废）
  - ⏳ 关联商机（可选择关联的商机）
- ⏳ **委托书列表**（待实现）
  - ⏳ 委托书列表展示（分页、筛选、搜索）
  - ⏳ 委托书状态筛选
  - ⏳ 委托书统计卡片（总数、已确认、待确认）
- ⏳ **委托书详情**（待实现）
  - ⏳ 委托书详细信息展示
  - ⏳ 关联商机信息展示
  - ⏳ 委托书转换为合同功能
- ⏳ **委托书编辑**（待实现）
  - ⏳ 委托书信息编辑（仅草稿状态可编辑）
  - ⏳ 委托书状态流转
- ⏳ **委托书转换为合同**（待实现）
  - ⏳ 基于委托书创建合同
  - ⏳ 委托书信息自动填充到合同
  - ⏳ 委托书与合同的关联关系

**与商机管理的整合**：
- **数据流向**：商机赢单后，可创建业务委托书
- **关联关系**：委托书可关联到对应的商机
- **业务流程**：商机赢单 → 创建委托书 → 委托书确认 → 创建正式合同

#### 3.6 合同模板库管理
**实现状态**：⏳ 待实现

**功能说明**：提供标准、合规的合同模板库，支持结构化模板、智能起草、版本控制等功能。

**数据模型**：
- ⏳ `ContractTemplate` - 合同模板模型（待创建）
- ⏳ `ContractTemplateVersion` - 合同模板版本模型（待创建）

**功能列表**：
- ⏳ **结构化模板**（待实现）
  - ⏳ 标准合同模板库（按合同类型分类：服务合同、采购合同、销售合同等）
  - ⏳ 模板变量定义（支持变量填空，如：{客户名称}、{合同金额}、{服务内容}等）
  - ⏳ 模板格式规范（确保合同规范性和合规性）
  - ⏳ 模板分类管理（按业务类型、合同类型、行业分类）
  - ⏳ 模板搜索功能（按模板名称、类型、关键词搜索）
- ⏳ **智能起草**（待实现）
  - ⏳ 问卷式引导（通过问卷收集合同信息，自动生成合同初稿）
  - ⏳ AI辅助生成（基于现有条款库，AI辅助生成合同初稿）
  - ⏳ 条款库关联（与现有条款库关联，自动匹配相关条款）
  - ⏳ 合同初稿预览（实时预览生成的合同内容）
  - ⏳ 合同初稿编辑（支持在线编辑合同内容）
- ⏳ **版本控制**（待实现）
  - ⏳ 模板版本管理（自动保存每次修改记录）
  - ⏳ 版本对比功能（可随时查看、对比历史版本）
  - ⏳ 版本恢复功能（可恢复到任意历史版本）
  - ⏳ 版本发布管理（模板版本发布、停用管理）
  - ⏳ 版本使用统计（统计各版本的使用情况）

**与合同信息管理的整合**：
- **数据流向**：使用模板创建合同时，模板信息自动填充到合同
- **关联关系**：合同可关联到使用的模板和模板版本
- **业务流程**：选择模板 → 填写变量 → 生成合同初稿 → 编辑完善 → 创建合同

#### 3.7 在线签署与加密
**实现状态**：⏳ 待实现

**功能说明**：集成电子签名服务，实现具有法律效力的在线签署，并对合同文件进行数字加密和存证。

**第三方服务集成**：
- ⏳ **e签宝电子签名服务**（待集成）
  - 电子签名API集成
  - 签署流程配置
  - 签署状态查询
  - 签署文件下载

**功能列表**：
- ⏳ **集成电子签名**（待实现）
  - ⏳ 无缝对接e签宝电子签章服务
  - ⏳ 在线签署流程（发起签署 → 签署人签署 → 签署完成）
  - ⏳ 多签署人支持（支持多个签署人顺序签署或并行签署）
  - ⏳ 签署位置配置（支持自定义签署位置）
  - ⏳ 签署提醒功能（短信、邮件提醒签署人）
  - ⏳ 签署状态跟踪（实时跟踪签署进度）
  - ⏳ 签署文件下载（下载已签署的合同文件）
- ⏳ **数字证书与存证**（待实现）
  - ⏳ 数字证书管理（签署人数字证书管理）
  - ⏳ 合同文件数字加密（对合同文件进行数字加密）
  - ⏳ 自动存证（自动存证至权威机构，确保不可篡改）
  - ⏳ 存证查询（查询合同存证信息）
  - ⏳ 存证证明下载（下载存证证明文件）
- ⏳ **签署记录管理**（待实现）
  - ⏳ 签署记录列表（显示所有签署记录）
  - ⏳ 签署信息展示（签署人、签署时间、签署位置、签署状态）
  - ⏳ 签署文件查看（查看已签署的合同文件）
  - ⏳ 签署证明下载（下载签署证明文件）

**与合同信息管理的整合**：
- **数据流向**：合同创建后，可发起在线签署
- **关联关系**：签署记录关联到具体合同
- **业务流程**：合同创建 → 发起签署 → 签署人签署 → 签署完成 → 合同状态更新为"已签署"
- **状态同步**：签署完成后，合同状态自动更新为"已签署"

#### 3.8 履约与执行跟踪
**实现状态**：⏳ 待实现

**功能说明**：监控合同执行过程中的关键节点，记录履约情况，与财务管理模块对接记录收付款情况。

**数据模型**：
- ⏳ `ContractMilestone` - 合同里程碑模型（待创建）
- ⏳ `ContractPerformance` - 履约情况记录模型（待创建）

**功能列表**：
- ⏳ **关键节点监控**（待实现）
  - ⏳ 自动提取合同中的关键节点（交付节点、付款节点、验收节点等）
  - ⏳ 里程碑节点设置（支持手动添加和自动提取）
  - ⏳ 节点提醒设置（设置节点提醒时间，提前提醒）
  - ⏳ 节点完成确认（节点完成后，确认节点完成状态）
  - ⏳ 节点进度跟踪（实时跟踪节点完成进度）
  - ⏳ 节点逾期提醒（节点逾期时，自动提醒）
- ⏳ **收付款管理**（待实现）
  - ⏳ 付款计划记录（记录合同中的付款计划）
  - ⏳ 实际付款情况记录（与财务管理模块对接，记录实际付款情况）
  - ⏳ 付款状态跟踪（跟踪付款计划执行情况）
  - ⏳ 付款提醒（付款节点到期前，自动提醒）
  - ⏳ 发票关联（付款记录关联到发票信息）
  - ⏳ 收付款统计（统计合同收付款情况）
- ⏳ **履约情况记录**（待实现）
  - ⏳ 补充协议记录（记录合同执行过程中的补充协议）
  - ⏳ 合同变更记录（记录合同变更情况，与合同变更管理模块关联）
  - ⏳ 违约事件记录（记录合同执行过程中的违约事件）
  - ⏳ 履约评价记录（记录合同履约评价）
  - ⏳ 履约情况统计（统计合同履约情况）

**与财务管理模块的整合**：
- **数据流向**：财务管理模块的付款记录自动同步到合同的付款情况
- **关联关系**：付款记录关联到合同的付款计划节点
- **业务流程**：合同付款节点到期 → 财务管理模块付款 → 自动更新合同付款状态
- **数据同步**：付款金额、付款日期自动同步到合同履约记录

**与合同变更管理的整合**：
- **数据流向**：合同变更记录自动同步到履约情况记录
- **关联关系**：履约情况记录关联到合同变更记录
- **业务流程**：合同变更 → 履约情况记录更新

#### 3.9 提醒与警报
**实现状态**：⏳ 待实现

**功能说明**：提供主动提醒和风险预警功能，确保合同关键事项及时处理，降低合同风险。

**功能列表**：
- ⏳ **主动提醒**（待实现）
  - ⏳ 合同到期提醒（合同到期前自动提醒，支持自定义提醒时间）
  - ⏳ 续签提醒（合同到期前提醒续签）
  - ⏳ 付款提醒（付款节点到期前提醒付款）
  - ⏳ 履约节点提醒（履约节点到期前提醒）
  - ⏳ 签署提醒（待签署合同提醒签署）
  - ⏳ 审批提醒（待审批合同提醒审批）
  - ⏳ 提醒方式（站内消息、邮件、短信）
  - ⏳ 提醒设置（用户可自定义提醒规则）
- ⏳ **风险预警**（待实现）
  - ⏳ 异常付款预警（付款异常时，系统自动预警）
  - ⏳ 长期未履约预警（长期未履约时，系统自动预警）
  - ⏳ 争议条款预警（合同存在争议条款时，系统自动预警）
  - ⏳ 合同逾期预警（合同逾期时，系统自动预警）
  - ⏳ 风险等级评估（自动评估合同风险等级）
  - ⏳ 风险预警通知（风险预警时，自动通知相关人员）
  - ⏳ 风险处理跟踪（跟踪风险处理情况）

**与合同信息管理的整合**：
- **数据流向**：合同状态、时间节点变化时，自动触发提醒
- **关联关系**：提醒记录关联到具体合同
- **业务流程**：合同状态/时间节点变化 → 检查提醒规则 → 触发提醒 → 用户处理

#### 3.10 合同统计分析
**实现状态**：⚠️ 待实现（建议统一纳入报表管理模块）

**功能说明**：提供合同相关的统计分析功能，支持经营决策。所有报表功能统一纳入报表管理模块（17.报表管理）进行集中管理。

**⚠️ 报表统一管理说明**：
- 所有合同统计报表统一纳入"报表管理"模块（17.报表管理）进行集中管理
- 在报表管理模块中通过"模块报表 > 合同管理报表"访问
- 合同列表页面的统计卡片保留，用于快速查看

**建议的报表类型**：
- ⏳ **合同金额统计报表**
  - 合同总金额统计
  - 按合同类型统计金额
  - 按客户统计金额
  - 按项目统计金额
  - 按时间统计金额趋势
- ⏳ **合同状态分布报表**
  - 各状态合同数量统计
  - 各状态合同金额统计
  - 状态分布图表
- ⏳ **合同履约分析报表**
  - 履约完成率统计
  - 履约节点完成情况分析
  - 履约逾期统计
  - 履约趋势分析
- ⏳ **合同签署分析报表**
  - 签署完成率统计
  - 签署时长分析
  - 签署效率分析
- ⏳ **合同风险分析报表**
  - 风险合同统计
  - 风险等级分布
  - 风险趋势分析
- ⏳ **合同分析报表**
  - 合同金额分析
  - 合同类型分析
  - 客户合同分析
  - 项目合同分析

**报表访问方式**：
- 主入口：报表管理模块 > 模块报表 > 合同管理报表
- 快捷入口：报表管理模块 > 报表收藏 > 合同管理报表（需先收藏）

---

### 4. 生产管理
- **状态**：✅ 已完成（核心功能）
- **完成度**：90%
- **说明**：生产管理模块支持四种服务类型的业务流程：结果优化、过程优化、精细化审图、全过程设计咨询

**⚠️ 样式模板调用提示**：
- ✅ 所有模板必须调用 `{% static 'css/common.css' %}`
- ✅ 列表页面使用 `list-page-container` 布局和 `info-card` 组件
- ✅ 详情页面使用 `info-card`、`info-grid`、`info-item` 组件
- ✅ 表单页面使用 `form-card`、`form-section` 组件

**模块定位与价值**：
- **核心定位**：生产管理模块是公司的核心业务执行平台，从"业务记录工具"升级为"生产赋能平台"，实现项目全生命周期的数字化管理
- **价值创造**：
  - **效率提升**：通过流程自动化、任务智能分配、进度实时跟踪，提升生产效率30%以上
  - **质量保障**：通过标准化流程、多级审核、质量检查，确保交付质量
  - **数据驱动**：通过数据统计、分析报表、趋势预测，支持管理决策
  - **知识沉淀**：通过经验总结、知识库积累、最佳实践复用，形成组织智慧
  - **成本控制**：通过节省金额计算、成本分析、资源优化，实现成本可控
- **三大核心原则**：
  1. **过程可量化**：将生产过程中的关键指标（进度、质量、成本）量化管理，基于系统自动采集数据
  2. **知识可沉淀**：建立生产知识库，沉淀技术经验、管理经验，让个人经验变成团队资产
  3. **价值可激励**：基于系统数据，激励高效生产、质量提升、成本节约等正确行为

**权限与安全设计**（✅ 已实现）：
- ✅ **项目数据权限控制**：
  - **员工角色**：仅能查看和操作自己参与的项目（项目团队成员）
  - **部门经理角色**：可以查看和操作部门所有项目
  - **高管角色**：可以查看和操作公司所有项目
  - **系统管理员**：拥有所有项目的完全权限
- ✅ **项目操作权限控制**：
  - **项目创建**：商务经理、项目负责人、管理员可以创建项目
  - **项目接收**：项目负责人可以接收项目（待接收状态）
  - **项目编辑**：项目负责人、商务经理、管理员可以编辑项目
  - **项目完成**：项目负责人、管理员可以完成项目
  - **项目归档**：项目负责人、管理员可以归档项目
  - **团队配置**：项目负责人、管理员可以配置项目团队
  - **流程操作**：根据项目流程节点和用户角色控制操作权限
- ✅ **项目信息可见性控制**：
  - **基本信息**：项目团队成员可见
  - **客户信息**：项目团队成员、商务经理可见
  - **设计单位信息**：项目团队成员可见
  - **团队信息**：项目团队成员可见
  - **财务信息**：项目负责人、商务经理、管理员可见
  - **敏感信息**：仅项目负责人、管理员可见

#### 4.1 生产准备
**功能说明**：生产准备阶段覆盖项目从立项完成后（商务经理完成立项，项目状态为"待接收"）到正式开工前的全部准备工作，包括项目接收、信息完善、团队配置、任务准备、图纸申请与预审、开工通知等环节。此阶段完成后，项目正式进入生产执行阶段。

**功能列表**：

##### 4.1.1 项目接收与创建
**功能说明**：项目负责人接收从商机管理模块（立项）移交过来的项目，完成项目创建和基本信息录入。

**详细功能**：
- ✅ **项目列表展示**
  - 项目列表展示（分页，每页默认20条）
  - 显示字段：项目编号、项目名称、客户名称、服务类型、项目负责人、商务经理、项目状态、创建时间
  - 支持快速筛选和高级筛选
  - 支持批量操作（批量分配、批量导出等）
- ✅ **项目状态筛选**
  - 支持筛选：待接收、配置中、待开工、进行中、暂停、已完工、已归档、已取消
  - 支持多状态组合筛选
  - 状态颜色标识（待接收-橙色、配置中-蓝色、待开工-黄色、进行中-绿色等）
- ✅ **项目搜索**
  - 支持按项目编号精确搜索
  - 支持按项目名称模糊搜索
  - 支持按客户名称搜索
  - 支持组合搜索（项目编号+项目名称+客户名称）
  - 搜索结果高亮显示
- ✅ **项目筛选**
  - 项目负责人筛选（下拉选择，支持搜索）
  - 商务经理筛选（下拉选择，支持搜索）
  - 服务类型筛选（结果优化、过程优化、精细化审图、全过程设计咨询）
  - 创建时间筛选（日期范围选择器）
  - 项目状态筛选（多选）
  - 筛选条件保存（本地存储，下次自动恢复）
- ✅ **数据导出**
  - 支持导出Excel格式（.xlsx）
  - 导出字段：项目编号、项目名称、客户名称、服务类型、项目负责人、商务经理、项目状态、创建时间、项目地址、项目业态等
  - 支持按当前筛选条件导出
  - 导出进度提示
- ✅ **项目接收**
  - **功能说明**：项目负责人接收从商机管理模块（立项）移交过来的项目
  - **操作流程**：
    1. 项目负责人登录系统，查看"待接收"状态的项目列表
    2. 点击"接收项目"按钮
    3. 系统自动更新项目状态为"配置中"
    4. 系统自动分配项目负责人为当前用户
    5. 系统发送通知给商务经理，告知项目已被接收
  - **业务规则**：
    - 只有项目负责人角色的用户才能接收项目
    - 项目状态必须为"待接收"才能接收（商务经理完成立项后，项目自动进入"待接收"状态）
    - 接收后项目状态自动更新为"配置中"
    - 接收时间自动记录
- ✅ **项目创建**
  - **功能说明**：项目负责人创建新项目或完善从商机管理模块（立项）移交过来的项目信息
  - **基本信息录入**：
    - 项目名称（必填，最大长度200字符）
    - 项目别名（可选，补充性内容，用于内部称呼，最大长度200字符）
    - 项目描述（可选，补充性内容，文本域，支持富文本）
    - 子公司选择（必填，下拉选择：四川维海、重庆维海、西安维海、禾间成都、宏天升荣）
  - **项目信息录入**：
    - 项目地址（必填，省市区三级联动选择+详细地址录入）
    - 项目业态（必填，下拉选择：住宅、综合体、商业、写字楼、学校、医院、工业厂房、市政、其他）
    - 图纸阶段（必填，下拉选择：施工图未审图、施工图已审图、初设阶段、扩初阶段、详规阶段、施工阶段）
    - 建筑面积（必填，数值输入，单位：平方米，支持小数点后2位）
    - 地上面积（必填，数值输入，单位：平方米）
    - 地下面积（必填，数值输入，单位：平方米）
    - 建筑高度（必填，数值输入，单位：米）
    - 地上层数（必填，整数输入）
    - 地下层数（必填，整数输入）
    - 结构形式（必填，下拉选择：剪力墙结构、框架结构、钢结构、其他）
    - 项目规模分批次录入（必填，JSON格式，支持多批次）
    - 服务范围（必填，文本输入）
    - 甲方特殊要求（可选，说明性内容，文本域）
    - 技术难点说明（可选，说明性内容，文本域）
    - 项目风险预判（可选，说明性内容，文本域）
  - **服务类型选择**：
    - 服务类型（必填，下拉选择：结果优化、过程优化、精细化审图、全过程设计咨询）
    - 服务专业（必填，多选，至少选择一个专业：建筑、结构、给排水、电气、暖通、其他）
    - 服务专业选择后，系统自动显示该服务类型对应的成果文件类型
  - **客户信息关联**：
    - 客户选择（必填，支持搜索选择已有客户，或快速创建新客户）
    - 客户信息自动带出（客户名称、统一信用代码、联系方式等）
    - 支持从客户管理模块选择客户
  - **设计单位信息录入**：
    - 设计单位名称（可选，文本输入）
    - 设计单位统一信用代码（可选，文本输入）
    - 设计单位项目负责人（可选，文本输入）
    - 设计单位项目负责人联系电话（可选，文本输入）
    - 设计单位项目负责人邮箱（可选，邮箱格式验证）
  - **项目团队初步分配**：
    - 商务经理（必填，从用户列表选择，需具有商务经理角色）
    - 项目负责人（必填，默认为当前登录用户，可从用户列表选择，需具有项目负责人角色）
    - 系统自动验证用户角色权限
  - **项目编号生成**：
    - 项目编号自动生成（格式：VIH-YYYY-NNN，YYYY为年份，NNN为序号）
    - 项目编号唯一性校验
    - 支持手动修改项目编号（需管理员权限）
  - **保存规则**：
    - 基本信息必填项校验
    - 项目名称唯一性校验（同一子公司内）
    - 保存成功后，项目状态更新为"配置中"
    - 保存失败时，显示具体错误信息

##### 4.1.2 项目信息完善
**功能说明**：项目负责人完善项目详细信息，包括补充项目信息、查看项目详情、编辑项目信息等。

**详细功能**：
- ✅ **项目信息补充完善**
  - **功能说明**：补充完善项目创建时未填写完整的信息
  - **可补充的信息**：
    - 项目详细信息（项目地址、项目业态、图纸阶段、建筑面积等）
    - 客户详细信息（客户联系人、联系方式等）
    - 设计单位详细信息（设计单位联系人、联系方式等）
    - 项目特殊要求（甲方特殊要求、技术难点、项目风险等）
  - **操作流程**：
    1. 进入项目详情页面
    2. 点击"完善信息"按钮
    3. 填写或修改项目信息
    4. 保存后，系统自动更新项目信息
  - **业务规则**：
    - 只有项目负责人或管理员可以完善项目信息
    - 项目状态为"配置中"或"待开工"时可以完善信息
    - 信息完善后，系统自动记录更新时间
- ✅ **项目详情查看**
  - **功能说明**：查看项目的完整信息，包括基本信息、项目信息、服务信息、客户信息、设计单位信息、项目团队信息、项目流程状态、项目统计信息等
  - **基本信息展示**：
    - 项目编号、项目名称、项目别名、项目描述
    - 子公司、项目状态、创建时间、更新时间
    - 创建人、项目负责人、商务经理
  - **项目信息展示**：
    - 项目地址、项目业态、图纸阶段
    - 建筑面积、地上面积、地下面积、建筑高度
    - 地上层数、地下层数、结构形式
    - 项目规模分批次信息（表格展示）
    - 服务范围、甲方特殊要求、技术难点、项目风险
  - **服务信息展示**：
    - 服务类型、服务专业列表
    - 服务专业对应的成果文件类型
  - **客户信息展示**：
    - 客户名称、统一信用代码、客户类型、客户等级
    - 客户联系人、联系方式、客户地址
    - 客户法律风险信息（司法案件数量、被执行人数量等）
    - 快速跳转到客户详情页面
  - **设计单位信息展示**：
    - 设计单位名称、统一信用代码
    - 设计单位项目负责人、联系方式
  - **项目团队信息展示**：
    - 项目负责人信息（姓名、部门、职位、联系方式）
    - 商务经理信息（姓名、部门、职位、联系方式）
    - 团队成员列表（我公司、甲方、设计方）
    - 团队成员角色和权限展示
    - 快速跳转到团队成员详情
  - **项目流程状态展示**：
    - 当前流程步骤（等待资料上传、资料预审、开工通知、意见编制、内部审核、待推送、报告已推送）
    - 流程步骤开始时间、截止时间
    - 流程进度条展示
    - 流程历史记录（时间线展示）
  - **项目统计信息展示**：
    - 项目任务统计（待处理、进行中、已完成）
    - 项目意见统计（总意见数、已回复、待回复）
    - 项目交付统计（已交付、待交付）
    - 项目产值统计（累计产值、确认产值）
  - **权限控制**：
    - 项目团队成员可以查看项目详情
    - 非项目团队成员需要申请权限才能查看
  - **项目流程操作**（✅ 已实现）：
    - 项目接收操作（待接收状态的项目）
    - 项目流程步骤操作（等待资料上传、资料预审、开工通知、意见编制、内部审核、待推送、报告已推送）
    - 项目状态流转操作（配置中、待开工、进行中、暂停、已完工）
    - 项目完成操作（项目完工确认）
    - 项目归档操作（跳转至档案管理模块）
  - **项目任务管理**（✅ 已实现）：
    - 项目任务列表展示（按任务类型分类）
    - 任务完成情况统计（待处理、进行中、已完成）
    - 任务操作（完成任务、取消任务、重新分配任务）
    - 任务自动创建（基于项目流程节点自动创建任务）
  - **项目图纸管理**（✅ 已实现）：
    - 图纸提交记录（优化前资料、优化后资料、精审前资料、精审后资料）
    - 图纸审核记录（预审记录、核图记录）
    - 图纸文件列表（支持在线预览、下载）
    - 图纸对比功能（优化前后对比、精审前后对比）
  - **项目意见管理**（✅ 已实现）：
    - 意见列表展示（按专业分类）
    - 意见统计（总意见数、已回复、待回复、已闭环）
    - 节省金额统计（结果优化、过程优化）
    - 意见详情查看（意见内容、回复记录、核图记录）
  - **项目会议记录**（✅ 已实现）：
    - 三方会议记录列表
    - 会议纪要查看
    - 会议决议查看
    - 会议附件下载
  - **项目设计方回复**（✅ 已实现）：
    - 设计方回复列表
    - 回复状态统计（同意、不同意、待定）
    - 回复详情查看
    - 我方复核记录
  - **项目里程碑**（✅ 已实现）：
    - 项目里程碑列表（按时间顺序）
    - 里程碑完成情况统计
    - 里程碑详情查看（里程碑名称、完成时间、完成说明）
  - **项目文档管理**（✅ 已实现）：
    - 项目文档列表（按类型分类）
    - 文档上传、下载、删除
    - 文档版本管理
    - 文档在线预览
- ✅ **项目信息编辑**
  - **功能说明**：编辑项目的基本信息、项目信息、服务信息
  - **可编辑的信息**：
    - 基本信息：项目名称、项目别名、项目描述、子公司
    - 项目信息：项目地址、项目业态、图纸阶段、建筑面积等所有项目信息字段
    - 服务信息：服务类型、服务专业
  - **不可编辑的信息**：
    - 项目编号（创建后不可修改，除非管理员权限）
    - 项目状态（由系统流程自动更新）
    - 创建时间、创建人（系统自动记录）
  - **编辑权限**：
    - 项目负责人可以编辑项目信息
    - 商务经理可以编辑基本信息和服务信息
    - 管理员可以编辑所有信息
  - **编辑历史记录**：
    - 系统自动记录每次编辑的字段变更
    - 记录编辑人、编辑时间、编辑内容
    - 支持查看编辑历史记录

##### 4.1.3 项目团队配置
**功能说明**：配置项目团队，包括分配项目负责人、商务经理，添加团队成员（我公司、甲方、设计方），设置团队成员角色和权限，管理团队成员，发送团队通知等。

**详细功能**：
- ✅ **项目负责人分配**
  - **功能说明**：分配或更换项目负责人
  - **操作流程**：
    1. 进入项目详情页面，点击"团队配置"
    2. 选择"项目负责人"标签
    3. 从用户列表中选择项目负责人（支持搜索）
    4. 系统自动验证用户是否具有项目负责人角色
    5. 确认后，系统更新项目负责人
    6. 系统发送通知给原项目负责人（如有）和新项目负责人
  - **业务规则**：
    - 项目负责人必须具有"项目负责人"角色
    - 一个项目只能有一个项目负责人
    - 更换项目负责人时，系统自动转移项目权限
    - 更换项目负责人需要管理员或当前项目负责人权限
- ✅ **商务经理分配**
  - **功能说明**：分配或更换商务经理
  - **操作流程**：
    1. 进入项目详情页面，点击"团队配置"
    2. 选择"商务经理"标签
    3. 从用户列表中选择商务经理（支持搜索）
    4. 系统自动验证用户是否具有商务经理角色
    5. 确认后，系统更新商务经理
  - **业务规则**：
    - 商务经理必须具有"商务经理"角色
    - 一个项目只能有一个商务经理
    - 商务经理可以管理多个项目
- ✅ **团队成员添加**
  - **功能说明**：添加项目团队成员，包括我公司成员、甲方成员、设计方成员
  - **我公司成员添加**：
    - 从用户列表中选择我公司员工（支持搜索）
    - 设置成员角色（专业负责人、专业工程师等）
    - 设置成员专业（建筑、结构、给排水、电气、暖通等）
    - 设置成员权限（查看、编辑、审核等）
  - **甲方成员添加**：
    - 输入甲方成员姓名、职位、部门
    - 输入联系方式（电话、邮箱）
    - 设置成员角色（甲方负责人、甲方项目负责人、甲方专业负责人等）
    - 系统自动创建甲方成员账号（如需要）
  - **设计方成员添加**：
    - 输入设计方成员姓名、职位、部门
    - 输入联系方式（电话、邮箱）
    - 设置成员角色（设计负责人、设计方项目负责人、设计方专业工程师等）
    - 设置成员专业（建筑、结构、给排水、电气、暖通等）
    - 系统自动创建设计方成员账号（如需要）
  - **批量添加**：
    - 支持Excel导入批量添加团队成员
    - Excel模板下载
    - 导入数据校验（格式校验、重复校验）
    - 导入结果反馈（成功数量、失败数量、失败原因）
- ✅ **团队成员角色设置**
  - **功能说明**：设置团队成员在项目中的角色和权限
  - **支持的角色**：
    - 项目负责人：项目总负责人，拥有项目最高权限
    - 商务经理：负责项目商务管理
    - 专业负责人：负责某个专业的审核和管理
    - 专业工程师：负责某个专业的意见编制
    - 设计负责人：设计方总负责人
    - 设计方专业工程师：设计方某个专业的工程师
    - 甲方负责人：甲方总负责人
    - 甲方项目负责人：甲方项目负责人
  - **角色权限设置**：
    - 查看权限：可以查看项目信息、意见、图纸等
    - 编辑权限：可以编辑项目信息、意见等
    - 审核权限：可以审核意见、图纸等
    - 交付权限：可以推送成果文件至收发管理、确认交付等
    - 系统根据角色自动分配默认权限
    - 支持自定义权限设置（管理员权限）
- ✅ **团队成员启用/禁用**
  - **功能说明**：启用或禁用项目团队成员
  - **启用成员**：
    - 成员被启用后，可以正常参与项目工作
    - 系统发送通知给被启用的成员
  - **禁用成员**：
    - 成员被禁用后，无法访问项目
    - 已分配的任务自动重新分配
    - 系统发送通知给被禁用的成员
  - **业务规则**：
    - 项目负责人和商务经理不能被禁用
    - 禁用成员需要项目负责人或管理员权限
- ✅ **团队成员管理**
  - **团队成员列表**：
    - 列表展示所有团队成员（分我公司、甲方、设计方三个标签）
    - 显示成员姓名、角色、专业、部门、联系方式、加入时间
    - 支持按角色、专业、部门筛选
    - 支持搜索成员姓名
  - **团队成员编辑**：
    - 编辑成员信息（姓名、职位、部门、联系方式）
    - 修改成员角色和专业
    - 调整成员权限
    - 只有项目负责人或管理员可以编辑成员信息
  - **团队成员删除**：
    - 删除团队成员（软删除，保留历史记录）
    - 删除前检查成员是否有未完成的任务
    - 删除后，成员无法访问项目
    - 项目负责人和商务经理不能被删除
- ✅ **团队通知**
  - **通知发送**：
    - 项目负责人或商务经理可以发送团队通知
    - 通知类型：项目通知、任务通知、会议通知、其他通知
    - 通知内容支持富文本编辑
    - 可以选择通知接收人（全部成员、指定成员、指定角色）
    - 支持附件上传
    - 支持紧急通知标记
  - **通知查看**：
    - 团队成员可以查看收到的通知列表
    - 通知列表显示：通知标题、发送人、发送时间、通知类型、是否已读
    - 支持按通知类型、发送人、时间范围筛选
    - 支持搜索通知标题和内容
    - 点击通知查看详情
  - **通知已读标记**：
    - 查看通知后自动标记为已读
    - 支持手动标记为已读/未读
    - 支持批量标记已读
    - 未读通知数量显示在通知图标上
- ✅ **团队变更记录**（✅ 已实现）
  - **功能说明**：自动记录项目团队的所有变更，包括成员添加、成员删除、角色变更、权限调整等
  - **变更记录内容**：
    - 变更类型（添加成员、删除成员、角色变更、权限调整）
    - 变更对象（成员姓名、角色、专业）
    - 变更前状态（原角色、原权限）
    - 变更后状态（新角色、新权限）
    - 变更操作人（操作人姓名、操作时间）
    - 变更原因（可选，说明变更原因）
  - **变更记录查看**：
    - 团队变更记录列表（按时间倒序）
    - 变更详情查看（变更前后对比）
    - 变更记录筛选（按变更类型、变更时间、操作人）
    - 变更记录搜索（搜索成员姓名、操作人）
  - **变更通知**：
    - 团队变更后，自动发送通知给相关成员
    - 通知内容：变更类型、变更对象、变更时间、操作人
    - 通知方式：系统通知、邮件通知（可选）
- ✅ **项目流程日志**（✅ 已实现）
  - **功能说明**：自动记录项目流程的所有操作，包括状态流转、流程步骤变更、关键操作等
  - **流程日志内容**：
    - 操作类型（状态流转、流程步骤变更、任务创建、任务完成等）
    - 操作对象（项目、任务、意见等）
    - 操作前状态（原状态、原流程步骤）
    - 操作后状态（新状态、新流程步骤）
    - 操作人（操作人姓名、操作时间）
    - 操作说明（操作原因、操作备注）
  - **流程日志查看**：
    - 流程日志列表（按时间倒序）
    - 日志详情查看（操作前后对比）
    - 日志筛选（按操作类型、操作时间、操作人）
    - 日志搜索（搜索操作说明、操作人）
  - **流程时间线展示**：
    - 项目流程时间线（可视化展示项目流程进展）
    - 时间线节点（关键流程节点、状态变更节点）
    - 时间线详情（节点时间、节点操作人、节点说明）

##### 4.1.4 生产任务准备
**功能说明**：创建和管理生产前的准备任务，包括任务工作台、任务创建、任务分配、任务跟踪等。

**详细功能**：
- ✅ **任务工作台（看板视图）**
  - **功能说明**：以看板形式展示任务，方便任务管理和跟踪
  - **看板列设置**：
    - 待处理：新创建或未开始的任务
    - 进行中：正在执行的任务
    - 已完成：已完成的任务
  - **任务卡片展示**：
    - 任务标题、任务类型、任务描述
    - 关联项目、负责人、分配角色
    - 截止时间、任务状态、优先级
    - 任务进度（如有）
  - **任务拖拽排序**：
    - 支持在不同列之间拖拽任务卡片
    - 拖拽后自动更新任务状态
    - 支持在同一列内调整任务顺序（优先级）
  - **任务筛选**：
    - 按项目筛选
    - 按负责人筛选
    - 按任务类型筛选
    - 按优先级筛选
    - 按截止时间筛选
  - **任务搜索**：
    - 支持搜索任务标题和描述
    - 搜索结果高亮显示
- ✅ **生产任务创建**
  - **功能说明**：创建生产前的准备任务
  - **任务标题录入**：
    - 任务标题（必填，最大长度200字符）
    - 任务标题应该简洁明了，能够清楚描述任务内容
  - **任务类型选择**：
    - 完善项目信息：完善项目基本信息、项目详细信息
    - 配置项目团队：添加团队成员、设置角色和权限
    - 优化任务：准备优化相关的任务
    - 审图任务：准备审图相关的任务
    - 其他：其他类型的任务
  - **任务描述录入**：
    - 任务描述（可选，文本域，支持富文本）
    - 可以详细说明任务要求、标准、注意事项等
  - **关联项目选择**：
    - 关联项目（必填，下拉选择，支持搜索）
    - 选择项目后，任务自动关联到该项目
    - 任务完成后，项目状态可能自动更新
  - **分配给用户选择**：
    - 分配给用户（必填，下拉选择，支持搜索）
    - 只能选择项目团队成员
    - 系统自动验证用户是否有权限执行该任务
  - **分配角色选择**：
    - 分配角色（可选，下拉选择）
    - 如果指定了角色，系统会自动分配给具有该角色的用户
    - 如果同时指定了用户和角色，以用户为准
  - **截止时间设置**：
    - 截止时间（可选，日期时间选择器）
    - 设置截止时间后，系统会在截止时间前提醒负责人
    - 超过截止时间未完成，任务标记为逾期
  - **任务标准设置**：
    - 任务标准（可选，文本域）
    - 可以设置任务完成的标准和要求
    - 用于任务验收和评估
  - **任务优先级设置**：
    - 优先级（可选，下拉选择：低、普通、高、紧急）
    - 优先级影响任务排序和提醒频率
  - **保存规则**：
    - 任务标题和关联项目为必填项
    - 任务创建后，状态自动设置为"待处理"
    - 系统自动发送通知给任务负责人
- ✅ **任务操作**
  - **任务完成**：
    - 任务负责人点击"完成任务"按钮
    - 填写任务完成说明（可选）
    - 上传任务成果文件（可选）
    - 确认后，任务状态更新为"已完成"
    - 系统自动发送通知给任务创建人
    - 如果任务有关联项目，可能触发项目状态更新
  - **任务取消**：
    - 任务创建人或项目负责人可以取消任务
    - 取消任务需要填写取消原因
    - 取消后，任务状态更新为"已取消"
    - 系统自动发送通知给任务负责人
  - **任务重新分配**：
    - 任务创建人或项目负责人可以重新分配任务
    - 选择新的负责人
    - 可以修改任务截止时间、优先级等
    - 重新分配后，系统自动发送通知给原负责人和新负责人
- ✅ **任务详情查看**
  - **任务信息展示**：
    - 任务标题、任务类型、任务描述
    - 任务状态、优先级、创建时间、更新时间
    - 截止时间、完成时间
    - 任务创建人、任务负责人
  - **关联项目信息**：
    - 关联项目名称、项目编号
    - 快速跳转到项目详情页面
  - **任务状态展示**：
    - 任务当前状态（待处理、进行中、已完成、已取消）
    - 任务状态变更历史（时间线展示）
  - **任务完成时间记录**：
    - 任务完成时间（如果已完成）
    - 任务完成说明
    - 任务成果文件列表
  - **任务评论**：
    - 团队成员可以对任务进行评论
    - 评论支持@提醒功能
    - 评论历史记录展示

##### 4.1.5 开工通知
**功能说明**：甲方项目负责人在图纸预审合格后，发布《开工通知》，项目正式进入生产计时阶段。

**详细功能**：
- ✅ **开工通知发布**
  - **功能说明**：甲方项目负责人发布《开工通知》，正式启动项目生产
  - **发布条件**：
    - 项目状态必须为"待开工通知"
    - 图纸预审必须已通过（在图纸管理模块完成）
    - 只有甲方项目负责人可以发布开工通知
  - **开工通知内容**：
    - 开工通知标题（必填，默认：项目名称+开工通知）
    - 开工通知正文（可选，文本域，支持富文本）
    - 开工日期（必填，日期选择器，默认为当前日期）
    - 项目基本信息（自动带出）
    - 关联项目（必填，自动关联当前项目）
  - **开工通知模板**：
    - 系统提供《开工通知》模板
    - 模板内容包括：项目基本信息、开工日期、项目要求等
    - 支持自定义模板内容
  - **发布流程**：
    1. 甲方项目负责人进入项目详情页面
    2. 点击"发布开工通知"按钮
    3. 填写开工通知内容
    4. 确认发布
    5. 系统自动更新项目状态为"进行中"
    6. 系统自动记录开工时间
    7. 系统自动发送通知给项目团队成员
- ✅ **项目正式进入生产计时**
  - **功能说明**：开工通知发布后，项目正式进入生产计时阶段
  - **计时规则**：
    - 开工时间以开工通知中的开工日期为准
    - 系统自动计算项目工期（从开工日期到预计完工日期）
    - 系统自动计算项目进度（基于任务完成情况）
  - **状态更新**：
    - 项目状态自动更新为"进行中"
    - 项目流程步骤自动更新为"意见编制"
    - 项目启动状态自动更新为"已开工"
  - **权限变更**：
    - 项目进入生产阶段后，某些信息不可再修改（如服务类型、服务专业等）
    - 项目团队成员权限自动激活
    - 项目负责人可以开始分配生产任务
- ✅ **开工通知时间记录**
  - **功能说明**：记录开工通知的发布时间和开工日期
  - **记录内容**：
    - 开工通知发布时间（系统时间）
    - 开工通知中的开工日期（用户选择）
    - 开工通知发布人（甲方项目负责人）
    - 开工通知内容
  - **历史记录**：
    - 系统自动保存开工通知历史记录
    - 支持查看历史开工通知
    - 如果项目暂停后重新开工，会记录多次开工通知
- ✅ **开工通知状态跟踪**
  - **功能说明**：跟踪开工通知的状态和项目生产进度
  - **状态展示**：
    - 开工通知状态（已发布、已确认、已生效）
    - 项目生产状态（进行中、暂停、已完成）
    - 项目进度（百分比显示）
  - **进度跟踪**：
    - 基于任务完成情况计算项目进度
    - 基于意见编制情况计算项目进度
    - 基于交付情况计算项目进度
    - 进度实时更新
  - **提醒功能**：
    - 如果项目进度滞后，系统自动提醒项目负责人
    - 如果项目接近完工，系统自动提醒项目负责人
    - 如果项目逾期，系统自动提醒项目负责人和管理层

##### 4.1.6 项目监控与数据统计（✅ 已实现）
**功能说明**：项目监控功能提供项目总览、数据统计、进度跟踪等功能，帮助管理层和项目负责人实时掌握项目状态和关键指标。

**详细功能**：
- ✅ **项目监控页面**（✅ 已实现）
  - **功能说明**：提供项目总览和关键指标监控
  - **关键指标展示**：
    - 项目总数统计（按状态分类：进行中、待开工、暂停、已完工）
    - 项目进度概览（平均完成度、进度分布）
    - 团队工作量统计（各专业工程师工作量）
    - 意见统计（总意见数、已回复、待回复）
    - 节省金额统计（结果优化、过程优化）
  - **项目列表展示**：
    - 项目列表（分页，每页默认20条）
    - 显示字段：项目编号、项目名称、客户名称、服务类型、项目负责人、商务经理、项目状态、进度、创建时间
    - 支持快速筛选和高级筛选
    - 支持按状态、服务类型、项目负责人筛选
  - **数据统计卡片**：
    - 项目总数卡片（按状态分类）
    - 进度统计卡片（平均完成度、进度分布）
    - 团队工作量卡片（各专业工作量分布）
    - 意见统计卡片（总意见数、回复率）
    - 节省金额卡片（累计节省金额、平均节省金额）
  - **权限控制**：
    - 根据用户权限显示不同范围的数据
    - 员工角色：仅显示自己参与的项目
    - 部门经理：显示部门所有项目
    - 高管：显示公司所有项目

- ✅ **项目任务工作台**（✅ 已实现）
  - **功能说明**：提供任务看板视图，方便任务管理和跟踪
  - **任务看板展示**：
    - 看板列设置：待处理、进行中、已完成
    - 任务卡片展示：任务标题、任务类型、关联项目、负责人、截止时间、任务状态、优先级
    - 支持任务拖拽排序（在不同列之间拖拽，自动更新状态）
    - 支持任务筛选（按项目、负责人、任务类型、优先级、截止时间）
    - 支持任务搜索（搜索任务标题和描述）
  - **任务统计**：
    - 待处理任务数统计
    - 进行中任务数统计
    - 已完成任务数统计
    - 逾期任务数统计
    - 任务完成率统计
  - **任务操作**：
    - 任务完成（填写完成说明、上传成果文件）
    - 任务取消（填写取消原因）
    - 任务重新分配（分配给其他用户或角色）
    - 任务延期（设置新的截止时间，需填写延期原因）

- ✅ **项目数据统计与分析**（✅ 已实现，集成在项目列表页面）
  - **项目进度统计**：
    - 项目总数统计（按状态分类）
    - 项目进度分布（按完成度：0-25%、25-50%、50-75%、75-100%）
    - 项目进度趋势（按时间维度：今日、本周、本月、本年）
    - 项目进度预警（延期项目、即将到期项目）
  - **团队工作量统计**：
    - 各专业工程师工作量统计（项目数、意见数、工时）
    - 各专业负责人工作量统计
    - 项目负责人工作量统计
    - 工作量分布分析（按时间、项目、专业）
  - **意见统计**：
    - 意见总数统计（按项目、专业、重要性分级）
    - 意见处理情况统计（待处理、处理中、已处理、已闭环）
    - 意见回复率统计（按项目、专业、设计方）
    - 意见处理时效统计（平均处理时间、最长处理时间）
  - **节省金额统计**（结果优化、过程优化）：
    - 节省金额汇总（按项目、专业、时间）
    - 节省金额趋势分析
    - 节省金额贡献排名（项目、专业、工程师）
  - **数据导出**：
    - 支持导出Excel格式（.xlsx）
    - 支持按当前筛选条件导出
    - 导出字段：项目编号、项目名称、客户名称、服务类型、项目负责人、商务经理、项目状态、进度、创建时间等

- ✅ **项目导入功能**（✅ 已实现，管理员专用）
  - **功能说明**：支持批量导入项目数据，用于数据迁移和历史数据导入
  - **导入方式**：
    - Excel文件导入（.xlsx格式）
    - Excel模板下载
    - 导入数据校验（格式校验、重复校验、必填字段校验）
    - 导入结果反馈（成功数量、失败数量、失败原因）
  - **导入字段**：
    - 项目基本信息（项目编号、项目名称、项目别名、项目描述、子公司）
    - 项目信息（项目地址、项目业态、图纸阶段、建筑面积等）
    - 服务信息（服务类型、服务专业）
    - 客户信息（客户名称、统一信用代码等）
    - 设计单位信息（设计单位名称、统一信用代码等）
    - 项目团队信息（项目负责人、商务经理）
  - **权限控制**：
    - 仅系统管理员可以使用导入功能
    - 导入前需确认操作
    - 导入记录自动保存（导入人、导入时间、导入结果）

#### 4.2 生产管理（按服务类型）

##### 4.2.1 结果优化业务流程
**功能列表**：
- ✅ **阶段1：项目启动与准备**
  - ✅ **项目移交**：商务经理创建项目，填写基本商务信息，移交至生产系统
  - ✅ **项目分析**：项目负责人接收项目，审阅合同与技术要求，完成项目创建与团队配置
  - ✅ **图纸申请**：项目负责人在图纸管理模块（4.3）向甲方项目负责人推送《图纸资料提供申请》
- ✅ **阶段2：图纸预审与项目开工**
  - ✅ **优化前资料**：在图纸管理模块（4.3）完成
    - 甲方项目负责人在图纸管理模块（4.3）上传"实施前"的全套图纸
    - 项目负责人/指定工程师在图纸管理模块（4.3）对图纸完整性、深度进行预审
    - 预审不合格：退回并说明原因，甲方重新上传
    - 预审合格：系统自动通知甲方项目负责人
    - 优化前资料归档管理
  - ✅ **开工通知**：甲方项目负责人在系统中发布《开工通知》，项目正式进入生产计时
- ✅ **阶段3：优化意见生产与内审**
  - ✅ **任务分发**：项目负责人向各专业工程师分发优化任务，明确任务标准、交付时间
  - ✅ **意见编制**：各专业工程师填报咨询意见
    - 系统触发"节省金额计算窗口"
    - 工程师填写优化前工程量(Q1)、优化后工程量(Q2)及单位
    - 系统辅助获取单价：从【综合单价库】搜索并选择材料/项目，自动带入优化前综合单价(P1)和优化后综合单价(P2)
    - 备选路径：若单价库中无此项，工程师可点击【申请单价】，任务推送至造价工程师，待其补充单价后系统自动回填并通知工程师继续
    - 系统自动计算：节省金额=(Q1×P1)-(Q2×P2)
    - 工程师确认后保存意见及关联的节省金额
    - 工程师完成所有意见填报后，提交生成的《专业咨询意见书》
  - ✅ **内部审核**：专业工程师提交→专业负责人校审→项目负责人审核
  - ✅ **推送至收发管理**：审核通过后，项目负责人将《设计优化报告》推送至收发管理模块，由收发管理模块完成交付任务
- ✅ **阶段4：意见回复与复核**
  - ✅ **设计方回复**：设计方各专业工程师对每条优化意见进行回复
    - 状态标记：【同意优化】、【不同意优化】（需填写原因）、【待定】（需填写原因）
  - ✅ **我方复核**：我方专业工程师重点对【不同意优化】和【待定】意见进行复核，填写复核意见
- ✅ **阶段5：三方会议与决议**
  - ✅ **会议发起**：项目负责人根据复核结果，向甲方推送《三方会议需求》
  - ✅ **会议召开**：甲方确认会议安排，三方召开会议，重点针对未达成一致的意见进行讨论
  - ✅ **会议纪要**：在系统中形成《三方会议纪要》，明确每条意见的最终处理方式
- ✅ **阶段6：图纸修改与核图**
  - ✅ **图纸修改**：设计方根据《三方会议纪要》修改图纸，在图纸管理模块（4.3）逐条记录每条意见的改图结果【已修改】/【未修改】
  - ✅ **优化后资料**：在图纸管理模块（4.3）完成
    - 设计方在图纸管理模块（4.3）上传"修改后"的全套图纸
    - 优化后资料与优化前资料对比
    - 优化后资料归档管理
  - ✅ **核图意见编制**：各专业工程师在图纸管理模块（4.3）逐条核对图纸修改情况，编制《专业核图意见》
  - ✅ **核图内审**：专业工程师提交→专业负责人校审→项目负责人审核
  - ✅ **核图结论**：项目负责人将《核图意见》推送至收发管理模块，由收发管理模块完成交付任务
    - 【核图未通过】：存在重要意见未落实，流程退回至"图纸修改"，通知设计方补充修改
    - 【核图通过】：进入下一环节
- ✅ **阶段7：成果确认与项目收尾**
  - ✅ **推送成果确认函至收发管理**：项目负责人将《优化成果确认函》推送至收发管理模块，由收发管理模块完成交付任务
  - ✅ **项目结算启动**：项目负责人根据确认函，启动结算流程（跳转到结算管理模块6.1进行具体结算操作）
  - ✅ **项目复盘**：项目团队进行线上复盘，总结技术与管理经验，更新知识库
  - ✅ **项目归档**：项目结算完成、复盘完成后，系统自动触发项目归档（项目状态更新为"已归档"），归档操作在档案管理模块（13.2）完成

##### 4.2.2 过程优化业务流程
**功能列表**：
- ✅ **第一阶段：项目启动与限额指标确定**（部分在生产准备模块完成）
  - ✅ **项目启动**：商务经理取得项目后，在系统中启动并移交项目（生产准备模块）
  - ✅ **限额指标**：在限额指标管理模块（4.11）完成
    - 项目负责人创建项目，分单体录入《优化限额指标表》（生产准备模块）
    - 结构专业：钢筋、混凝土
    - 停车效率：单车位指标
    - 其他专业指标
    - 限额指标作为优化意见编制的参考依据
  - ✅ **团队配置**：配置团队（含我公司、甲方、设计方）（生产准备模块）
  - ✅ **任务分发**：项目负责人根据优化节点计划，向各专业工程师分发任务（生产准备模块）
- ✅ **第二阶段：动态优化与循环反馈**
  - ✅ **意见编制与提交**：专业工程师分析图纸，填报咨询意见，生成《专业咨询意见书》并提交
  - ✅ **内部审核**：专业工程师→专业负责人校审→项目负责人审核
  - ✅ **推送至收发管理**：审核通过后，项目负责人将《过程优化报告》推送至收发管理模块，由收发管理模块完成交付任务
  - ✅ **设计方回复**：设计方项目负责人组织各专业工程师，逐条回复咨询意见（采纳/不采纳及原因），并提交
  - ✅ **过程跟踪与图纸修改**：
    - 我方跟踪设计方改图/绘图进度，并提供必要的技术澄清
    - 设计方根据采纳的意见进行后续绘图或修改，完成阶段性设计后，在图纸管理模块（4.3）上传修改后的图纸或下一阶段设计文件
  - ✅ **优化后资料**：在图纸管理模块（4.3）完成
    - 设计方在图纸管理模块（4.3）上传修改后的图纸或下一阶段设计文件
    - 优化后资料与限额指标对比
    - 优化后资料归档管理
    - 支持多阶段优化后资料管理
  - ✅ **核图与闭环**：
    - 各专业工程师在图纸管理模块（4.3）复核图纸修改情况，编制《核图意见》
    - 内部校审后，《核图意见》达到交付条件，自动推送至收发管理模块（5.2）进行交付
    - 【核图未通过】：若存在未落实的重要意见，流程退回至"图纸修改"，要求设计方补充修改，直至所有关键意见闭环
    - 【核图通过】：进入下一阶段优化或最终成果确认
  - ⚠️ **注**：第5步至第10步构成一个动态循环，随设计持续推进，确保优化工作始终与设计进度同步。项目负责人需定期编制《过程优化报告》
- ✅ **第三阶段：成果确认与项目收尾**
  - ✅ **推送成果确认函至收发管理**：当所有设计阶段完成，且优化意见均已闭环后，项目负责人将《最终成果确认函》推送至收发管理模块，由收发管理模块完成交付任务
  - ✅ **项目结算启动**：项目负责人启动结算流程（跳转到结算管理模块6.1进行具体结算操作）
  - ✅ **项目复盘**：项目团队进行线上复盘，更新公司指标库与知识库
  - ✅ **项目归档**：项目结算完成、复盘完成后，系统自动触发项目归档（项目状态更新为"已归档"），归档操作在档案管理模块（13.2）完成

##### 4.2.3 精细化审图业务流程
**功能列表**：
- ✅ **第一阶段：项目启动与图纸准备**（在生产准备模块完成）
  - ✅ **项目移交**：商务经理取得项目后，在系统中启动并移交项目
  - ✅ **项目创建与标准确认**：项目负责人接收项目，完成项目创建与团队配置
    - **审图要点标准确认**：
      - 【按甲方标准审图】：需上传甲方标准文件（字段：`专业名称`、`部位名称`、`审查要点`、`问题类别`），并将其设定为本项目的审查基准
      - 【非甲方标准审图】：需调用或上传我方标准文件（字段同上），作为审查基准
  - ✅ **图纸申请**：项目负责人在图纸管理模块（4.3）向甲方项目负责人推送《图纸资料提供申请》
  - ✅ **精审前资料**：在图纸管理模块（4.3）完成
    - 甲方在图纸管理模块（4.3）上传全套施工图
    - 我方在图纸管理模块（4.3）进行图纸预审（审查完整性、深度）
    - 预审不合格：退回甲方并说明原因
    - 预审合格：甲方项目负责人发布《开工通知》
    - 精审前资料归档管理
- ✅ **第二阶段：任务分发与多轮次审查（精细化审图核心）**
  - ✅ **任务分发**：项目负责人启动生产，明确自审、互审、会审工期
    - 系统根据审图流程，自动分阶段生成审查任务：
      - **第一阶段：专业自审**：任务自动分发至各专业工程师
      - **第二阶段：专业互审**：待自审完成后，任务自动分发至各专业负责人，由其安排交叉审查
      - **第三阶段：综合会审**：待互审完成后，任务自动提醒项目负责人组织合图审查
  - ✅ **专业自审**：各专业工程师依据确认的审查要点，对图纸进行第一轮详细审查，在系统中录入审图意见
  - ✅ **专业互审**：各专业负责人组织交叉审查，对自审意见进行复核、补充与完善
  - ✅ **综合会审**：项目负责人组织各专业负责人，重点审查各专业图纸间的"碰撞"与"矛盾"，并补充跨专业审图意见
  - ✅ **意见整合与报告生成**：项目负责人对"自审、互审、会审"三轮产生的所有意见进行最终审核、去重与整合，形成统一的《精细化审图报告》
- ✅ **第三阶段：报告出具与意见回复**
  - ✅ **推送至收发管理**：项目负责人将《精细化审图报告》推送至收发管理模块，由收发管理模块完成交付任务
  - ✅ **设计方回复**：设计方针对报告中的每条意见，在系统中逐条回复【同意修改】/【不同意修改（需附详细说明）】
- ✅ **第四阶段：修改跟踪与闭环核图**
  - ✅ **图纸修改与上传**：设计方根据采纳的意见修改图纸，完成后在图纸管理模块（4.3）上传"修改后"的图纸，并需逐条关联并标记每条审图意见的处理结果（已修改/未修改及原因）
  - ✅ **精审后资料**：在图纸管理模块（4.3）完成
    - 设计方在图纸管理模块（4.3）上传"修改后"的全套图纸
    - 精审后资料与精审前资料对比
    - 精审后资料归档管理
  - ✅ **核图与验证**：
    - 各专业工程师在图纸管理模块（4.3）收到修改版图纸后，逐条核对设计方的修改情况，在系统中填写核图意见
    - 《核图意见》达到交付条件，自动推送至收发管理模块（5.2）进行交付
    - 【核图未通过】：若存在重要问题未修改或修改不到位，项目负责人将问题清单退回给设计方，要求其继续修改并重新提交，流程跳回"图纸修改"
    - 【核图通过】：所有审图意见均已妥善闭环，进入收尾阶段
- ✅ **第五阶段：成果确认与归档**
  - ✅ **推送成果确认函至收发管理**：项目负责人将《审图成果确认函》推送至收发管理模块，由收发管理模块完成交付任务，并附上最终的审图报告与核图记录
  - ✅ **项目结算启动**：项目负责人可根据合同约定启动结算流程（跳转到结算管理模块6.1进行具体结算操作）
  - ✅ **项目关闭**：项目负责人在系统中关闭项目（项目状态更新为"已关闭"）
  - ✅ **项目归档**：项目关闭后，项目归档操作在档案管理模块（13.2）完成

##### 4.2.4 全过程设计咨询业务流程
**功能列表**：
- ✅ **第一阶段：项目启动与准备**（在生产准备模块完成）
  - ✅ **项目移交**：商务经理在系统中创建项目，填写基本商务信息，移交至生产系统
  - ✅ **项目分析**：项目负责人接收项目，审阅合同与技术要求，完成项目创建与团队配置
  - ✅ **图纸申请**：项目负责人在图纸管理模块（4.3）向甲方项目负责人推送《图纸资料提供申请》
- ✅ **第二阶段：与设计并行的动态咨询循环**
  - ✅ **接收设计过程资料**：设计方在图纸管理模块（4.3）每周提交最新的过程设计图纸、模型及计算书
  - ✅ **过程咨询后资料**：在图纸管理模块（4.3）完成
    - 设计方在图纸管理模块（4.3）每周提交最新的过程设计图纸、模型及计算书
    - 过程咨询后资料归档管理
    - 支持多周次过程咨询后资料管理
  - ✅ **同步实施优化与审图**：各专业工程师接收资料后，立即并行开展两项工作：
    - **成本优化分析**：针对新设计内容，进行多方案技术经济对比，提出更经济的优化建议
    - **精细化审图**：检查新设计内容的错、漏、碰、缺及合规性问题
    - 所有意见均在系统中录入，并关联至具体图纸与设计节点
  - ✅ **内部复核**：专业负责人对意见进行快速复核，确保专业性与准确性
  - ✅ **生成并提交《全过程咨询每周快报》**：
    - 项目负责人整合本周工作，编制《全过程咨询每周快报》
    - 内容需包括：
      - 本周设计进度对标
      - 本周主要优化建议及预估节省金额
      - 本周发现的图纸问题及重要性分级
      - 累计成本指标变动趋势
      - 待决策事项及风险提示
    - 达到交付条件，自动推送至收发管理模块（5.2）进行交付（固定时间点如每周五）
- ✅ **第三阶段：意见落实与下周循环**
  - ✅ **意见回复与图纸更新**：
    - 设计方根据《每周快报》中的意见进行回复与图纸修改
    - 在下一轮设计中将修改结果体现出来，并在图纸管理模块（4.3）下次提交资料时说明对意见的处理情况
  - ✅ **持续跟踪与闭环**：我方在接收下一周的设计资料时，会重点核查上周意见的落实情况，并在下一期《每周快报》中更新问题状态，形成管理闭环
  - ✅ **循环推进**：流程跳回"接收设计过程资料"，接收下一轮设计资料，开始新的咨询循环，直至所有设计工作完成
- ✅ **第四阶段：成果汇总与项目收尾**
  - ✅ **推送总结报告至收发管理**：设计全部完成后，项目负责人将《全过程咨询总结报告》推送至收发管理模块，由收发管理模块完成交付任务，汇总所有阶段的优化节省成果与审图问题闭环情况
  - ✅ **项目结算启动**：项目负责人启动结算流程（跳转到结算管理模块6.1进行具体结算操作）
  - ✅ **项目复盘**：项目团队进行线上复盘，总结技术与管理经验，更新知识库
  - ✅ **项目归档**：项目结算完成、复盘完成后，系统自动触发项目归档（项目状态更新为"已归档"），归档操作在档案管理模块（13.2）完成

#### 4.3 图纸管理
**功能说明**：统一管理项目全生命周期的所有图纸文件，包括批量上传、自动识别、文件管理、分类组织、对比分析等。不包含业务流程（申请、预审、审核等），只负责图纸文件本身的管理。

**核心价值**：支持批量上传大量图纸（一次可上传几百张），并自动识别图纸信息，避免手工逐张录入。如果不能实现批量上传与自动识别，手工操作将失去意义。

**注意**：不同服务类型对图纸管理的需求不同，需要根据服务类型区分图纸类型和管理方式。

**详细功能**：

##### 4.3.1 图纸批量上传与自动识别（核心功能）
**功能说明**：支持批量上传大量图纸文件（一次可上传几百张），并自动识别图纸信息，避免手工逐张录入。这是图纸管理模块的核心功能。

**详细功能**：

- ✅ **批量上传机制**
  - **上传方式**：
    - 单文件上传：一次上传一个文件（适用于补充上传）
    - 批量文件上传：一次选择多个文件（支持Ctrl/Cmd多选，最多500个文件）
    - 文件夹上传：上传整个文件夹（浏览器支持的情况下，自动包含子文件夹）
    - 拖拽上传：支持拖拽文件或文件夹到上传区域
    - 断点续传：支持大文件断点续传，网络中断后可继续上传
  - **支持的文件格式**：
    - 图纸文件：DWG、PDF、DWF、DXF等
    - 文档文件：PDF、Word、Excel等
    - 图片文件：JPG、PNG、TIFF等
    - 模型文件：RVT、IFC等（如需要）
  - **文件大小限制**：
    - 单个文件最大500MB
    - 批量上传总大小最大10GB（支持几百张图纸）
    - 超过限制时，提示用户并分批上传
  - **上传进度显示**：
    - 实时显示上传进度（总体进度和单个文件进度）
    - 显示上传速度、剩余时间
    - 支持暂停、继续、取消操作
    - 上传完成后显示成功/失败统计

- ✅ **自动识别图纸信息**（核心功能）
  - **识别方式**（按优先级）：
    - **文件名解析**（优先级最高，最快最准确）
      - 支持常见命名规则：`专业-图号-图纸名称.pdf`、`图号-专业-图纸名称.pdf`等
      - 支持自定义命名规则配置（在系统设置中配置）
      - 自动识别专业代码（如：建、结、水、电、暖等）
      - 自动识别图号（如：建施-01、结施-02等）
    - **PDF元数据提取**（优先级第二）
      - 提取标题、作者、主题等元数据
      - 提取创建时间、修改时间
    - **OCR文字识别**（优先级第三，最全面）
      - 识别图纸标题栏中的文字信息
      - 识别图纸编号、专业、图号、图纸名称
      - 识别设计单位、项目名称等信息
      - 支持中英文混合识别
      - 识别准确率要求：≥90%
    - **DWG文件解析**（针对DWG格式）
      - 提取图纸属性信息
      - 提取图层信息
      - 提取图块信息
      - 提取文字信息（图纸编号、专业、图号等）
  - **自动识别的字段**：
    - 图纸编号：自动从文件名或OCR识别中提取
    - 图纸名称：自动从文件名或OCR识别中提取
    - 专业分类：自动识别专业（建筑、结构、给排水、电气、暖通等）
    - 图号：自动识别图号（如：建施-01、结施-02等）
    - 图纸阶段：根据文件名或内容自动判断（施工图、初设、扩初等）
    - 图纸类型：根据服务类型和文件名自动判断（优化前/后、精审前/后等）
    - 设计单位：从OCR识别或元数据中提取
    - 设计日期：从PDF元数据或OCR识别中提取
  - **识别规则配置**（系统设置）：
    - 配置文件名解析规则（正则表达式）
    - 配置专业代码映射表（如：建→建筑、结→结构）
    - 配置图号格式规则
    - 配置OCR识别区域（标题栏位置）
    - 配置识别优先级（文件名>PDF元数据>OCR识别）

- ✅ **批量处理流程**
  - **处理步骤**：
    1. 用户选择文件（支持多选、文件夹、拖拽）
    2. 系统显示文件列表预览（文件名、大小、格式）
    3. 用户确认上传，系统开始批量上传
    4. 上传过程中，系统后台自动识别每个文件的信息（异步处理）
    5. 识别完成后，显示识别结果预览
    6. 用户确认或修正识别结果
    7. 批量保存到数据库
  - **识别结果预览**：
    - 以表格形式展示所有文件的识别结果
    - 显示识别状态（成功/失败/需人工确认）
    - 显示识别出的字段（图纸编号、名称、专业、图号等）
    - 显示识别置信度（0-100%）
    - 支持批量编辑识别结果
    - 支持批量修正识别错误
    - 支持标记识别失败的文件，后续手工处理
  - **识别失败处理**：
    - 识别失败的文件单独列出
    - 提供手工录入界面
    - 支持重新识别
    - 支持从历史记录中复制相似文件的识别结果

- ✅ **图纸基本信息**
  - **必填字段**（自动识别或手工录入）：
    - 图纸名称（自动识别，可手工修正）
    - 关联项目（必填，自动关联当前项目）
    - 服务类型（必填，自动从项目获取：结果优化、过程优化、精细化审图、全过程设计咨询）
    - 图纸类型（必填，根据服务类型动态显示，自动识别）：
      - 结果优化：优化前图纸、优化后图纸
      - 过程优化：实施前图纸、优化后图纸（支持多阶段）
      - 精细化审图：精审前图纸、精审后图纸
      - 全过程设计咨询：过程咨询图纸（支持多周次）
  - **可选字段**（自动识别或手工录入）：
    - 图纸编号（自动识别）
    - 专业分类（自动识别：建筑、结构、给排水、电气、暖通等）
    - 图号（自动识别）
    - 图纸批次名称（可选，如：第一批次、第二批次、修改后图纸等）
    - 图纸批次说明（可选，说明本批次图纸的内容）
    - 图纸阶段（自动识别或手工选择：施工图未审图、施工图已审图、初设阶段、扩初阶段、详规阶段、施工阶段）
    - 设计单位（自动识别）
    - 设计日期（自动识别）
    - 图纸说明（可选，文本域）

##### 4.3.2 图纸文件管理
**功能说明**：管理已上传的图纸文件，包括文件列表、下载、删除、预览、版本管理等。

**详细功能**：

- ✅ **图纸文件列表**
  - 列表展示所有图纸文件（分页，每页默认50条）
  - 显示字段：文件名称、图纸编号、图纸名称、专业、图号、文件大小、文件类型、上传时间、上传人、关联项目、服务类型、关联批次、图纸类型、图纸阶段、识别状态
  - **筛选功能**：
    - 按项目筛选
    - 按服务类型筛选（结果优化、过程优化、精细化审图、全过程设计咨询）
    - 按批次筛选
    - 按专业筛选（建筑、结构、给排水、电气、暖通等）
    - 按文件类型筛选（PDF、DWG、图片等）
    - 按图纸类型筛选（根据服务类型动态显示）：
      - 结果优化：优化前图纸、优化后图纸
      - 过程优化：实施前图纸、优化后图纸（支持阶段筛选）
      - 精细化审图：精审前图纸、精审后图纸
      - 全过程设计咨询：过程咨询图纸（支持周次筛选）
    - 按图纸阶段筛选
    - 按识别状态筛选（识别成功、识别失败、需人工确认）
    - 按上传时间筛选
    - 按上传人筛选
  - **搜索功能**：
    - 支持搜索文件名称
    - 支持搜索图纸编号
    - 支持搜索图纸名称
    - 支持搜索图号
    - 支持组合搜索
  - **排序功能**：
    - 按文件名称排序
    - 按文件大小排序
    - 按上传时间排序
    - 按图纸编号排序
    - 按专业排序
  - **文件分组显示**：
    - 按项目分组
    - 按服务类型分组
    - 按批次分组
    - 按专业分组
    - 按图纸类型分组

- ✅ **图纸文件下载**
  - 支持单个文件下载
  - 支持批量文件下载（打包下载为ZIP）
  - 支持按批次下载
  - 支持按专业下载
  - 支持按图纸类型下载
  - 下载权限控制（只有项目团队成员可以下载）
  - 下载记录（记录下载人、下载时间）
  - 下载次数统计

- ✅ **图纸文件删除**
  - 支持删除图纸文件（需权限控制）
  - 只有项目负责人或管理员可以删除文件
  - 删除前需要确认
  - 删除后，文件进入回收站（软删除）
  - 支持恢复删除的文件
  - 删除记录（记录删除人、删除时间、删除原因）

- ✅ **图纸文件预览**
  - 支持在线预览图纸文件（PDF、图片格式）
  - 支持DWG文件在线预览（需要插件支持）
  - 预览页面支持缩放、旋转、标注等功能
  - 预览页面支持下载、打印功能
  - 预览页面显示图纸基本信息（编号、名称、专业、图号等）

- ✅ **图纸文件版本管理**
  - 支持图纸文件版本管理
  - 每次上传新版本，自动保存旧版本
  - 支持查看文件版本历史
  - 支持回退到指定版本
  - 版本对比功能（对比不同版本的差异）
  - 版本说明录入（记录每次版本更新的原因）

##### 4.3.3 图纸分类与组织
**功能说明**：根据服务类型、专业、批次等维度对图纸进行分类和组织。

**详细功能**：

- ✅ **自动分类**
  - **按专业分类**：
    - 建筑专业图纸
    - 结构专业图纸
    - 给排水专业图纸
    - 电气专业图纸
    - 暖通专业图纸
    - 其他专业图纸
  - **按图纸类型分类**（根据服务类型）：
    - 结果优化：优化前图纸、优化后图纸
    - 过程优化：实施前图纸、优化后图纸（按阶段分类）
    - 精细化审图：精审前图纸、精审后图纸
    - 全过程设计咨询：过程咨询图纸（按周次分类）
  - **按图纸阶段分类**：
    - 施工图未审图
    - 施工图已审图
    - 初设阶段
    - 扩初阶段
    - 详规阶段
    - 施工阶段
  - **按批次分类**：
    - 第一批次
    - 第二批次
    - 修改后图纸
    - 其他批次
  - **自定义分类规则**：
    - 支持在系统设置中配置自定义分类规则
    - 支持多维度组合分类

- ✅ **图纸组织管理**
  - **文件夹结构**：
    - 按项目组织：项目/服务类型/专业/图纸类型
    - 按批次组织：项目/批次/专业/图纸类型
    - 按时间组织：项目/上传日期/专业
  - **标签管理**：
    - 支持为图纸添加标签
    - 支持按标签筛选和查找
    - 支持批量添加标签
  - **图纸关联**：
    - 支持关联相关图纸（如：优化前图纸关联优化后图纸）
    - 支持关联意见（关联优化意见或审图意见）
    - 支持关联项目节点（全过程咨询）

##### 4.3.4 图纸对比管理
**功能说明**：根据服务类型提供不同的图纸对比功能。

**详细功能**：

- ✅ **结果优化图纸对比**
  - 优化前图纸与优化后图纸对比
  - 支持版本对比功能
  - 自动匹配同名图纸进行对比
  - 对比结果展示（差异标注、变更统计）

- ✅ **过程优化图纸对比**
  - 优化后图纸与限额指标对比
  - 支持多阶段图纸对比
  - 自动匹配同阶段图纸进行对比
  - 对比结果展示（指标对比、变更统计）

- ✅ **精细化审图图纸对比**
  - 精审前图纸与精审后图纸对比
  - 支持版本对比功能
  - 自动匹配同名图纸进行对比
  - 对比结果展示（修改标注、变更统计）

- ✅ **全过程设计咨询图纸对比**
  - 过程咨询图纸多周次对比
  - 支持周次间对比
  - 自动匹配同周次图纸进行对比
  - 对比结果展示（进度对比、变更统计）

##### 4.3.5 图纸统计与分析
**功能说明**：图纸统计与分析功能集成在图纸管理列表页面中，统计和分析图纸相关数据，根据服务类型提供不同的统计维度。统计功能在列表页顶部以统计卡片或图表形式展示，无需单独设计菜单。

**详细功能**：

- ✅ **图纸数量统计**
  - 按项目统计图纸数量
  - 按服务类型统计图纸数量
  - 按批次统计图纸数量
  - 按专业统计图纸数量
  - 按图纸类型统计图纸数量（根据服务类型区分）
  - 按图纸阶段统计图纸数量
  - 按时间统计图纸数量（今日、本周、本月、本年）

- ✅ **图纸上传情况统计**
  - 统计图纸上传次数
  - 统计图纸上传及时率
  - 统计图纸文件大小分布
  - 统计图纸文件类型分布
  - **按服务类型统计上传情况**：
    - 结果优化：优化前图纸、优化后图纸上传统计
    - 过程优化：各阶段优化后图纸上传统计
    - 精细化审图：精审前图纸、精审后图纸上传统计
    - 全过程设计咨询：各周次过程咨询图纸上传统计

- ✅ **图纸识别情况统计**
  - 统计识别成功率
  - 统计识别准确率
  - 统计各识别方式的成功率（文件名解析、PDF元数据、OCR、DWG解析）
  - 统计识别失败的文件数量
  - 统计需人工确认的文件数量

- ✅ **图纸对比统计**（根据服务类型）
  - **结果优化**：
    - 优化前图纸与优化后图纸对比统计
    - 图纸版本对比统计
  - **过程优化**：
    - 优化后图纸与限额指标对比统计
    - 多阶段图纸对比统计
  - **精细化审图**：
    - 精审前图纸与精审后图纸对比统计
    - 图纸版本对比统计
  - **全过程设计咨询**：
    - 多周次过程咨询图纸对比统计

- ✅ **图纸分析报表**
  - **⚠️ 报表统一管理说明**：图纸分析报表统一纳入"报表管理"模块（17.报表管理）进行集中管理，在报表管理模块中通过"模块报表 > 生产管理报表 > 图纸分析报表"访问
  - 图纸上传趋势分析（按服务类型）
  - 图纸文件大小分析
  - 图纸文件类型分析
  - 图纸识别准确率分析
  - 图纸对比分析（根据服务类型）
  - 支持导出分析报表（Excel、PDF）
  - **报表访问入口**：报表管理模块 > 模块报表 > 生产管理报表 > 图纸分析报表

**技术实现方案**：详见`docs/图纸批量上传与自动识别实现方案.md`


#### 4.4 意见管理（核心功能）
**功能说明**：意见管理是生产管理的核心功能，支持专业工程师创建、编辑、提交优化意见或审图意见，并自动计算节省金额（结果优化、过程优化）。意见管理贯穿整个生产流程，从意见创建、内部审核、设计方回复、三方会议到核图，形成完整的意见生命周期管理。

**详细功能**：

##### 4.4.1 意见创建
- ✅ **基本信息录入**
  - 意见标题录入（必填，最大长度200字符）
  - 专业分类选择（必填，下拉选择：建筑、结构、给排水、电气、暖通等）
  - 部位名称录入（必填，如：地下室、首层、标准层等）
  - 意见内容录入（必填，支持富文本编辑，最大长度5000字符）
  - 意见类型选择（必填，根据服务类型自动判断：优化意见、审图意见）
  - 重要性分级（必填，下拉选择：高、中、低）
- ✅ **关联信息设置**
  - 关联图纸选择（从图纸管理模块4.3选择，支持多选）
  - 关联设计节点选择（全过程设计咨询专用，选择设计阶段节点）
  - 关联限额指标（过程优化专用，关联限额指标管理模块4.11的指标）
  - 关联审图标准（精细化审图专用，关联标准管理模块17.1的标准）
- ✅ **意见模板**
  - 支持使用意见模板快速创建
  - 支持保存常用意见为模板
  - 支持从历史意见中复制创建

##### 4.4.2 节省金额计算（结果优化、过程优化专用）
- ✅ **工程量录入**
  - 优化前工程量(Q1)录入（必填，数值输入，支持小数点后2位）
  - 优化后工程量(Q2)录入（必填，数值输入，支持小数点后2位）
  - 单位选择（必填，下拉选择：m³、m²、m、t、kg、个等）
  - 工程量说明录入（可选，说明工程量的计算依据）
- ✅ **综合单价获取**
  - 综合单价库搜索与选择（从资源管理模块14.6搜索）
  - 材料/项目名称搜索（支持模糊搜索）
  - 专业分类筛选（自动根据当前专业筛选）
  - 优化前综合单价(P1)自动带入（从单价库获取）
  - 优化后综合单价(P2)自动带入（从单价库获取）
  - 单价单位自动匹配（确保单位一致）
- ✅ **单价申请功能**
  - 若单价库中无此项，点击【申请单价】按钮
  - 任务自动推送至造价工程师（系统通知）
  - 造价工程师在资源管理模块14.6补充单价
  - 系统自动回填单价并通知工程师继续
  - 申请状态跟踪（待处理、处理中、已完成）
- ✅ **节省金额自动计算**
  - 计算公式：节省金额 = (Q1 × P1) - (Q2 × P2)
  - 系统自动计算并显示结果
  - 支持手动调整计算结果（需填写调整原因）
  - 节省金额确认（工程师确认后保存）
  - 节省金额汇总（按项目、专业、意见汇总）

##### 4.4.3 意见提交
- ✅ **提交操作**
  - 专业工程师完成所有意见填报后，点击【提交】按钮
  - 系统自动生成《专业咨询意见书》（PDF格式）
  - 提交时间自动记录
  - 提交状态自动更新为"待审核"
  - 系统自动通知专业负责人进行校审
- ✅ **提交前检查**
  - 必填字段检查（标题、专业、部位、内容等）
  - 节省金额计算完整性检查（结果优化、过程优化）
  - 关联图纸检查（至少关联一张图纸）
  - 提交前预览《专业咨询意见书》

##### 4.4.4 意见列表管理
- ✅ **列表展示**
  - 意见列表展示（分页，每页默认20条）
  - 显示字段：意见编号、意见标题、专业、部位、重要性、节省金额、创建人、创建时间、回复状态、核图状态、关联项目
  - 支持列表视图和卡片视图切换
- ✅ **筛选功能**
  - 按项目筛选（下拉选择，支持搜索）
  - 按专业筛选（多选：建筑、结构、给排水、电气、暖通等）
  - 按重要性筛选（多选：高、中、低）
  - 按回复状态筛选（待回复、已回复、已闭环）
  - 按核图状态筛选（待核图、核图中、核图通过、核图未通过）
  - 按服务类型筛选（结果优化、过程优化、精细化审图、全过程设计咨询）
  - 按创建时间筛选（日期范围选择器）
  - 按创建人筛选（下拉选择，支持搜索）
- ✅ **搜索功能**
  - 支持搜索意见标题（模糊搜索）
  - 支持搜索意见内容（全文搜索）
  - 支持搜索意见编号（精确搜索）
  - 支持搜索部位名称（模糊搜索）
  - 支持组合搜索（标题+内容+编号）
  - 搜索结果高亮显示
- ✅ **排序功能**
  - 按创建时间排序（最新、最旧）
  - 按节省金额排序（从高到低、从低到高）
  - 按重要性排序（高、中、低）
  - 按回复时间排序
- ✅ **批量操作**
  - 批量导出意见（Excel格式）
  - 批量修改重要性
  - 批量关联图纸
  - 批量删除意见（需权限控制）

##### 4.4.5 意见详情查看
- ✅ **基本信息展示**
  - 意见编号、标题、专业、部位、重要性
  - 意见内容（支持富文本展示）
  - 创建人、创建时间
  - 最后修改人、最后修改时间
- ✅ **关联信息展示**
  - 关联图纸列表（从图纸管理模块4.3获取，支持在线预览）
  - 关联设计节点（全过程设计咨询）
  - 关联限额指标（过程优化）
  - 关联审图标准（精细化审图）
- ✅ **节省金额展示**（结果优化、过程优化）
  - 优化前工程量(Q1)、优化后工程量(Q2)
  - 优化前综合单价(P1)、优化后综合单价(P2)
  - 单位、节省金额
  - 节省金额计算过程展示
- ✅ **流程记录展示**
  - 内部审核记录（专业负责人校审、项目负责人审核）
  - 设计方回复记录（回复状态、回复内容、回复时间）
  - 三方会议记录（会议纪要、决议）
  - 核图记录（核图意见、核图结论、核图时间）
  - 修改记录（每次修改的变更内容、修改人、修改时间）
- ✅ **操作功能**
  - 编辑意见（需权限控制，已提交的意见需撤回后才能编辑）
  - 删除意见（需权限控制，软删除）
  - 复制意见（创建新意见）
  - 导出意见（PDF格式）
  - 打印意见

#### 4.5 内部审核管理
**说明**：综合单价库管理统一在资源管理模块（14.6）中管理，生产管理模块在创建意见时可调用资源管理模块中的综合单价库。
**功能说明**：内部审核管理用于管理意见的内部审核流程，包括专业负责人校审和项目负责人审核。审核流程确保意见的质量和准确性，审核通过后才能推送至收发管理或进入下一环节。

**详细功能**：

##### 4.5.1 审核流程
- ✅ **三级审核流程**
  - **第一级：专业工程师提交**
    - 专业工程师完成意见编制后提交
    - 提交状态自动更新为"待校审"
    - 系统自动通知专业负责人
  - **第二级：专业负责人校审**
    - 专业负责人收到通知后，对意见进行校审
    - 校审内容包括：意见内容准确性、技术合理性、节省金额计算正确性等
    - 校审通过：提交至项目负责人审核
    - 校审驳回：退回专业工程师修改，需填写驳回原因
  - **第三级：项目负责人审核**
    - 项目负责人收到通知后，对意见进行最终审核
    - 审核内容包括：意见完整性、专业协调性、整体质量等
    - 审核通过：意见状态更新为"审核通过"，可推送至收发管理或进入下一环节
    - 审核驳回：退回专业负责人或专业工程师修改，需填写驳回原因

##### 4.5.2 审核操作
- ✅ **审核通过**
  - 审核人点击【审核通过】按钮
  - 填写审核意见（可选，用于记录审核要点）
  - 审核时间自动记录
  - 审核状态自动更新
  - 系统自动通知下一级审核人或提交人
- ✅ **审核驳回**
  - 审核人点击【审核驳回】按钮
  - 填写驳回原因（必填，说明驳回的具体原因）
  - 选择退回对象（退回至专业负责人或专业工程师）
  - 审核时间自动记录
  - 审核状态自动更新为"已驳回"
  - 系统自动通知退回对象
- ✅ **审核意见录入**
  - 支持录入审核意见（文本域，支持富文本）
  - 支持上传审核附件（如：参考文件、标准规范等）
  - 审核意见保存后，提交人可查看
- ✅ **审核时间记录**
  - 自动记录审核开始时间
  - 自动记录审核完成时间
  - 自动计算审核耗时
  - 支持审核超时提醒（超过规定时间未审核，系统自动提醒）

##### 4.5.3 审核历史
- ✅ **审核记录列表**
  - 审核记录列表展示（分页，每页默认20条）
  - 显示字段：审核编号、意见编号、意见标题、审核人、审核级别、审核结果、审核时间、审核意见
  - 按审核结果筛选（通过、驳回）
  - 按审核级别筛选（校审、审核）
  - 按审核时间筛选
  - 按审核人筛选
- ✅ **审核详情查看**
  - 审核人信息（姓名、部门、角色）
  - 审核时间（开始时间、完成时间、耗时）
  - 审核结果（通过/驳回）
  - 审核意见（文本内容、附件）
  - 驳回原因（如驳回）
  - 退回对象（如驳回）
- ✅ **审核统计分析**（集成在审核历史列表页面中）
  - 审核通过率统计（按项目、专业、审核人）
  - 审核耗时统计（平均审核时间、最长审核时间）
  - 审核驳回原因统计（常见驳回原因分析）
  - 审核效率排名（审核人审核效率排名）

#### 4.7 设计方回复管理
**功能说明**：设计方回复管理用于管理设计方对优化意见或审图意见的回复，包括回复状态标记、回复内容录入、我方复核等。设计方回复是三方沟通的重要环节，直接影响后续的三方会议和图纸修改。

**详细功能**：

##### 4.7.1 意见回复
- ✅ **回复状态选择**
  - 设计方专业工程师对每条意见进行回复
  - 回复状态选择（必填）：
    - 【同意优化】/【同意修改】：表示设计方同意该意见，将进行修改
    - 【不同意优化】/【不同意修改】：表示设计方不同意该意见，需填写详细原因
    - 【待定】：表示设计方需要进一步研究，需填写待定原因
  - 回复状态自动更新意见的回复状态
- ✅ **回复内容录入**
  - 回复内容录入（文本域，支持富文本）
  - 对于【不同意优化】/【不同意修改】和【待定】状态，需填写详细原因（必填）
  - 支持上传回复附件（如：技术说明、计算书、参考文件等）
  - 回复内容保存后，我方工程师可查看
- ✅ **回复时间记录**
  - 回复时间自动记录（首次回复时间）
  - 最后修改时间自动记录（如修改回复内容）
  - 回复及时性统计（回复时间 vs 要求回复时间）

##### 4.7.2 回复列表
- ✅ **回复记录列表**
  - 回复记录列表展示（分页，每页默认20条）
  - 显示字段：意见编号、意见标题、专业、回复状态、回复人、回复时间、复核状态、关联项目
  - 按回复状态筛选（同意、不同意、待定）
  - 按复核状态筛选（待复核、已复核）
  - 按专业筛选
  - 按项目筛选
  - 按回复时间筛选
- ✅ **回复详情查看**
  - 意见基本信息（意见编号、标题、专业、内容）
  - 回复信息（回复状态、回复内容、回复人、回复时间、附件）
  - 复核信息（复核意见、复核人、复核时间）
  - 关联图纸（从图纸管理模块4.3获取）

##### 4.7.3 我方复核
- ✅ **复核对象**
  - 重点对【不同意优化】/【不同意修改】和【待定】意见进行复核
  - 系统自动筛选出需要复核的意见
  - 复核任务自动分配给专业工程师
- ✅ **复核意见录入**
  - 复核意见录入（文本域，支持富文本）
  - 复核结论选择（维持原意见、修改意见、撤回意见）
  - 支持上传复核附件
  - 复核意见保存后，项目负责人可查看
- ✅ **复核时间记录**
  - 复核时间自动记录
  - 复核及时性统计
  - 复核超时提醒

#### 4.8 三方会议管理
**功能说明**：三方会议管理用于管理甲方、设计方、我方的三方会议，包括会议发起、会议确认、会议纪要等。三方会议是解决意见分歧、达成一致的重要环节，会议决议直接影响后续的图纸修改和核图。

**详细功能**：

##### 4.8.1 会议发起
- ✅ **会议需求推送**
  - 项目负责人根据复核结果，向甲方推送《三方会议需求》
  - 会议需求内容录入（必填，说明会议目的、讨论议题等）
  - 会议时间建议（可选，建议会议时间）
  - 会议地点建议（可选，建议会议地点）
  - 参会人员建议（可选，建议参会人员）
  - 会议需求推送后，甲方可查看并确认
- ✅ **会议议题设置**
  - 关联需要讨论的意见（从意见管理模块4.4选择）
  - 自动筛选出【不同意优化】/【不同意修改】和【待定】意见
  - 支持手动添加其他议题
  - 议题优先级设置（高、中、低）

##### 4.8.2 会议确认
- ✅ **甲方确认会议安排**
  - 甲方收到会议需求后，可确认或调整会议安排
  - 会议时间确认（必填，确认最终会议时间）
  - 会议地点确认（必填，确认最终会议地点）
  - 参会人员确认（必填，确认参会人员名单）
  - 会议方式选择（现场会议、视频会议、电话会议）
- ✅ **会议通知发送**
  - 会议确认后，系统自动发送会议通知给所有参会人员
  - 通知方式：系统通知、邮件通知、短信通知（可选）
  - 通知内容：会议时间、地点、议题、参会人员等
  - 会议提醒（会议前1天、会议前1小时自动提醒）

##### 4.8.3 会议纪要
- ✅ **会议纪要创建**
  - 会议结束后，项目负责人创建会议纪要
  - 会议纪要标题录入（必填）
  - 会议基本信息录入（会议时间、地点、参会人员、会议方式）
- ✅ **会议内容录入**
  - 会议讨论内容录入（文本域，支持富文本）
  - 会议决议录入（必填，明确每条意见的最终处理方式）
  - 每条意见的处理方式选择：
    - 【同意优化】/【同意修改】：设计方同意修改
    - 【不同意优化】/【不同意修改】：设计方不同意，需说明原因
    - 【待定】：需要进一步研究，需说明后续安排
  - 支持上传会议附件（如：会议录音、会议PPT、会议照片等）
- ✅ **会议决议记录**
  - 会议决议自动关联到对应意见
  - 意见状态自动更新（根据会议决议）
  - 会议决议保存后，所有参会人员可查看
  - 会议决议作为后续图纸修改和核图的依据
- ✅ **会议时间记录**
  - 会议开始时间记录
  - 会议结束时间记录
  - 会议时长自动计算
- ✅ **参会人员记录**
  - 参会人员名单记录（姓名、单位、角色）
  - 参会人员签到（可选，现场签到或系统签到）
  - 参会人员确认（确认是否参会）

#### 4.9 核图管理
**功能说明**：核图管理用于管理图纸修改后的核图工作，包括核图意见编制、核图内审、核图结论等。核图是确保设计方按照意见修改图纸的重要环节，核图通过后才能进入成果确认阶段。

**详细功能**：

##### 4.9.1 核图意见编制
- ✅ **图纸修改情况核对**
  - 各专业工程师收到修改后的图纸（从图纸管理模块4.3获取）
  - 逐条核对图纸修改情况
  - 对比修改前图纸和修改后图纸（从图纸管理模块4.3的对比功能获取）
  - 核对每条意见的修改落实情况
- ✅ **核图意见录入**
  - 核图意见录入（文本域，支持富文本）
  - 修改情况确认（必填，选择：已修改、未修改、部分修改）
  - 未修改原因录入（如未修改，需填写原因）
  - 部分修改说明录入（如部分修改，需说明修改情况）
  - 支持上传核图附件（如：核图标注图、对比图等）
- ✅ **核图意见关联**
  - 核图意见自动关联到对应意见（从意见管理模块4.4获取）
  - 核图意见自动关联到对应图纸（从图纸管理模块4.3获取）
  - 核图意见自动关联到三方会议决议（从三方会议管理模块4.8获取）

##### 4.9.2 核图内审
- ✅ **三级审核流程**
  - **第一级：专业工程师提交**
    - 专业工程师完成核图意见编制后提交
    - 提交状态自动更新为"待校审"
    - 系统自动通知专业负责人
  - **第二级：专业负责人校审**
    - 专业负责人收到通知后，对核图意见进行校审
    - 校审内容包括：核图意见准确性、修改情况确认准确性等
    - 校审通过：提交至项目负责人审核
    - 校审驳回：退回专业工程师修改，需填写驳回原因
  - **第三级：项目负责人审核**
    - 项目负责人收到通知后，对核图意见进行最终审核
    - 审核内容包括：核图意见完整性、修改落实情况等
    - 审核通过：核图意见状态更新为"审核通过"，可进入核图结论环节
    - 审核驳回：退回专业负责人或专业工程师修改，需填写驳回原因

##### 4.9.3 核图结论
- ✅ **核图结论选择**
  - 项目负责人根据核图意见，选择核图结论（必填）：
    - 【核图通过】：所有重要意见均已落实，图纸修改符合要求
    - 【核图未通过】：存在重要意见未落实或修改不到位
- ✅ **核图未通过处理**
  - 若选择【核图未通过】，需填写未通过原因（必填）
  - 列出未落实的意见清单
  - 流程自动退回至"图纸修改"环节
  - 系统自动通知设计方补充修改
  - 设计方修改后，重新进入核图环节
- ✅ **核图通过处理**
  - 若选择【核图通过】，核图意见达到交付条件
  - 系统自动推送《核图意见》至收发管理模块（5.2）进行交付
  - 核图意见状态更新为"已交付"
  - 项目进入成果确认阶段

#### 4.10 项目收尾
**功能说明**：项目收尾阶段包括项目结算启动、项目复盘和项目关闭。项目归档操作统一在档案管理模块（13.2）完成。项目收尾是项目生命周期的最后阶段，确保项目成果得到确认、结算完成、经验得到沉淀。

**详细功能**：

##### 4.10.1 项目结算启动（自动触发）
- ✅ **结算启动条件（自动检查）**
  - 项目状态为"已完工"
  - 所有意见已提交
  - 所有意见已审核通过
  - 所有成果文件已推送至收发管理
  - 成果确认函已得到客户确认（交付状态为"已确认"或"已反馈"）
- ✅ **自动触发结算**
  - 满足条件后，系统自动触发结算流程
  - 项目状态自动更新为"待结算"
  - 项目信息自动同步至结算管理模块
  - 自动创建结算记录
  - 通知结算负责人项目已进入结算阶段
- ✅ **结算操作**
  - 跳转到结算管理模块6.1进行具体结算操作
  - 结算完成后，项目状态更新为"已结算"
- ✅ **结算信息同步**
  - 项目基本信息同步至结算模块（项目编号、项目名称、客户名称等）
  - 节省金额信息同步至结算模块（结果优化、过程优化）
  - 交付成果信息同步至结算模块（报告、确认函等）

##### 4.10.2 项目复盘
- ✅ **复盘启动**
  - 项目负责人启动项目复盘
  - 复盘时间设置（建议在项目关闭前1周内完成）
  - 复盘参与人员设置（项目团队成员、管理层等）
- ✅ **技术经验总结**
  - 技术优化经验总结（结果优化、过程优化）
  - 审图经验总结（精细化审图）
  - 咨询经验总结（全过程设计咨询）
  - 技术难点与解决方案总结
  - 技术成果与创新点总结
- ✅ **管理经验总结**
  - 项目管理经验总结（进度管理、质量管理、成本管理等）
  - 团队协作经验总结
  - 客户沟通经验总结
  - 问题处理经验总结
  - 流程优化建议
- ✅ **知识库更新**
  - 技术经验自动推送至生产知识库管理模块（4.17）
  - 管理经验自动推送至生产知识库管理模块（4.17）
  - 典型案例自动推送至生产知识库管理模块（4.17）
  - 知识库分类与标签自动设置
- ✅ **指标库更新**（过程优化专用）
  - 限额指标数据自动推送至限额指标管理模块（4.11）
  - 指标库数据更新
  - 指标库统计分析

##### 4.10.3 项目关闭
- ✅ **关闭条件检查**
  - 项目结算已完成（结算状态为"已结算"）
  - 项目复盘已完成（复盘状态为"已完成"）
  - 所有交付成果已完成（交付状态为"已确认"或"已反馈"）
  - 系统自动检查关闭条件，不满足条件的项目不允许关闭
- ✅ **项目归档（自动触发）**
  - 项目结算完成、复盘完成后，系统自动触发项目归档
  - 项目状态自动更新为"已归档"
  - 归档时间自动记录
  - 归档记录自动同步至档案管理模块
  - 项目团队成员权限自动调整为只读
    - 提醒方式：系统通知、邮件通知（可选）
    - 提醒时间：项目关闭后立即提醒，7天、15天、30天再次提醒
  - **归档跳转**：
    - 项目关闭后，可点击【项目归档】按钮跳转至档案管理模块（13.1）进行归档操作
    - 归档操作统一在档案管理模块（13.1）中完成
  - **权限调整**：
    - 项目关闭后，项目团队成员权限保持正常权限（归档完成后才调整为只读权限）
    - 归档完成后，项目团队成员权限自动调整为只读权限
  - **统计更新**：
    - 项目统计信息自动更新（项目状态、项目数量等）
    - 归档统计待归档完成后更新

#### 4.11 限额指标管理（过程优化）
**功能说明**：限额指标管理用于管理过程优化服务类型中的限额指标，包括限额指标表录入、查看、更新等。限额指标是过程优化的参考依据，用于指导优化意见的编制和优化效果的评估。

**详细功能**：

##### 4.11.1 限额指标表录入
- ✅ **项目关联**
  - 限额指标表关联到具体项目（从项目列表选择）
  - 项目信息自动带入（项目编号、项目名称、客户名称等）
  - 服务类型自动判断为"过程优化"
- ✅ **分单体录入**
  - 支持分单体录入《优化限额指标表》
  - 单体名称录入（必填，如：1#楼、2#楼、商业楼等）
  - 单体信息录入（建筑面积、地上面积、地下面积等）
  - 支持多个单体同时录入
- ✅ **结构专业指标**
  - 钢筋指标录入（必填，单位：kg/m²，支持小数点后2位）
  - 混凝土指标录入（必填，单位：m³/m²，支持小数点后2位）
  - 指标说明录入（可选，说明指标的来源、适用范围等）
- ✅ **停车效率指标**
  - 单车位指标录入（必填，单位：m²/个，支持小数点后2位）
  - 停车效率说明录入（可选）
- ✅ **其他专业指标**
  - 给排水专业指标（可选）
  - 电气专业指标（可选）
  - 暖通专业指标（可选）
  - 其他专业指标（可选，自定义指标名称和数值）

##### 4.11.2 限额指标查看
- ✅ **限额指标列表**
  - 限额指标列表展示（分页，每页默认20条）
  - 显示字段：项目编号、项目名称、单体名称、钢筋指标、混凝土指标、单车位指标、创建时间、最后更新时间
  - 按项目筛选
  - 按单体筛选
  - 按创建时间筛选
- ✅ **限额指标详情**
  - 项目基本信息（项目编号、项目名称、客户名称等）
  - 单体信息（单体名称、建筑面积等）
  - 结构专业指标（钢筋、混凝土）
  - 停车效率指标（单车位指标）
  - 其他专业指标
  - 指标说明
  - 创建人、创建时间
  - 最后修改人、最后修改时间
- ✅ **指标变动趋势**
  - 指标历史变动记录（每次修改的记录）
  - 指标变动趋势图表（折线图）
  - 指标对比分析（不同单体、不同项目对比）

##### 4.11.3 限额指标更新
- ✅ **指标调整**
  - 支持调整限额指标（需权限控制）
  - 调整原因录入（必填，说明调整原因）
  - 调整时间自动记录
  - 调整历史自动保存
- ✅ **指标更新记录**
  - 每次指标更新自动记录
  - 记录字段：更新前数值、更新后数值、更新原因、更新人、更新时间
  - 支持查看指标更新历史
  - 支持回退到指定版本

#### 4.12 多轮次审查管理（精细化审图）
**功能说明**：多轮次审查管理用于管理精细化审图服务类型中的多轮次审查流程，包括专业自审、专业互审、综合会审三个阶段。多轮次审查确保审图意见的全面性和准确性，形成完整的《精细化审图报告》。审图标准管理已移至标准管理模块（17.1），生产管理模块在创建精细化审图项目时可调用标准管理模块中的审图标准。

**详细功能**：

##### 4.12.1 审查任务自动分发
- ✅ **系统自动分阶段生成审查任务**
  - 系统根据审图流程，自动分阶段生成审查任务
  - 任务自动关联到具体项目（项目编号、项目名称等）
  - 任务自动关联到审图标准（从标准管理模块17.1获取）
  - 任务自动关联到图纸（从图纸管理模块4.3获取）
- ✅ **第一阶段：专业自审任务自动分发**
  - 任务自动分发至各专业工程师
  - 任务内容包括：审查图纸、编制审图意见、提交自审意见
  - 任务截止时间自动设置（根据自审工期设置）
  - 系统自动通知专业工程师
- ✅ **第二阶段：专业互审任务自动分发**
  - 待自审完成后，任务自动分发至各专业负责人
  - 任务内容包括：交叉审查、复核自审意见、补充互审意见、提交互审意见
  - 任务截止时间自动设置（根据互审工期设置）
  - 系统自动通知专业负责人
- ✅ **第三阶段：综合会审任务自动提醒**
  - 待互审完成后，任务自动提醒项目负责人
  - 任务内容包括：组织综合会审、审查各专业图纸间的"碰撞"与"矛盾"、补充跨专业审图意见、整合所有意见
  - 任务截止时间自动设置（根据会审工期设置）
  - 系统自动通知项目负责人

##### 4.12.2 审查工期设置
- ✅ **自审工期设置**
  - 自审工期设置（必填，单位：天，默认7天）
  - 自审工期可针对不同专业设置不同工期
  - 自审工期可针对不同项目设置不同工期
- ✅ **互审工期设置**
  - 互审工期设置（必填，单位：天，默认5天）
  - 互审工期可针对不同专业设置不同工期
  - 互审工期可针对不同项目设置不同工期
- ✅ **会审工期设置**
  - 会审工期设置（必填，单位：天，默认3天）
  - 会审工期可针对不同项目设置不同工期

##### 4.12.3 审查进度跟踪
- ✅ **自审进度跟踪**
  - 自审任务列表展示（按专业、按工程师）
  - 自审进度统计（已完成、进行中、未开始）
  - 自审意见数量统计（按专业、按工程师）
  - 自审及时性统计（按时完成率）
- ✅ **互审进度跟踪**
  - 互审任务列表展示（按专业、按负责人）
  - 互审进度统计（已完成、进行中、未开始）
  - 互审意见数量统计（按专业、按负责人）
  - 互审及时性统计（按时完成率）
- ✅ **会审进度跟踪**
  - 会审任务列表展示（按项目）
  - 会审进度统计（已完成、进行中、未开始）
  - 会审意见数量统计（按项目）
  - 会审及时性统计（按时完成率）

##### 4.12.4 意见整合
- ✅ **意见整合操作**
  - 项目负责人对"自审、互审、会审"三轮产生的所有意见进行最终审核、去重与整合
  - 意见去重规则：相同专业、相同部位、相同审查要点的意见自动去重
  - 意见整合规则：相似意见自动合并，保留最重要的意见内容
  - 意见重要性重新分级（高、中、低）
- ✅ **形成统一的《精细化审图报告》**
  - 系统自动生成《精细化审图报告》（PDF格式）
  - 报告内容包括：项目基本信息、审图标准、审图意见汇总（按专业、按重要性）、审图结论
  - 报告支持导出（PDF、Word格式）
  - 报告达到交付条件，自动推送至收发管理模块（5.2）进行交付

#### 4.13 项目归档（已移至档案管理模块）
**功能说明**：项目归档功能已统一移至档案管理模块（13.2 项目档案），此处保留引用说明。

**成果文件流转说明**：
- **成果文件产生**：成果文件在生产管理、结算管理等业务过程中产生
- **推送至收发管理**：成果文件达到交付条件时，从生产管理、结算管理等模块推送至收发管理模块
- **交付任务执行**：由收发管理模块完成交付任务（邮件、快递、送达等方式），跟踪交付状态
- **推送至档案管理**：交付完成后（状态为"已确认"或"已反馈"），自动推送至档案管理模块进行归档
- **项目归档**：项目关闭后，项目归档操作在档案管理模块（13.2）完成
- **工作闭环**：形成"生产/结算 → 收发管理 → 档案管理"的完整工作闭环

#### 4.14 生产数据统计与分析（价值创造核心）
**功能说明**：生产数据统计与分析功能集成在项目列表页面中，通过数据统计和分析，为生产管理提供决策支持，实现数据驱动的生产管理。统计功能在列表页顶部以统计卡片或图表形式展示，无需单独设计菜单。

**⚠️ 报表统一管理说明**：
- **统计卡片**：项目列表页面的统计卡片（项目总数、进度统计、团队工作量等）保留在项目列表页面，用于快速查看
- **详细报表**：所有详细的生产管理报表（项目进度报表、意见统计报表、节省金额报表、团队工作量报表等）统一纳入"报表管理"模块（17.报表管理）进行集中管理
- **报表访问入口**：报表管理模块 > 模块报表 > 生产管理报表
- **报表导出**：所有报表的导出功能统一在报表管理模块完成，支持Excel、PDF、Word等格式

**详细功能**：

- ✅ **项目进度概览**
  - 项目总数统计（按状态分类：进行中、待开工、暂停、已完工）
  - 项目进度分布（按完成度：0-25%、25-50%、50-75%、75-100%）
  - 项目进度趋势（按时间维度：今日、本周、本月、本年）
  - 项目进度预警（延期项目、即将到期项目）
- ✅ **项目进度分析**
  - 各服务类型项目进度对比
  - 各专业项目进度对比
  - 项目负责人项目进度排名
  - 项目进度效率分析（计划时间 vs 实际时间）
- ✅ **进度报表**（⚠️ 统一纳入报表管理模块）
  - **报表统一管理说明**：所有进度报表（日报、周报、月报）统一纳入"报表管理"模块（17.报表管理）进行集中管理，在报表管理模块中通过"模块报表 > 生产管理报表 > 进度报表"访问
  - 项目进度日报
  - 项目进度周报
  - 项目进度月报
  - 支持导出Excel、PDF格式
  - **报表访问入口**：报表管理模块 > 模块报表 > 生产管理报表 > 进度报表

- ✅ **意见统计**
  - 意见总数统计（按项目、专业、重要性分级）
  - 意见处理情况统计（待处理、处理中、已处理、已闭环）
  - 意见回复率统计（按项目、专业、设计方）
  - 意见采纳率统计（同意优化/修改占比）
  - 意见处理时效统计（平均处理时间、最长处理时间）
- ✅ **节省金额统计**（结果优化、过程优化）
  - 节省金额汇总（按项目、专业、时间）
  - 节省金额趋势分析
  - 节省金额贡献排名（项目、专业、工程师）
  - 节省金额达成率分析（计划 vs 实际）
- ✅ **成果交付统计**
  - 交付成果数量统计（按类型、项目、时间）
  - 交付及时率统计
  - 交付质量统计（客户反馈、确认率）
  - 交付成果价值分析

- ✅ **团队工作量统计**
  - 各专业工程师工作量统计（项目数、意见数、工时）
  - 各专业负责人工作量统计
  - 项目负责人工作量统计
  - 工作量分布分析（按时间、项目、专业）
- ✅ **团队效率分析**
  - 人均产出统计（意见数/人、节省金额/人）
  - 工作效率排名
  - 工作质量排名（审核通过率、客户满意度）
  - 工作效率趋势分析
- ✅ **团队协作统计**
  - 协作频次统计（内部审核、三方会议、核图）
  - 协作效率分析（响应时间、处理时效）
  - 协作质量分析（一次通过率、返工率）

- ✅ **成本分析**
  - 项目成本统计（人力成本、时间成本）
  - 成本结构分析（按专业、阶段、项目）
  - 成本趋势分析
  - 成本控制目标达成率
- ✅ **效益分析**
  - 项目效益统计（节省金额、服务费收入）
  - 投入产出比分析
  - 效益贡献排名（项目、专业、工程师）
  - 效益趋势预测

- ✅ **质量指标统计**
  - 审核通过率统计（按项目、专业、工程师）
  - 一次通过率统计
  - 返工率统计
  - 客户满意度统计
- ✅ **质量问题分析**
  - 质量问题分类统计
  - 质量问题趋势分析
  - 质量问题原因分析
  - 质量改进建议

- ✅ **仪表盘展示**
  - 生产管理总览仪表盘（关键指标、趋势图表）
  - 项目进度仪表盘
  - 团队效率仪表盘
  - 成本效益仪表盘
- ✅ **图表展示**
  - 柱状图（进度、效率、成本对比）
  - 折线图（趋势分析）
  - 饼图（分布分析）
  - 热力图（工作量分布）
  - 甘特图（项目进度）

#### 4.15 生产预警与监控（风险控制）
**功能说明**：通过实时监控和预警机制，及时发现生产过程中的风险和问题，确保项目顺利推进。

**详细功能**：

##### 4.15.1 进度预警
- ✅ **进度延期预警**
  - 自动识别延期项目（计划完成时间 < 当前时间）
  - 延期天数计算
  - 延期风险等级评估（低、中、高、紧急）
  - 延期预警通知（项目负责人、管理层）
- ✅ **进度风险预警**
  - 识别进度风险项目（完成度 < 计划进度）
  - 进度偏差分析
  - 进度风险预测（基于历史数据）
  - 风险预警通知

##### 4.15.2 质量预警
- ✅ **质量风险预警**
  - 识别质量风险项目（审核通过率低、返工率高）
  - 质量问题预警
  - 质量趋势预警
  - 质量预警通知
- ✅ **审核预警**
  - 审核超时预警（审核时间超过规定时间）
  - 审核积压预警（待审核任务过多）
  - 审核质量预警（审核通过率异常）

##### 4.15.3 成本预警
- ✅ **成本超支预警**
  - 识别成本超支项目（实际成本 > 预算成本）
  - 成本偏差分析
  - 成本趋势预警
  - 成本预警通知
- ✅ **效益预警**
  - 效益不达标预警（实际效益 < 目标效益）
  - 效益趋势预警
  - 效益预警通知

##### 4.15.4 资源预警
- ✅ **资源紧张预警**
  - 识别资源紧张项目（工作量 > 团队能力）
  - 资源分配预警
  - 资源冲突预警
  - 资源预警通知
- ✅ **团队负荷预警**
  - 识别超负荷团队成员
  - 团队负荷分布分析
  - 负荷预警通知

##### 4.15.5 预警管理
- ✅ **预警规则配置**
  - 预警阈值设置（进度、质量、成本、资源）
  - 预警级别设置
  - 预警通知方式设置（系统通知、邮件、短信）
  - 预警接收人设置
- ✅ **预警处理**
  - 预警列表展示
  - 预警详情查看
  - 预警处理操作（确认、忽略、处理中）
  - 预警处理记录
- ✅ **预警统计**
  - 预警数量统计（按类型、级别、时间）
  - 预警处理情况统计
  - 预警趋势分析

#### 4.16 生产知识库管理（知识沉淀）
**功能说明**：建立生产知识库，沉淀技术经验、管理经验，形成组织智慧，支持知识复用和经验传承。

**详细功能**：

##### 4.16.1 知识库分类
- ✅ **技术知识库**
  - 优化技术知识（按专业分类：建筑、结构、给排水、电气、暖通）
  - 审图技术知识（按专业、问题类型分类）
  - 核图技术知识
  - 技术标准知识
- ✅ **管理知识库**
  - 项目管理经验
  - 团队协作经验
  - 客户沟通经验
  - 问题处理经验
- ✅ **案例知识库**
  - 成功案例库（按项目类型、服务类型分类）
  - 失败案例库（问题分析、经验教训）
  - 典型案例库（具有代表性的案例）

##### 4.16.2 知识录入与管理
- ✅ **知识创建**
  - 知识标题录入
  - 知识分类选择（技术、管理、案例）
  - 知识内容录入（支持富文本、图片、附件）
  - 知识标签设置
  - 关联项目选择（可选）
  - 知识来源录入（项目、工程师、经验总结）
- ✅ **知识审核**
  - 知识提交审核
  - 审核通过/驳回
  - 审核意见录入
  - 知识发布
- ✅ **知识编辑**
  - 知识内容编辑
  - 知识分类调整
  - 知识标签更新
  - 知识版本管理
- ✅ **知识删除**
  - 知识删除（软删除）
  - 删除原因录入
  - 删除记录

##### 4.16.3 知识检索与应用
- ✅ **知识搜索**
  - 关键词搜索（标题、内容、标签）
  - 分类筛选
  - 标签筛选
  - 高级搜索（组合条件）
- ✅ **知识推荐**
  - 基于项目类型推荐相关知识
  - 基于专业推荐相关知识
  - 基于问题类型推荐相关知识
  - 基于历史使用推荐相关知识
- ✅ **知识应用**
  - 知识查看（阅读量统计）
  - 知识收藏
  - 知识分享
  - 知识评价（有用/无用）
  - 知识应用记录（关联项目、应用效果）

##### 4.16.4 知识统计与分析
**功能说明**：知识统计与分析功能集成在知识库列表页面中，包括知识库统计和知识贡献统计，无需单独设计菜单。

- ✅ **知识库统计**（集成在知识库列表页面中）
  - 知识总数统计（按分类、标签）
  - 知识增长趋势
  - 知识使用统计（查看量、收藏量、应用量）
  - 知识质量统计（评价、评分）
- ✅ **知识贡献统计**（集成在知识库列表页面中）
  - 知识贡献排名（按创建数量、使用量）
  - 知识贡献趋势
  - 知识贡献奖励（积分、排名）

#### 4.17 生产任务智能分配（效率提升）
**功能说明**：通过智能算法，根据项目需求、团队能力、工作负荷等因素，自动分配生产任务，提升分配效率和合理性。

**详细功能**：

##### 4.17.1 任务分配规则配置
- ✅ **分配规则设置**
  - 专业匹配规则（专业工程师匹配对应专业任务）
  - 能力匹配规则（根据工程师能力等级匹配任务难度）
  - 负荷均衡规则（考虑工程师当前工作负荷）
  - 经验匹配规则（优先分配给有相关经验的工程师）
  - 地域匹配规则（考虑项目地域，优先本地工程师）
- ✅ **权重设置**
  - 各规则权重设置
  - 权重调整
  - 权重效果测试

##### 4.17.2 智能分配算法
- ✅ **自动分配**
  - 基于分配规则自动分配任务
  - 分配结果展示
  - 分配理由说明
  - 分配结果确认
- ✅ **推荐分配**
  - 推荐多个分配方案
  - 推荐理由说明
  - 人工选择最优方案
- ✅ **批量分配**
  - 批量任务分配
  - 批量分配规则设置
  - 批量分配结果展示

##### 4.17.3 分配结果管理
- ✅ **分配结果查看**
  - 分配任务列表
  - 分配详情查看
  - 分配历史记录
- ✅ **分配调整**
  - 手动调整分配结果
  - 重新分配
  - 分配调整原因录入
- ✅ **分配效果分析**
  - 分配效率分析（分配时间、分配准确度）
  - 分配满意度分析（工程师反馈）
  - 分配效果优化建议

#### 4.18 生产流程自动化（效率提升）
**功能说明**：通过流程自动化，减少人工操作，提升生产效率，降低出错率。

**详细功能**：

##### 4.18.1 流程规则配置
- ✅ **自动流转规则**
  - 状态自动流转规则（条件触发）
  - 任务自动分配规则
  - **通知自动发送规则**（✅ 已实现）：
    - 项目接收后，自动发送通知给商务经理
    - 项目配置完成后，自动发送通知给项目团队成员
    - 任务分配后，自动发送通知给任务负责人
    - 意见提交后，自动发送通知给审核人
    - 审核完成后，自动发送通知给提交人
    - 项目状态变更后，自动发送通知给项目负责人和管理层
  - **报表自动生成规则**（⏳ 待实现）：
    - 项目进度报表自动生成（每日、每周、每月）
    - 团队工作量报表自动生成（每周、每月）
    - 意见统计报表自动生成（每周、每月）
    - 节省金额报表自动生成（每月、每季度）
- ✅ **规则条件设置**
  - 条件类型（时间、状态、数据、事件）
  - 条件组合（AND、OR）
  - 条件测试

##### 4.18.2 自动化流程（✅ 已实现）
- ✅ **状态自动流转**（✅ 已实现）
  - **项目状态自动更新**（基于流程节点完成情况）：
    - 项目接收后，状态自动从"待接收"更新为"配置中"
    - 项目配置完成后，状态自动从"配置中"更新为"待开工"
    - 开工通知发布后，状态自动从"待开工"更新为"进行中"
    - 项目完工后，状态自动从"进行中"更新为"已完工"
    - 项目归档后，状态自动从"已完工"更新为"已归档"
  - **流程步骤自动流转**：
    - 图纸上传完成后，流程步骤自动从"等待资料上传"更新为"资料预审"
    - 图纸预审通过后，流程步骤自动从"资料预审"更新为"开工通知"
    - 开工通知发布后，流程步骤自动从"开工通知"更新为"意见编制"
    - 意见提交后，流程步骤自动从"意见编制"更新为"内部审核"
    - 审核通过后，流程步骤自动从"内部审核"更新为"待推送"
    - 成果推送后，流程步骤自动从"待推送"更新为"报告已推送"
  - **任务状态自动更新**（✅ 已实现）：
    - 任务创建后，状态自动设置为"待处理"
    - 任务开始后，状态自动更新为"进行中"
    - 任务完成后，状态自动更新为"已完成"
    - 任务取消后，状态自动更新为"已取消"
  - **任务自动创建**（✅ 已实现）：
    - 项目接收后，自动创建"完善项目信息"任务
    - 项目配置完成后，自动创建"配置项目团队"任务
    - 开工通知发布后，自动创建"意见编制"任务（按专业分发）
    - 意见提交后，自动创建"内部审核"任务（按审核级别分发）
    - 审核通过后，自动创建"推送成果"任务
  - 意见状态自动更新
- ✅ **任务自动分配**
  - 基于规则自动分配任务
  - 任务自动提醒
  - 任务自动跟踪
- ✅ **通知自动发送**
  - 状态变更通知
  - 任务分配通知
  - 审核提醒通知
  - 预警通知
- ✅ **报表自动生成**
  - 日报自动生成
  - 周报自动生成
  - 月报自动生成
  - 报表自动发送

##### 4.18.3 自动化监控
- ✅ **自动化执行监控**
  - 自动化任务执行记录
  - 执行成功/失败统计
  - 执行时间统计
  - 执行异常处理
- ✅ **自动化效果分析**
  - 自动化效率提升分析
  - 自动化成本节约分析
  - 自动化效果优化建议

#### 4.19 生产移动端支持（便捷性提升）
**功能说明**：提供移动端支持，方便项目团队随时随地查看项目信息、处理任务、提交意见等。

**详细功能**：

##### 4.19.1 移动端功能
- ✅ **项目查看**
  - 项目列表查看
  - 项目详情查看
  - 项目进度查看
  - 项目统计查看
- ✅ **任务处理**
  - 任务列表查看
  - 任务详情查看
  - 任务处理（提交、审核）
  - 任务状态更新
- ✅ **意见管理**
  - 意见列表查看
  - 意见创建（简化版）
  - 意见详情查看
  - 意见回复
- ✅ **通知查看**
  - 通知列表
  - 通知详情
  - 通知处理
- ✅ **数据查看**
  - 统计数据查看
  - 报表查看
  - 图表查看

##### 4.19.2 移动端优化
- ✅ **响应式设计**
  - 适配不同屏幕尺寸
  - 触摸操作优化
  - 加载速度优化
- ✅ **离线支持**
  - 关键数据离线缓存
  - 离线查看
  - 网络恢复后自动同步

---


---

### 5. 收发管理
- **状态**：✅ 已完成
- **完成度**：90%
- **说明**：统一管理公司所有对外文件的交付，包括项目相关文件和非项目文件。凡是对外的文件，均应纳入收发管理中，实现从交付准备、交付执行、交付跟踪到交付确认的完整流程。交付确认完成后，自动推送至档案管理模块进行归档管理。

**⚠️ 样式模板调用提示**：
- ✅ 所有模板必须调用 `{% static 'css/common.css' %}`
- ✅ 列表页面使用 `list-page-container` 布局和 `info-card` 组件
- ✅ 详情页面使用 `info-card`、`info-grid`、`info-item` 组件
- ✅ 表单页面使用 `form-card`、`form-section` 组件

**功能定位**：
- **统一管理平台**：公司所有对外文件的统一管理平台
- **文件类型**：
  - 项目相关文件：项目报告、确认函、快报、结算单等
  - 非项目文件：商务文件、合同文件、资质文件、其他对外文件等
- **全流程管理**：交付准备 → 交付执行 → 交付跟踪 → 交付确认的完整流程
- **归档管理**：交付确认完成后，自动推送至档案管理模块（13.档案管理）进行归档管理

**交付流程闭环**：
```
┌─────────────────────────────────────────────────────────────┐
│                    交付流程闭环                              │
├─────────────────────────────────────────────────────────────┤
│ 1. 交付准备阶段                                              │
│    ├── 文件准备（文件上传、文件审核、文件确认）              │
│    ├── 交付创建（交付单创建、收件人确认、交付方式选择）      │
│    └── 交付审核（内部审核、审批流程）                        │
│                                                             │
│ 2. 交付执行阶段                                              │
│    ├── 邮件发送（邮件发送、发送确认、发送失败处理）          │
│    ├── 快递寄送（快递下单、快递单号录入、快递费用记录）      │
│    └── 现场送达（送达人选择、送达时间记录、送达确认）        │
│                                                             │
│ 3. 交付跟踪阶段                                              │
│    ├── 状态跟踪（状态流转记录、状态变更通知）                │
│    ├── 物流跟踪（快递物流查询、位置更新、异常处理）          │
│    └── 签收跟踪（签收状态、签收时间、签收人记录）            │
│                                                             │
│ 4. 交付确认阶段                                              │
│    ├── 收件确认（收件人确认、收件时间记录）                  │
│    ├── 签收确认（签收人确认、签收凭证上传）                  │
│    ├── 成果确认（项目文件的甲方确认）                        │
│    ├── 客户反馈（反馈内容、反馈时间、反馈人）                │
│    ├── 满意度评价（满意度评分、评价内容）                    │
│    └── 确认完成（交付状态更新为"已确认"或"已反馈"）          │
│                                                             │
│ 5. 归档推送                                                  │
│    └── 自动推送至档案管理（交付确认完成后自动推送）          │
│                                                             │
│ 6. 流程闭环                                                  │
│    └── 交付完成（流程结束、数据统计、经验沉淀）              │
└─────────────────────────────────────────────────────────────┘
```

**交付状态流转**：
- **正常流程**：草稿 → 待审核 → 审核中 → 审核通过 → 待交付 → 交付中 → 已送达 → 已签收 → 已确认 → 已反馈 → 已完成
- **异常状态**：审核驳回、发送失败、拒收、逾期、已取消
- **归档说明**：交付状态为"已确认"或"已反馈"时，自动推送至档案管理模块进行归档，归档管理统一在档案管理模块中完成

#### 5.1 交付文件类型
**支持的交付类型**：

##### 5.1.1 项目文件类型
- ✅ **结果优化类**
  - 《专业咨询意见书》
  - 《设计优化报告》
  - 《专业核图意见》
  - 《核图意见书》
  - 《优化成果确认函》
- ✅ **过程优化类**
  - 《专业咨询意见书》
  - 《过程优化报告》
  - 《专业核图意见》
  - 《最终成果确认函》
- ✅ **精细化审图类**
  - 《精细化审图报告》
  - 《专业核图意见》
  - 《审图成果确认函》
- ✅ **全过程设计咨询类**
  - 《全过程咨询每周快报》
  - 《全过程咨询总结报告》
- ✅ **其他项目文件**
  - 三方会议纪要
  - 项目结算单
  - 其他项目成果文件

##### 5.1.2 非项目文件类型
- ✅ **商务文件**
  - 商务合同
  - 商务协议
  - 商务函件
  - 商务报价单
  - 其他商务文件
- ✅ **合同文件**
  - 服务合同
  - 采购合同
  - 合作协议
  - 其他合同文件
- ✅ **资质文件**
  - 公司资质证书
  - 人员资质证书
  - 项目资质证明
  - 其他资质文件
- ✅ **其他非项目文件**
  - 对外函件
  - 对外通知
  - 对外报告
  - 其他对外文件

#### 5.2 交付准备阶段
**功能说明**：交付准备阶段包括文件准备、交付创建、交付审核等环节，确保交付文件完整、准确，交付信息正确，交付流程合规。

##### 5.2.1 交付创建
**功能说明**：创建交付记录，包括项目文件交付和非项目文件交付。

**功能列表**：
- ✅ **交付记录列表**
  - 交付记录列表展示（分页）
  - 交付状态筛选（草稿、待审核、审核中、审核通过、待交付、交付中、已送达、已签收、已确认、已反馈、已归档、已完成、审核驳回、发送失败、拒收、逾期、已取消）
  - 交付方式筛选（邮件、快递、送达）
  - 优先级筛选（低、普通、高、紧急）
  - 文件类型筛选（项目文件、非项目文件）
  - 项目筛选（项目文件）
  - 客户筛选
  - 部门筛选（非项目文件）
  - 交付类型筛选（设计优化报告、过程优化报告、精细化审图报告、核图意见、每周快报、总结报告、成果确认函、商务文件、合同文件、资质文件等）
  - 交付单号搜索
  - 收件人信息搜索
  - 创建时间筛选
  - 计划交付时间筛选
- ✅ **项目文件交付创建**
  - 交付类型选择（设计优化报告、过程优化报告、精细化审图报告、核图意见、每周快报、总结报告、成果确认函、其他）
  - 交付标题录入（必填）
  - 交付说明录入（可选）
  - 关联项目选择（必填，自动关联服务类型）
  - 关联客户选择（自动从项目获取）
  - 交付方式选择（邮件、快递、送达）
  - 收件人信息录入（姓名、电话、邮箱、地址，必填）
  - **收件人自动填充**：
    - 甲方项目负责人（自动从项目团队获取）
    - 设计方项目负责人（自动从项目团队获取）
    - 设计方专业负责人（自动从项目团队获取）
  - 计划交付时间设置（必填）
  - 交付期限设置（必填）
  - 优先级设置（低、普通、高、紧急）
  - 交付单号自动生成（VIH-JF-{YYYYMMDD}-{序列号}）
- ✅ **非项目文件交付创建**
  - 文件类型选择（商务文件、合同文件、资质文件、其他）
  - 文件分类选择（必填，用于文件分类管理）
  - 交付标题录入（必填）
  - 交付说明录入（可选）
  - 关联部门选择（必填）
  - 关联客户选择（可选，如商务文件、合同文件等）
  - 交付方式选择（邮件、快递、送达）
  - 收件人信息录入（姓名、电话、邮箱、地址，必填）
  - 计划交付时间设置（必填）
  - 交付期限设置（必填）
  - 优先级设置（低、普通、高、紧急）
  - 文件上传（必填，支持多文件）
  - 交付单号自动生成（VIH-JF-{YYYYMMDD}-{序列号}）
- ✅ **交付记录详情查看**
  - 交付基本信息展示
  - 关联项目信息（项目文件）
  - 关联客户信息
  - 关联部门信息（非项目文件）
  - 收件人信息展示
  - 交付文件列表
  - 交付跟踪记录列表（状态流转、物流跟踪、签收记录）
  - 交付反馈列表（收件确认、客户反馈、满意度评价）
  - 交付状态时间线（完整的状态流转记录）
  - 交付审核记录（审核意见、审核人、审核时间）
- ✅ **交付记录编辑**
  - 交付信息编辑（仅草稿状态可编辑）
  - 收件人信息编辑（仅草稿状态可编辑）
  - 文件上传/删除（仅草稿状态可操作）
- ✅ **交付记录删除**
  - 交付记录删除（仅草稿状态可删除，需权限控制）
  - 删除确认（防止误删）
  - 删除记录（删除人、删除时间、删除原因）

##### 5.2.2 文件准备
**功能说明**：准备交付文件，包括文件上传、文件审核、文件确认等环节。

**功能列表**：
- ✅ **文件上传**
  - 文件上传（支持多文件，支持拖拽上传）
  - 文件名称自动获取或手动录入
  - 文件大小记录
  - 文件类型识别（PDF、Word、Excel、图片等）
  - 文件分类选择（项目文件/非项目文件）
  - 文件标签设置（可选，用于文件检索）
  - 文件版本管理（支持文件替换、版本历史）
  - 文件预览（支持在线预览）
- ✅ **文件审核**
  - 文件完整性检查（文件是否完整、格式是否正确）
  - 文件内容审核（文件内容是否符合要求）
  - 文件格式审核（文件格式是否符合标准）
  - 审核意见录入
  - 审核结果标记（通过/驳回）
  - 审核人记录
  - 审核时间记录
- ✅ **文件确认**
  - 文件确认操作（确认文件准备完成）
  - 确认人记录
  - 确认时间记录
  - 文件准备完成标记
- ✅ **文件列表管理**
  - 文件列表展示（分页）
  - 文件类型筛选（项目文件/非项目文件）
  - 文件分类筛选
  - 文件状态筛选（待审核、审核中、审核通过、审核驳回、已确认）
  - 文件搜索（文件名、标签、内容）
  - 关联项目/客户筛选
  - 文件下载（支持批量下载）
  - 文件删除（软删除，需权限控制）

##### 5.2.3 交付审核
**功能说明**：对交付记录进行内部审核，确保交付信息准确、交付流程合规。

**功能列表**：
- ✅ **交付审核列表**
  - 待审核交付记录列表
  - 审核中交付记录列表
  - 已审核交付记录列表
  - 审核状态筛选（待审核、审核中、审核通过、审核驳回）
  - 审核人筛选
  - 审核时间筛选
- ✅ **交付审核操作**
  - 审核意见录入（必填）
  - 审核结果选择（审核通过/审核驳回）
  - 审核人记录（自动记录当前用户）
  - 审核时间记录（自动记录当前时间）
  - 审核流程支持（支持多级审核）
  - 审核通知（审核结果通知创建人）
- ✅ **审核历史记录**
  - 审核历史列表展示
  - 审核意见查看
  - 审核人信息查看
  - 审核时间查看
  - 审核流程查看（多级审核流程）

##### 5.2.4 每周快报交付（全过程设计咨询）
**功能说明**：全过程设计咨询项目的每周快报自动交付功能。

**功能列表**：
- ✅ **每周快报交付创建**
  - 关联项目选择（自动识别为全过程设计咨询项目）
  - 快报周期设置（第X周）
  - 快报内容录入：
    - 本周设计进度对标
    - 本周主要优化建议及预估节省金额
    - 本周发现的图纸问题及重要性分级
    - 累计成本指标变动趋势
    - 待决策事项及风险提示
  - 关联意见列表（本周新增意见）
  - 固定时间点设置（如每周五）
  - 自动生成交付记录
- ✅ **每周快报交付列表**
  - 快报交付记录列表
  - 项目筛选
  - 周期筛选
  - 快报详情查看
  - 快报历史记录
- ✅ **每周快报自动交付**
  - 定时任务自动生成快报交付记录
  - 自动关联本周意见数据
  - 自动发送通知

#### 5.3 交付执行阶段
**功能说明**：交付执行阶段包括邮件发送、快递寄送、现场送达等交付方式的执行。

##### 5.3.1 邮件发送
**功能列表**：
- ✅ **邮件发送列表**
  - 待发送邮件列表（审核通过、待交付状态）
  - 发送中邮件列表
  - 已发送邮件列表
  - 发送失败邮件列表
  - 邮件状态筛选
- ✅ **邮件发送操作**
  - 邮件主题录入（必填）
  - 邮件正文录入（支持HTML，支持模板）
  - 收件人邮箱确认（必填）
  - 抄送邮箱录入（可选）
  - 密送邮箱录入（可选）
  - 邮件模板选择（可选）
  - 邮件附件添加（交付文件自动添加）
  - 邮件发送操作
  - 发送时间记录
  - 发送人记录
- ✅ **邮件发送确认**
  - 发送成功确认（邮件服务器返回成功）
  - 发送失败处理（失败原因记录、重试机制）
  - 发送状态更新（已发送、发送失败）
  - 发送通知（发送成功/失败通知创建人）
- ✅ **邮件发送历史**
  - 发送历史记录列表
  - 发送时间查看
  - 发送状态查看
  - 发送失败原因查看

##### 5.3.2 快递寄送
**功能列表**：
- ✅ **快递寄送列表**
  - 待寄送快递列表（审核通过、待交付状态）
  - 寄送中快递列表
  - 已寄送快递列表
  - 寄送失败快递列表
  - 快递状态筛选
- ✅ **快递寄送操作**
  - 快递公司选择（必填，如顺丰、圆通、中通等）
  - 快递单号录入（必填，寄送后录入）
  - 快递费用录入（必填）
  - 寄件人信息确认（自动填充公司信息）
  - 收件人信息确认（从交付记录获取）
  - 快递物品信息录入（交付文件清单）
  - 快递保价设置（可选）
  - 快递备注录入（可选）
  - 寄送时间记录
  - 寄送人记录
- ✅ **快递下单**
  - 快递API对接（支持主流快递公司API）
  - 快递下单操作（自动下单或手动下单）
  - 快递单号自动获取（API返回）
  - 快递费用自动计算（API返回）
  - 下单成功确认
  - 下单失败处理（失败原因记录、重试机制）
- ✅ **快递寄送确认**
  - 寄送成功确认（快递公司确认收件）
  - 寄送失败处理（失败原因记录、重试机制）
  - 寄送状态更新（已寄送、寄送失败）
  - 寄送通知（寄送成功/失败通知创建人）

##### 5.3.3 现场送达
**功能列表**：
- ✅ **现场送达列表**
  - 待送达列表（审核通过、待交付状态）
  - 送达中列表
  - 已送达列表
  - 送达失败列表
  - 送达状态筛选
- ✅ **现场送达操作**
  - 送达人选择（必填，从员工列表选择）
  - 送达时间设置（计划送达时间）
  - 送达地点确认（从交付记录获取）
  - 送达备注录入（可选）
  - 送达凭证上传（可选，如现场照片）
  - 送达时间记录（实际送达时间）
  - 送达人记录
- ✅ **现场送达确认**
  - 送达成功确认（送达人确认送达完成）
  - 送达失败处理（失败原因记录、重新安排送达）
  - 送达状态更新（已送达、送达失败）
  - 送达通知（送达成功/失败通知创建人）
  - 签收确认（现场签收，见5.4.2签收确认）

#### 5.4 交付跟踪阶段
**功能说明**：交付跟踪阶段包括状态跟踪、物流跟踪、签收跟踪等环节，实时掌握交付状态。

##### 5.4.1 状态跟踪
**功能列表**：
- ✅ **交付状态流转**
  - 状态流转记录（完整的状态流转历史）
  - 状态变更时间记录
  - 状态变更操作人记录
  - 状态变更原因记录
  - 状态流转通知（状态变更通知相关人员）
- ✅ **交付状态时间线**
  - 状态时间线展示（可视化展示状态流转过程）
  - 状态节点展示（每个状态节点的时间、操作人、操作原因）
  - 状态流转路径展示（完整的状态流转路径）
- ✅ **状态异常处理**
  - 异常状态识别（发送失败、拒收、逾期等）
  - 异常原因记录
  - 异常处理措施记录
  - 异常处理结果跟踪

##### 5.4.2 物流跟踪
**功能列表**：
- ✅ **快递物流跟踪**
  - 快递单号查询（支持主流快递公司）
  - 快递物流状态查询（API对接快递公司物流查询接口）
  - 快递位置跟踪（实时位置更新）
  - 快递状态更新（自动更新或手动更新）
  - 物流异常处理（物流异常记录、异常处理）
- ✅ **物流信息展示**
  - 物流轨迹展示（可视化展示物流轨迹）
  - 物流节点展示（收件、运输中、派送中、已签收等）
  - 物流时间展示（各节点时间）
  - 物流位置展示（各节点位置）

##### 5.4.3 签收跟踪
**功能列表**：
- ✅ **签收状态跟踪**
  - 签收状态查询（待签收、已签收、拒收）
  - 签收时间跟踪（签收时间记录）
  - 签收人跟踪（签收人信息记录）
  - 签收凭证跟踪（签收凭证上传记录）
  - 签收备注跟踪（签收备注记录）
- ✅ **签收信息展示**
  - 签收状态展示（实时展示签收状态）
  - 签收时间线展示（签收过程时间线）
  - 签收人信息展示（签收人详细信息）

#### 5.5 交付确认阶段
**功能说明**：交付确认阶段包括收件确认、签收确认、成果确认、客户反馈、满意度评价等环节，确保交付文件已成功送达并确认。交付确认完成后（状态为"已确认"或"已反馈"），自动推送至档案管理模块（13.档案管理）进行归档管理。

##### 5.5.1 收件确认
**功能列表**：
- ✅ **收件确认列表**
  - 待收件确认列表（已送达、已发送状态）
  - 已收件确认列表
  - 收件确认状态筛选
- ✅ **收件确认操作**
  - 收件确认操作（收件人确认收到文件）
  - 收件时间记录（实际收件时间）
  - 收件人记录（收件人姓名、联系方式）
  - 收件确认状态更新（已收件）
  - 收件确认通知（收件确认通知创建人）
- ✅ **收件异常处理**
  - 未收件处理（未收件原因记录、重新安排交付）
  - 收件异常记录（收件异常原因、处理措施）

##### 5.5.2 签收确认
**功能列表**：
- ✅ **签收确认列表**
  - 待签收确认列表（已送达状态）
  - 已签收确认列表
  - 签收确认状态筛选
- ✅ **签收确认操作**
  - 签收确认操作（签收人确认签收文件）
  - 签收时间记录（实际签收时间）
  - 签收人记录（签收人姓名、联系方式、签名）
  - 签收凭证上传（签收单、签收照片等）
  - 签收备注录入（可选）
  - 签收确认状态更新（已签收）
  - 签收确认通知（签收确认通知创建人）
- ✅ **拒收处理**
  - 拒收原因记录（拒收原因录入）
  - 拒收处理措施（重新安排交付、取消交付等）
  - 拒收状态更新（已拒收）
  - 拒收通知（拒收通知创建人）

##### 5.5.3 成果确认（项目文件）
**功能列表**：
- ✅ **成果确认函交付**
  - 确认函类型选择（优化成果确认函、审图成果确认函、最终成果确认函）
  - 确认函内容录入
  - 确认函文件上传
  - 关联项目选择
  - 关联报告文件（审图报告、核图记录等）
  - 提交交付
- ✅ **甲方确认**
  - 甲方在系统中确认优化成果/审图成果
  - 确认时间记录
  - 确认人记录
  - 确认意见录入
  - 确认状态更新（已确认、已拒绝）
  - 确认完成后自动推送至档案管理（确认后触发）
- ✅ **确认状态跟踪**
  - 确认状态展示（待确认、已确认、已拒绝）
  - 确认时间线展示
  - 确认历史记录

##### 5.5.4 客户反馈
**功能列表**：
- ✅ **客户反馈列表**
  - 待反馈列表（已签收、已确认状态）
  - 已反馈列表
  - 反馈状态筛选
- ✅ **客户反馈记录**
  - 反馈类型选择（已接收、已确认、有疑问、需要修改、其他）
  - 反馈内容录入（必填）
  - 反馈人录入（必填）
  - 反馈时间记录（自动记录）
  - 反馈附件上传（可选）
  - 反馈状态更新（已反馈）
  - 反馈通知（反馈通知创建人）
- ✅ **反馈处理**
  - 反馈回复（对客户反馈进行回复）
  - 反馈处理措施（问题处理、改进措施）
  - 反馈处理结果跟踪
  - 反馈处理完成标记

##### 5.5.5 满意度评价
**功能列表**：
- ✅ **满意度评价列表**
  - 待评价列表（已签收、已确认状态）
  - 已评价列表
  - 评价状态筛选
- ✅ **满意度评价记录**
  - 满意度评分（1-5星评分，必填）
  - 评价内容录入（可选）
  - 评价维度选择（文件质量、交付及时性、服务态度等）
  - 评价人录入（必填）
  - 评价时间记录（自动记录）
  - 评价状态更新（已评价）
  - 评价通知（评价通知创建人）
- ✅ **满意度统计分析**
  - 满意度评分统计（平均分、各分数段分布）
  - 满意度趋势分析（按时间维度）
  - 满意度维度分析（各维度评分对比）

##### 5.5.6 归档推送
**功能说明**：交付确认完成后（状态为"已确认"或"已反馈"），自动推送至档案管理模块（13.1项目档案管理）进行归档管理。这是交付文件的自动归档，是项目归档的一部分。归档管理统一在档案管理模块中完成。

**交付文件自动归档说明**：
- **归档触发条件**：交付状态为"已确认"或"已反馈"时自动触发归档推送
- **归档性质**：这是交付文件的自动归档，属于项目归档的一部分
- **归档关系**：
  - 交付文件自动归档：交付完成后立即自动归档，无需人工操作
  - 项目归档：项目关闭后统一归档项目所有文件，包括已自动归档的交付文件
  - 关系说明：交付文件自动归档是项目归档的一部分，项目归档时会自动收集已自动归档的交付文件，无需重复归档
- **归档位置**：归档管理统一在档案管理模块（13.1项目档案管理）中完成

**功能列表**：
- ✅ **自动归档触发**
  - 交付状态为"已确认"或"已反馈"时自动触发归档推送
  - 归档推送时间：交付完成后立即自动推送（无需等待）
  - 归档任务创建（自动创建归档任务）
  - 归档状态标记（交付状态自动更新为"已归档"）
- ✅ **归档推送内容**
  - 交付记录推送（推送交付记录至档案管理模块，包含交付单号、交付类型、交付时间、交付人、关联项目）
  - 交付文件推送（推送交付文件至档案管理模块）
  - 交付跟踪记录推送（推送交付跟踪记录）
  - 客户反馈推送（推送客户反馈信息）
  - 满意度评价推送（推送满意度评价信息）
  - 关联项目信息推送（项目编号、项目名称、客户名称）
- ✅ **归档推送跟踪**
  - 推送时间记录（自动记录推送时间）
  - 归档推送状态跟踪（推送成功/失败、推送时间）
  - 归档推送失败处理（推送失败时支持手动重试）
  - 归档推送记录（推送记录列表、推送记录详情）
  - 归档文件状态（已归档、归档中、归档失败）
  - 推送状态跟踪（成功/失败）
  - 推送失败处理（失败原因记录、重试机制）
  - 推送成功通知（推送成功通知创建人）

#### 5.6 交付预警与异常处理
**功能说明**：交付预警与异常处理功能，实时监控交付流程中的异常情况，及时预警和处理。

##### 5.8.1 交付预警
**功能列表**：
- ✅ **逾期预警**
  - 逾期交付记录列表（超过交付期限的交付记录）
  - 逾期天数计算（自动计算逾期天数）
  - 逾期提醒（邮件、短信、系统通知）
  - 逾期预警级别（一般、重要、紧急）
- ✅ **风险等级评估**
  - 风险等级自动计算（基于逾期天数、交付重要性等）
  - 风险等级展示（低风险、中风险、高风险）
  - 风险等级更新（实时更新风险等级）
- ✅ **预警列表**
  - 预警记录列表（所有预警记录）
  - 预警级别筛选（一般、重要、紧急）
  - 预警类型筛选（逾期、异常、失败等）
  - 预警处理（预警处理措施、处理结果）

##### 5.8.2 异常处理
**功能列表**：
- ✅ **异常识别**
  - 发送失败异常（邮件发送失败、快递寄送失败）
  - 物流异常（物流停滞、物流异常）
  - 签收异常（拒收、未签收）
  - 反馈异常（客户反馈问题、满意度低）
- ✅ **异常处理**
  - 异常原因分析（异常原因记录、分析）
  - 异常处理措施（重新发送、重新寄送、联系客户等）
  - 异常处理结果跟踪（处理结果记录、跟踪）
  - 异常处理完成标记（异常处理完成、状态更新）
- ✅ **异常统计**
  - 异常类型统计（各类型异常数量统计）
  - 异常趋势分析（异常趋势分析）
  - 异常处理效率统计（异常处理时间统计）

#### 5.7 交付统计
**功能说明**：交付统计功能集成在交付记录列表页面中，包括交付总数统计、交付状态分布统计、交付方式统计、文件统计、时间统计、项目文件交付统计、非项目文件交付统计、交付趋势分析、交付效率分析、客户满意度统计等统计信息，无需单独设计菜单。统计功能在列表页顶部以统计卡片或图表形式展示。

**统计维度**：
- ✅ **交付总数统计**（全部、项目文件、非项目文件）
- ✅ **交付状态分布统计**（各状态数量、占比）
- ✅ **交付方式统计**（邮件、快递、送达的数量、占比）
- ✅ **文件统计**（文件总数、总大小、文件类型分布）
- ✅ **时间统计**（今日、本周、本月、本年的交付数量）
- ✅ **交付效率统计**（平均交付时间、及时率、完成率）
- ✅ **客户满意度统计**（平均满意度、满意度分布、满意度趋势）
- ✅ **异常统计**（异常数量、异常类型分布、异常处理效率）

---

### 6. 结算管理
- **状态**：✅ 已完成（基础功能）
- **完成度**：70%
- **说明**：管理项目结算的全流程，包括结算创建、结算初审、初审回复、结算对账、争议解决、结算定案等环节，实现结算流程的规范化管理。

**⚠️ 样式模板调用提示**：
- ✅ 所有模板必须调用 `{% static 'css/common.css' %}`
- ✅ 列表页面使用 `list-page-container` 布局和 `info-card` 组件
- ✅ 详情页面使用 `info-card`、`info-grid`、`info-item` 组件
- ✅ 表单页面使用 `form-card`、`form-section` 组件

**结算流程**：
```
┌─────────────────────────────────────────────────────────────┐
│                    结算流程                                  │
├─────────────────────────────────────────────────────────────┤
│ 1. 结算创建                                                  │
│    ├── 结算单创建（关联项目、合同、结算明细项）              │
│    ├── 结算金额计算（节省金额、服务费、税额等）              │
│    └── 结算提交（提交至初审）                                │
│                                                             │
│ 2. 结算初审                                                  │
│    ├── 甲方初审（甲方对结算单进行初审）                      │
│    ├── 初审意见录入（初审意见、初审结果）                    │
│    └── 初审完成（初审通过或驳回）                            │
│                                                             │
│ 3. 初审回复                                                  │
│    ├── 初审意见查看（查看甲方初审意见）                      │
│    ├── 回复意见录入（对初审意见进行回复）                    │
│    └── 回复提交（提交回复意见）                              │
│                                                             │
│ 4. 结算对账                                                  │
│    ├── 对账准备（对账数据准备、对账人员安排）                │
│    ├── 对账执行（双方对账、对账结果确认）                    │
│    └── 对账完成（对账结果记录、对账完成确认）                │
│                                                             │
│ 5. 争议解决                                                  │
│    ├── 争议识别（识别结算争议点）                            │
│    ├── 争议协商（双方协商、争议处理）                        │
│    └── 争议解决（争议解决方案、争议解决确认）                │
│                                                             │
│ 6. 结算定案                                                  │
│    ├── 定案确认（结算金额最终确认）                          │
│    ├── 定案审批（定案审批流程）                              │
│    └── 定案完成（结算定案完成、结算状态更新）                │
└─────────────────────────────────────────────────────────────┘
```

**结算状态流转**：
- **正常流程**：草稿 → 已提交 → 初审中 → 初审完成 → 初审回复中 → 对账中 → 对账完成 → 争议处理中（如有争议）→ 争议已解决 → 定案中 → 定案完成
- **异常状态**：初审驳回、对账失败、争议未解决、定案驳回、已取消

#### 6.1 结算创建
**功能说明**：创建结算单，包括项目结算和合同结算，完成结算金额计算和结算明细项管理。

**功能列表**：
- ✅ **结算列表**
  - 结算列表展示（分页）
  - 结算状态筛选（草稿、已提交、初审中、初审完成、初审回复中、对账中、对账完成、争议处理中、争议已解决、定案中、定案完成、已取消）
  - 结算类型筛选（阶段结算、最终结算、合同结算）
  - 项目筛选（项目结算）
  - 合同筛选（合同结算）
  - 结算单号搜索
  - 结算日期筛选
- ✅ **项目结算创建**
  - 关联项目选择（仅显示状态为"已完工"的项目）
  - 关联合同选择（可选）
  - 结算类型选择（阶段结算、最终结算）
  - 结算周期设置（开始日期、结束日期）
  - 结算日期设置（默认当前日期）
  - 结算明细项添加（从生产管理模块的Opinion选择）
  - 结算单号自动生成（VIH-JS-{项目编号}-{序列号}）
  - 节省金额自动汇总（从明细项计算）
  - 服务费率自动匹配（从合同费率表匹配）
  - 服务费金额自动计算（取费基数 × 服务费率）
  - 结算总金额自动计算（基础服务费 + 服务费金额）
  - 税额自动计算
  - 含税金额自动计算
- ✅ **合同结算创建**
  - 关联合同选择（必填）
  - 结算日期设置（必填）
  - 结算批次设置（同一合同的第几次结算）
  - 合同金额录入（必填）
  - 已结算金额录入（本次结算前已结算的金额）
  - 本次结算金额录入（必填）
  - 累计结算金额自动计算
  - 税额自动计算
  - 含税金额自动计算
  - 结算单号自动生成（CONTRACT-SETTLE-YYYY-{序列号}）
- ✅ **结算详情查看**
  - 结算基本信息展示
  - 关联项目信息（项目结算）
  - 关联合同信息
  - 结算明细项列表（项目结算）
  - 节省金额汇总展示（项目结算）
  - 服务费计算展示（项目结算）
  - 结算总金额展示
  - 产值统计展示（累计产值、确认产值，项目结算）
  - 结算流程状态展示
  - 结算文件下载
- ✅ **结算编辑**
  - 结算信息编辑（仅草稿状态可编辑）
  - 结算明细项编辑（项目结算，仅草稿状态可编辑）
  - 节省金额调整（项目结算，仅草稿状态可调整）
  - 服务费率调整（项目结算，仅草稿状态可调整）
- ✅ **结算提交**
  - 提交结算初审
  - 更新结算状态（已提交 → 初审中）
  - 提交时间记录
  - 提交人记录

#### 6.2 结算初审
**功能说明**：甲方对结算单进行初审，包括初审意见录入、初审结果确认等。

**功能列表**：
- ✅ **初审列表**
  - 待初审列表（已提交状态）
  - 初审中列表
  - 已初审列表
  - 初审状态筛选（待初审、初审中、初审完成、初审驳回）
- ✅ **初审操作**
  - 初审人选择（甲方初审人）
  - 初审时间记录（自动记录）
  - 初审意见录入（必填）
  - 初审结果选择（初审通过、初审驳回）
  - 初审明细项审核（项目结算，逐项审核）
  - 节省金额调整（项目结算，如有调整）
  - 调整原因录入（如有调整）
- ✅ **初审完成**
  - 初审完成确认
  - 初审状态更新（初审中 → 初审完成 或 初审驳回）
  - 初审完成通知（通知创建人）
  - 初审驳回处理（驳回原因记录、驳回通知）

#### 6.3 初审回复
**功能说明**：对甲方初审意见进行回复，包括初审意见查看、回复意见录入等。

**功能列表**：
- ✅ **初审回复列表**
  - 待回复列表（初审完成状态）
  - 已回复列表
  - 回复状态筛选（待回复、回复中、已回复）
- ✅ **初审意见查看**
  - 初审意见展示（甲方初审意见）
  - 初审结果展示（初审通过/驳回）
  - 初审明细项审核结果展示（项目结算）
  - 节省金额调整情况展示（项目结算，如有调整）
  - 调整原因展示（如有调整）
- ✅ **回复意见录入**
  - 回复意见录入（必填）
  - 回复人记录（自动记录）
  - 回复时间记录（自动记录）
  - 回复附件上传（可选）
- ✅ **回复提交**
  - 回复提交确认
  - 回复状态更新（待回复 → 已回复）
  - 回复通知（通知甲方初审人）
  - 流程推进（已回复 → 对账中）

#### 6.4 结算对账
**功能说明**：双方对结算金额进行对账，包括对账准备、对账执行、对账结果确认等。

**功能列表**：
- ✅ **对账列表**
  - 待对账列表（已回复状态）
  - 对账中列表
  - 已对账列表
  - 对账状态筛选（待对账、对账中、对账完成、对账失败）
- ✅ **对账准备**
  - 对账数据准备（结算数据、明细数据）
  - 对账人员安排（对账人选择）
  - 对账时间安排（对账时间设置）
  - 对账方式选择（现场对账、线上对账）
- ✅ **对账执行**
  - 对账操作（双方对账）
  - 对账结果录入（对账结果、对账说明）
  - 对账差异记录（如有差异，记录差异项、差异金额、差异原因）
  - 对账人记录（双方对账人）
  - 对账时间记录（实际对账时间）
- ✅ **对账完成**
  - 对账完成确认（双方确认对账结果）
  - 对账状态更新（对账中 → 对账完成 或 对账失败）
  - 对账完成通知（通知相关人员）
  - 流程推进（对账完成 → 定案中，如有争议 → 争议处理中）

#### 6.5 争议解决
**功能说明**：处理结算过程中的争议，包括争议识别、争议协商、争议解决等。

**功能列表**：
- ✅ **争议列表**
  - 待处理争议列表（对账失败或有争议项）
  - 处理中争议列表
  - 已解决争议列表
  - 争议状态筛选（待处理、处理中、已解决、未解决）
- ✅ **争议识别**
  - 争议点识别（识别结算争议点）
  - 争议类型选择（金额争议、明细项争议、其他争议）
  - 争议原因录入（争议原因说明）
  - 争议金额记录（如有金额争议）
- ✅ **争议协商**
  - 协商记录录入（协商过程、协商结果）
  - 协商人员记录（双方协商人员）
  - 协商时间记录（协商时间）
  - 协商方案录入（协商方案、方案说明）
- ✅ **争议解决**
  - 争议解决方案确认（双方确认解决方案）
  - 争议解决结果录入（争议解决结果、解决说明）
  - 争议解决状态更新（处理中 → 已解决 或 未解决）
  - 争议解决通知（通知相关人员）
  - 流程推进（争议已解决 → 定案中）

#### 6.6 结算定案
**功能说明**：完成结算定案，包括定案确认、定案审批、定案完成等。

**功能列表**：
- ✅ **定案列表**
  - 待定案列表（对账完成或争议已解决状态）
  - 定案中列表
  - 已定案列表
  - 定案状态筛选（待定案、定案中、定案完成、定案驳回）
- ✅ **定案确认**
  - 结算金额最终确认（最终结算金额确认）
  - 定案意见录入（定案意见、定案说明）
  - 定案人记录（定案人）
  - 定案时间记录（定案时间）
- ✅ **定案审批**
  - 定案审批流程（支持多级审批）
  - 审批意见录入（审批意见）
  - 审批结果选择（审批通过、审批驳回）
  - 审批人记录（审批人）
  - 审批时间记录（审批时间）
- ✅ **定案完成**
  - 定案完成确认
  - 定案状态更新（定案中 → 定案完成）
  - 结算状态更新（定案完成 → 已完成）
  - 定案完成通知（通知相关人员）
  - 结算文件生成（生成最终结算文件）
  - 结算数据归档（结算数据推送至相关模块）

#### 6.7 结算统计
**功能说明**：结算统计功能集成在结算列表页面中，包括结算总额统计、结算数量统计、结算趋势分析、结算状态分布、对账效率统计、争议处理统计、定案效率统计等统计信息，无需单独设计菜单。统计功能在列表页顶部以统计卡片或图表形式展示。

---

### 7. 回款管理
- **状态**：✅ 已完成（基础功能）
- **完成度**：60%
- **说明**：管理项目回款和合同回款的全流程，包括回款计划、回款跟踪、发票管理、催收管理、回款预测、风险预警等，实现回款和发票的统一管理。根据合同规定，与各节点联动触发回款提醒，通过预测、预警和催收机制避免长期不回款导致坏账风险。

**⚠️ 样式模板调用提示**：
- ✅ 所有模板必须调用 `{% static 'css/common.css' %}`
- ✅ 列表页面使用 `list-page-container` 布局和 `info-card` 组件
- ✅ 详情页面使用 `info-card`、`info-grid`、`info-item` 组件
- ✅ 表单页面使用 `form-card`、`form-section` 组件

#### 7.1 回款计划管理
**功能说明**：管理回款计划，包括项目回款计划和商务合同回款计划，支持回款计划的创建、跟踪、预测和风险预警。根据合同规定，与各节点联动触发回款提醒，实现自动化的回款管理。

**功能列表**：
- ✅ **项目回款计划**
  - 回款计划列表（关联项目）
  - 回款计划创建
  - 回款计划编辑
  - 回款计划删除
  - 阶段名称设置（必填）
  - 计划金额设置（必填）
  - 计划日期设置（必填）
  - 实际金额录入
  - 实际日期录入
  - 回款状态更新（待回款、部分回款、已回款、逾期、坏账）
  - 触发条件设置（基于项目里程碑）
  - 风险等级显示（自动计算风险等级）
  - 回款概率显示（回款预测概率）
  - 预警状态显示（是否有预警）
- ✅ **商务合同回款计划**
  - 回款计划列表（关联合同）
  - 回款计划创建
  - 回款计划编辑
  - 回款计划删除
  - 阶段名称设置（必填）
  - 计划金额设置（必填）
  - 计划日期设置（必填）
  - 实际金额录入
  - 实际日期录入
  - 回款状态更新（待回款、部分回款、已回款、逾期、坏账）
  - 风险等级显示（自动计算风险等级）
  - 回款概率显示（回款预测概率）
  - 预警状态显示（是否有预警）
- ✅ **合同节点联动触发回款提醒**
  - 合同节点配置（配置合同中的回款节点）
  - 节点触发条件设置（节点完成条件、触发时间设置）
  - 节点完成检测（检测合同节点是否完成）
  - 自动触发回款提醒（节点完成时自动触发回款提醒）
  - 提醒时间设置（节点完成后X天提醒，或节点完成时立即提醒）
  - 提醒对象设置（提醒财务人员、商务人员、项目负责人等）
  - 提醒方式设置（邮件、短信、系统通知）
  - 提醒内容模板设置（提醒内容模板，包含节点信息、回款金额、回款日期等）
  - 联动触发记录（记录节点联动触发的回款提醒记录）
  - 触发状态跟踪（已触发、待触发、触发失败）
- ✅ **回款计划列表**
  - 回款计划列表展示（分页）
  - 回款状态筛选（待回款、部分回款、已回款、逾期、坏账）
  - 风险等级筛选（低风险、中风险、高风险、极高风险）
  - 预警状态筛选（有预警、无预警）
  - 关联项目筛选（项目回款计划）
  - 关联合同筛选（商务合同回款计划）
  - 计划日期筛选
  - 逾期天数筛选
  - 触发方式筛选（手动创建、节点联动触发）
  - 催收状态筛选（有催收任务、无催收任务）
  - 回款计划详情查看（基本信息、回款记录、跟踪记录、预测信息、预警信息、节点联动触发记录、催收任务列表、催收记录列表）

#### 7.2 回款跟踪
**功能说明**：跟踪回款计划的执行情况，记录回款过程和状态变化，通过跟踪记录实时掌握回款进展。

**功能列表**：
- ✅ **回款记录登记**
  - 关联回款计划选择（项目回款计划或商务回款计划）
  - 关联结算单选择（可选，关联已定案的结算单）
  - 关联发票选择（可选，从发票管理中选择已开具的发票）
  - 回款单号自动生成（PAY-YYYY-{序列号}）
  - 回款金额录入（必填）
  - 回款日期设置（必填）
  - 回款方式选择（银行转账、现金、支票、承兑汇票、其他）
  - 发票号码录入（可选，如已关联发票则自动填充）
  - 发票代码录入（可选，如已关联发票则自动填充）
  - 收款账户录入（必填）
  - 收款凭证上传（必填，银行回单、收据等）
  - 备注录入（可选）
- ✅ **回款状态跟踪**
  - 回款状态更新（待确认、已确认、已拒绝、部分回款、已回款、逾期、坏账）
  - 回款确认操作
  - 回款确认时间记录
  - 回款确认人记录
  - 回款状态时间线展示（完整的状态流转历史）
  - 状态变更通知（状态变更时通知相关人员）
- ✅ **跟踪记录管理**
  - 跟踪记录创建（记录回款跟踪过程）
  - 跟踪时间记录（跟踪时间）
  - 跟踪方式选择（电话、邮件、现场、会议、其他）
  - 跟踪对象记录（跟踪对象姓名、职位、联系方式）
  - 跟踪内容录入（跟踪内容、沟通结果）
  - 跟踪结果选择（已沟通、待回复、已回复、无回复、其他）
  - 下次跟踪时间设置（下次跟踪计划时间）
  - 跟踪附件上传（沟通记录、邮件截图、会议纪要等）
  - 跟踪记录人记录（跟踪记录人）
  - 跟踪记录列表（按回款计划或回款记录查看跟踪记录）
  - 跟踪记录时间线展示（跟踪记录时间线）
  - 跟踪记录统计（跟踪次数、跟踪及时率、跟踪效果）
- ✅ **回款记录列表**
  - 回款记录列表展示（分页）
  - 回款状态筛选（待确认、已确认、已拒绝、部分回款、已回款、逾期、坏账）
  - 回款方式筛选
  - 回款日期筛选
  - 关联结算单筛选
  - 关联发票筛选
  - 回款单号搜索
  - 发票号码搜索
  - 逾期筛选（逾期、未逾期）
  - 风险等级筛选（低风险、中风险、高风险）
- ✅ **回款记录详情查看**
  - 回款基本信息展示
  - 关联回款计划信息
  - 关联结算单信息
  - 关联发票信息（发票号码、发票代码、发票文件）
  - 收款凭证查看
  - 回款状态时间线（完整的状态流转历史）
  - 跟踪记录列表（关联的跟踪记录列表）
  - 跟踪记录时间线（跟踪记录时间线展示）
  - 催收任务列表（关联的催收任务列表）
  - 催收记录列表（关联的催收记录列表）
- ✅ **催收任务触发**
  - 逾期自动触发催收（回款计划逾期时自动创建催收任务）
  - 临近回款日期触发催收（回款计划临近回款日期时自动创建催收任务）
  - 手动创建催收任务（手动为回款计划创建催收任务）
  - 催收任务触发规则配置（配置自动触发催收的规则）

#### 7.3 发票管理
**功能说明**：管理发票的开具、跟踪、关联等全流程，包括发票申请、发票开具、发票状态跟踪、发票与回款关联、回款确认提醒等。为避免发票开具后不能及时回款却必须纳税的问题，系统在每月25日提醒确认是否能够准时回款，如果确认不能回款或不确认，将对发票作出作废处理。

##### 7.3.1 发票开具
**功能列表**：
- ✅ **发票开具申请**
  - 关联结算单选择（关联已定案的结算单）
  - 关联回款计划选择（关联回款计划，可选）
  - 发票类型选择（增值税专用发票、增值税普通发票、其他）
  - 发票金额录入（必填，从结算单自动获取或手动录入）
  - 发票抬头录入（必填，客户公司名称）
  - 纳税人识别号录入（必填）
  - 开户银行录入（可选）
  - 银行账号录入（可选）
  - 地址电话录入（可选）
  - 发票内容选择（服务费、咨询费、其他）
  - 发票备注录入（可选）
  - 发票申请单号自动生成（INV-APPLY-{YYYYMMDD}-{序列号}）
  - 申请时间记录（自动记录）
  - 申请人记录（自动记录）
- ✅ **发票开具**
  - 发票开具列表（待开具、开具中、已开具）
  - 发票开具操作（开具发票）
  - 发票号码录入（必填，开具后录入）
  - 发票代码录入（必填，开具后录入）
  - 开票日期录入（必填，开具日期）
  - 开票人记录（开票人）
  - 发票文件上传（发票扫描件或电子发票）
  - 发票开具状态更新（待开具 → 已开具）
  - 发票开具时间记录
  - 自动加入回款确认提醒（发票开具后，自动加入回款确认提醒流程，在每月25日提醒确认是否能够准时回款）
- ✅ **发票开具记录**
  - 发票开具历史记录
  - 发票开具详情查看
  - 发票开具状态跟踪
  - 发票开具统计

##### 7.3.2 发票列表
**功能列表**：
- ✅ **发票列表**
  - 发票列表展示（分页）
  - 发票状态筛选（待开具、开具中、已开具、已作废、已红冲）
  - 发票类型筛选（增值税专用发票、增值税普通发票、其他）
  - 关联结算单筛选
  - 关联回款计划筛选
  - 发票号码搜索
  - 发票代码搜索
  - 开票日期筛选
  - 发票抬头搜索
  - 回款确认提醒状态筛选（待确认、已确认能回款、已确认不能回款、已确认不确定、已超时、已作废）
  - 回款确认提醒日期筛选
- ✅ **发票详情查看**
  - 发票基本信息展示
  - 关联结算单信息
  - 关联回款计划信息
  - 关联回款记录信息
  - 发票文件查看（发票扫描件或电子发票）
  - 发票开具记录
  - 发票状态时间线
  - 回款确认提醒信息（回款确认提醒记录、确认结果、确认时间）
  - 回款确认提醒时间线（回款确认提醒历史记录）
- ✅ **发票编辑**
  - 发票信息编辑（仅待开具状态可编辑）
  - 发票备注编辑
- ✅ **发票作废**
  - 发票作废操作（已开具发票可作废）
  - 作废原因录入（必填，手动作废时）
  - 作废时间记录
  - 作废人记录（手动作废时记录操作人，自动作废时记录为"系统"）
  - 发票状态更新（已开具 → 已作废）
  - 自动作废标记（标记是否为自动作废）
  - 自动作废原因（回款确认不能回款、回款确认超时未确认）
  - 作废来源展示（手动作废、回款确认自动作废）
- ✅ **发票红冲**
  - 发票红冲操作（已开具发票可红冲）
  - 红冲原因录入（必填）
  - 红冲时间记录
  - 红冲人记录
  - 红冲发票号码录入（红冲发票号码）
  - 发票状态更新（已开具 → 已红冲）

##### 7.3.3 发票关联
**功能列表**：
- ✅ **发票与结算单关联**
  - 发票关联结算单（一个发票可关联一个结算单）
  - 结算单关联发票（一个结算单可关联多个发票）
  - 关联金额匹配（发票金额与结算单金额匹配检查）
  - 关联状态跟踪（已关联、未关联）
- ✅ **发票与回款计划关联**
  - 发票关联回款计划（一个发票可关联一个回款计划）
  - 回款计划关联发票（一个回款计划可关联多个发票）
  - 关联金额匹配（发票金额与回款计划金额匹配检查）
  - 关联状态跟踪（已关联、未关联）
- ✅ **发票与回款记录关联**
  - 发票关联回款记录（一个发票可关联多个回款记录）
  - 回款记录关联发票（一个回款记录可关联一个发票）
  - 关联金额匹配（发票金额与回款金额匹配检查）
  - 关联状态跟踪（已关联、未关联）
- ✅ **发票关联查询**
  - 按结算单查询发票（查询结算单关联的所有发票）
  - 按回款计划查询发票（查询回款计划关联的所有发票）
  - 按回款记录查询发票（查询回款记录关联的发票）
  - 发票关联统计（关联数量、关联金额统计）

##### 7.3.4 回款确认提醒
**功能说明**：为避免发票开具后不能及时回款却必须纳税的问题，系统在每月25日自动提醒确认是否能够准时回款。如果确认不能回款或不确认，将对发票作出作废处理，避免税务风险。

**功能列表**：
- ✅ **回款确认提醒规则**
  - 提醒时间设置（每月25日自动提醒）
  - 提醒对象设置（财务人员、商务人员、项目负责人等）
  - 提醒方式设置（邮件、短信、系统通知）
  - 确认截止时间设置（提醒后X天内需确认，默认3天）
  - 自动作废规则设置（确认不能回款或不确认时自动作废）
- ✅ **回款确认提醒列表**
  - 待确认提醒列表（每月25日生成的待确认提醒）
  - 已确认提醒列表
  - 已超时提醒列表（超过确认截止时间未确认）
  - 提醒状态筛选（待确认、已确认能回款、已确认不能回款、已超时、已作废）
  - 关联发票筛选
  - 关联回款计划筛选
  - 提醒日期筛选
- ✅ **回款确认提醒详情**
  - 发票基本信息展示
  - 关联回款计划信息
  - 关联回款记录信息（已回款金额、未回款金额）
  - 计划回款日期展示
  - 实际回款情况展示
  - 回款预测信息展示（回款概率、预测回款时间）
  - 提醒时间展示
  - 确认截止时间展示
- ✅ **回款确认操作**
  - 回款确认选择（能准时回款、不能准时回款、不确定）
  - 确认能回款操作（确认能准时回款）
    - 确认时间记录
    - 确认人记录
    - 确认意见录入（可选）
    - 预计回款时间录入（可选）
    - 提醒状态更新（待确认 → 已确认能回款）
  - 确认不能回款操作（确认不能准时回款）
    - 确认时间记录
    - 确认人记录
    - 不能回款原因录入（必填）
    - 预计回款时间录入（可选）
    - 提醒状态更新（待确认 → 已确认不能回款）
    - 自动触发发票作废（自动作废发票）
  - 不确定操作（不确定是否能准时回款）
    - 确认时间记录
    - 确认人记录
    - 不确定原因录入（必填）
    - 预计回款时间录入（可选）
    - 提醒状态更新（待确认 → 已确认不确定）
    - 自动触发发票作废（自动作废发票）
- ✅ **自动作废处理**
  - 作废条件检查（确认不能回款或不确认时）
  - 自动作废操作（自动作废发票）
  - 作废原因自动填充（"回款确认不能回款"或"回款确认超时未确认"）
  - 作废时间记录
  - 作废人记录（系统自动记录）
  - 发票状态更新（已开具 → 已作废）
  - 作废通知（通知相关人员发票已作废）
- ✅ **超时未确认处理**
  - 超时检测（超过确认截止时间未确认）
  - 超时提醒（再次提醒确认）
  - 超时自动作废（超时后自动作废发票）
  - 超时作废原因记录（"回款确认超时未确认"）
  - 超时作废通知（通知相关人员发票已作废）
- ✅ **回款确认提醒统计**
  - 提醒数量统计（本月提醒数量、已确认数量、未确认数量）
  - 确认结果统计（能回款数量、不能回款数量、不确定数量）
  - 作废数量统计（因回款确认作废的发票数量）
  - 确认及时率统计（及时确认率）
  - 回款确认准确率统计（确认能回款的实际回款率）

#### 7.4 催收管理
**功能说明**：管理回款催收任务，包括催收任务创建、催收记录管理、催收效果跟踪等，通过系统化的催收管理提高回款效率，降低坏账风险。

**功能列表**：
- ✅ **催收任务创建**
  - 关联回款计划选择（关联待回款或逾期的回款计划）
  - 催收任务单号自动生成（COLLECT-{YYYYMMDD}-{序列号}）
  - 催收原因选择（逾期未回款、临近回款日期、其他）
  - 催收优先级设置（低、普通、高、紧急）
  - 催收方式选择（电话催收、邮件催收、现场催收、函件催收、法律催收、其他）
  - 催收对象录入（催收对象姓名、职位、联系方式）
  - 催收内容模板选择（催收内容模板）
  - 催收内容录入（催收内容、催收要求）
  - 计划催收时间设置（计划催收时间）
  - 催收负责人选择（催收负责人）
  - 催收任务状态设置（待催收、催收中、已完成、已取消）
- ✅ **催收任务列表**
  - 催收任务列表展示（分页）
  - 催收任务状态筛选（待催收、催收中、已完成、已取消）
  - 催收优先级筛选（低、普通、高、紧急）
  - 催收方式筛选
  - 关联回款计划筛选
  - 关联项目筛选
  - 关联客户筛选
  - 催收负责人筛选
  - 计划催收时间筛选
  - 催收任务详情查看（基本信息、关联回款计划、催收记录、催收效果）
- ✅ **催收记录管理**
  - 催收记录创建（记录每次催收活动）
  - 关联催收任务选择（关联催收任务）
  - 催收时间记录（实际催收时间）
  - 催收方式记录（电话、邮件、现场、函件、法律、其他）
  - 催收对象记录（催收对象姓名、职位、联系方式）
  - 催收内容记录（催收内容、沟通结果）
  - 催收结果选择（已沟通、待回复、已回复、无回复、已承诺回款、拒绝回款、其他）
  - 承诺回款时间录入（如已承诺回款，录入承诺回款时间）
  - 承诺回款金额录入（如已承诺回款，录入承诺回款金额）
  - 催收反馈录入（催收反馈、客户态度、客户意见）
  - 催收附件上传（催收记录、邮件截图、函件、录音等）
  - 催收人记录（催收人）
  - 催收记录列表（按催收任务查看催收记录）
  - 催收记录时间线（催收记录时间线展示）
- ✅ **催收效果跟踪**
  - 催收效果评估（催收效果评估：有效、部分有效、无效）
  - 回款情况跟踪（跟踪催收后的回款情况）
  - 承诺回款跟踪（跟踪承诺回款是否兑现）
  - 催收成功率统计（催收成功率、催收效果统计）
  - 催收及时性统计（催收及时率、催收响应时间）
- ✅ **催收任务完成**
  - 催收任务完成确认（催收任务完成确认）
  - 完成时间记录
  - 完成人记录
  - 完成说明录入（完成说明、回款情况）
  - 催收任务状态更新（催收中 → 已完成）
  - 催收任务关闭（催收任务关闭）
- ✅ **催收统计**
  - 催收任务统计（催收任务数量、各状态任务数量）
  - 催收方式统计（各催收方式使用情况）
  - 催收效果统计（催收成功率、催收效果分布）
  - 催收及时性统计（催收及时率、平均催收响应时间）
  - 催收回款统计（催收后回款金额、催收后回款率）
  - 催收成本统计（催收成本、催收效率）

#### 7.5 回款预测
**功能说明**：基于历史回款数据、客户信用状况、项目进度等因素，预测回款时间和回款概率，为回款管理提供决策支持。

**功能列表**：
- ✅ **回款预测模型**
  - 历史回款数据分析（分析历史回款数据，建立预测模型）
  - 客户信用评估（客户信用等级、历史回款记录、信用评分）
  - 项目进度分析（项目进度、项目阶段、项目风险）
  - 回款周期分析（平均回款周期、回款周期分布）
  - 回款概率计算（基于多因素计算回款概率）
  - 回款时间预测（预测回款时间范围）
- ✅ **回款预测列表**
  - 回款预测列表展示（分页）
  - 关联回款计划筛选
  - 关联项目筛选
  - 关联客户筛选
  - 预测回款时间筛选
  - 回款概率筛选（高概率、中概率、低概率）
  - 预测状态筛选（待回款、预测中、已回款、预测偏差）
- ✅ **回款预测详情**
  - 回款计划基本信息
  - 预测回款时间（预测回款时间范围）
  - 回款概率（回款概率百分比）
  - 预测依据展示（历史数据、客户信用、项目进度等）
  - 预测模型说明（使用的预测模型、预测算法）
  - 预测准确性评估（预测准确性、预测偏差）
- ✅ **回款预测更新**
  - 自动更新预测（定期自动更新预测结果）
  - 手动更新预测（手动触发预测更新）
  - 预测结果对比（预测结果与实际回款对比）
  - 预测模型优化（根据实际回款情况优化预测模型）
- ✅ **回款预测统计**
  - 预测准确性统计（预测准确率、预测偏差统计）
  - 预测回款金额统计（预测回款金额、实际回款金额对比）
  - 预测回款时间统计（预测回款时间分布、实际回款时间分布）
  - 回款概率分布统计（各概率段回款计划数量）

#### 7.6 风险预警
**功能说明**：监控回款风险，及时发现逾期回款、坏账风险等情况，通过预警机制提醒相关人员采取应对措施，避免长期不回款导致坏账风险。

**功能列表**：
- ✅ **风险识别**
  - 逾期风险识别（识别逾期回款计划）
  - 坏账风险识别（识别可能成为坏账的回款计划）
  - 客户信用风险识别（识别客户信用风险）
  - 项目风险识别（识别项目风险对回款的影响）
  - 回款概率风险识别（识别回款概率低的风险）
  - 回款周期风险识别（识别回款周期过长的风险）
- ✅ **风险等级评估**
  - 风险等级自动计算（基于逾期天数、回款概率、客户信用等因素）
  - 风险等级划分（低风险、中风险、高风险、极高风险）
  - 风险评分计算（风险评分0-100分）
  - 风险等级更新（实时更新风险等级）
- ✅ **预警规则配置**
  - 逾期预警规则（逾期天数阈值设置）
  - 坏账预警规则（逾期天数阈值、回款概率阈值）
  - 客户信用预警规则（客户信用等级阈值）
  - 回款概率预警规则（回款概率阈值）
  - 回款周期预警规则（回款周期阈值）
  - 预警通知规则（预警通知方式、通知对象、通知频率）
- ✅ **预警列表**
  - 预警记录列表展示（分页）
  - 预警级别筛选（一般、重要、紧急、极高）
  - 风险等级筛选（低风险、中风险、高风险、极高风险）
  - 预警类型筛选（逾期预警、坏账预警、信用预警、其他预警）
  - 关联回款计划筛选
  - 关联项目筛选
  - 关联客户筛选
  - 预警状态筛选（待处理、处理中、已处理、已关闭）
- ✅ **预警详情**
  - 预警基本信息展示
  - 关联回款计划信息
  - 关联项目信息
  - 关联客户信息
  - 风险等级展示
  - 风险评分展示
  - 预警原因说明（预警触发原因）
  - 预警建议措施（建议采取的措施）
  - 预警处理记录（预警处理历史）
- ✅ **预警处理**
  - 预警处理操作（处理预警）
  - 处理措施录入（采取的处理措施）
  - 处理结果录入（处理结果）
  - 处理时间记录
  - 处理人记录
  - 预警状态更新（待处理 → 处理中 → 已处理）
  - 预警关闭（预警关闭操作、关闭原因）
  - 自动创建催收任务（预警触发时自动创建催收任务，可选）
  - 催收任务关联（关联创建的催收任务）
- ✅ **预警通知**
  - 预警通知发送（邮件、短信、系统通知）
  - 通知对象设置（通知相关人员）
  - 通知频率设置（实时通知、每日汇总、每周汇总）
  - 通知记录查看（通知发送记录）
- ✅ **坏账管理**
  - 坏账认定（认定坏账的标准、坏账认定流程）
  - 坏账记录（坏账记录创建、坏账金额记录）
  - 坏账原因分析（坏账原因录入、坏账原因分析）
  - 坏账处理措施（坏账处理措施、坏账追讨记录）
  - 坏账统计（坏账金额统计、坏账率统计、坏账趋势分析）
- ✅ **风险预警统计**
  - 预警数量统计（各类型预警数量、各风险等级预警数量）
  - 预警处理效率统计（预警处理时间、预警处理率）
  - 风险分布统计（各风险等级分布、各类型风险分布）
  - 坏账统计（坏账金额、坏账率、坏账趋势）

#### 7.7 回款统计
**功能说明**：回款统计功能集成在回款计划列表和回款记录列表页面中，包括回款完成率统计、逾期回款统计、回款趋势分析、回款方式分布统计、发票开具统计、发票关联统计、回款预测统计、风险预警统计等统计信息，无需单独设计菜单。统计功能在列表页顶部以统计卡片或图表形式展示。

---

### 8. 人事管理
- **状态**：⏳ 计划中
- **完成度**：0%
- **说明**：全面管理企业人力资源，包括组织架构、员工管理、考勤管理、薪资管理、绩效考核、培训管理、福利管理等，实现人力资源的全生命周期管理。

**⚠️ 样式模板调用提示**：
- ✅ 所有模板必须调用 `{% static 'css/common.css' %}`
- ✅ 列表页面使用 `list-page-container` 布局和 `info-card` 组件
- ✅ 详情页面使用 `info-card`、`info-grid`、`info-item` 组件
- ✅ 表单页面使用 `form-card`、`form-section` 组件

#### 8.1 组织架构管理
**功能说明**：管理企业的组织架构，包括部门管理、职位管理、组织架构图等。

**功能列表**：
- ✅ **部门管理**
  - 部门列表展示（树形结构）
  - 部门创建（部门名称、部门编码、上级部门、部门负责人、部门描述）
  - 部门编辑（部门信息编辑）
  - 部门删除（删除部门，需检查是否有员工）
  - 部门排序（调整部门顺序）
  - 部门状态管理（启用、停用）
  - 部门人员统计（部门人员数量统计）
- ✅ **职位管理**
  - 职位列表展示
  - 职位创建（职位名称、职位编码、所属部门、职位级别、职位描述、任职要求）
  - 职位编辑（职位信息编辑）
  - 职位删除（删除职位，需检查是否有员工）
  - 职位状态管理（启用、停用）
  - 职位人员统计（职位人员数量统计）
- ✅ **组织架构图**
  - 组织架构图展示（可视化展示组织架构）
  - 组织架构图导出（导出为图片或PDF）
  - 组织架构图打印

#### 8.2 员工管理
**功能说明**：管理员工的全生命周期，包括员工信息、员工档案、员工异动、合同管理等。

##### 8.2.1 员工信息管理
**功能列表**：
- ✅ **员工列表**
  - 员工列表展示（分页）
  - 员工搜索（姓名、工号、手机号）
  - 部门筛选（多级部门筛选）
  - 职位筛选
  - 状态筛选（在职、试用期、离职、停薪留职）
  - 入职日期筛选
  - 员工详情查看（基本信息、联系方式、部门职位、合同信息、薪资信息、考勤信息、绩效信息等）
- ✅ **员工创建**
  - 基本信息录入（姓名、性别、出生日期、身份证号、民族、政治面貌、婚姻状况）
  - 联系方式录入（手机、邮箱、地址、紧急联系人、紧急联系电话）
  - 部门选择（必填）
  - 职位选择（必填）
  - 工号自动生成（EMP-{YYYYMMDD}-{序列号}）
  - 入职日期设置（必填）
  - 员工照片上传
  - 学历信息录入（学历、毕业院校、专业、毕业时间）
  - 工作经历录入（可选）
  - 技能证书录入（可选）
- ✅ **员工信息编辑**
  - 基本信息编辑
  - 联系方式编辑
  - 部门调整（部门调整记录）
  - 职位调整（职位调整记录）
  - 学历信息编辑
  - 工作经历编辑
  - 技能证书编辑
- ✅ **员工信息查询**
  - 员工详情查看（完整员工信息）
  - 员工档案查看（员工档案信息）
  - 员工历史记录查看（员工异动历史）

##### 8.2.2 员工档案管理
**功能说明**：管理员工的档案文件，包括入职档案、转正档案、异动档案、离职档案等各类档案文件的上传、存储、查看和管理。

**功能列表**：
- ✅ **员工档案创建**
  - 档案编号自动生成（ARCH-{YYYYMMDD}-{序列号}）
  - 关联员工选择（必填）
  - 档案类型选择（入职档案、转正档案、异动档案、离职档案、培训档案、绩效档案、合同档案、其他）
  - 档案文件上传（支持多文件，支持PDF、Word、Excel、图片等格式）
  - 档案文件分类（身份证、学历证书、资格证书、劳动合同、体检报告、其他）
  - 档案描述录入（可选）
  - 档案创建时间记录
  - 档案创建人记录
  - 档案有效期设置（可选，用于提醒档案到期）
- ✅ **员工档案列表**
  - 档案列表展示（分页）
  - 关联员工筛选
  - 档案类型筛选
  - 档案文件分类筛选
  - 创建时间筛选
  - 档案搜索（档案编号、档案描述、文件名）
  - 档案状态筛选（有效、即将到期、已到期）
- ✅ **员工档案查看**
  - 档案基本信息展示
  - 关联员工信息
  - 档案文件列表展示
  - 档案文件在线预览（支持PDF、图片等格式）
  - 档案文件下载（单个下载、批量下载）
  - 档案创建记录
  - 档案操作日志（查看、下载、删除等操作记录）
- ✅ **员工档案管理**
  - 档案编辑（档案信息编辑）
  - 档案文件添加（添加档案文件，支持多文件上传）
  - 档案文件删除（删除档案文件，需权限控制）
  - 档案文件重命名（重命名档案文件）
  - 档案文件分类调整（调整档案文件分类）
  - 档案删除（删除档案，需权限控制）
  - 档案归档（档案归档操作，归档后只读）
  - 档案到期提醒（档案到期提醒规则配置、到期提醒通知）

##### 8.2.3 员工异动管理
**功能说明**：管理员工的异动，包括入职、离职、调岗、晋升等。

**功能列表**：
- ✅ **入职管理**
  - 入职申请创建（关联招聘信息或直接创建）
  - 入职信息录入（入职日期、试用期期限、试用期薪资、转正日期）
  - 入职材料上传（身份证、学历证书、体检报告等）
  - 入职审批流程（支持多级审批）
  - 入职审批记录（审批意见、审批人、审批时间）
  - 入职完成确认（入职完成确认、员工账号创建）
  - 入职通知（通知相关部门和人员）
- ✅ **离职管理**
  - 离职申请创建（离职申请、离职原因、离职日期）
  - 离职审批流程（支持多级审批）
  - 离职审批记录（审批意见、审批人、审批时间）
  - 离职交接管理（工作交接、资产交接、账号注销）
  - 离职结算（薪资结算、福利结算、补偿金计算）
  - 离职完成确认（离职完成确认、员工状态更新）
  - 离职通知（通知相关部门和人员）
- ✅ **调岗管理**
  - 调岗申请创建（调岗原因、调出部门、调入部门、调出职位、调入职位、调岗日期）
  - 调岗审批流程（支持多级审批）
  - 调岗审批记录（审批意见、审批人、审批时间）
  - 调岗完成确认（调岗完成确认、员工信息更新）
  - 调岗通知（通知相关部门和人员）
- ✅ **晋升管理**
  - 晋升申请创建（晋升原因、原职位、新职位、晋升日期）
  - 晋升审批流程（支持多级审批）
  - 晋升审批记录（审批意见、审批人、审批时间）
  - 晋升完成确认（晋升完成确认、员工信息更新、薪资调整）
  - 晋升通知（通知相关部门和人员）
- ✅ **异动记录列表**
  - 异动记录列表展示（分页）
  - 异动类型筛选（入职、离职、调岗、晋升）
  - 关联员工筛选
  - 异动状态筛选（待审批、审批中、已通过、已拒绝、已完成）
  - 异动日期筛选
  - 异动记录详情查看（异动信息、审批记录、完成情况）

##### 8.2.4 合同管理
**功能列表**：
- ✅ **合同列表**
  - 合同列表展示（分页）
  - 关联员工筛选
  - 合同类型筛选（劳动合同、实习合同、劳务合同、其他）
  - 合同状态筛选（待签署、已签署、即将到期、已到期、已续签、已解除）
  - 合同到期日期筛选
  - 合同搜索（合同编号、合同名称）
- ✅ **合同创建**
  - 关联员工选择（必填）
  - 合同类型选择（劳动合同、实习合同、劳务合同、其他）
  - 合同编号自动生成（CONTRACT-{YYYYMMDD}-{序列号}）
  - 合同名称录入（必填）
  - 合同开始日期设置（必填）
  - 合同结束日期设置（必填）
  - 合同期限计算（自动计算合同期限）
  - 合同内容录入（合同条款、薪资待遇、工作内容等）
  - 合同文件上传（合同扫描件或电子合同）
  - 签署状态设置（待签署、已签署）
  - 签署日期录入（已签署时）
  - 签署人录入（签署人姓名）
- ✅ **合同编辑**
  - 合同信息编辑（待签署状态可编辑）
  - 合同文件更新（更新合同文件）
- ✅ **合同续签**
  - 合同续签申请创建（续签原因、续签期限、续签日期）
  - 续签审批流程（支持多级审批）
  - 续签审批记录（审批意见、审批人、审批时间）
  - 续签合同创建（创建新合同，关联原合同）
  - 续签完成确认（续签完成确认、合同状态更新）
- ✅ **合同解除**
  - 合同解除申请创建（解除原因、解除日期）
  - 解除审批流程（支持多级审批）
  - 解除审批记录（审批意见、审批人、审批时间）
  - 解除完成确认（解除完成确认、合同状态更新）
- ✅ **合同到期提醒**
  - 合同到期提醒规则配置（到期前X天提醒）
  - 合同到期提醒列表（即将到期的合同列表）
  - 合同到期提醒通知（通知相关人员）
  - 合同到期处理（合同到期后的处理措施）

#### 8.3 考勤管理
**功能说明**：管理员工的考勤，包括考勤打卡、请假、加班等，支持多种考勤方式和考勤规则配置。

**功能列表**：
- ✅ **考勤规则配置**
  - 考勤时间设置（上班时间、下班时间、午休时间）
  - 考勤地点设置（考勤地点、GPS范围）
  - 考勤方式设置（GPS定位打卡、WiFi打卡、人脸识别打卡、其他）
  - 迟到早退规则（迟到时间阈值、早退时间阈值）
  - 缺勤规则（缺勤判定规则）
  - 考勤周期设置（按日、按周、按月）
- ✅ **考勤打卡**
  - 上班打卡（打卡时间、打卡地点、打卡方式、打卡IP地址）
  - 下班打卡（打卡时间、打卡地点、打卡方式、打卡IP地址）
  - GPS定位打卡（GPS定位、位置验证、位置偏差检测）
  - WiFi打卡（WiFi验证、WiFi名称验证、WiFi MAC地址验证）
  - 人脸识别打卡（人脸识别验证、人脸照片保存）
  - 打卡记录列表（个人打卡记录、部门打卡记录、实时打卡记录）
  - 打卡异常处理（打卡失败、打卡异常、异常原因记录）
  - 打卡提醒（上班打卡提醒、下班打卡提醒、打卡时间提醒）
  - 外勤打卡（外勤打卡申请、外勤打卡审批、外勤打卡记录）
  - 打卡统计（个人打卡统计、部门打卡统计、打卡率统计）
- ✅ **考勤记录**
  - 考勤记录列表展示（分页）
  - 员工筛选
  - 部门筛选
  - 日期筛选
  - 考勤状态筛选（正常、迟到、早退、缺勤、补卡）
  - 考勤记录详情查看（打卡时间、打卡地点、考勤状态、异常原因）
- ✅ **考勤异常处理**
  - 迟到处理（迟到记录、迟到原因录入）
  - 早退处理（早退记录、早退原因录入）
  - 缺勤处理（缺勤记录、缺勤原因录入）
  - 补卡申请（补卡申请、补卡原因、补卡日期）
  - 补卡审批（补卡审批流程、审批意见）
  - 补卡记录（补卡记录列表）
- ✅ **考勤统计**（集成在考勤记录列表页面中）
  - 个人考勤统计（出勤天数、迟到次数、早退次数、缺勤天数、请假天数）
  - 部门考勤统计（部门出勤率、部门迟到率、部门缺勤率）
  - 考勤报表生成（日报、周报、月报）
  - 考勤数据导出（Excel导出）
- ✅ **请假管理**
  - 请假申请创建（请假类型、请假开始时间、请假结束时间、请假天数、请假原因）
  - 请假类型管理（事假、病假、年假、调休、婚假、产假、陪产假、丧假、其他）
  - 请假审批流程（支持多级审批）
  - 请假审批记录（审批意见、审批人、审批时间）
  - 请假记录查询（个人请假记录、部门请假记录）
  - 请假统计（请假天数统计、请假类型统计）
- ✅ **加班管理**
  - 加班申请创建（加班日期、加班开始时间、加班结束时间、加班时长、加班原因、加班类型）
  - 加班类型设置（工作日加班、休息日加班、节假日加班、其他）
  - 加班审批流程（支持多级审批）
  - 加班审批记录（审批意见、审批人、审批时间）
  - 加班记录查询（个人加班记录、部门加班记录、按日期查询）
  - 加班时长统计（个人加班时长、部门加班时长、加班时长趋势）
  - 加班调休管理（加班调休申请、调休审批、调休记录、调休余额查询）
  - 加班费用管理（加班费用计算、加班费用发放、加班费用统计）
  - 加班规则配置（加班时长计算规则、加班费用计算规则、调休规则）

#### 8.4 薪资管理
**功能说明**：管理员工的薪资，包括薪资核算、薪资发放、薪资规则配置等。

**功能列表**：
- ✅ **薪资规则配置**
  - 薪资结构设置（薪资结构模板）
  - 薪资项目设置（基本工资、绩效工资、奖金、补贴、扣款、社保、公积金、个税等）
  - 薪资计算规则设置（计算规则、计算公式）
  - 社保规则设置（社保基数、社保比例）
  - 公积金规则设置（公积金基数、公积金比例）
  - 个税规则设置（个税起征点、个税税率）
- ✅ **薪资核算**
  - 薪资核算列表（按月份、按员工）
  - 薪资核算创建（选择员工、选择月份）
  - 基本工资录入（基本工资）
  - 绩效工资录入（绩效工资，关联绩效考核结果）
  - 奖金录入（奖金项目、奖金金额）
  - 补贴录入（补贴项目、补贴金额）
  - 扣款录入（扣款项目、扣款金额）
  - 社保计算（自动计算社保）
  - 公积金计算（自动计算公积金）
  - 个税计算（自动计算个税）
  - 应发工资计算（自动计算应发工资）
  - 实发工资计算（自动计算实发工资）
  - 薪资核算审核（薪资核算审核流程）
  - 薪资调整（薪资调整申请、审批、执行）
- ✅ **薪资发放**
  - 薪资发放列表（按月份、按员工、按状态）
  - 薪资发放创建（选择核算记录、发放日期、发放方式）
  - 薪资发放方式设置（银行转账、现金、其他）
  - 薪资发放审批（薪资发放审批流程、支持多级审批）
  - 薪资发放审批记录（审批意见、审批人、审批时间）
  - 薪资发放执行（薪资发放执行、发放状态更新、发放时间记录）
  - 薪资发放记录（发放记录列表、发放记录详情）
  - 薪资条生成（自动生成薪资条、薪资条模板设置）
  - 薪资条发送（邮件发送、短信发送、系统通知、发送记录）
  - 薪资条查看（员工查看自己的薪资条、薪资条下载、薪资条打印）
  - 薪资发放统计（发放金额统计、发放人数统计、发放完成率）
- ✅ **薪资统计**（集成在薪资发放列表页面中）
  - 个人薪资统计（个人薪资总额、平均薪资、薪资趋势）
  - 部门薪资统计（部门薪资总额、平均薪资、薪资分布）
  - 薪资报表生成（薪资报表、薪资分析报表）
  - 薪资数据导出（Excel导出）

#### 8.5 绩效考核
**功能说明**：管理员工的绩效考核，包括考核计划、考核执行、考核结果等。

**功能列表**：
- ✅ **考核计划管理**
  - 考核计划列表（按周期、按部门）
  - 考核计划创建（考核周期、考核对象、考核指标、考核权重、考核标准）
  - 考核周期设置（月度、季度、半年度、年度）
  - 考核指标设置（KPI指标、工作目标、能力指标等）
  - 考核权重设置（各指标权重设置）
  - 考核标准设置（考核标准、评分规则）
  - 考核计划编辑（考核计划编辑）
  - 考核计划发布（考核计划发布、通知考核对象）
- ✅ **考核执行**
  - 考核任务列表（待考核、考核中、已完成）
  - 考核自评（员工自评、自评分数、自评说明）
  - 考核上级评价（上级评价、评价分数、评价说明）
  - 考核同事评价（同事评价、评价分数、评价说明，可选）
  - 考核下级评价（下级评价、评价分数、评价说明，可选）
  - 考核360度评价（多维度评价）
  - 考核进度跟踪（考核进度、完成情况）
- ✅ **考核结果**
  - 考核结果列表（按周期、按员工、按部门）
  - 考核结果计算（自动计算考核总分、考核等级）
  - 考核等级划分（优秀、良好、合格、待改进、不合格）
  - 考核结果审核（考核结果审核流程）
  - 考核结果确认（考核结果确认、员工确认）
  - 考核结果应用（考核结果应用于薪资、晋升、培训等）
  - 考核结果统计（考核结果分布、考核结果趋势）
  - 考核结果导出（Excel导出）

#### 8.6 培训管理
**功能说明**：管理员工的培训，包括培训计划、培训执行、培训记录等。

**功能列表**：
- ✅ **培训计划管理**
  - 培训计划列表（按年度、按部门）
  - 培训计划创建（培训名称、培训类型、培训对象、培训时间、培训地点、培训讲师、培训内容、培训费用）
  - 培训类型设置（内部培训、外部培训、在线培训、其他）
  - 培训对象设置（全员、部门、职位、个人）
  - 培训计划编辑（培训计划编辑）
  - 培训计划发布（培训计划发布、通知培训对象）
- ✅ **培训执行**
  - 培训任务列表（待培训、培训中、已完成）
  - 培训报名（员工报名、报名审核）
  - 培训签到（培训签到、签到记录）
  - 培训记录（培训过程记录、培训内容记录）
  - 培训考核（培训考核、考核成绩）
  - 培训反馈（培训反馈、满意度评价）
  - 培训进度跟踪（培训进度、完成情况）
- ✅ **培训记录**
  - 培训记录列表（按员工、按培训计划）
  - 培训记录详情查看（培训信息、培训内容、培训成绩、培训反馈）
  - 培训证书管理（培训证书生成、培训证书发放）
  - 培训记录统计（培训次数、培训时长、培训效果）
  - 培训记录导出（Excel导出）

#### 8.7 福利管理
**功能说明**：管理员工的福利，包括福利项目、福利发放、福利统计等。

**功能列表**：
- ✅ **福利项目管理**
  - 福利项目列表（福利项目列表）
  - 福利项目创建（福利项目名称、福利类型、福利标准、福利对象、福利周期）
  - 福利类型设置（节日福利、生日福利、健康福利、交通福利、餐饮福利、其他）
  - 福利标准设置（福利金额、福利物品、福利服务）
  - 福利对象设置（全员、部门、职位、个人）
  - 福利周期设置（一次性、月度、季度、年度）
  - 福利项目编辑（福利项目编辑）
  - 福利项目启用/停用（福利项目状态管理）
- ✅ **福利发放**
  - 福利发放列表（按周期、按员工）
  - 福利发放创建（选择福利项目、选择发放对象、发放日期、发放金额、发放方式）
  - 福利发放方式（现金、物品、服务、其他）
  - 福利发放审批（福利发放审批流程）
  - 福利发放记录（发放记录列表）
  - 福利发放通知（通知员工福利发放）
- ✅ **福利统计**（集成在福利发放列表页面中）
  - 个人福利统计（个人福利总额、福利类型分布）
  - 部门福利统计（部门福利总额、福利类型分布）
  - 福利项目统计（各福利项目发放情况）
  - 福利报表生成（福利报表、福利分析报表）
  - 福利数据导出（Excel导出）

#### 8.8 招聘管理
**功能说明**：管理企业招聘流程，包括招聘需求、招聘计划、简历管理、面试管理、录用管理等，实现从招聘需求到员工入职的全流程管理。

**功能列表**：
- ✅ **招聘需求管理**
  - 招聘需求列表（按部门、按职位、按状态）
  - 招聘需求创建（需求部门、需求职位、需求人数、岗位要求、薪资范围、需求原因、需求日期）
  - 招聘需求审批流程（支持多级审批）
  - 招聘需求审批记录（审批意见、审批人、审批时间）
  - 招聘需求状态管理（待审批、已批准、招聘中、已完成、已取消）
  - 招聘需求编辑（招聘需求信息编辑）
  - 招聘需求统计（各职位需求数量、各状态需求数量）
- ✅ **招聘计划管理**
  - 招聘计划列表（按年度、按季度、按部门）
  - 招聘计划创建（计划名称、计划年度、计划季度、计划部门、计划职位、计划人数、计划预算、计划时间）
  - 招聘计划关联需求（关联招聘需求）
  - 招聘计划编辑（招聘计划编辑）
  - 招聘计划发布（招聘计划发布、通知相关部门）
  - 招聘计划执行跟踪（计划执行情况、完成情况）
  - 招聘计划统计（计划完成率、计划执行情况）
- ✅ **简历管理**
  - 简历列表（按职位、按来源、按状态）
  - 简历上传（简历文件上传、简历信息录入）
  - 简历信息录入（姓名、性别、年龄、学历、工作经验、联系方式、期望薪资、简历来源）
  - 简历来源管理（招聘网站、内部推荐、校园招聘、猎头、其他）
  - 简历状态管理（待筛选、已筛选、待面试、已面试、已录用、已拒绝、已入职）
  - 简历筛选（简历筛选、筛选意见、筛选人、筛选时间）
  - 简历搜索（按姓名、按职位、按关键词搜索）
  - 简历详情查看（简历信息、面试记录、评价记录）
  - 简历统计（各来源简历数量、各状态简历数量、简历转化率）
- ✅ **面试管理**
  - 面试安排列表（按日期、按面试官、按状态）
  - 面试安排创建（关联简历、面试职位、面试时间、面试地点、面试官、面试方式）
  - 面试方式设置（现场面试、视频面试、电话面试、其他）
  - 面试通知（面试通知发送、面试确认）
  - 面试记录创建（面试评价、面试评分、面试意见、面试结果）
  - 面试结果管理（通过、待定、不通过）
  - 面试评价录入（面试官评价、面试评分、面试建议）
  - 面试记录查询（个人面试记录、职位面试记录）
  - 面试统计（面试通过率、面试评价统计）
- ✅ **录用管理**
  - 录用申请创建（关联简历、关联面试记录、录用职位、录用薪资、入职日期、试用期期限）
  - 录用审批流程（支持多级审批）
  - 录用审批记录（审批意见、审批人、审批时间）
  - 录用通知（录用通知发送、录用确认）
  - 录用状态管理（待审批、已批准、已拒绝、已入职、已取消）
  - 录用信息录入（入职日期、试用期期限、试用期薪资、转正日期）
  - 录用完成确认（录用完成确认、关联员工创建）
  - 录用统计（录用率、录用人数统计）
- ✅ **招聘统计**（集成在招聘需求列表页面中）
  - 招聘需求统计（各职位需求数量、各状态需求数量）
  - 简历统计（各来源简历数量、各状态简历数量、简历转化率）
  - 面试统计（面试次数、面试通过率、面试评价统计）
  - 录用统计（录用人数、录用率、录用来源统计）
  - 招聘成本统计（招聘费用、人均招聘成本）
  - 招聘报表生成（招聘报表、招聘分析报表）
  - 招聘数据导出（Excel导出）

#### 8.9 员工关系管理
**功能说明**：管理员工关系，包括员工沟通、员工关怀、员工活动、员工投诉、员工建议等，维护良好的员工关系。

**功能列表**：
- ✅ **员工沟通管理**
  - 沟通记录创建（沟通对象、沟通时间、沟通方式、沟通内容、沟通结果）
  - 沟通方式设置（面谈、电话、邮件、会议、其他）
  - 沟通记录列表（按员工、按时间、按方式）
  - 沟通记录查询（沟通记录详情查看）
  - 沟通统计（沟通次数、沟通方式统计）
- ✅ **员工关怀管理**
  - 关怀记录创建（关怀对象、关怀类型、关怀时间、关怀内容、关怀结果）
  - 关怀类型设置（生日关怀、节日关怀、生病关怀、困难关怀、其他）
  - 关怀记录列表（按员工、按类型、按时间）
  - 关怀提醒（生日提醒、节日提醒、重要事件提醒）
  - 关怀统计（关怀次数、关怀类型统计）
- ✅ **员工活动管理**
  - 活动列表（按类型、按时间、按状态）
  - 活动创建（活动名称、活动类型、活动时间、活动地点、活动内容、参与人员、活动预算）
  - 活动类型设置（团建活动、培训活动、文体活动、其他）
  - 活动报名（员工报名、报名审核）
  - 活动签到（活动签到、签到记录）
  - 活动记录（活动过程记录、活动照片、活动总结）
  - 活动统计（活动次数、参与人数、活动效果）
- ✅ **员工投诉管理**
  - 投诉列表（按状态、按类型、按时间）
  - 投诉创建（投诉人、投诉类型、投诉内容、投诉时间、投诉对象）
  - 投诉类型设置（工作环境、薪资福利、人际关系、管理问题、其他）
  - 投诉处理（投诉处理、处理意见、处理结果、处理人、处理时间）
  - 投诉状态管理（待处理、处理中、已处理、已关闭）
  - 投诉统计（投诉数量、投诉类型统计、投诉处理率）
- ✅ **员工建议管理**
  - 建议列表（按状态、按类型、按时间）
  - 建议创建（建议人、建议类型、建议内容、建议时间）
  - 建议类型设置（工作改进、管理改进、制度改进、其他）
  - 建议处理（建议处理、处理意见、处理结果、处理人、处理时间）
  - 建议状态管理（待处理、处理中、已采纳、已拒绝、已关闭）
  - 建议统计（建议数量、建议类型统计、建议采纳率）

---

### 9. 行政管理
- **状态**：⏳ 计划中
- **完成度**：0%
- **说明**：全面管理企业行政事务，包括行政事务、办公用品、会议、车辆、固定资产、印章、档案、接待、差旅等，实现行政管理的规范化、流程化和数字化。

**⚠️ 样式模板调用提示**：
- ✅ 所有模板必须调用 `{% static 'css/common.css' %}`
- ✅ 列表页面使用 `list-page-container` 布局和 `info-card` 组件
- ✅ 详情页面使用 `info-card`、`info-grid`、`info-item` 组件
- ✅ 表单页面使用 `form-card`、`form-section` 组件

#### 9.1 行政事务管理
**功能说明**：管理日常行政事务，包括事务创建、分配、处理、跟踪等全流程管理。

**功能列表**：
- ✅ **行政事务列表**
  - 事务列表展示（分页）
  - 事务类型筛选（日常事务、专项事务、紧急事务、其他）
  - 事务状态筛选（待处理、处理中、已完成、已取消）
  - 优先级筛选（低、普通、高、紧急）
  - 负责人筛选
  - 创建时间筛选
  - 事务搜索（事务标题、事务内容）
- ✅ **事务创建**
  - 事务标题录入（必填）
  - 事务类型选择（日常事务、专项事务、紧急事务、其他）
  - 事务内容录入（必填）
  - 优先级设置（低、普通、高、紧急）
  - 负责人选择（必填）
  - 参与人选择（可选）
  - 计划开始时间设置（必填）
  - 计划完成时间设置（必填）
  - 事务附件上传（可选）
  - 事务编号自动生成（ADMIN-{YYYYMMDD}-{序列号}）
- ✅ **事务分配**
  - 事务分配操作（分配负责人、参与人）
  - 分配时间记录
  - 分配人记录
  - 分配通知（通知负责人和参与人）
- ✅ **事务处理**
  - 事务处理操作（开始处理事务）
  - 处理进度更新（处理进度百分比）
  - 处理说明录入（处理说明、处理结果）
  - 处理附件上传（处理过程文件、处理结果文件）
  - 事务状态更新（待处理 → 处理中）
  - 处理时间记录
- ✅ **事务完成**
  - 事务完成确认（完成确认）
  - 完成时间记录
  - 完成人记录
  - 完成说明录入（完成说明、完成结果）
  - 事务状态更新（处理中 → 已完成）
  - 完成通知（通知相关人员）
- ✅ **事务跟踪**
  - 事务状态跟踪（状态流转记录）
  - 事务进度跟踪（进度更新记录）
  - 事务时间线展示（完整的事务处理时间线）
  - 事务历史记录（所有操作记录）
- ✅ **事务统计**（集成在事务列表页面中）
  - 事务数量统计（总事务数、各状态事务数）
  - 事务完成率统计（完成率、及时完成率）
  - 事务类型统计（各类型事务数量、占比）
  - 事务优先级统计（各优先级事务数量）
  - 事务处理效率统计（平均处理时间、处理及时率）

#### 9.2 办公用品管理
**功能说明**：管理办公用品的采购、领用、库存等全流程，实现办公用品的规范化管理。

**功能列表**：
- ✅ **用品分类管理**
  - 用品分类列表（树形结构）
  - 用品分类创建（分类名称、分类编码、上级分类、分类描述）
  - 用品分类编辑（分类信息编辑）
  - 用品分类删除（删除分类，需检查是否有用品）
  - 用品分类排序（调整分类顺序）
- ✅ **办公用品列表**
  - 用品列表展示（分页）
  - 用品分类筛选
  - 用品状态筛选（在用、停用、已报废）
  - 用品名称搜索
  - 用品编号搜索
  - 用品详情查看（基本信息、库存信息、采购记录、领用记录）
- ✅ **办公用品信息管理**
  - 用品创建（用品名称、用品编号、用品分类、规格型号、单位、单价、供应商、用品描述）
  - 用品编号自动生成（OFFICE-{YYYYMMDD}-{序列号}）
  - 用品编辑（用品信息编辑）
  - 用品删除（删除用品，需检查是否有库存）
  - 用品状态管理（启用、停用、报废）
- ✅ **采购管理**
  - 采购申请创建（采购用品、采购数量、采购单价、采购总价、采购原因、供应商）
  - 采购审批流程（支持多级审批）
  - 采购审批记录（审批意见、审批人、审批时间）
  - 采购订单创建（采购订单号、采购合同、采购日期）
  - 采购入库（采购入库操作、入库数量、入库时间、入库人）
  - 采购记录列表（采购记录列表、采购记录详情）
  - 采购统计（采购金额统计、采购数量统计、供应商统计）
- ✅ **领用管理**
  - 领用申请创建（领用用品、领用数量、领用原因、领用人、领用部门）
  - 领用审批流程（支持多级审批）
  - 领用审批记录（审批意见、审批人、审批时间）
  - 领用出库（领用出库操作、出库数量、出库时间、出库人）
  - 领用记录列表（领用记录列表、领用记录详情）
  - 领用统计（领用数量统计、领用金额统计、部门领用统计）
- ✅ **库存管理**
  - 库存查询（按用品、按分类、按仓库查询库存）
  - 库存列表展示（库存数量、库存金额、库存预警状态）
  - 库存预警规则配置（低库存阈值设置）
  - 库存预警列表（低库存用品列表、预警通知）
  - 库存盘点（盘点计划创建、盘点执行、盘点结果录入、盘盈盘亏处理）
  - 库存调整（库存调整申请、审批、调整执行）
  - 库存统计（库存总金额、库存总数量、库存周转率、库存分布统计）

#### 9.3 会议管理
**功能说明**：管理会议的全流程，包括会议安排、会议室管理、会议记录等。

**功能列表**：
- ✅ **会议安排**
  - 会议列表展示（分页）
  - 会议状态筛选（待开始、进行中、已结束、已取消）
  - 会议类型筛选（内部会议、外部会议、视频会议、其他）
  - 会议室筛选
  - 会议时间筛选
  - 会议创建（会议主题、会议类型、会议时间、会议时长、会议室选择、参会人员、会议议程、会议附件）
  - 会议编号自动生成（MEET-{YYYYMMDD}-{序列号}）
  - 会议通知（会议通知发送、参会确认）
  - 会议编辑（会议信息编辑，仅待开始状态可编辑）
  - 会议取消（会议取消操作、取消原因录入、取消通知）
- ✅ **会议室管理**
  - 会议室列表展示
  - 会议室创建（会议室名称、会议室编号、会议室位置、容纳人数、设备配置、会议室描述）
  - 会议室编辑（会议室信息编辑）
  - 会议室删除（删除会议室，需检查是否有预订）
  - 会议室状态管理（可用、维护中、停用）
  - 会议室预订（会议室预订、预订时间、预订人、预订状态）
  - 会议室使用情况查询（会议室使用情况、预订情况、空闲时间）
  - 会议室冲突检测（预订冲突检测、冲突提醒）
- ✅ **会议记录**
  - 会议记录创建（关联会议、会议纪要录入、会议决议记录、会议附件上传）
  - 会议记录列表（会议记录列表、会议记录详情）
  - 会议纪要查看（会议纪要查看、会议纪要编辑）
  - 会议决议跟踪（会议决议跟踪、决议执行情况）
  - 会议记录导出（会议记录导出、会议纪要导出）
- ✅ **会议统计**（集成在会议列表页面中）
  - 会议数量统计（总会议数、各状态会议数）
  - 会议类型统计（各类型会议数量、占比）
  - 会议室使用率统计（会议室使用率、使用时长）
  - 参会人员统计（参会人次、参会率）

#### 9.4 车辆管理
**功能说明**：管理公司车辆的使用、调度、维护等，实现车辆使用的规范化管理。

**功能列表**：
- ✅ **车辆信息管理**
  - 车辆列表展示（分页）
  - 车辆状态筛选（可用、使用中、维修中、停用）
  - 车辆类型筛选（轿车、SUV、商务车、货车、其他）
  - 车辆创建（车牌号、车辆品牌、车辆型号、车辆颜色、购买日期、购买价格、车辆照片、车辆描述）
  - 车辆编辑（车辆信息编辑）
  - 车辆删除（删除车辆，需检查是否有使用记录）
  - 车辆状态管理（启用、停用、报废）
- ✅ **用车申请**
  - 用车申请创建（用车事由、用车时间、用车地点、用车人数、车辆类型要求、驾驶员要求）
  - 用车审批流程（支持多级审批）
  - 用车审批记录（审批意见、审批人、审批时间）
  - 用车申请列表（待审批、已审批、已拒绝、已完成）
- ✅ **车辆调度**
  - 车辆调度操作（分配车辆、分配驾驶员）
  - 调度时间记录
  - 调度人记录
  - 调度通知（通知申请人和驾驶员）
  - 车辆使用记录（使用开始时间、使用结束时间、使用里程、使用费用）
  - 车辆归还（车辆归还确认、归还时间、归还状态检查）
- ✅ **车辆维护**
  - 维护记录创建（维护类型、维护项目、维护费用、维护日期、维护单位、维护说明）
  - 维护类型管理（日常保养、定期保养、维修、年检、保险、其他）
  - 维护记录列表（维护记录列表、维护记录详情）
  - 维护提醒（维护到期提醒、保养提醒）
  - 维护统计（维护费用统计、维护次数统计、维护类型统计）
- ✅ **车辆统计**（集成在车辆列表页面中）
  - 车辆使用率统计（车辆使用率、使用时长）
  - 车辆费用统计（使用费用、维护费用、总费用）
  - 车辆使用统计（使用次数、使用里程）

#### 9.5 固定资产管理
**功能说明**：管理公司的固定资产，包括资产信息、采购、领用、盘点、折旧等。

**功能列表**：
- ✅ **资产信息管理**
  - 资产列表展示（分页）
  - 资产分类筛选（办公设备、电子设备、家具、车辆、其他）
  - 资产状态筛选（在用、闲置、维修中、已报废）
  - 资产创建（资产名称、资产编号、资产分类、资产规格、购买日期、购买价格、资产照片、资产描述）
  - 资产编号自动生成（ASSET-{YYYYMMDD}-{序列号}）
  - 资产编辑（资产信息编辑）
  - 资产删除（删除资产，需检查是否有使用记录）
  - 资产状态管理（启用、停用、报废）
- ✅ **资产采购**
  - 资产采购申请创建（采购资产、采购数量、采购单价、采购总价、采购原因、供应商）
  - 资产采购审批流程（支持多级审批）
  - 资产采购审批记录（审批意见、审批人、审批时间）
  - 资产采购订单创建（采购订单号、采购合同、采购日期）
  - 资产入库（资产入库操作、入库数量、入库时间、入库人）
  - 资产采购记录列表（采购记录列表、采购记录详情）
- ✅ **资产领用**
  - 资产领用申请创建（领用资产、领用数量、领用原因、领用人、领用部门、使用地点）
  - 资产领用审批流程（支持多级审批）
  - 资产领用审批记录（审批意见、审批人、审批时间）
  - 资产领用出库（资产领用出库操作、出库数量、出库时间、出库人）
  - 资产领用记录列表（领用记录列表、领用记录详情）
  - 资产归还（资产归还操作、归还时间、归还状态检查）
- ✅ **资产盘点**
  - 盘点计划创建（盘点范围、盘点时间、盘点人员）
  - 盘点执行（盘点操作、盘点结果录入、盘盈盘亏处理）
  - 盘点结果审核（盘点结果审核流程）
  - 盘点记录列表（盘点记录列表、盘点记录详情）
  - 盘点统计（盘点准确率、盘盈盘亏统计）
- ✅ **资产折旧**
  - 折旧方法设置（直线法、年数总和法、双倍余额递减法）
  - 折旧规则配置（折旧年限、残值率、折旧率）
  - 资产折旧计算（自动计算资产折旧）
  - 折旧记录列表（折旧记录列表、折旧记录详情）
  - 折旧统计（折旧总额、折旧率统计）
- ✅ **资产统计**（集成在资产列表页面中）
  - 资产总价值统计（资产总价值、资产净值）
  - 资产分类统计（各分类资产数量、价值）
  - 资产状态统计（各状态资产数量、价值）
  - 资产使用率统计（资产使用率、闲置率）

#### 9.6 印章管理
**功能说明**：管理公司印章的使用，包括印章信息、用印申请、用印审批、用印记录等，确保印章使用的规范性和安全性。

**功能列表**：
- ✅ **印章信息管理**
  - 印章列表展示（分页）
  - 印章类型筛选（公章、财务章、合同章、法人章、部门章、其他）
  - 印章状态筛选（在用、停用、已销毁）
  - 印章创建（印章名称、印章类型、印章编号、保管人、保管部门、印章照片、印章描述）
  - 印章编号自动生成（SEAL-{YYYYMMDD}-{序列号}）
  - 印章编辑（印章信息编辑）
  - 印章删除（删除印章，需检查是否有使用记录）
  - 印章状态管理（启用、停用、销毁）
- ✅ **用印申请**
  - 用印申请创建（用印事由、用印文件、用印类型、用印数量、用印日期、申请人、申请部门）
  - 用印文件上传（用印文件上传）
  - 用印审批流程（支持多级审批）
  - 用印审批记录（审批意见、审批人、审批时间）
  - 用印申请列表（待审批、已审批、已拒绝、已完成）
- ✅ **用印审批**
  - 用印审批列表（待审批、已审批、已拒绝）
  - 用印审批操作（审批通过、审批拒绝）
  - 审批意见录入（审批意见、审批说明）
  - 审批时间记录
  - 审批人记录
- ✅ **用印记录**
  - 用印记录创建（关联用印申请、实际用印时间、用印人、用印文件、用印数量）
  - 用印记录列表（用印记录列表、用印记录详情）
  - 用印文件查看（用印后文件查看）
  - 用印记录统计（用印次数统计、用印类型统计、用印部门统计）

#### 9.7 接待管理
**功能说明**：管理公司的接待事务，包括接待申请、接待安排、接待记录等。

**功能列表**：
- ✅ **接待申请**
  - 接待申请创建（接待事由、接待对象、接待人数、接待日期、接待地点、接待标准、接待预算、申请人、申请部门）
  - 接待审批流程（支持多级审批）
  - 接待审批记录（审批意见、审批人、审批时间）
  - 接待申请列表（待审批、已审批、已拒绝、已完成）
- ✅ **接待安排**
  - 接待安排创建（关联接待申请、接待人员、接待车辆、接待住宿、接待餐饮、接待行程）
  - 接待人员安排（接待人员选择、接待职责分配）
  - 接待车辆安排（车辆选择、车辆调度）
  - 接待住宿安排（住宿预订、住宿标准）
  - 接待餐饮安排（餐饮预订、餐饮标准）
  - 接待行程安排（行程安排、时间安排）
  - 接待通知（通知接待人员）
- ✅ **接待记录**
  - 接待记录创建（关联接待申请、实际接待情况、接待费用、接待效果、接待反馈）
  - 接待费用录入（接待费用明细、费用总额）
  - 接待记录列表（接待记录列表、接待记录详情）
  - 接待费用统计（接待费用统计、接待次数统计、接待效果统计）

#### 9.8 差旅管理
**功能说明**：管理员工的差旅事务，包括差旅申请、差旅审批、差旅报销等。

**功能列表**：
- ✅ **差旅申请**
  - 差旅申请创建（差旅事由、差旅目的地、差旅开始时间、差旅结束时间、差旅天数、差旅人员、差旅方式、差旅预算、申请人、申请部门）
  - 差旅方式选择（飞机、火车、汽车、自驾、其他）
  - 差旅审批流程（支持多级审批）
  - 差旅审批记录（审批意见、审批人、审批时间）
  - 差旅申请列表（待审批、已审批、已拒绝、已完成）
- ✅ **差旅审批**
  - 差旅审批列表（待审批、已审批、已拒绝）
  - 差旅审批操作（审批通过、审批拒绝）
  - 审批意见录入（审批意见、审批说明）
  - 审批时间记录
  - 审批人记录
- ✅ **差旅报销**
  - 差旅报销申请创建（关联差旅申请、交通费用、住宿费用、餐饮费用、其他费用、费用总额、报销凭证）
  - 报销凭证上传（发票、收据等）
  - 差旅报销审批流程（支持多级审批）
  - 差旅报销审批记录（审批意见、审批人、审批时间）
  - 差旅报销支付（报销支付操作、支付时间、支付方式）
  - 差旅报销记录列表（报销记录列表、报销记录详情）
- ✅ **差旅统计**（集成在差旅申请列表页面中）
  - 差旅次数统计（差旅次数、差旅天数）
  - 差旅费用统计（差旅费用总额、平均费用、费用分布）
  - 差旅目的地统计（各目的地差旅次数、费用）
  - 差旅人员统计（各人员差旅次数、费用）

---

### 10. 财务管理
- **状态**：🚧 开发中
- **完成度**：约22%
- **说明**：全面管理企业财务，包括财务核算、资金管理、预算管理、成本管理、往来账款、财务报表、财务分析、税务管理等，实现财务管理的规范化、流程化和数字化。

#### 10.1 财务核算
**功能说明**：管理企业的财务核算，包括会计科目、凭证、账簿等基础财务功能。

**功能列表**：
- ✅ **会计科目管理**（已实现）
  - ✅ 科目列表展示（分页，支持筛选、搜索）
  - ✅ 科目类别管理（资产、负债、所有者权益、收入、费用、成本）
  - ✅ 科目创建（科目编码、科目名称、科目类别、上级科目、科目性质、余额方向）
  - ⚠️ 科目编码规则（按会计准则设置编码规则）- 缺少配置界面
  - ✅ 科目编辑（科目信息编辑）
  - ✅ 科目删除（删除科目，需检查是否有凭证或余额）
  - ✅ 科目启用/停用（科目状态管理）
  - ⚠️ 科目余额查询（科目余额查询、余额明细）- 缺少查询功能
- ✅ **凭证管理**（已实现）
  - ✅ 凭证列表展示（分页）
  - ✅ 凭证日期筛选
  - ✅ 凭证号筛选
  - ✅ 凭证状态筛选（草稿、待审核、已审核、已记账、已作废）
  - ✅ 凭证创建（凭证日期、凭证号、摘要、借方科目、贷方科目、金额）
  - ✅ 凭证编号自动生成（按日期和序号生成）
  - ⚠️ 凭证类型设置（收款凭证、付款凭证、转账凭证、其他）- 缺少类型设置
  - ✅ 凭证编辑（凭证信息编辑，仅草稿状态可编辑）
  - ✅ 凭证删除（凭证删除，仅草稿状态可删除）
  - ⚠️ 凭证审核（凭证审核流程、审核意见、审核人、审核时间）- 缺少审批流程
  - ⚠️ 凭证记账（凭证记账操作、记账时间、记账人）- 缺少记账操作
  - ✅ 凭证作废（凭证作废操作、作废原因）
  - ✅ 凭证查询（多维度查询凭证）
  - ⚠️ 凭证打印（凭证打印、凭证模板设置）- 缺少打印功能
- ⚠️ **账簿管理**（部分实现）
  - ✅ 总账（总账查询）- 已实现
  - ❌ 总账打印 - 缺少打印功能
  - ❌ 明细账（明细账查询、明细账打印）- 完全缺失
  - ❌ 科目余额表（科目余额表查询、余额表打印）- 完全缺失
  - ❌ 试算平衡表（试算平衡表查询、平衡检查）- 完全缺失
  - ❌ 多栏账（多栏账设置、多栏账查询）- 完全缺失
  - ❌ 日记账（现金日记账、银行日记账）- 完全缺失
  - ❌ 账簿打印（账簿打印、账簿导出）- 完全缺失

#### 10.2 资金管理
**功能说明**：管理企业的资金，包括银行账户、资金流水、资金调拨、资金预测等。

**功能列表**：
- ❌ **银行账户管理**（完全缺失）
  - ❌ 账户列表展示（分页）
  - ❌ 账户状态筛选（启用、停用）
  - ❌ 账户类型筛选（基本户、一般户、专用户、其他）
  - ❌ 账户创建（账户名称、账户类型、开户银行、账号、开户日期、初始余额、账户状态）
  - ❌ 账户编辑（账户信息编辑）
  - ❌ 账户删除（删除账户，需检查是否有流水）
  - ❌ 账户余额查询（账户余额查询、余额明细）
  - ❌ 账户状态管理（启用、停用）
- ✅ **资金流水**（已实现）
  - ✅ 资金流水列表展示（分页）
  - ✅ 流水类型筛选（收入、支出、转账）
  - ✅ 流水日期筛选
  - ✅ 流水创建（流水类型、金额、流水日期、对方单位、摘要）
  - ✅ 流水编辑（流水信息编辑）
  - ✅ 流水删除（流水删除，需权限控制）
  - ✅ 流水查询（多维度查询流水）
  - ⚠️ 流水统计（收入统计、支出统计、余额统计）- 缺少统计功能
- ❌ **资金调拨**（完全缺失）
  - ❌ 调拨申请创建（调出账户、调入账户、调拨金额、调拨日期、调拨原因）
  - ❌ 调拨审批流程（支持多级审批）
  - ❌ 调拨审批记录（审批意见、审批人、审批时间）
  - ❌ 调拨执行（调拨执行操作、调拨时间、调拨人）
  - ❌ 调拨记录列表（调拨记录列表、调拨记录详情）
- ❌ **资金预测**（完全缺失）
  - ❌ 资金预测模型（基于历史数据、业务计划等建立预测模型）
  - ❌ 资金流入预测（预测资金流入时间、金额）
  - ❌ 资金流出预测（预测资金流出时间、金额）
  - ❌ 资金余额预测（预测资金余额变化）
  - ❌ 资金预测报表（资金预测报表生成、报表查看）

#### 10.3 预算管理
**功能说明**：管理企业的预算，包括预算编制、预算执行、预算分析等。

**功能列表**：
- ✅ **预算编制**（已实现）
  - ✅ 预算编制创建（预算年度、预算科目、预算金额、预算说明）
  - ✅ 预算列表展示（分页，支持筛选、搜索）
  - ✅ 预算编辑、详情查看
  - ⚠️ 预算年度设置（预算年度、预算周期）- 缺少设置界面
  - ⚠️ 预算科目设置（预算科目、预算项目）- 缺少设置界面
  - ⚠️ 预算编制审批流程（支持多级审批）- 缺少审批流程
  - ⚠️ 预算编制审批记录（审批意见、审批人、审批时间）- 缺少审批记录
  - ❌ 预算版本管理（预算版本创建、版本对比、版本启用）- 完全缺失
  - ❌ 预算调整（预算调整申请、审批流程、调整执行）- 完全缺失
- ❌ **预算执行**（完全缺失）
  - ❌ 预算执行记录（预算执行记录创建、执行金额、执行日期）
  - ❌ 预算执行查询（按科目、按项目、按时间查询执行情况）
  - ❌ 预算执行率计算（预算执行率自动计算）
  - ❌ 预算超支预警（预算超支预警、预警通知）
  - ❌ 预算执行分析（预算执行情况分析）
- ❌ **预算分析**（完全缺失）
  - ❌ 预算执行率分析（各科目、各项目执行率分析）
  - ❌ 预算差异分析（预算与实际差异分析、差异原因分析）
  - ❌ 预算趋势分析（预算趋势分析、预算预测）
  - ❌ 预算报表（预算报表生成、预算分析报表）

#### 10.4 成本管理
**功能说明**：管理企业的成本，包括成本核算、成本分析、成本控制等。

**功能列表**：
- ❌ **成本核算**（完全缺失）
  - ❌ 成本科目设置（成本科目、成本项目）
  - ❌ 成本归集（成本归集规则设置、成本归集操作）
  - ❌ 成本分配（成本分配规则设置、成本分配操作）
  - ❌ 成本核算（成本核算操作、成本计算）
  - ❌ 成本核算记录（成本核算记录列表、核算记录详情）
- ❌ **成本分析**（完全缺失）
  - ❌ 成本结构分析（成本结构分析、成本占比分析）
  - ❌ 成本趋势分析（成本趋势分析、成本变化分析）
  - ❌ 成本对比分析（同期对比、预算对比、目标对比）
  - ❌ 成本项目分析（各成本项目分析、成本项目占比）
- ❌ **成本控制**（完全缺失）
  - ❌ 成本预算设置（成本预算设置、成本预算审批）
  - ❌ 成本预警规则配置（成本预警阈值设置）
  - ❌ 成本预警（成本超支预警、预警通知）
  - ❌ 成本控制措施（成本控制措施录入、措施执行跟踪）

#### 10.5 往来账款管理
**功能说明**：管理企业的往来账款，包括应收账款、应付账款、对账管理等。

**功能列表**：
- ❌ **应收账款管理**（完全缺失）
  - ❌ 应收账款列表（分页、多维度筛选）
  - ❌ 应收账款创建（关联客户、关联项目、应收金额、应收日期、账期、收款计划）
  - ❌ 应收账款查询（按客户、按项目、按时间查询）
  - ❌ 应收账款统计（应收总额、已收金额、未收金额、账龄分析）
  - ❌ 应收账款催收（关联回款管理模块的催收功能）
- ❌ **应付账款管理**（完全缺失）
  - ❌ 应付账款列表（分页、多维度筛选）
  - ❌ 应付账款创建（关联供应商、关联项目、应付金额、应付日期、账期、付款计划）
  - ❌ 应付账款查询（按供应商、按项目、按时间查询）
  - ❌ 应付账款统计（应付总额、已付金额、未付金额、账龄分析）
  - ❌ 应付账款支付（付款申请、审批流程、付款执行）
- ❌ **对账管理**（完全缺失）
  - ❌ 对账申请创建（对账对象、对账期间、对账类型）
  - ❌ 对账数据准备（对账数据准备、对账明细）
  - ❌ 对账执行（对账操作、对账结果录入）
  - ❌ 对账差异处理（对账差异记录、差异处理）
  - ❌ 对账确认（对账确认操作、确认时间、确认人）
  - ❌ 对账记录列表（对账记录列表、对账记录详情）

#### 10.6 财务报表
**功能说明**：生成和管理财务报表，包括资产负债表、利润表、现金流量表等标准报表和自定义报表。

**功能列表**：
- ❌ **资产负债表**（完全缺失）
  - ❌ 报表生成（按会计期间生成资产负债表）
  - ❌ 报表查看（资产负债表查看、报表数据展示）
  - ❌ 报表导出（Excel导出、PDF导出）
  - ❌ 报表打印（报表打印、报表模板设置）
  - ❌ 报表对比（同期对比、上期对比）
- ❌ **利润表**（完全缺失）
  - ❌ 报表生成（按会计期间生成利润表）
  - ❌ 报表查看（利润表查看、报表数据展示）
  - ❌ 报表导出（Excel导出、PDF导出）
  - ❌ 报表打印（报表打印、报表模板设置）
  - ❌ 报表对比（同期对比、上期对比）
- ❌ **现金流量表**（完全缺失）
  - ❌ 报表生成（按会计期间生成现金流量表）
  - ❌ 报表查看（现金流量表查看、报表数据展示）
  - ❌ 报表导出（Excel导出、PDF导出）
  - ❌ 报表打印（报表打印、报表模板设置）
  - ❌ 报表对比（同期对比、上期对比）
- ❌ **自定义报表**（完全缺失）
  - ❌ 报表设计器（报表设计器、报表模板设计）
  - ❌ 报表模板管理（报表模板创建、编辑、删除）
  - ❌ 报表生成（基于模板生成报表）
  - ❌ 报表查看（报表查看、报表数据展示）
  - ❌ 报表导出（Excel导出、PDF导出）
  - ❌ 报表打印（报表打印）

#### 10.7 财务分析
**功能说明**：进行财务分析，包括财务指标分析、成本分析、利润分析等。

**功能列表**：
- ❌ **财务指标分析**（完全缺失）
  - ❌ 盈利能力分析（毛利率、净利率、ROE、ROA等）
  - ❌ 偿债能力分析（流动比率、速动比率、资产负债率等）
  - ❌ 运营能力分析（应收账款周转率、存货周转率等）
  - ❌ 发展能力分析（营业收入增长率、净利润增长率等）
  - ❌ 财务指标计算（自动计算各项财务指标）
  - ❌ 财务指标对比（同期对比、行业对比）
- ❌ **成本分析**（完全缺失）
  - ❌ 成本结构分析（成本结构分析、成本占比分析）
  - ❌ 成本趋势分析（成本趋势分析、成本变化趋势）
  - ❌ 成本对比分析（同期对比、预算对比、目标对比）
  - ❌ 成本项目分析（各成本项目分析、成本项目占比）
- ❌ **利润分析**（完全缺失）
  - ❌ 利润结构分析（利润结构分析、利润来源分析）
  - ❌ 利润趋势分析（利润趋势分析、利润变化趋势）
  - ❌ 利润对比分析（同期对比、预算对比、目标对比）
  - ❌ 利润项目分析（各利润项目分析、利润项目占比）
- ❌ **资金分析**（完全缺失）
  - ❌ 资金流入分析（资金流入分析、流入来源分析）
  - ❌ 资金流出分析（资金流出分析、流出用途分析）
  - ❌ 资金余额分析（资金余额分析、余额变化趋势）
  - ❌ 资金周转分析（资金周转率分析、资金周转效率）

#### 10.8 税务管理
**功能说明**：管理企业的税务事务，包括税务申报、发票管理、税务统计等。

**功能列表**：
- ❌ **税务申报**（完全缺失）
  - ❌ 税务申报列表（按税种、按期间）
  - ❌ 税务申报创建（税种选择、申报期间、申报金额、申报日期）
  - ❌ 税种管理（增值税、企业所得税、个人所得税、其他税种）
  - ❌ 税务申报审批流程（支持多级审批）
  - ❌ 税务申报审批记录（审批意见、审批人、审批时间）
  - ❌ 税务申报提交（申报提交、申报状态跟踪）
  - ❌ 税务申报记录（申报记录列表、申报记录详情）
- ⚠️ **发票管理**（部分实现，与财务管理模块的发票管理关联）
  - ✅ 发票列表展示、创建、编辑、详情查看（已在财务管理模块实现）
  - ✅ 发票类型管理（进项发票、销项发票）
  - ✅ 发票状态管理（草稿、已开具、已认证、已作废）
  - ⚠️ 发票开具记录查询（查询回款管理模块的发票开具记录）- 需要关联回款管理模块
  - ⚠️ 发票统计（发票开具统计、发票金额统计）- 缺少统计功能
  - ⚠️ 发票认证（发票认证操作、认证记录）- 模型有字段但缺少操作界面
  - ⚠️ 发票作废记录（发票作废记录查询）- 缺少查询功能
- ❌ **税务统计**（完全缺失）
  - ❌ 税务申报统计（各税种申报统计、申报金额统计）
  - ❌ 税务缴纳统计（税务缴纳统计、缴纳金额统计）
  - ❌ 税务趋势分析（税务趋势分析、税务变化趋势）

---

### 11. 产值管理
- **状态**：✅ 已完成（数据模型和API）
- **完成度**：60%
- **说明**：全面管理企业产值，包括产值配置、产值计算、产值查询、产值分析、产值审批、产值分配等，实现产值的规范化管理和科学分配。
- **重要说明**：产值管理与审批流程引擎紧密关联。**审批流程引擎配置在系统管理模块（19.1.7）中完成**，但审批节点必须与产值阶段/里程碑关联。审批通过后自动触发产值计算，审批人可作为产值分配对象。详细配置说明请参考系统管理模块（19.1.7）中的审批流程引擎配置。

#### 11.1 产值阶段配置
**功能说明**：配置产值的计算规则，包括产值阶段、产值里程碑、产值事件等，建立产值计算的基础规则体系。

**与审批流程的关联**：
- **产值阶段/里程碑配置**：在产值管理模块中配置产值阶段和里程碑
- **审批节点关联**：在系统管理模块（19.1.7）的审批流程引擎配置中，将审批节点与产值阶段/里程碑关联
- **关联关系**：每个审批节点必须关联一个产值阶段或产值里程碑，审批通过后自动触发对应阶段/里程碑的产值计算
- **配置顺序**：建议先配置产值阶段/里程碑，再在审批流程引擎中配置审批节点与产值阶段/里程碑的关联关系

**功能列表**：
- ✅ **产值阶段管理**
  - 阶段列表展示（转化阶段、合同阶段、生产阶段、结算阶段、回款阶段、售后阶段）
  - 阶段创建（阶段名称、阶段编码、阶段顺序、阶段产值比例、计取基数类型、阶段描述）
  - 阶段编辑（阶段信息编辑）
  - 阶段删除（删除阶段，需检查是否有关联里程碑）
  - 阶段产值比例设置（%，必填）
  - 计取基数类型设置（备案金额、意向金额、合同金额、结算金额、回款金额）
  - 阶段启用/停用（阶段状态管理）
  - 阶段排序（调整阶段顺序）
- ✅ **产值里程碑管理**
  - 里程碑列表展示（关联阶段）
  - 里程碑创建（里程碑名称、里程碑编码、关联阶段、里程碑产值比例、里程碑描述）
  - 里程碑编辑（里程碑信息编辑）
  - 里程碑删除（删除里程碑，需检查是否有关联事件）
  - 里程碑产值比例设置（%，必填）
  - 里程碑启用/停用（里程碑状态管理）
  - 里程碑排序（调整里程碑顺序）
- ✅ **产值事件管理**
  - 事件列表展示（关联里程碑）
  - 事件创建（事件名称、事件编码、关联里程碑、事件产值比例、责任岗位编码、关联业务事件、事件描述）
  - 事件编辑（事件信息编辑）
  - 事件删除（删除事件，需检查是否有产值记录）
  - 事件产值比例设置（%，必填）
  - 责任岗位编码设置（business_manager、project_manager、professional_engineer等，必填）
  - 关联业务事件设置（关联项目流程事件，如：项目创建、图纸审批、意见审批、成果确认等，必填）
  - **说明**：产值事件中的"关联业务事件"是指该产值事件对应的业务事件（如项目创建、图纸审批等），但这些业务事件需要通过审批流程。产值计算的触发机制是：审批节点通过 → 触发产值计算，而不是直接基于业务事件触发。
  - 事件启用/停用（事件状态管理）
  - 事件排序（调整事件顺序）

#### 11.2 产值计算
**功能说明**：执行产值计算，包括自动计算和手动计算，支持产值确认和产值调整。

**产值计算触发机制（统一说明）**：
```
┌─────────────────────────────────────────────────────────────┐
│              产值计算触发机制                                  │
├─────────────────────────────────────────────────────────────┤
│ 1. 触发方式                                                  │
│    ├── 主要方式：审批节点通过 → 自动触发产值计算             │
│    └── 辅助方式：手动触发产值计算                             │
│                                                             │
│ 2. 审批触发流程                                              │
│    ├── 业务事件发生（如：项目创建、图纸审批、意见审批等）    │
│    ├── 业务事件进入审批流程（审批流程在系统管理模块19.1.7中配置）
│    ├── 审批节点通过（审批状态为"通过"）                      │
│    ├── 系统检查审批节点关联的产值阶段/里程碑                 │
│    ├── 自动触发产值计算（在产值管理模块11.2中执行）         │
│    └── 产值记录自动创建                                      │
│                                                             │
│ 3. 触发条件                                                  │
│    ├── 审批节点必须已在系统管理模块（19.1.7）中配置产值关联 │
│    ├── 审批节点必须关联产值阶段或产值里程碑                 │
│    ├── 审批状态必须为"通过"                                  │
│    └── 产值阶段/里程碑必须在产值管理模块（11.1）中已配置    │
│                                                             │
│ 4. 产值计算规则                                              │
│    ├── 产值计算公式：基数 × 阶段比例 × 里程碑比例 × 事件比例 │
│    ├── 基数自动获取（根据计取基数类型自动获取基数）         │
│    ├── 责任人自动识别（基于责任岗位编码自动识别责任人）     │
│    └── 计算时间：审批通过时间作为产值计算时间               │
│                                                             │
│ 5. 产值分配                                                  │
│    ├── 审批人可作为产值分配对象                             │
│    ├── 根据审批节点配置的产值比例进行产值分配               │
│    └── 产值分配在产值管理模块（11.5）中完成                 │
└─────────────────────────────────────────────────────────────┘
```

**重要说明**：
- **统一触发机制**：产值计算的触发机制统一为"审批节点通过 → 自动触发产值计算"
- **不是基于业务事件直接触发**：虽然产值事件中配置了"关联业务事件"（如项目创建、图纸审批等），但这些业务事件需要通过审批流程，审批通过后才触发产值计算，而不是业务事件直接触发产值计算
- **审批流程是必须的**：每个业务节点都必须配置审批流程（在系统管理模块19.1.7中配置），审批通过后才能触发产值计算
- **产值事件的作用**：产值事件中的"关联业务事件"用于标识该产值事件对应的业务场景，但产值计算的触发仍然依赖于审批节点的通过

**功能列表**：
- ✅ **产值自动计算**
  - **触发机制**：审批节点通过后自动触发产值计算（统一触发机制）
  - **触发流程**：
    1. 业务事件发生（如项目创建、图纸审批、意见审批等）
    2. 业务事件进入审批流程
    3. 审批节点通过（审批状态为"通过"）
    4. 系统检查审批节点关联的产值阶段/里程碑
    5. 自动触发产值计算
    6. 产值记录自动创建
  - **产值计算公式**：基数 × 阶段比例 × 里程碑比例 × 事件比例
  - **基数自动获取**（根据计取基数类型自动获取基数）
  - **责任人自动识别**（基于责任岗位编码自动识别责任人）
  - **产值记录自动创建**（自动创建产值记录）
  - **产值计算日志**（记录产值计算过程、计算时间、计算人）
  - **计算时间**：审批通过时间作为产值计算时间
- ✅ **产值手动计算**
  - 手动触发产值计算（手动选择项目、阶段、里程碑、事件）
  - 基数选择（手动选择或录入基数）
  - 阶段/里程碑/事件选择（手动选择阶段、里程碑、事件）
  - 责任人选择（手动选择责任人）
  - 产值金额计算（自动计算产值金额）
  - 产值记录创建（创建产值记录）
- ✅ **产值确认**
  - 产值确认列表（待确认产值列表）
  - 产值确认操作（确认产值）
  - 确认时间记录（自动记录）
  - 确认人记录（自动记录）
  - 确认意见录入（可选）
  - 产值状态更新（待确认 → 已确认）
- ✅ **产值调整**
  - 产值调整申请创建（调整原因、调整金额、调整说明）
  - 产值调整审批流程（支持多级审批）
  - 产值调整审批记录（审批意见、审批人、审批时间）
  - 产值调整执行（调整执行、产值记录更新）
  - 产值调整记录（调整记录列表、调整记录详情）

#### 11.3 产值查询
**功能说明**：查询产值信息，包括个人产值、项目产值、部门产值等多维度查询。

**功能列表**：
- ✅ **产值列表**
  - 产值列表展示（分页）
  - 产值状态筛选（待确认、已确认、已分配、已调整、已取消）
  - 关联项目筛选
  - 责任人筛选
  - 部门筛选
  - 产值阶段筛选
  - 产值日期筛选
  - 产值金额筛选（金额范围）
  - 产值搜索（项目编号、项目名称、责任人姓名）
- ✅ **个人产值查询**
  - 个人产值列表（当前用户的产值列表）
  - 个人产值汇总（个人产值总额、已确认产值、待确认产值）
  - 按阶段统计（各阶段产值统计）
  - 按项目统计（各项目产值统计）
  - 时间范围筛选（按月份、季度、年度筛选）
- ✅ **项目产值查询**
  - 项目产值列表（关联项目的产值列表）
  - 项目产值汇总（项目产值总额、已确认产值、待确认产值）
  - 按阶段统计（各阶段产值统计）
  - 按责任人统计（各责任人产值统计）
  - 项目产值明细（项目产值明细列表）
- ✅ **部门产值查询**
  - 部门产值列表（部门所有员工的产值列表）
  - 部门产值汇总（部门产值总额、已确认产值、待确认产值）
  - 按员工统计（各员工产值统计）
  - 按项目统计（各项目产值统计）
  - 按阶段统计（各阶段产值统计）
- ✅ **产值详情查看**
  - 产值基本信息展示（产值金额、产值阶段、产值里程碑、产值事件、责任人、关联项目）
  - 产值计算明细展示（基数、阶段比例、里程碑比例、事件比例、计算公式、计算结果）
  - 产值确认记录（确认时间、确认人、确认意见）
  - 产值调整记录（调整记录列表）
  - 产值分配记录（分配记录列表）

#### 11.4 产值分析
**功能说明**：进行产值分析，包括产值趋势分析、产值对比分析、产值排名等。

**功能列表**：
- ✅ **产值趋势分析**
  - 个人产值趋势（个人产值趋势分析、产值变化趋势）
  - 项目产值趋势（项目产值趋势分析、产值变化趋势）
  - 部门产值趋势（部门产值趋势分析、产值变化趋势）
  - 公司产值趋势（公司产值趋势分析、产值变化趋势）
  - 时间维度分析（按日、周、月、季度、年度分析）
- ✅ **产值对比分析**
  - 同期对比（同期产值对比、同比增长率）
  - 环比对比（环比产值对比、环比增长率）
  - 目标对比（产值与目标对比、完成率）
  - 预算对比（产值与预算对比、预算完成率）
  - 部门对比（各部门产值对比）
  - 员工对比（各员工产值对比）
- ✅ **产值排名**
  - 个人产值排名（个人产值排名、排名变化）
  - 项目产值排名（项目产值排名、排名变化）
  - 部门产值排名（部门产值排名、排名变化）
  - 排名统计（排名分布、排名趋势）
- ✅ **产值结构分析**
  - 产值阶段结构分析（各阶段产值占比）
  - 产值项目结构分析（各项目产值占比）
  - 产值部门结构分析（各部门产值占比）
  - 产值人员结构分析（各人员产值占比）
- ✅ **产值统计分析**（集成在产值列表页面中）
  - 产值总额统计（总产值、已确认产值、待确认产值）
  - 产值分布统计（各阶段、各项目、各部门产值分布）
  - 产值完成率统计（产值完成率、目标完成率）
  - 产值增长率统计（产值增长率、同比增长率、环比增长率）

#### 11.5 产值审批
**功能说明**：管理产值的审批流程，包括产值审核、产值分配等。

**功能列表**：
- ✅ **产值审核**
  - 产值审核列表（待审核产值列表）
  - 产值审核操作（审核通过、审核驳回）
  - 审核意见录入（审核意见、审核说明）
  - 审核时间记录（自动记录）
  - 审核人记录（自动记录）
  - 产值状态更新（待确认 → 已审核 或 审核驳回）
  - 审核流程支持（支持多级审核）
  - 审核历史记录（审核历史记录列表）
- ✅ **产值分配**
  - 产值分配列表（待分配产值列表）
  - 产值分配操作（分配产值给责任人）
  - 分配比例设置（多人分配时设置分配比例）
  - 分配金额计算（自动计算分配金额）
  - 分配时间记录（自动记录）
  - 分配人记录（自动记录）
  - 产值状态更新（已审核 → 已分配）
  - 分配通知（通知责任人产值已分配）
  - 分配记录（分配记录列表、分配记录详情）
- ✅ **产值审批统计**（集成在产值审批列表页面中）
  - 审批数量统计（待审批、已审批、已驳回数量）
  - 审批效率统计（审批时间、审批及时率）
  - 分配数量统计（待分配、已分配数量）
  - 分配效率统计（分配时间、分配及时率）

#### 11.5.1 产值分配规则
**功能说明**：详细说明产值分配的规则、机制和配置方式，确保产值分配的规范化、公平性和可追溯性。

**产值分配机制**：
```
┌─────────────────────────────────────────────────────────────┐
│              产值分配机制                                    │
├─────────────────────────────────────────────────────────────┤
│ 1. 分配对象识别                                              │
│    ├── 审批人 → 产值分配对象（主要方式）                    │
│    ├── 审批角色 → 产值分配角色（角色维度分配）              │
│    └── 审批部门 → 产值分配部门（部门维度分配）              │
│                                                             │
│ 2. 分配触发时机                                              │
│    ├── 产值计算完成后（产值状态为"已计算"或"已确认"）      │
│    ├── 产值审核通过后（产值状态为"已审核"）                │
│    └── 审批节点通过后（审批通过时自动触发产值计算和分配）   │
│                                                             │
│ 3. 分配方式                                                  │
│    ├── 自动分配：基于审批节点配置自动分配                   │
│    ├── 手动分配：管理员手动分配产值                         │
│    └── 混合分配：自动分配 + 手动调整                        │
│                                                             │
│ 4. 分配比例规则                                              │
│    ├── 单人分配：100%分配给单个责任人                       │
│    ├── 多人分配：按配置比例分配给多个责任人                 │
│    └── 比例总和：多人分配时比例总和必须等于100%             │
│                                                             │
│ 5. 分配金额计算                                              │
│    ├── 计算公式：分配金额 = 产值金额 × 分配比例             │
│    ├── 自动计算：系统自动计算分配金额                       │
│    └── 手动调整：支持手动调整分配金额（需审批）            │
└─────────────────────────────────────────────────────────────┘
```

**产值分配规则配置**：

**1. 审批节点产值分配配置**（在系统管理模块19.1.7中配置）
- **分配对象配置**：
  - 审批人作为产值分配对象（主要方式）
  - 审批角色作为产值分配角色（角色维度分配）
  - 审批部门作为产值分配部门（部门维度分配）
  - 支持指定用户、指定角色、指定部门、指定岗位、动态指定
- **分配比例配置**：
  - 节点产值比例设置（节点产值比例、比例计算规则）
  - 多人分配时设置分配比例（比例总和必须等于100%）
  - 支持按角色设置分配比例
  - 支持按部门设置分配比例
- **分配方式配置**：
  - 自动分配：审批通过后自动分配产值
  - 手动分配：审批通过后需手动分配产值
  - 混合分配：自动分配 + 手动调整
- **产值基数配置**：
  - 产值基数类型（备案金额、意向金额、合同金额、结算金额、回款金额）
  - 基数来源（项目合同金额、项目备案金额等）
  - 基数计算规则（基数计算公式、基数调整规则）

**2. 产值阶段/里程碑分配配置**（在产值管理模块11.1中配置）
- **阶段分配配置**：
  - 阶段产值比例设置（阶段产值比例、比例计算规则）
  - 阶段分配对象设置（阶段责任人、阶段分配角色）
- **里程碑分配配置**：
  - 里程碑产值比例设置（里程碑产值比例、比例计算规则）
  - 里程碑分配对象设置（里程碑责任人、里程碑分配角色）
- **事件分配配置**：
  - 事件产值比例设置（事件产值比例、比例计算规则）
  - 事件责任岗位编码设置（business_manager、project_manager、professional_engineer等）
  - 事件责任人自动识别（基于责任岗位编码自动识别责任人）

**产值分配流程**：
```
┌─────────────────────────────────────────────────────────────┐
│              产值分配流程                                    │
├─────────────────────────────────────────────────────────────┤
│ 第一步：产值计算完成                                          │
│    ├── 业务事件发生（如项目创建、图纸审批、意见审批等）      │
│    ├── 业务事件进入审批流程                                  │
│    ├── 审批节点通过                                          │
│    ├── 系统自动触发产值计算                                  │
│    └── 产值记录创建（产值状态为"已计算"）                   │
│                                                             │
│ 第二步：产值审核（可选）                                      │
│    ├── 产值审核列表（待审核产值列表）                        │
│    ├── 产值审核操作（审核通过、审核驳回）                    │
│    ├── 审核意见录入（审核意见、审核说明）                    │
│    └── 产值状态更新（已计算 → 已审核）                      │
│                                                             │
│ 第三步：产值分配                                              │
│    ├── 产值分配列表（待分配产值列表）                        │
│    ├── 分配对象识别（审批人、审批角色、审批部门）            │
│    ├── 分配比例设置（单人分配、多人分配）                    │
│    ├── 分配金额计算（自动计算分配金额）                      │
│    ├── 产值分配操作（分配产值给责任人）                      │
│    ├── 分配时间记录（自动记录）                              │
│    ├── 分配人记录（自动记录）                                │
│    └── 产值状态更新（已审核 → 已分配）                      │
│                                                             │
│ 第四步：分配通知                                              │
│    ├── 分配通知发送（通知责任人产值已分配）                  │
│    ├── 通知方式（系统通知、邮件通知、短信通知）              │
│    └── 通知内容（分配金额、分配时间、分配项目）              │
│                                                             │
│ 第五步：分配记录                                              │
│    ├── 分配记录列表（分配记录列表、分配记录详情）            │
│    ├── 分配记录查询（按项目、按责任人、按时间查询）            │
│    └── 分配记录统计（分配金额统计、分配次数统计）            │
└─────────────────────────────────────────────────────────────┘
```

**产值分配规则说明**：

**1. 分配对象规则**
- **主要分配对象**：审批人作为产值分配对象（审批节点通过后，审批人自动成为产值分配对象）
- **角色分配对象**：审批角色作为产值分配角色（按角色维度分配产值）
- **部门分配对象**：审批部门作为产值分配部门（按部门维度分配产值）
- **责任人分配对象**：产值事件中配置的责任岗位编码对应的责任人（基于责任岗位编码自动识别责任人）

**2. 分配比例规则**
- **单人分配**：100%分配给单个责任人（默认分配方式）
- **多人分配**：按配置比例分配给多个责任人（比例总和必须等于100%）
- **比例计算**：分配金额 = 产值金额 × 分配比例
- **比例调整**：支持手动调整分配比例（需审批）

**3. 分配时机规则**
- **自动分配**：审批节点通过后自动分配产值（基于审批节点配置）
- **手动分配**：产值审核通过后手动分配产值（管理员手动分配）
- **混合分配**：自动分配 + 手动调整（先自动分配，后手动调整）

**4. 分配金额规则**
- **计算公式**：分配金额 = 产值金额 × 分配比例
- **自动计算**：系统自动计算分配金额（基于分配比例）
- **手动调整**：支持手动调整分配金额（需审批）
- **金额校验**：多人分配时，分配金额总和必须等于产值金额

**5. 分配状态规则**
- **待分配**：产值计算完成，但尚未分配（产值状态为"已计算"或"已确认"）
- **已分配**：产值已分配完成（产值状态为"已分配"）
- **分配中**：产值正在分配过程中（分配操作进行中）
- **分配失败**：产值分配失败（分配操作失败，需重新分配）

**产值分配配置位置**：
- **审批节点产值分配配置**：在系统管理模块（19.1.7）的审批流程引擎配置中完成
- **产值阶段/里程碑分配配置**：在产值管理模块（11.1）的产值阶段配置中完成
- **产值分配操作**：在产值管理模块（11.5）的产值审批中完成

**产值分配配置流程**：
```
第一步：在产值管理模块（11.1）配置产值阶段和里程碑
    ↓
第二步：在系统管理模块（19.1.7）配置审批流程模板
    ↓
第三步：在系统管理模块（19.1.7）配置审批节点
    ↓
第四步：在系统管理模块（19.1.7）将审批节点与产值阶段/里程碑关联，并配置产值分配规则
    ↓
第五步：业务事件发生 → 进入审批流程 → 审批节点通过 → 系统自动触发产值计算
    ↓
第六步：在产值管理模块（11.5）完成产值分配（自动分配或手动分配）
```

**产值分配示例**：

**示例1：单人分配**
- **场景**：项目创建审批通过后，产值分配给项目负责人
- **分配对象**：项目负责人（审批人）
- **分配比例**：100%
- **分配金额**：产值金额 × 100% = 产值金额
- **分配方式**：自动分配

**示例2：多人分配**
- **场景**：图纸审批通过后，产值分配给项目负责人和专业负责人
- **分配对象**：项目负责人（审批人1）、专业负责人（审批人2）
- **分配比例**：项目负责人60%、专业负责人40%
- **分配金额**：
  - 项目负责人：产值金额 × 60%
  - 专业负责人：产值金额 × 40%
- **分配方式**：自动分配

**示例3：角色分配**
- **场景**：意见审批通过后，产值分配给审批角色对应的所有人员
- **分配对象**：专业工程师角色（审批角色）
- **分配比例**：按角色内人员数量平均分配
- **分配金额**：产值金额 ÷ 角色内人员数量
- **分配方式**：自动分配

**产值分配注意事项**：
- **分配比例总和**：多人分配时，分配比例总和必须等于100%
- **分配金额总和**：多人分配时，分配金额总和必须等于产值金额
- **分配对象存在性**：分配对象必须存在且有效（用户、角色、部门必须存在）
- **分配权限**：只有具有产值分配权限的用户才能进行产值分配操作
- **分配记录**：所有分配操作都会记录分配记录，包括分配时间、分配人、分配对象、分配金额等
- **分配通知**：分配完成后，系统会自动通知分配对象产值已分配
- **分配调整**：支持对已分配的产值进行调整，但需要审批流程

**产值分配数据模型设计**：

**1. 产值计算记录模型（OutputValueRecord）**
- **关联信息**：
  - 关联项目（project）
  - 产值阶段（stage）
  - 产值里程碑（milestone）
  - 产值事件（event）
  - 责任人（responsible_user）
- **计算相关字段**：
  - 计取基数（base_amount）
  - 基数类型（base_amount_type）
  - 阶段比例（stage_percentage）
  - 里程碑比例（milestone_percentage）
  - 事件比例（event_percentage）
  - 计算产值（calculated_value）
- **状态和记录**：
  - 状态（status）：待计算、已计算、已确认、已分配、已取消
  - 计算时间（calculated_time）
  - 确认时间（confirmed_time）
  - 确认人（confirmed_by）
  - 备注（notes）

**2. 产值分配记录模型（OutputValueDistribution，建议新增）**
- **关联信息**：
  - 关联产值记录（output_value_record）
  - 关联项目（project）
  - 分配对象（distributed_to）：用户、角色、部门
  - 分配对象类型（distributed_to_type）：user、role、department
- **分配相关字段**：
  - 分配比例（distribution_percentage）
  - 分配金额（distribution_amount）
  - 分配基数（distribution_base_amount）：等于产值金额
- **状态和记录**：
  - 分配状态（status）：待分配、已分配、已调整、已取消
  - 分配时间（distributed_time）
  - 分配人（distributed_by）
  - 分配方式（distribution_method）：自动分配、手动分配、混合分配
  - 分配来源（distribution_source）：审批节点、手动分配、调整分配
- **调整相关字段**：
  - 是否调整（is_adjusted）
  - 调整前金额（original_amount）
  - 调整后金额（adjusted_amount）
  - 调整原因（adjustment_reason）
  - 调整时间（adjusted_time）
  - 调整人（adjusted_by）

**产值分配记录管理**：

**1. 分配记录列表**
- **列表展示**：
  - 分配记录列表（分页展示）
  - 分配记录详情（点击查看详情）
  - 分配记录搜索（按项目、按分配对象、按时间搜索）
- **筛选功能**：
  - 分配状态筛选（待分配、已分配、已调整、已取消）
  - 关联项目筛选
  - 分配对象筛选（用户、角色、部门）
  - 分配方式筛选（自动分配、手动分配、混合分配）
  - 分配时间筛选（按日期范围筛选）
  - 分配金额筛选（按金额范围筛选）
- **排序功能**：
  - 按分配时间排序（默认倒序）
  - 按分配金额排序
  - 按项目排序
  - 按分配对象排序

**2. 分配记录详情**
- **基本信息**：
  - 分配记录编号
  - 关联项目信息（项目编号、项目名称）
  - 产值记录信息（产值金额、产值阶段、产值里程碑、产值事件）
  - 分配对象信息（分配对象名称、分配对象类型）
  - 分配比例和分配金额
  - 分配方式和分配来源
- **时间信息**：
  - 分配时间
  - 分配人
  - 调整时间（如有调整）
  - 调整人（如有调整）
- **状态信息**：
  - 分配状态
  - 状态变更历史
- **调整信息**（如有调整）：
  - 调整前金额
  - 调整后金额
  - 调整原因
  - 调整审批记录

**3. 分配记录统计**
- **统计维度**：
  - 按项目统计（各项目分配金额统计）
  - 按分配对象统计（各用户、角色、部门分配金额统计）
  - 按分配方式统计（自动分配、手动分配、混合分配统计）
  - 按时间统计（按日、周、月、季度、年度统计）
- **统计指标**：
  - 分配总额
  - 分配次数
  - 平均分配金额
  - 最大分配金额
  - 最小分配金额
  - 分配对象数量
- **统计图表**：
  - 分配金额趋势图
  - 分配对象分布图
  - 分配方式分布图
  - 项目分配金额对比图

**产值分配与产值计算的关系**：

**1. 产值计算完成后才能分配**
- 产值必须先计算完成（产值状态为"已计算"或"已确认"）
- 产值计算完成后，系统自动生成待分配产值列表
- 产值分配基于已计算的产值金额进行分配

**2. 产值分配不影响产值计算**
- 产值分配是对已计算产值的分配，不改变产值计算金额
- 产值分配记录与产值计算记录是一对多关系（一个产值记录可以分配给多个对象）
- 产值分配金额总和必须等于产值计算金额

**3. 产值分配可以调整**
- 支持对已分配的产值进行调整
- 调整需要审批流程
- 调整后更新分配记录，保留调整历史

**产值分配权限管理**：

**1. 分配权限角色**
- **产值管理员**：具有所有产值分配权限，包括自动分配、手动分配、分配调整
- **项目负责人**：具有项目相关产值分配权限，可以分配项目产值
- **部门负责人**：具有部门相关产值分配权限，可以分配部门产值
- **普通用户**：只能查看自己的产值分配记录

**2. 分配操作权限**
- **查看权限**：所有用户都可以查看自己的产值分配记录
- **分配权限**：只有具有产值分配权限的用户才能进行产值分配操作
- **调整权限**：只有具有产值调整权限的用户才能进行产值调整操作
- **审批权限**：产值调整需要审批，只有具有审批权限的用户才能审批

**产值分配与审批流程的关联**：

**1. 审批节点配置产值分配**
- 在系统管理模块（19.1.7）的审批流程引擎配置中，审批节点可以配置产值分配规则
- 审批节点通过后，根据配置的产值分配规则自动分配产值
- 审批人可以作为产值分配对象

**2. 审批流程触发产值分配**
- 业务事件发生 → 进入审批流程 → 审批节点通过 → 触发产值计算 → 触发产值分配
- 审批节点配置的产值分配规则决定了产值如何分配
- 审批人、审批角色、审批部门都可以作为产值分配对象

**3. 产值分配审批**
- 产值分配调整需要审批流程
- 产值分配审批在产值管理模块（11.5）中完成
- 产值分配审批通过后，分配记录更新，分配状态变更为"已分配"

#### 11.6 产值统计
**功能说明**：产值统计功能集成在产值列表页面中，包括个人产值统计、项目产值统计、产值趋势分析、产值对比分析、产值排名、产值结构分析等统计信息，无需单独设计菜单。统计功能在列表页顶部以统计卡片或图表形式展示。

---

### 12. 计划管理
- **状态**：✅ 已完成
- **完成度**：100%
- **最后更新**：2025-01-30
- **说明**：全面管理企业计划，包括战略目标管理、计划管理、计划执行、计划分析等。计划管理与公司战略目标紧密关联，通过目标分解和计划对齐，确保计划与战略目标的一致性，实现战略目标的落地执行。

**模块定位**：
计划管理模块是企业战略目标落地执行的核心模块，负责管理从战略目标制定、目标分解、计划创建、计划执行到目标达成的全流程。模块通过目标分解和计划对齐机制，确保计划与战略目标的一致性，实现战略目标的落地执行。

**业务价值**：
1. **战略目标体系化**：建立从公司到部门、团队、个人的完整战略目标体系，实现目标层层分解
2. **计划与目标对齐**：通过目标对齐检查机制，确保计划与战略目标的一致性
3. **执行过程可视化**：通过执行跟踪、进度更新、问题管理等功能，实现计划执行过程的可视化管理
4. **数据驱动决策**：通过计划分析、目标达成分析等功能，为管理决策提供数据支撑

**与其他模块的关联**：
- **项目中心**：计划可关联项目，项目执行情况影响计划进度
- **人事管理**：计划负责人和参与人员关联员工信息
- **系统管理**：计划审批流程使用审批流程引擎

**代码文件位置**：
- ✅ 模型定义：`backend/apps/plan_management/models.py`（已完成，869行，10个模型）
- ✅ 页面视图：`backend/apps/plan_management/views_pages.py`（已完成，约1730行，22个视图函数）
- ⏳ REST API视图：`backend/apps/plan_management/views.py`（待实现）
- ✅ URL路由：`backend/apps/plan_management/urls_pages.py`（已完成）
- ✅ 页面模板：`backend/templates/plan_management/`（已完成，17个模板文件）
- ✅ 表单定义：`backend/apps/plan_management/forms.py`（已完成，约600行，6个表单）
- ✅ Admin配置：`backend/apps/plan_management/admin.py`（已完成，所有模型已注册）
- ⏳ 服务层：`backend/apps/plan_management/services/`（待实现）

**技术实现细节**：
- ⏳ 审批流程引擎集成（工作流引擎）
  - 计划审批流程代码：`plan_approval_workflow`（待配置）
  - 审批节点：根据计划类型和金额配置多级审批
- ✅ 目标分解算法
  - ✅ 目标分解树结构（使用自定义递归方法实现树形结构）
  - ✅ 目标对齐度计算算法（基础版已实现，可扩展）
  - ✅ 目标贡献度计算算法（已实现，基于计划完成情况）
- ✅ 计划进度自动更新机制
  - ✅ 计划执行进度更新时，自动更新关联战略目标进度（通过模型方法实现）
  - ✅ 计划完成时，自动评估目标达成情况（通过状态转换实现）
- ✅ 权限控制（基于权限码系统）
  - ✅ 权限码：`plan_management.view` - 计划管理查看权限
  - ✅ 权限码：`plan_management.create` - 计划创建权限
  - ✅ 权限码：`plan_management.edit` - 计划编辑权限
  - ✅ 权限码：`plan_management.delete` - 计划删除权限
  - ✅ 权限码：`plan_management.approve` - 计划审批权限
  - ✅ 权限码：`plan_management.manage_goal` - 战略目标管理权限
- ✅ 关联关系检查（删除前检查）
  - ✅ 战略目标删除：检查关联的计划（通过模型方法实现）
  - ✅ 计划删除：检查关联的子计划、任务、执行记录（通过模型方法实现）
- ✅ 数据统计分析（聚合查询）
  - ✅ 使用 Django ORM 的 `aggregate()` 和 `annotate()` 方法
  - ✅ 统计维度：计划完成率、目标达成率、计划贡献度等（已实现3个分析页面）

**已知问题和待优化**：
- ⚠️ 需要集成审批流程引擎（工作流引擎集成）
- ⚠️ 目标对齐度计算算法可以进一步优化（当前为基础版）
- ⚠️ 需要运行数据库迁移（需先解决customer_success的迁移历史问题）
- ⚠️ REST API接口待实现（当前仅实现页面视图）
- ⚠️ 数据导出功能待实现（Excel导出）

**已完成工作**：
1. ✅ 创建计划管理应用（`plan_management`）
2. ✅ 设计并实现数据模型（10个模型：战略目标、计划、计划执行、问题管理等）
3. ✅ 实现视图函数和URL路由（22个视图函数，完整URL路由配置）
4. ✅ 创建页面模板（17个模板文件：列表、详情、表单、分析等）
5. ✅ 实现业务逻辑（目标分解、计划对齐、进度跟踪、问题管理等）
6. ✅ 实现统计分析功能（完成分析、目标达成分析、计划统计）
7. ⏳ 集成审批流程引擎（待实现）
8. ⏳ 实现REST API接口（待实现）
9. ⏳ 实现数据导出功能（待实现）

**⚠️ 样式模板调用提示**：
- ✅ 所有模板必须调用 `{% static 'css/common.css' %}`
- ✅ 列表页面使用 `list-page-container` 布局和 `info-card` 组件
- ✅ 详情页面使用 `info-card`、`info-grid`、`info-item` 组件
- ✅ 表单页面使用 `form-card`、`form-section` 组件

**数据模型**（已完成）：
- ✅ `StrategicGoal` - 战略目标模型（包含自动编号、完成率计算、状态转换等）
- ✅ `GoalStatusLog` - 目标状态转换日志
- ✅ `GoalProgressRecord` - 目标进度记录
- ✅ `GoalAdjustment` - 目标调整申请
- ✅ `GoalAlignmentRecord` - 目标对齐度记录
- ✅ `Plan` - 计划模型（包含自动编号、进度跟踪、状态转换等）
- ✅ `PlanStatusLog` - 计划状态转换日志
- ✅ `PlanProgressRecord` - 计划进度记录
- ✅ `PlanIssue` - 计划问题模型
- ✅ `PlanApproval` - 计划审批记录

**API接口**（REST API，待创建）：
- ⏳ `/api/plan/strategic-goals/` - 战略目标列表/创建/详情/编辑/删除（ViewSet）
- ⏳ `/api/plan/strategic-goals/<id>/decompose/` - 目标分解
- ⏳ `/api/plan/strategic-goals/<id>/track/` - 目标跟踪
- ⏳ `/api/plan/plans/` - 计划列表/创建/详情/编辑/删除（ViewSet）
- ⏳ `/api/plan/plans/<id>/decompose/` - 计划分解
- ⏳ `/api/plan/plans/<id>/goal-alignment/` - 目标对齐
- ⏳ `/api/plan/plans/<id>/approval/` - 计划审批
- ⏳ `/api/plan/plans/<id>/execution/` - 计划执行
- ⏳ `/api/plan/plans/<id>/progress/` - 计划进度
- ⏳ `/api/plan/plans/<id>/issues/` - 计划问题
- ⏳ `/api/plan/analysis/completion/` - 完成分析
- ⏳ `/api/plan/analysis/goal-achievement/` - 目标达成分析
- ⏳ `/api/plan/analysis/statistics/` - 计划统计

**计划与战略目标关联逻辑**：
```
┌─────────────────────────────────────────────────────────────┐
│              计划与战略目标关联体系                            │
├─────────────────────────────────────────────────────────────┤
│ 1. 战略目标制定                                              │
│    └── 公司战略目标（年度、三年、五年）                      │
│                                                             │
│ 2. 战略目标分解                                              │
│    ├── 公司目标 → 部门目标                                   │
│    ├── 部门目标 → 团队目标                                   │
│    └── 团队目标 → 个人目标                                   │
│                                                             │
│ 3. 计划与目标对齐                                            │
│    ├── 计划关联战略目标（计划必须关联战略目标）              │
│    ├── 计划目标对齐检查（计划目标与战略目标对齐）            │
│    └── 计划贡献度评估（计划对战略目标的贡献度）              │
│                                                             │
│ 4. 计划执行与目标达成                                        │
│    ├── 计划执行 → 目标进度更新                               │
│    ├── 计划完成 → 目标达成评估                               │
│    └── 目标达成分析（目标达成率、目标贡献度）                │
└─────────────────────────────────────────────────────────────┘
```

#### 12.1 战略目标管理
**功能说明**：管理公司的战略目标，包括目标制定、目标分解、目标跟踪等，建立战略目标体系。

**功能列表**：
- ⏳ **战略目标制定**
  - 目标列表展示（按年度、按周期，分页，每页20条）
  - 目标创建（目标名称、目标类型、目标周期、目标描述、目标指标、目标值、目标权重、目标负责人）
  - 目标类型设置（财务目标、市场目标、运营目标、创新目标、人才目标、其他）
  - 目标周期设置（年度目标、三年目标、五年目标）
  - 目标指标设置（目标指标、指标类型、指标单位、目标值、当前值、完成率）
  - 目标权重设置（目标权重、权重总和检查，同一周期内所有目标权重总和不超过100）
  - 目标编辑（目标信息编辑，仅制定中或已发布状态可编辑）
  - 目标删除（删除目标，需检查是否有关联计划，仅制定中状态可删除）
  - 目标状态管理（制定中、已发布、执行中、已完成、已取消）
  - 目标搜索（支持按目标编号、目标名称、负责人名称搜索）
  - 目标筛选（状态筛选、类型筛选、周期筛选、负责人筛选、时间筛选）
- ⏳ **战略目标分解**
  - 目标分解树展示（树形结构，展示目标分解关系，支持展开/折叠）
  - 目标分解操作（将上级目标分解为下级目标）
  - 分解规则设置（分解比例、分解方式，支持按部门、按团队、按个人分解）
  - 部门目标创建（关联公司目标、部门选择、部门目标值、部门目标指标）
  - 团队目标创建（关联部门目标、团队选择、团队目标值、团队目标指标）
  - 个人目标创建（关联团队目标、员工选择、个人目标值、个人目标指标）
  - 目标对齐检查（检查下级目标是否与上级目标对齐，自动计算对齐度）
  - 目标分解关系展示（目标分解关系图，可视化展示目标分解关系）
  - 目标分解统计（统计各层级目标数量）
- ⏳ **目标跟踪**
  - 目标进度更新（目标进度更新、当前值更新、完成率自动计算）
  - 目标进度跟踪（目标进度跟踪、进度变化记录、进度时间线展示）
  - 目标达成评估（目标达成评估、达成率计算、达成时间预测）
  - 目标预警（目标进度预警、目标达成预警，预警规则可配置）
  - 目标调整（目标调整申请、审批流程、目标调整执行）
  - 目标完成确认（目标完成确认、完成时间、完成评估、完成总结）

#### 12.2 计划管理
**功能说明**：管理工作计划，包括计划创建、计划分解、目标对齐、计划审批等，确保计划与战略目标的一致性。

**功能列表**：
- ⏳ **计划创建**
  - 计划列表展示（分页，每页20条，按创建时间倒序）
  - 计划类型筛选（个人计划、部门计划、公司计划、项目计划）
  - 计划周期筛选（日计划、周计划、月计划、季度计划、年计划）
  - 计划状态筛选（草稿、待审批、审批中、已审批、执行中、已完成、已取消）
  - 关联目标筛选（关联战略目标筛选，下拉选择）
  - 计划创建（计划名称、计划类型、计划周期、计划内容、计划目标、关联战略目标、计划开始时间、计划结束时间、负责人、参与人员、计划优先级、计划预算）
  - 关联战略目标选择（必填，选择关联的战略目标，支持搜索）
  - 目标对齐检查（检查计划目标是否与战略目标对齐，自动计算对齐度）
  - 计划贡献度评估（评估计划对战略目标的贡献度，自动计算）
  - 计划编号自动生成（PLAN-{YYYYMMDD}-{序列号}）
  - 计划搜索（支持按计划编号、计划名称、负责人名称搜索）
  - 批量操作（批量删除、批量导出，仅草稿状态）
- ⏳ **计划分解**
  - 计划分解树展示（树形结构，展示计划分解关系，支持展开/折叠）
  - 计划分解操作（将上级计划分解为下级计划）
  - 子计划创建（关联父计划、子计划名称、子计划内容、子计划目标、子计划时间、子计划负责人）
  - 计划任务创建（关联计划、任务名称、任务内容、任务目标、任务时间、任务负责人）
  - 计划分解关系展示（计划分解关系图，可视化展示计划分解关系）
  - 计划对齐检查（检查子计划是否与父计划对齐，自动计算对齐度）
  - 计划分解统计（统计各层级计划数量）
- ⏳ **目标对齐**
  - 目标对齐检查（检查计划目标与战略目标的对齐情况，自动计算对齐度）
  - 对齐度评估（计划目标与战略目标的对齐度评估，显示对齐度百分比）
  - 对齐度报告（对齐度报告生成、对齐度分析、对齐度趋势分析）
  - 目标对齐调整（目标对齐调整、对齐度提升建议、对齐度提升记录）
- ⏳ **计划审批**
  - 计划审批列表（待审批、审批中、已审批、已拒绝，分页，每页20条）
  - 计划审批流程（支持多级审批，审批流程在系统管理模块中配置）
  - 计划审批操作（审批通过、审批拒绝，需权限验证）
  - 审批意见录入（审批意见、审批说明，必填）
  - 审批时间记录（自动记录）
  - 审批人记录（自动记录）
  - 计划状态更新（待审批 → 已审批 或 已拒绝，自动更新）
  - 审批历史记录（审批历史记录列表，显示所有审批记录）
- ⏳ **计划编辑**
  - 计划信息编辑（仅草稿或待审批状态可编辑，需权限验证）
  - 计划内容编辑（编辑计划内容、计划目标）
  - 计划时间调整（调整计划开始时间、结束时间）
  - 计划目标调整（计划目标调整、目标对齐重新检查）
  - 计划关联目标调整（关联战略目标调整、目标对齐重新检查）
- ⏳ **计划查看**
  - 计划列表展示（多维度筛选、搜索，分页）
  - 计划详情查看（计划基本信息、计划内容、关联战略目标、计划分解、计划执行情况、计划完成情况）
  - 计划进度查看（计划进度、进度时间线、进度里程碑）
  - 计划关联目标查看（关联战略目标信息、目标对齐情况、目标贡献度）

#### 12.3 计划执行
**功能说明**：跟踪计划的执行情况，包括执行跟踪、进度更新、问题管理等。

**功能列表**：
- ⏳ **执行跟踪**
  - 执行计划列表（执行中计划列表，分页，每页20条）
  - 执行进度更新（执行进度百分比更新，范围0-100，进度说明必填）
  - 执行情况录入（执行情况、执行结果、执行问题，文本域）
  - 执行时间记录（执行时间、执行人，自动记录）
  - 执行记录列表（执行记录列表、执行记录详情，分页，每页20条）
  - 执行时间线展示（执行时间线、执行里程碑，可视化展示）
  - 执行记录搜索（支持按时间、执行人搜索）
- ⏳ **进度更新**
  - 进度更新操作（进度百分比更新，范围0-100，进度说明必填）
  - 进度更新时间记录（自动记录）
  - 进度更新人记录（自动记录）
  - 进度里程碑设置（进度里程碑设置、里程碑完成确认）
  - 进度预警（进度滞后预警、进度异常预警，预警规则可配置）
  - 进度统计（进度统计、进度趋势分析，可视化展示）
  - 进度预测（根据历史进度预测计划完成时间）
- ⏳ **问题管理**
  - 问题记录创建（问题类型、问题描述、问题影响、问题级别、问题负责人）
  - 问题类型设置（资源问题、时间问题、质量问题、其他问题）
  - 问题级别设置（一般、重要、紧急）
  - 问题处理（问题处理措施、处理结果、处理时间，自动记录处理人）
  - 问题跟踪（问题跟踪、问题状态更新，状态：待处理、处理中、已解决、已关闭）
  - 问题列表（问题列表、问题详情，分页，每页20条）
  - 问题统计（问题数量统计、问题类型统计、问题处理效率统计，可视化展示）
  - 问题搜索（支持按类型、级别、负责人搜索）
- ⏳ **计划完成情况**
  - 计划完成标记（计划完成确认，需权限验证）
  - 完成时间记录（自动记录）
  - 完成人记录（自动记录）
  - 完成情况总结（完成情况总结、完成成果，文本域，必填）
  - 完成质量评估（完成质量评估、质量评分，范围0-100）
  - 计划状态更新（执行中 → 已完成，自动更新）
  - 目标进度更新（关联战略目标进度自动更新）
  - 目标达成评估（目标达成评估、目标贡献度计算，自动计算）

#### 12.4 计划分析
**功能说明**：进行计划分析，包括完成分析、目标达成分析、计划统计等。

**功能列表**：
- ⏳ **完成分析**
  - 计划完成率分析（个人、部门、公司、计划类型完成率，可视化展示）
  - 计划完成时间分析（计划完成时间分析、及时完成率，可视化展示）
  - 计划完成质量分析（计划完成质量分析、质量评分分布，可视化展示）
  - 计划完成趋势分析（计划完成趋势、完成率变化趋势，可视化展示）
  - 时间维度筛选（按日、周、月、季度、年度筛选）
  - 数据导出（支持Excel、PDF格式导出）
- ⏳ **目标达成**
  - 目标达成率分析（战略目标达成率、目标达成情况，可视化展示）
  - 计划对目标贡献度分析（计划对战略目标的贡献度分析，可视化展示）
  - 目标对齐度分析（计划目标与战略目标的对齐度分析，可视化展示）
  - 目标达成趋势分析（目标达成趋势、达成率变化趋势，可视化展示）
  - 目标达成报告（目标达成报告生成、目标达成分析报告，支持导出）
  - 时间维度筛选（按日、周、月、季度、年度筛选）
  - 数据导出（支持Excel、PDF格式导出）
- ⏳ **计划统计**（集成在计划列表页面中）
  - 计划数量统计（总计划数、各状态计划数、各类型计划数，可视化展示）
  - 计划完成率统计（个人、部门、公司、计划类型完成率，可视化展示）
  - 计划执行效率统计（计划执行效率、及时完成率，可视化展示）
  - 计划与目标关联统计（关联战略目标的计划数量、目标对齐度统计，可视化展示）
  - 计划贡献度统计（计划对战略目标的贡献度统计，可视化展示）
  - 计划趋势分析（计划趋势分析、计划变化趋势，可视化展示）
  - 时间维度筛选（按日、周、月、季度、年度筛选）
  - 数据导出（支持Excel、PDF格式导出）

---

### 13. 档案管理
- **状态**：✅ 已完成（基础功能）
- **完成度**：60%
- **说明**：档案管理是公司的重点模块，统一管理所有档案，包括项目档案和行政档案。实现档案的全生命周期管理，从档案形成、收集、整理、归档、保管、利用到销毁的完整闭环。支持档案的数字化管理、安全管理、检索利用、统计分析等功能，实现档案的规范化、标准化、信息化管理。

**档案管理全生命周期**：
```
┌─────────────────────────────────────────────────────────────┐
│              档案管理全生命周期流程                            │
├─────────────────────────────────────────────────────────────┤
│ 1. 档案形成                                                  │
│    ├── 项目档案：项目文档、图纸、交付文件等                  │
│    └── 行政档案：行政文件、合同、资质等                      │
│                                                             │
│ 2. 档案收集                                                  │
│    ├── 自动收集：从收发管理、生产管理等模块自动推送         │
│    ├── 手动上传：文档上传、批量导入                         │
│    └── 外部接收：外部文件接收、扫描件接收                   │
│                                                             │
│ 3. 档案整理                                                  │
│    ├── 档案分类：按分类规则进行分类                         │
│    ├── 档案编号：按编号规则生成档案编号                     │
│    ├── 档案著录：档案基本信息著录                           │
│    └── 档案装订：档案装订、装盒                             │
│                                                             │
│ 4. 档案归档                                                  │
│    ├── 归档申请：归档申请创建                               │
│    ├── 归档审批：归档审批流程                               │
│    ├── 档案入库：档案入库、上架、位置记录                   │
│    └── 归档确认：归档完成确认                               │
│                                                             │
│ 5. 档案保管                                                  │
│    ├── 库房管理：库房信息、位置管理                         │
│    ├── 保管期限：保管期限设置、到期提醒                     │
│    ├── 档案盘点：定期盘点、盘点记录                         │
│    └── 档案维护：档案维护、修复                             │
│                                                             │
│ 6. 档案利用                                                  │
│    ├── 档案检索：全文检索、高级检索                         │
│    ├── 档案借阅：借阅申请、审批、出库                       │
│    ├── 档案归还：归还操作、归还确认                         │
│    └── 档案下载：在线下载、批量下载                         │
│                                                             │
│ 7. 档案销毁                                                  │
│    ├── 销毁申请：销毁申请创建                               │
│    ├── 销毁审批：销毁审批流程                               │
│    └── 销毁执行：销毁操作、销毁记录                         │
└─────────────────────────────────────────────────────────────┘
```

**档案类型**：
- **项目档案**：项目文档、项目归档文件、交付文件、图纸文件、过程文件等
- **行政档案**：行政文件、合同文件、资质文件、人事档案、财务档案、其他行政档案等

**成果文件流转逻辑**：
- **接收收发管理推送**：接收从收发管理模块推送的已完成交付的成果文件（交付状态为"已确认"或"已反馈"）
- **自动归档处理**：接收推送后，自动进行归档处理，包括文件分类、归档时间记录等
- **归档文件管理**：统一管理归档后的成果文件，支持查询、下载等功能
- **工作闭环**：与收发管理模块形成"收发管理 → 档案管理"的完整工作闭环

#### 13.1 项目档案管理
**功能说明**：统一管理项目档案，包括项目文档、项目归档、交付文件归档、图纸归档等。项目关闭后，从生产管理模块跳转至此进行归档操作。实现项目档案的全生命周期管理。

**项目归档完整流程**：
```
┌─────────────────────────────────────────────────────────────┐
│              项目归档完整流程                                │
├─────────────────────────────────────────────────────────────┤
│ 1. 归档触发条件（自动触发）                                 │
│    ├── 项目状态必须为"已结算"（结算管理模块中结算状态为"已结算"）│
│    ├── 项目复盘已完成（复盘记录已创建）                      │
│    ├── 所有交付成果已完成（交付状态为"已确认"或"已反馈"）  │
│    └── 归档条件已满足                                        │
│                                                             │
│ 2. 交付文件自动归档（持续进行）                             │
│    ├── 收发管理模块完成交付任务后                           │
│    ├── 交付状态为"已确认"或"已反馈"时                       │
│    ├── 自动推送成果文件至档案管理模块                       │
│    ├── 档案管理模块自动接收并归档                           │
│    └── 归档状态标记为"已归档"                               │
│                                                             │
│ 3. 项目自动归档（满足条件后自动触发）                       │
│    ├── 系统自动检查归档条件                                 │
│    ├── 满足条件后自动触发归档                               │
│    ├── 项目状态自动更新为"已归档"                           │
│    └── 归档记录自动同步至档案管理模块                       │
│    ├── 填写归档原因和归档说明                               │
│    └── 提交归档申请                                         │
│                                                             │
│ 4. 归档审批流程                                             │
│    ├── 归档申请提交后，进入审批流程                         │
│    ├── 支持多级审批（审批流程在系统管理模块19.1.7中配置）  │
│    ├── 审批人查看归档文件清单                               │
│    ├── 审批通过：进入归档执行阶段                           │
│    └── 审批驳回：退回申请人，需填写驳回原因                 │
│                                                             │
│ 5. 归档执行阶段                                             │
│    ├── 自动收集项目所有文件                                 │
│    │   ├── 项目基本信息（项目信息、客户信息、合同信息）    │
│    │   ├── 图纸文件（从图纸管理模块4.3获取）                │
│    │   ├── 意见文件（从意见管理模块4.4获取）                │
│    │   ├── 交付文件（已自动归档的交付文件）                │
│    │   ├── 结算文件（从结算管理模块6获取）                  │
│    │   ├── 回款文件（从回款管理模块7获取）                  │
│    │   └── 其他过程文件（项目复盘、会议纪要等）            │
│    ├── 归档文件分类整理                                     │
│    │   ├── 按文件类型分类（图纸、意见、报告、结算等）      │
│    │   ├── 按专业分类（建筑、结构、给排水、电气、暖通）    │
│    │   └── 按阶段分类（立项、生产、结算、回款等）          │
│    ├── 生成归档文件清单                                     │
│    ├── 归档编号自动生成（ARCH-PROJ-{YYYYMMDD}-{序列号}）  │
│    └── 归档时间记录（自动记录）                             │
│                                                             │
│ 6. 归档确认                                                 │
│    ├── 档案管理员确认归档完成                               │
│    ├── 归档状态更新为"已归档"                               │
│    ├── 归档完成时间记录                                     │
│    └── 归档完成通知（通知项目负责人）                       │
│                                                             │
│ 7. 归档后处理                                               │
│    ├── 项目数据只读权限（项目团队成员权限自动调整为只读）  │
│    ├── 归档文件统一管理（支持查询、下载、借阅）            │
│    └── 归档统计更新（归档项目数量、归档文件数量）          │
└─────────────────────────────────────────────────────────────┘
```

**归档触发条件说明**：
- **项目归档触发条件（自动触发）**：
  1. 项目状态必须为"已结算"（结算管理模块中结算状态为"已结算"）
  2. 项目复盘已完成（复盘记录已创建）
  3. 所有交付成果已完成（交付状态为"已确认"或"已反馈"）
  4. 归档条件已满足
- **交付文件自动归档触发条件**：
  1. 收发管理模块完成交付任务
  2. 交付状态为"已确认"或"已反馈"
  3. 自动触发，无需人工操作

**归档责任人和时间节点**：
- **归档申请人**：项目负责人或档案管理员
- **归档审批人**：根据审批流程配置（在系统管理模块19.1.7中配置）
- **归档执行人**：档案管理员
- **归档时间**：项目关闭后30天内完成归档（可配置）
- **归档提醒**：项目关闭后7天、15天、30天自动提醒归档

**交付文件自动归档与项目归档的关系**：
- **交付文件自动归档**：收发管理模块完成交付任务后，自动推送成果文件至档案管理模块，这是持续进行的归档操作
- **项目归档**：项目关闭后，统一归档项目所有文件，包括已自动归档的交付文件和其他项目文件
- **关系说明**：交付文件自动归档是项目归档的一部分，项目归档时会自动收集已自动归档的交付文件，无需重复归档

**功能列表**：
- ✅ **文档管理**
  - 文档列表展示（分页，按上传时间倒序）
  - 文档类型筛选（项目文档、图纸、交付文件、过程文件、其他）
  - 项目筛选（项目编号、项目名称、客户名称）
  - 文档搜索（文档名称、文档编号、关键词）
  - 文档分类筛选（按档案分类树筛选）
  - 文档状态筛选（草稿、待归档、已归档、已借出）
  - 文档上传（支持多文件、批量上传、拖拽上传）
  - 文档信息录入（文档名称、文档编号、文档类型、文档分类、项目关联、文档描述、文档标签、文档密级）
  - 文档编号自动生成（DOC-{YYYYMMDD}-{序列号}）
  - 文档版本管理（文档版本号、版本历史、版本对比）
  - 文档预览（在线预览、支持多种格式）
  - 文档下载（单个文件下载、批量下载、下载记录、下载权限控制）
  - 文档编辑（文档信息编辑、文档分类调整、文档标签编辑）
  - 文档删除（需权限控制、删除确认、删除记录）
  - 文档移动（文档移动到其他分类）
  - 文档复制（文档复制到其他位置）
- ✅ **接收收发管理推送**
  - 自动接收从收发管理模块推送的已完成交付的成果文件
  - 推送触发条件：交付状态为"已确认"或"已反馈"
  - 推送内容包括：交付记录、交付文件、交付跟踪记录、客户反馈、交付时间、交付人
  - 接收时间记录（自动记录）
  - 接收状态跟踪（成功/失败、失败原因）
  - 接收失败时支持手动重试（手动重试推送接收）
  - 推送文件自动分类（按交付类型、项目类型自动分类）
  - 推送文件自动关联项目（自动关联到对应项目）
  - 推送记录列表（推送记录列表、推送记录详情）
- ✅ **项目归档（自动触发）**
  - **归档触发条件（自动检查）**：
    - 项目状态必须为"已结算"（结算管理模块中结算状态为"已结算"）
    - 项目复盘已完成（复盘记录已创建）
    - 所有交付成果已完成（交付状态为"已确认"或"已反馈"）
    - 归档条件已满足
    - 系统自动检查归档条件，满足条件后自动触发归档
  - **自动归档执行**：
    - 系统自动触发归档流程
    - 项目状态自动更新为"已归档"
    - 归档记录自动同步至档案管理模块
    - 项目团队成员权限自动调整为只读
    - 通知项目负责人、项目团队成员项目已归档
  - **归档记录管理**：
    - 归档记录查看（归档记录列表、归档记录详情）
    - 项目选择（仅显示满足归档条件的项目）
    - 归档原因录入（必填，归档原因、归档说明）
    - 归档时间设置（计划归档时间）
    - 归档申请提交（提交后进入审批流程）
  - **归档审批流程**：
    - 归档申请提交后，自动进入审批流程
    - 审批流程在系统管理模块（19.1.7）中配置
    - 支持多级审批（审批流程可配置）
    - 审批人查看归档文件清单（预览待归档文件）
    - 审批意见录入（审批意见、审批说明）
    - 审批通过：进入归档执行阶段
    - 审批驳回：退回申请人，需填写驳回原因
    - 审批记录（审批意见、审批人、审批时间、审批状态）
  - **归档执行阶段**：
    - 归档文件自动收集：
      - 项目基本信息（项目信息、客户信息、合同信息）
      - 图纸文件（从图纸管理模块4.3获取所有图纸）
      - 意见文件（从意见管理模块4.4获取所有意见）
      - 交付文件（已自动归档的交付文件，从收发管理模块5获取）
      - 结算文件（从结算管理模块6获取结算相关文件）
      - 回款文件（从回款管理模块7获取回款相关文件）
      - 其他过程文件（项目复盘、会议纪要、三方会议记录等）
    - 归档文件分类整理：
      - 按文件类型分类（图纸、意见、报告、结算、回款等）
      - 按专业分类（建筑、结构、给排水、电气、暖通等）
      - 按阶段分类（立项、生产、结算、回款等）
      - 按时间分类（按创建时间、修改时间分类）
    - 归档文件清单生成：
      - 自动生成归档文件清单（文件名称、文件类型、文件大小、创建时间等）
      - 文件清单导出（Excel格式、PDF格式）
      - 文件清单预览（在线预览文件清单）
    - 归档编号自动生成（ARCH-PROJ-{YYYYMMDD}-{序列号}）
    - 归档时间记录（自动记录归档执行时间）
    - 归档执行人记录（自动记录归档执行人）
  - **归档确认**：
    - 归档完成确认（档案管理员确认归档完成）
    - 归档状态更新（归档中 → 已归档）
    - 归档完成时间记录（自动记录）
    - 归档完成通知（通知项目负责人归档完成）
  - **归档状态管理**：
    - 归档状态：待归档、归档审批中、归档执行中、已归档、归档驳回
    - 归档状态流转：待归档 → 归档审批中 → 归档执行中 → 已归档
    - 归档状态查询（按归档状态筛选）
  - **归档后处理**：
    - 项目数据只读权限（项目团队成员权限自动调整为只读）
    - 归档文件统一管理（支持查询、下载、借阅）
    - 归档统计更新（归档项目数量、归档文件数量）
- ✅ **图纸归档**
  - 图纸归档操作（从图纸管理模块选择图纸进行归档）
  - 图纸归档申请创建（图纸选择、归档原因、归档时间、归档人）
  - 图纸归档审批流程（支持多级审批）
  - 归档分类（按项目、按批次、按图纸类型、按专业等分类）
  - 归档时间记录（自动记录）
  - 归档人记录（自动记录）
  - 归档状态标记（待归档、归档中、已归档）
  - 图纸归档清单生成（图纸归档清单、清单导出）
  - 图纸版本管理（图纸版本号、版本历史）
- ✅ **交付归档**
  - 交付归档操作（从收发管理模块选择交付记录进行归档）
  - 交付归档申请创建（交付记录选择、归档原因、归档时间、归档人）
  - 交付归档审批流程（支持多级审批）
  - 交付文件自动归档（交付文件自动归档到项目档案）
  - 交付记录归档（交付记录归档、交付跟踪记录归档）
  - 客户反馈归档（客户反馈归档、满意度评价归档）
  - 归档时间记录（自动记录）
  - 归档状态管理（待归档、归档中、已归档）
- ✅ **归档项目列表**
  - 归档项目列表展示（分页）
  - 归档时间筛选（按归档时间范围筛选）
  - 项目搜索（项目编号、项目名称、客户名称、归档编号）
  - 归档状态筛选（待归档、归档中、已归档）
  - 项目类型筛选（按项目类型筛选）
  - 归档人筛选（按归档人筛选）
  - 归档项目统计（归档项目数量、归档文件数量）
- ✅ **归档项目查看**
  - 归档项目详情查看（项目基本信息、归档信息、归档文件清单）
  - 归档文件查看（按分类展示、文件树展示）
  - 归档文件预览（在线预览、支持多种格式）
  - 归档文件下载（单个文件下载、批量下载、下载权限控制）
  - 归档历史记录（归档历史记录列表、归档操作记录）
  - 归档文件统计（归档文件数量、文件类型统计、文件大小统计）
  - 归档关联信息（关联项目信息、关联交付记录、关联图纸记录）

#### 13.2 档案分类管理
**功能说明**：管理档案分类体系，包括项目档案分类和行政档案分类。支持多级分类、分类规则设置、分类编码规则等。

**功能列表**：
- ✅ **档案分类列表**
  - 分类列表展示（树形结构、支持展开/折叠）
  - 分类类型筛选（项目档案分类、行政档案分类）
  - 分类搜索（分类名称、分类代码）
  - 分类层级展示（显示分类层级、分类路径）
  - 分类统计（每个分类下的档案数量）
- ✅ **档案分类创建**
  - 分类名称录入（必填）
  - 分类代码录入（必填，唯一性检查）
  - 分类类型选择（项目档案分类、行政档案分类）
  - 上级分类选择（选择上级分类，支持多级分类）
  - 分类描述录入（分类说明、分类用途）
  - 分类排序设置（分类显示顺序）
  - 分类图标设置（分类图标选择）
  - 分类规则设置（分类规则、分类条件）
  - 保管期限设置（保管期限、保管期限单位）
  - 密级设置（分类密级、保密级别）
- ✅ **档案分类编辑**
  - 分类信息编辑（分类名称、分类代码、分类描述）
  - 分类层级调整（调整分类层级、移动分类）
  - 分类排序调整（调整分类显示顺序）
  - 分类规则调整（调整分类规则、分类条件）
  - 保管期限调整（调整保管期限）
  - 密级调整（调整分类密级）
- ✅ **档案分类删除**
  - 分类删除（需检查关联档案，有关联档案时不允许删除）
  - 删除确认（删除确认提示）
  - 批量删除（批量删除分类，需检查关联档案）
- ✅ **分类规则管理**
  - 分类规则设置（分类规则、分类条件、分类规则表达式）
  - 自动分类规则（自动分类规则设置、规则优先级）
  - 分类规则测试（分类规则测试、规则验证）
  - 分类规则导入导出（分类规则导入、分类规则导出）
- ✅ **分类编码规则**
  - 编码规则设置（编码规则、编码格式、编码生成规则）
  - 编码规则测试（编码规则测试、编码生成测试）
  - 编码规则导入导出（编码规则导入、编码规则导出）

#### 13.3 行政档案管理
**功能说明**：管理公司的行政档案，包括档案分类、档案归档、档案借阅、档案归还、档案销毁等，实现行政档案的规范化管理。支持档案的全生命周期管理。

**功能列表**：
- ✅ **档案分类管理**
  - 档案分类列表（树形结构、支持展开/折叠）
  - 档案分类创建（分类名称、分类编码、上级分类、分类描述、保管期限、密级）
  - 档案分类编辑（分类信息编辑、分类层级调整）
  - 档案分类删除（删除分类，需检查是否有档案）
  - 档案分类排序（调整分类顺序）
  - 分类统计（每个分类下的档案数量）
- ✅ **档案归档**
  - 档案归档申请创建（档案名称、档案分类、档案编号、归档日期、归档人、归档部门、档案文件、档案描述、档案密级、保管期限）
  - 档案编号自动生成（ARCH-{YYYYMMDD}-{序列号}）
  - 档案编号规则设置（编号规则、编号格式、编号生成规则）
  - 档案归档审批流程（支持多级审批、审批流程配置）
  - 档案归档审批记录（审批意见、审批人、审批时间、审批状态）
  - 档案入库（档案入库操作、入库位置、入库时间、入库人、库房选择、架位选择）
  - 档案上架（档案上架操作、上架位置记录、上架时间记录）
  - 档案列表展示（分页、多维度筛选、搜索）
  - 档案详情查看（档案基本信息、档案文件、档案历史记录、档案位置信息）
  - 档案编辑（档案信息编辑、档案文件编辑、档案位置调整）
  - 档案著录（档案著录信息录入、著录字段配置、著录模板）
- ✅ **档案借阅**
  - 档案借阅申请创建（借阅档案、借阅事由、借阅日期、归还日期、借阅人、借阅部门、借阅用途、借阅方式）
  - 借阅方式选择（现场查阅、借出、复印、扫描）
  - 档案借阅审批流程（支持多级审批、审批流程配置）
  - 档案借阅审批记录（审批意见、审批人、审批时间、审批状态）
  - 档案借阅出库（档案借阅出库操作、出库时间、出库人、出库位置记录）
  - 借阅记录列表（借阅记录列表、借阅记录详情、借阅状态筛选）
  - 借阅状态管理（待审批、审批中、已批准、已出库、已归还、已拒绝）
  - 借阅超期提醒（借阅超期提醒、超期天数计算、超期处理）
  - 借阅续借（借阅续借申请、续借审批、续借时间延长）
  - 借阅统计（借阅次数统计、借阅率统计、超期率统计）
- ✅ **档案归还**
  - 档案归还操作（档案归还操作、归还时间、归还人、归还状态检查）
  - 归还状态检查（档案完整性检查、档案损坏检查、档案缺失检查）
  - 归还记录录入（归还记录、归还状态、归还说明）
  - 档案入库（归还后档案入库、入库位置记录、入库时间记录）
  - 归还记录列表（归还记录列表、归还记录详情）
  - 归还超期处理（归还超期处理、超期原因记录、超期处理措施）
- ✅ **档案销毁**
  - 档案销毁申请创建（销毁档案、销毁原因、销毁日期、销毁人、销毁方式、销毁依据）
  - 销毁条件检查（保管期限检查、销毁条件验证）
  - 档案销毁审批流程（支持多级审批、审批流程配置）
  - 档案销毁审批记录（审批意见、审批人、审批时间、审批状态）
  - 档案销毁执行（档案销毁操作、销毁记录、销毁证明、销毁照片）
  - 档案销毁记录列表（销毁记录列表、销毁记录详情）
  - 销毁档案清单（销毁档案清单、清单导出）
  - 销毁统计（销毁数量统计、销毁原因统计）

#### 13.4 档案库管理
**功能说明**：管理档案库房、架位、上架、盘点等，实现档案的物理位置管理和库房管理。

**功能列表**：
- ✅ **库房管理**
  - 库房列表展示（库房列表、库房详情）
  - 库房创建（库房名称、库房编号、库房位置、库房面积、库房容量、库房负责人、库房描述）
  - 库房编号自动生成（ROOM-{序列号}）
  - 库房编辑（库房信息编辑）
  - 库房删除（删除库房，需检查是否有档案）
  - 库房状态管理（启用、停用、维护中）
  - 库房统计（库房档案数量、库房使用率、库房容量统计）
- ✅ **位置管理**
  - 位置列表展示（按库房展示位置列表）
  - 位置创建（位置名称、位置编号、所属库房、位置类型、位置容量、位置描述）
  - 位置类型设置（架位、柜位、箱位、其他）
  - 位置编号规则（位置编号规则、编号格式）
  - 位置编辑（位置信息编辑）
  - 位置删除（删除位置，需检查是否有档案）
  - 位置树形展示（库房-位置树形结构）
  - 位置统计（位置档案数量、位置使用率）
- ✅ **档案上架**
  - 档案上架操作（选择档案、选择位置、上架时间、上架人）
  - 上架位置记录（上架位置、上架时间、上架人）
  - 上架记录列表（上架记录列表、上架记录详情）
  - 上架位置查询（按位置查询档案、按档案查询位置）
  - 上架位置调整（档案位置调整、位置变更记录）
- ✅ **档案盘点**
  - 盘点计划创建（盘点名称、盘点范围、盘点时间、盘点人、盘点方式）
  - 盘点方式设置（全面盘点、抽样盘点、重点盘点）
  - 盘点范围设置（按库房、按分类、按时间范围）
  - 盘点执行（盘点操作、盘点记录、盘点结果录入）
  - 盘点结果统计（盘点结果统计、盘点差异统计）
  - 盘点差异处理（盘点差异处理、差异原因记录、差异处理措施）
  - 盘点记录列表（盘点记录列表、盘点记录详情）
  - 盘点报告生成（盘点报告生成、盘点报告导出）

#### 13.5 档案安全
**功能说明**：管理档案的安全，包括权限管理、访问控制、操作日志、安全审计等，确保档案的安全性和可追溯性。

**功能列表**：
- ✅ **权限管理**
  - 权限角色管理（角色列表、角色创建、角色编辑、角色删除）
  - 权限分配（角色权限分配、用户权限分配）
  - 权限类型设置（查看权限、下载权限、编辑权限、删除权限、归档权限、借阅权限、销毁权限）
  - 档案密级管理（密级设置、密级权限控制）
  - 权限继承（分类权限继承、项目权限继承）
  - 权限审批（权限申请、权限审批、权限授予）
- ✅ **访问控制**
  - 访问控制规则设置（访问控制规则、访问条件、访问时间限制）
  - 访问权限检查（访问权限检查、权限验证）
  - 访问日志记录（访问日志、访问时间、访问人、访问操作）
  - IP地址限制（IP地址白名单、IP地址黑名单）
  - 访问频率限制（访问频率限制、访问次数统计）
  - 异常访问预警（异常访问检测、异常访问预警）
- ✅ **操作日志**
  - 操作日志记录（操作类型、操作人、操作时间、操作内容、操作结果）
  - 操作类型设置（上传、下载、编辑、删除、归档、借阅、归还、销毁、移动、复制）
  - 操作日志查询（操作日志列表、操作日志搜索、操作日志筛选）
  - 操作日志导出（操作日志导出、日志报表生成）
  - 操作日志统计（操作统计、操作趋势分析）
- ✅ **安全审计**
  - 安全审计规则设置（审计规则、审计条件、审计频率）
  - 安全审计执行（审计执行、审计记录、审计结果）
  - 安全审计报告（审计报告生成、审计报告导出）
  - 安全事件管理（安全事件记录、安全事件处理、安全事件统计）
  - 安全风险评估（安全风险评估、风险等级评定、风险处理措施）

#### 13.6 档案数字化
**功能说明**：管理档案的数字化，包括数字化申请、数字化处理、数字化成果管理等，实现档案的数字化管理。

**功能列表**：
- ✅ **数字化申请**
  - 数字化申请创建（申请档案、数字化类型、数字化原因、申请时间、申请人、申请部门）
  - 数字化类型设置（扫描、OCR识别、格式转换、其他）
  - 数字化申请审批流程（支持多级审批）
  - 数字化申请审批记录（审批意见、审批人、审批时间、审批状态）
  - 数字化申请列表（申请列表、申请状态筛选）
  - 数字化优先级设置（优先级设置、优先级排序）
- ✅ **数字化处理**
  - 数字化任务分配（任务分配、处理人、处理时间）
  - 数字化处理操作（数字化处理、处理进度更新、处理结果录入）
  - 数字化处理记录（处理记录、处理时间、处理人、处理结果）
  - 数字化质量检查（质量检查、质量评分、质量反馈）
  - 数字化进度跟踪（进度跟踪、进度统计）
- ✅ **数字化成果**
  - 数字化成果管理（数字化文件、数字化成果列表、成果查看）
  - 数字化成果关联（数字化成果关联原档案、关联关系维护）
  - 数字化成果预览（在线预览、支持多种格式）
  - 数字化成果下载（数字化成果下载、下载权限控制）
  - 数字化成果统计（数字化成果统计、数字化率统计）

#### 13.7 档案检索
**功能说明**：提供强大的档案检索功能，包括全文检索、高级检索、检索历史等，支持多维度、多条件的档案检索。

**功能列表**：
- ✅ **全文检索**
  - 全文检索功能（全文检索、关键词搜索、模糊搜索）
  - 检索范围设置（检索范围、检索类型、检索条件）
  - 检索结果展示（检索结果列表、结果排序、结果筛选）
  - 检索结果高亮（关键词高亮、结果摘要）
  - 检索结果统计（检索结果数量、检索耗时）
- ✅ **高级检索**
  - 高级检索条件设置（多条件组合、条件逻辑关系、条件值设置）
  - 检索字段选择（档案名称、档案编号、档案分类、归档时间、归档人、项目名称、客户名称等）
  - 检索条件保存（检索条件保存、检索条件复用）
  - 检索结果导出（检索结果导出、结果报表生成）
  - 检索历史记录（检索历史、历史检索复用）
- ✅ **检索历史**
  - 检索历史记录（检索历史列表、检索时间、检索条件、检索结果数量）
  - 检索历史查看（检索历史详情、检索结果查看）
  - 检索历史复用（检索历史复用、检索条件复用）
  - 检索历史删除（检索历史删除、历史清理）
  - 检索统计（检索次数统计、检索关键词统计、检索趋势分析）

#### 13.8 档案查询
**功能说明**：统一查询项目档案和行政档案，支持多维度检索和查询。

**功能列表**：
- ✅ **档案检索**
  - 档案类型筛选（项目档案、行政档案）
  - 档案搜索（项目编号、项目名称、客户名称、档案名称、档案编号）
  - 档案分类筛选（按分类树筛选）
  - 归档时间筛选（按时间范围筛选）
  - 归档人筛选（按归档人筛选）
  - 档案状态筛选（已归档、已借出、已销毁）
  - 档案密级筛选（按密级筛选）
- ✅ **档案查看**
  - 档案详情查看（档案基本信息、档案文件、档案历史记录、档案位置信息）
  - 档案文件查看（在线预览、支持多种格式、文件下载）
  - 档案关联信息查看（关联项目、关联部门、关联交付记录等）
  - 档案版本历史（档案版本历史、版本对比）
  - 档案操作历史（档案操作历史、操作记录查看）
- ✅ **档案下载**
  - 档案文件下载（单个文件下载、批量下载、下载权限控制）
  - 下载记录（下载人、下载时间、下载文件、下载IP）
  - 下载权限控制（下载权限检查、下载审批）
  - 下载统计（下载次数统计、下载文件统计、下载趋势分析）

#### 13.9 档案统计（集成在档案列表页面中）
**功能说明**：提供档案统计功能，包括档案统计、利用统计、保管统计等，支持多维度统计分析。

**功能列表**：
- ✅ **档案统计**
  - 档案数量统计（总档案数、各类型档案数、各分类档案数、各库房档案数）
  - 档案增长统计（档案增长趋势、增长速率、增长预测）
  - 档案类型统计（项目档案数量、行政档案数量、各类型占比）
  - 档案分类统计（各分类档案数量、分类占比、分类趋势）
  - 档案密级统计（各密级档案数量、密级分布）
  - 档案状态统计（已归档、已借出、已销毁等状态统计）
- ✅ **利用统计**
  - 借阅统计（借阅次数、借阅率、借阅趋势、借阅类型统计）
  - 下载统计（下载次数、下载率、下载趋势、下载文件统计）
  - 检索统计（检索次数、检索关键词、检索趋势、检索类型统计）
  - 利用效率统计（利用效率、利用频率、利用分布）
  - 利用分析（利用分析、利用报告、利用建议）
- ✅ **保管统计**
  - 保管期限统计（各保管期限档案数量、到期档案数量、到期提醒）
  - 库房使用统计（库房使用率、库房容量统计、库房分布）
  - 位置使用统计（位置使用率、位置分布、位置利用率）
  - 盘点统计（盘点次数、盘点结果、盘点差异统计）
  - 保管质量统计（保管质量、保管问题、保管改进）

---

### 14. 资源管理
- **状态**：⏳ 计划中
- **完成度**：0%
- **说明**：全面管理企业的各类资源，包括技术标准、设计规范、图纸模板、计算工具、知识文档、案例库、综合单价库等。实现资源的统一管理、分类存储、权限控制、使用跟踪、价值评估等功能，建立企业资源库，提升资源利用效率，促进知识共享和经验传承。综合单价库由造价工程师维护，专业工程师在生产管理模块创建意见时可调用综合单价库。

**资源管理价值**：
```
┌─────────────────────────────────────────────────────────────┐
│              资源管理价值体系                                  │
├─────────────────────────────────────────────────────────────┤
│ 1. 知识沉淀                                                  │
│    ├── 技术标准、设计规范、图纸模板等标准化资源             │
│    ├── 项目案例、经验总结、最佳实践等知识资源               │
│    └── 计算工具、设计软件、辅助工具等技术资源               │
│                                                             │
│ 2. 效率提升                                                  │
│    ├── 快速检索：快速找到所需资源，减少重复工作             │
│    ├── 模板复用：使用标准模板，提高工作效率                 │
│    └── 工具共享：共享计算工具和设计软件，提升生产力         │
│                                                             │
│ 3. 质量保障                                                  │
│    ├── 标准化：使用标准资源，确保工作质量                   │
│    ├── 规范化：遵循规范要求，统一工作标准                   │
│    └── 经验传承：传承最佳实践，避免重复错误                 │
│                                                             │
│ 4. 价值评估                                                  │
│    ├── 使用统计：统计资源使用情况，评估资源价值             │
│    ├── 效果评估：评估资源使用效果，优化资源配置             │
│    └── 价值分析：分析资源价值，指导资源建设                 │
└─────────────────────────────────────────────────────────────┘
```

**资源类型**：
- **技术标准**：国家标准、行业标准、企业标准、地方标准等
- **设计规范**：设计规范、技术规范、施工规范等
- **图纸模板**：标准图纸模板、图纸图例、图纸样式等
- **计算工具**：计算表格、计算软件、计算小程序等
- **知识文档**：技术文档、经验总结、最佳实践、培训资料等
- **案例库**：项目案例、设计案例、问题案例、解决方案等
- **综合单价库**：各类材料、项目的综合单价，用于结果优化和过程优化服务类型中的节省金额计算
- **其他资源**：软件工具、参考资料、其他辅助资源等

#### 14.1 资源标准管理
**功能说明**：管理企业的各类标准资源，包括技术标准、设计规范等。支持标准的创建、编辑、版本管理、应用跟踪等功能。

**功能列表**：
- ✅ **资源标准列表**
  - 标准列表展示（分页）
  - 标准类型筛选（技术标准、设计规范、其他标准）
  - 标准分类筛选（按分类树筛选）
  - 标准状态筛选（草稿、已发布、已停用）
  - 标准搜索（标准名称、标准编号、标准内容）
  - 标准排序（按创建时间、更新时间、使用次数排序）
  - 标准统计卡片（标准总数、已发布标准、使用次数）
- ✅ **资源标准创建**
  - 标准名称录入（必填）
  - 标准编号录入（必填，唯一性检查）
  - 标准编号自动生成（STD-{YYYYMMDD}-{序列号}）
  - 标准类型选择（技术标准、设计规范、其他标准）
  - 标准分类选择（必填，从分类树选择）
  - 标准内容录入（标准内容、标准说明）
  - 标准文件上传（支持多文件、支持多种格式）
  - 标准版本设置（版本号、版本说明）
  - 标准适用范围设置（适用范围、适用条件）
  - 标准标签设置（标签添加、标签管理）
  - 标准密级设置（公开、内部、保密）
  - 标准状态设置（草稿、已发布、已停用）
  - 标准创建人记录（自动记录）
  - 标准创建时间记录（自动记录）
- ✅ **资源标准编辑**
  - 标准信息编辑（标准名称、标准编号、标准类型、标准分类）
  - 标准内容编辑（标准内容、标准说明）
  - 标准文件编辑（文件上传、文件删除、文件替换）
  - 标准版本更新（版本号更新、版本说明录入）
  - 版本历史记录（版本历史列表、版本对比）
  - 标准适用范围调整（适用范围调整、适用条件调整）
  - 标准标签编辑（标签添加、标签删除）
  - 标准状态调整（状态调整、停用原因录入）
- ✅ **标准版本管理**
  - 版本列表展示（版本列表、版本详情）
  - 版本创建（新版本创建、版本号设置、版本说明）
  - 版本对比（版本内容对比、版本差异展示）
  - 版本回退（版本回退操作、回退确认）
  - 版本发布（版本发布操作、发布通知）
  - 版本使用统计（版本使用次数、版本使用情况）
- ✅ **标准应用跟踪**
  - 标准应用记录（应用记录列表、应用时间、应用人、应用项目）
  - 标准使用统计（使用次数、使用频率、使用趋势）
  - 标准效果评估（效果评估、效果反馈）
  - 标准关联项目（关联项目列表、项目详情）

#### 14.2 资源库管理
**功能说明**：管理企业的资源库，包括各类资源的统一管理、分类存储、标签管理、检索利用等。

**功能列表**：
- ✅ **资源库管理**
  - 资源列表展示（分页）
  - 资源类型筛选（技术标准、设计规范、图纸模板、计算工具、知识文档、案例库、其他资源）
  - 资源分类筛选（按分类树筛选）
  - 资源状态筛选（草稿、已发布、已停用、已删除）
  - 资源搜索（资源名称、资源编号、资源内容、资源标签）
  - 资源排序（按创建时间、更新时间、使用次数、下载次数排序）
  - 资源统计卡片（资源总数、各类型资源数、使用次数、下载次数）
- ✅ **资源上传**
  - 资源创建（资源名称、资源编号、资源类型、资源分类）
  - 资源编号自动生成（RES-{YYYYMMDD}-{序列号}）
  - 资源内容录入（资源内容、资源说明、资源描述）
  - 资源文件上传（支持多文件、支持多种格式、支持批量上传）
  - 资源标签设置（标签添加、标签选择、标签管理）
  - 资源密级设置（公开、内部、保密）
  - 资源权限设置（查看权限、下载权限、编辑权限）
  - 资源状态设置（草稿、已发布、已停用）
  - 资源创建人记录（自动记录）
  - 资源创建时间记录（自动记录）
- ✅ **资源编辑**
  - 资源信息编辑（资源名称、资源编号、资源类型、资源分类）
  - 资源内容编辑（资源内容、资源说明、资源描述）
  - 资源文件编辑（文件上传、文件删除、文件替换）
  - 资源标签编辑（标签添加、标签删除）
  - 资源权限调整（权限调整、权限审批）
  - 资源状态调整（状态调整、停用原因录入）
  - 资源删除（资源删除、删除确认、删除记录）
- ✅ **资源分类管理**
  - 分类列表展示（树形结构、支持展开/折叠）
  - 分类创建（分类名称、分类编码、上级分类、分类描述、分类图标）
  - 分类编码自动生成（CAT-{序列号}）
  - 分类编辑（分类信息编辑、分类层级调整）
  - 分类删除（删除分类，需检查关联资源）
  - 分类排序（调整分类显示顺序）
  - 分类统计（每个分类下的资源数量）
- ✅ **标签管理**
  - 标签列表展示（标签列表、标签统计）
  - 标签创建（标签名称、标签颜色、标签描述）
  - 标签编辑（标签信息编辑）
  - 标签删除（删除标签，需检查关联资源）
  - 标签合并（标签合并操作、合并确认）
  - 标签统计（标签使用次数、标签使用情况）
- ✅ **资源检索**
  - 关键词搜索（关键词搜索、模糊搜索、精确搜索）
  - 分类筛选（按分类树筛选）
  - 标签筛选（按标签筛选、多标签组合筛选）
  - 类型筛选（按资源类型筛选）
  - 状态筛选（按资源状态筛选）
  - 高级搜索（多条件组合、条件逻辑关系、条件值设置）
  - 检索结果展示（检索结果列表、结果排序、结果筛选）
  - 检索结果高亮（关键词高亮、结果摘要）
  - 检索历史记录（检索历史、历史检索复用）
- ✅ **资源预览与下载**
  - 资源预览（在线预览、支持多种格式）
  - 资源下载（单个文件下载、批量下载、下载权限控制）
  - 下载记录（下载人、下载时间、下载文件、下载IP）
  - 下载统计（下载次数统计、下载文件统计、下载趋势分析）

#### 14.3 资源使用管理
**功能说明**：管理资源的使用，包括使用申请、使用审批、使用记录等，实现资源使用的规范化管理。

**功能列表**：
- ✅ **使用申请**
  - 使用申请创建（申请资源、使用事由、使用时间、使用人、使用部门、使用项目）
  - 使用方式选择（查看、下载、编辑、其他）
  - 使用申请提交（申请提交、申请状态更新）
  - 使用申请列表（申请列表、申请状态筛选）
  - 申请状态管理（待审批、审批中、已批准、已拒绝、已使用）
- ✅ **使用审批**
  - 使用审批列表（待审批、审批中、已审批、已拒绝）
  - 使用审批流程（支持多级审批、审批流程配置）
  - 使用审批操作（审批通过、审批拒绝、审批意见录入）
  - 审批意见录入（审批意见、审批说明）
  - 审批时间记录（自动记录）
  - 审批人记录（自动记录）
  - 审批历史记录（审批历史记录列表）
- ✅ **使用记录**
  - 使用记录列表（使用记录列表、使用记录详情）
  - 使用记录查询（按资源、按用户、按时间、按项目查询）
  - 使用记录统计（使用次数统计、使用频率统计、使用趋势分析）
  - 使用效果评估（使用效果评估、效果反馈）
  - 使用关联信息（关联项目、关联用户、关联部门）

#### 14.4 资源权限管理
**功能说明**：管理资源的权限，包括权限管理、访问控制等，确保资源的安全使用。

**功能列表**：
- ✅ **权限管理**
  - 权限角色管理（角色列表、角色创建、角色编辑、角色删除）
  - 权限分配（角色权限分配、用户权限分配）
  - 权限类型设置（查看权限、下载权限、编辑权限、删除权限、管理权限）
  - 资源密级管理（密级设置、密级权限控制）
  - 权限继承（分类权限继承、项目权限继承）
  - 权限审批（权限申请、权限审批、权限授予）
- ✅ **访问控制**
  - 访问控制规则设置（访问控制规则、访问条件、访问时间限制）
  - 访问权限检查（访问权限检查、权限验证）
  - 访问日志记录（访问日志、访问时间、访问人、访问操作）
  - IP地址限制（IP地址白名单、IP地址黑名单）
  - 访问频率限制（访问频率限制、访问次数统计）
  - 异常访问预警（异常访问检测、异常访问预警）

#### 14.5 资源统计（集成在资源列表页面中）
**功能说明**：提供资源统计功能，包括使用统计、价值统计、趋势分析等，支持多维度统计分析。

**功能列表**：
- ✅ **使用统计**
  - 资源使用次数统计（总使用次数、各类型资源使用次数、各分类资源使用次数）
  - 资源下载次数统计（总下载次数、各类型资源下载次数、各分类资源下载次数）
  - 资源使用频率统计（使用频率、使用频率分布、使用频率趋势）
  - 资源使用用户统计（使用用户数、用户使用情况、用户使用排名）
  - 资源使用项目统计（使用项目数、项目使用情况、项目使用排名）
  - 热门资源分析（热门资源列表、热门资源排名、热门资源趋势）
- ✅ **价值统计**
  - 资源价值评估（资源价值评估、价值评分、价值等级）
  - 资源使用效果评估（使用效果评估、效果评分、效果反馈）
  - 资源贡献度统计（资源贡献度、贡献度排名、贡献度趋势）
  - 资源建设投入统计（建设投入、投入产出比、投入效果）
  - 资源价值分析（价值分析、价值报告、价值建议）
- ✅ **趋势分析**
  - 资源增长趋势（资源数量增长趋势、增长速率、增长预测）
  - 资源使用趋势（使用次数趋势、使用频率趋势、使用趋势预测）
  - 资源下载趋势（下载次数趋势、下载频率趋势、下载趋势预测）
  - 资源价值趋势（价值变化趋势、价值趋势预测）
  - 资源类型分布（各类型资源分布、分布变化趋势）
  - 资源分类分布（各分类资源分布、分布变化趋势）

#### 14.6 综合单价库管理
**功能说明**：综合单价库管理用于存储和管理各类材料、项目的综合单价，支持结果优化和过程优化服务类型中的节省金额计算。单价库由造价工程师维护，专业工程师在生产管理模块创建意见时可以从单价库中搜索并选择单价，若单价库中无此项，可以申请补充。

**详细功能**：

##### 14.6.1 单价库列表
- ⏳ **列表展示**
  - 单价库列表展示（分页，每页默认50条）
  - 显示字段：材料/项目名称、专业分类、优化前综合单价(P1)、优化后综合单价(P2)、单位、创建人、创建时间、最后修改时间、使用次数
  - 支持列表视图和表格视图切换
- ⏳ **搜索功能**
  - 支持搜索材料/项目名称（模糊搜索）
  - 支持搜索专业分类
  - 支持组合搜索
  - 搜索结果高亮显示
- ⏳ **筛选功能**
  - 按专业分类筛选（建筑、结构、给排水、电气、暖通等）
  - 按创建时间筛选（日期范围选择器）
  - 按创建人筛选（下拉选择，支持搜索）
  - 按使用频率筛选（高频、中频、低频）
- ⏳ **排序功能**
  - 按材料/项目名称排序（A-Z、Z-A）
  - 按创建时间排序（最新、最旧）
  - 按使用次数排序（从高到低、从低到高）
- ⏳ **单价库导入**
  - 支持Excel格式导入（.xlsx）
  - 导入模板下载
  - 导入字段：材料/项目名称、专业分类、优化前综合单价(P1)、优化后综合单价(P2)、单位
  - 导入数据验证（格式检查、重复检查）
  - 导入结果展示（成功数量、失败数量、失败原因）
  - 支持批量导入

##### 14.6.2 单价库维护
- ⏳ **单价创建**
  - 材料/项目名称录入（必填，最大长度200字符）
  - 专业分类选择（必填，下拉选择：建筑、结构、给排水、电气、暖通等）
  - 优化前综合单价(P1)录入（必填，数值输入，支持小数点后2位，单位：元）
  - 优化后综合单价(P2)录入（必填，数值输入，支持小数点后2位，单位：元）
  - 单位设置（必填，下拉选择：m³、m²、m、t、kg、个等）
  - 单价说明录入（可选，说明单价的来源、适用范围等）
  - 单价有效期设置（可选，设置单价的生效时间和失效时间）
- ⏳ **单价编辑**
  - 支持编辑单价信息（需权限控制）
  - 编辑历史记录（记录每次修改的变更内容、修改人、修改时间）
  - 版本管理（每次修改自动创建新版本，保留历史版本）
- ⏳ **单价删除**
  - 支持删除单价（需权限控制，软删除）
  - 删除前检查使用情况（若有关联的意见使用此单价，需先解除关联）
  - 删除原因录入
  - 删除记录（记录删除人、删除时间、删除原因）

##### 14.6.3 单价申请处理
- ⏳ **单价申请列表**
  - 申请列表展示（分页，每页默认20条）
  - 显示字段：申请编号、材料/项目名称、专业分类、申请理由、申请人、申请时间、处理状态、处理人、处理时间
  - 按处理状态筛选（待处理、处理中、已完成、已驳回）
  - 按专业分类筛选
  - 按申请时间筛选
- ⏳ **单价申请详情查看**
  - 申请基本信息（申请编号、材料/项目名称、专业分类、申请理由）
  - 申请人信息（姓名、部门、联系方式）
  - 关联意见信息（关联的意见编号、意见标题）
  - 处理记录（处理状态、处理意见、处理人、处理时间）
- ⏳ **单价补充录入**
  - 造价工程师查看申请详情
  - 补充单价信息（优化前综合单价P1、优化后综合单价P2、单位）
  - 填写处理意见（可选）
  - 提交处理结果（通过/驳回）
  - 系统自动回填单价到申请的意见中
  - 系统自动通知申请人处理完成
- ⏳ **申请处理完成通知**
  - 处理完成后，系统自动通知申请人
  - 通知方式：系统通知、邮件通知（可选）
  - 通知内容：处理结果、补充的单价信息、处理意见

---

### 15. 风险管理
- **状态**：⏳ 计划中
- **完成度**：0%
- **说明**：全面管理企业的各类风险，包括项目风险、合同风险、财务风险、运营风险等。实现风险的全生命周期管理，从风险识别、风险评估、风险应对到风险监控的完整闭环。支持风险预警、风险跟踪、风险报告等功能，帮助企业及时发现风险、评估风险、应对风险，降低风险损失，保障企业安全运营。

**风险管理价值**：
```
┌─────────────────────────────────────────────────────────────┐
│              风险管理价值体系                                  │
├─────────────────────────────────────────────────────────────┤
│ 1. 风险识别                                                  │
│    ├── 主动识别：主动识别各类风险，提前发现潜在风险           │
│    ├── 全面覆盖：覆盖项目、合同、财务、运营等各类风险         │
│    └── 及时记录：及时记录风险信息，建立风险档案               │
│                                                             │
│ 2. 风险评估                                                  │
│    ├── 科学评估：科学评估风险概率和影响，量化风险等级         │
│    ├── 风险矩阵：建立风险矩阵，直观展示风险分布               │
│    └── 动态评估：动态评估风险变化，及时调整风险等级           │
│                                                             │
│ 3. 风险应对                                                  │
│    ├── 应对措施：制定应对措施，降低风险损失                   │
│    ├── 应对跟踪：跟踪应对措施执行，确保措施有效               │
│    └── 应对优化：优化应对措施，提高应对效果                   │
│                                                             │
│ 4. 风险监控                                                  │
│    ├── 实时监控：实时监控风险状态，及时发现风险变化           │
│    ├── 风险预警：建立预警机制，提前预警高风险事件             │
│    └── 监控报告：生成监控报告，支持管理决策                   │
└─────────────────────────────────────────────────────────────┘
```

**风险管理全生命周期**：
```
┌─────────────────────────────────────────────────────────────┐
│              风险管理全生命周期流程                            │
├─────────────────────────────────────────────────────────────┤
│ 1. 风险识别                                                  │
│    ├── 风险登记：登记风险信息，建立风险档案                   │
│    ├── 风险分类：按类型、级别、来源等分类                     │
│    └── 风险列表：统一管理风险列表，便于查询和管理             │
│                                                             │
│ 2. 风险评估                                                  │
│    ├── 风险分析：分析风险概率、影响、范围等                   │
│    ├── 风险等级：评估风险等级，划分风险级别                   │
│    └── 风险矩阵：建立风险矩阵，直观展示风险分布               │
│                                                             │
│ 3. 风险应对                                                  │
│    ├── 应对措施：制定应对措施，选择应对策略                   │
│    ├── 应对计划：制定应对计划，分配责任人和时间               │
│    └── 应对跟踪：跟踪应对措施执行，评估应对效果               │
│                                                             │
│ 4. 风险预警                                                  │
│    ├── 预警规则：设置预警规则，建立预警机制                   │
│    ├── 预警管理：管理预警信息，处理预警事件                   │
│    └── 预警通知：发送预警通知，及时提醒相关人员               │
│                                                             │
│ 5. 风险监控                                                  │
│    ├── 监控看板：实时监控风险状态，展示风险信息               │
│    ├── 监控报告：生成监控报告，分析风险趋势                   │
│    └── 监控统计：统计风险数据，支持管理决策                   │
│                                                             │
│ 6. 风险报告                                                  │
│    ├── 报告生成：生成风险报告，汇总风险信息                   │
│    ├── 报告查看：查看风险报告，了解风险情况                   │
│    └── 报告导出：导出风险报告，支持报告分享                   │
└─────────────────────────────────────────────────────────────┘
```

**风险类型**：
- **项目风险**：项目进度风险、项目质量风险、项目成本风险、项目技术风险等
- **合同风险**：合同履约风险、合同变更风险、合同争议风险、合同违约风险等
- **财务风险**：资金风险、回款风险、成本风险、税务风险等
- **运营风险**：市场风险、客户风险、供应商风险、合规风险等
- **其他风险**：人员风险、技术风险、环境风险、其他风险等

#### 15.1 风险识别
**功能说明**：识别和登记企业的各类风险，包括风险登记、风险列表、风险分类等，建立风险档案。

**功能列表**：
- ✅ **风险登记**
  - 风险登记表创建（风险基本信息录入）
  - 风险编号自动生成（RISK-{YYYYMMDD}-{序列号}）
  - 风险名称录入（必填）
  - 风险描述录入（风险详细描述、风险背景、风险原因）
  - 风险类型选择（项目风险、合同风险、财务风险、运营风险、其他风险）
  - 风险分类选择（技术风险、进度风险、质量风险、成本风险、合同风险、其他）
  - 风险来源选择（内部风险、外部风险、其他）
  - 风险关联项目选择（关联项目、项目编号、项目名称）
  - 风险关联客户选择（关联客户、客户名称、客户编号）
  - 风险关联合同选择（关联合同、合同编号、合同名称）
  - 风险发现时间记录（自动记录）
  - 风险发现人记录（自动记录）
  - 风险发现部门记录（自动记录）
  - 风险发现方式选择（主动识别、被动发现、其他）
  - 风险状态设置（已识别、评估中、已评估、应对中、已应对、已关闭）
- ✅ **风险列表**
  - 风险列表展示（分页）
  - 风险类型筛选（项目风险、合同风险、财务风险、运营风险、其他风险）
  - 风险分类筛选（技术风险、进度风险、质量风险、成本风险、合同风险、其他）
  - 风险状态筛选（已识别、评估中、已评估、应对中、已应对、已关闭）
  - 风险等级筛选（低、中、高、极高）
  - 风险来源筛选（内部风险、外部风险、其他）
  - 风险搜索（风险名称、风险编号、风险描述、关联项目、关联客户）
  - 风险排序（按发现时间、按风险等级、按风险状态排序）
  - 风险统计卡片（风险总数、各类型风险数、各等级风险数、各状态风险数）
- ✅ **风险分类**
  - 风险类型分类（项目风险、合同风险、财务风险、运营风险、其他风险）
  - 风险分类管理（分类创建、分类编辑、分类删除）
  - 风险级别分类（低、中、高、极高）
  - 风险来源分类（内部风险、外部风险、其他）
  - 风险标签管理（标签创建、标签编辑、标签删除、标签关联）
- ✅ **风险详情查看**
  - 风险基本信息展示（风险名称、风险编号、风险类型、风险分类、风险状态）
  - 风险描述查看（风险详细描述、风险背景、风险原因）
  - 风险关联信息查看（关联项目、关联客户、关联合同）
  - 风险发现信息查看（发现时间、发现人、发现部门、发现方式）
  - 风险评估信息查看（评估结果、评估时间、评估人）
  - 风险应对信息查看（应对措施、应对状态、应对效果）
  - 风险跟踪记录查看（跟踪记录列表、跟踪记录详情）

#### 15.2 风险评估
**功能说明**：评估风险的等级和影响，包括风险分析、风险等级划分、风险矩阵等，量化风险。

**功能列表**：
- ✅ **风险分析**
  - 风险概率评估（概率等级：很低、低、中、高、很高；概率值：0-100%）
  - 风险影响评估（影响等级：很低、低、中、高、很高；影响程度：影响范围、影响程度、影响时间）
  - 风险影响范围分析（影响范围：项目、部门、公司、其他）
  - 风险影响程度分析（影响程度：轻微、一般、严重、非常严重）
  - 风险影响时间分析（影响时间：短期、中期、长期）
  - 风险评估时间记录（自动记录）
  - 风险评估人记录（自动记录）
  - 风险评估部门记录（自动记录）
  - 风险评估说明录入（评估说明、评估依据、评估方法）
- ✅ **风险等级划分**
  - 风险等级自动计算（基于概率和影响，自动计算风险等级）
  - 风险等级计算公式（风险等级 = 风险概率 × 风险影响）
  - 风险等级标准设置（等级标准、等级阈值、等级说明）
  - 风险等级手动调整（手动调整风险等级、调整原因录入）
  - 风险等级确认（等级确认、确认时间、确认人）
  - 风险等级历史记录（等级历史、等级变化记录）
- ✅ **风险矩阵**
  - 风险矩阵展示（风险矩阵图、风险分布图）
  - 风险矩阵配置（矩阵维度、矩阵等级、矩阵颜色）
  - 风险矩阵分析（风险分布分析、高风险区域识别）
  - 风险矩阵导出（矩阵导出、矩阵打印）
- ✅ **风险评估管理**
  - 评估任务分配（评估任务分配、评估人选择、评估时间设置）
  - 评估任务列表（评估任务列表、任务状态、任务进度）
  - 评估结果审核（评估结果审核、审核意见、审核状态）
  - 评估结果确认（评估结果确认、确认时间、确认人）
  - 评估历史记录（评估历史、评估记录查询）

#### 15.3 风险应对
**功能说明**：制定和实施风险应对措施，包括应对措施制定、应对计划、应对跟踪等，降低风险损失。

**功能列表**：
- ✅ **应对措施制定**
  - 应对措施创建（应对措施名称、应对措施描述）
  - 应对措施类型选择（规避、减轻、转移、接受）
  - 应对策略说明（策略说明、策略依据、策略效果预期）
  - 应对措施责任人分配（责任人选择、责任部门选择）
  - 应对措施时间计划（开始时间、结束时间、计划周期）
  - 应对措施预算设置（预算金额、预算说明）
  - 应对措施优先级设置（优先级：低、中、高、紧急）
  - 应对措施状态设置（待执行、执行中、已完成、已取消）
  - 应对措施创建时间记录（自动记录）
  - 应对措施创建人记录（自动记录）
- ✅ **应对计划**
  - 应对计划创建（计划名称、计划描述、计划目标）
  - 应对计划步骤设置（步骤列表、步骤顺序、步骤内容）
  - 应对计划时间安排（时间安排、时间节点、里程碑）
  - 应对计划资源分配（资源分配、资源需求、资源预算）
  - 应对计划审批流程（审批流程、审批人、审批状态）
  - 应对计划执行跟踪（执行跟踪、执行进度、执行状态）
- ✅ **应对跟踪**
  - 风险状态跟踪（风险状态更新、状态变化记录）
  - 应对措施执行跟踪（执行进度更新、执行情况记录）
  - 应对措施效果评估（效果评估、效果评分、效果反馈）
  - 应对措施调整（措施调整、调整原因、调整记录）
  - 风险变化记录（风险变化记录、变化原因、变化影响）
  - 跟踪记录列表（跟踪记录列表、跟踪记录详情）
  - 跟踪记录查询（按风险、按时间、按责任人查询）
  - 跟踪记录统计（跟踪统计、跟踪趋势分析）

#### 15.4 风险预警
**功能说明**：建立风险预警机制，包括预警规则设置、预警管理、预警通知等，提前预警高风险事件。

**功能列表**：
- ✅ **预警规则设置**
  - 预警规则创建（规则名称、规则描述、规则条件）
  - 预警条件设置（风险等级、风险类型、风险状态、风险概率、风险影响）
  - 预警阈值设置（阈值设置、阈值类型、阈值值）
  - 预警级别设置（预警级别：一般、重要、紧急、特急）
  - 预警通知方式设置（通知方式：系统通知、邮件通知、短信通知、其他）
  - 预警通知对象设置（通知对象：责任人、部门负责人、高管、其他）
  - 预警规则启用/停用（规则状态、启用时间、停用原因）
- ✅ **预警管理**
  - 预警列表展示（预警列表、预警状态筛选）
  - 预警信息查看（预警详情、预警原因、预警级别）
  - 预警处理（预警处理、处理措施、处理结果）
  - 预警确认（预警确认、确认时间、确认人）
  - 预警关闭（预警关闭、关闭原因、关闭时间）
  - 预警统计（预警数量统计、预警级别统计、预警处理统计）
- ✅ **预警通知**
  - 预警通知发送（通知发送、通知时间、通知对象）
  - 预警通知记录（通知记录列表、通知记录详情）
  - 预警通知查询（按风险、按时间、按通知对象查询）
  - 预警通知统计（通知统计、通知趋势分析）
  - 预警通知设置（通知设置、通知模板、通知频率）

#### 15.5 风险监控
**功能说明**：实时监控风险状态，包括监控看板、监控报告、监控统计等，支持管理决策。

**功能列表**：
- ✅ **监控看板**
  - 风险监控看板（风险总览、风险分布、风险趋势）
  - 风险状态展示（各状态风险数量、状态分布图）
  - 风险等级展示（各等级风险数量、等级分布图）
  - 风险类型展示（各类型风险数量、类型分布图）
  - 高风险预警展示（高风险预警列表、预警详情）
  - 应对措施执行情况（执行进度、执行状态、执行效果）
  - 风险趋势图表（风险趋势图、风险变化趋势）
  - 看板刷新（数据刷新、刷新频率设置）
- ✅ **监控报告**
  - 监控报告生成（报告生成、报告模板、报告格式）
  - 报告内容设置（报告内容、报告字段、报告范围）
  - 报告时间设置（报告周期、报告时间、报告频率）
  - 报告接收人设置（接收人选择、接收方式）
  - 报告查看（报告查看、报告详情）
  - 报告导出（报告导出、报告格式：PDF、Excel、Word）
  - 报告历史记录（报告历史、报告记录查询）
- ✅ **监控统计**
  - 风险数量统计（总风险数、各类型风险数、各等级风险数、各状态风险数）
  - 风险趋势统计（风险增长趋势、风险变化趋势、风险预测）
  - 风险评估统计（评估数量、评估效率、评估准确性）
  - 风险应对统计（应对数量、应对效率、应对效果）
  - 风险预警统计（预警数量、预警级别分布、预警处理情况）
  - 风险损失统计（损失金额、损失趋势、损失分析）
  - 风险成本统计（应对成本、监控成本、总成本）

#### 15.6 风险报告
**功能说明**：生成和管理风险报告，包括报告生成、报告查看、报告导出等，支持风险信息的汇总和分析。

**功能列表**：
- ✅ **报告生成**
  - 风险报告创建（报告名称、报告类型、报告周期）
  - 报告类型选择（风险识别报告、风险评估报告、风险应对报告、风险监控报告、综合风险报告）
  - 报告内容设置（报告内容、报告字段、报告范围）
  - 报告模板选择（模板选择、模板应用、模板自定义）
  - 报告数据源设置（数据源选择、数据源配置、数据源过滤）
  - 报告格式设置（报告格式、报告样式、报告布局）
  - 报告生成时间设置（生成时间、生成频率、生成方式）
  - 报告生成操作（报告生成、生成进度、生成状态）
- ✅ **报告查看**
  - 报告列表展示（报告列表、报告状态筛选）
  - 报告详情查看（报告内容、报告数据、报告图表）
  - 报告在线预览（在线预览、预览格式、预览样式）
  - 报告搜索（报告名称、报告类型、报告时间）
  - 报告排序（按生成时间、按报告类型排序）
  - 报告收藏（报告收藏、收藏列表、收藏管理）
- ✅ **报告导出**
  - 报告导出格式（PDF、Excel、Word、其他格式）
  - 报告导出设置（导出范围、导出字段、导出格式）
  - 报告导出操作（导出操作、导出进度、导出状态）
  - 报告导出记录（导出记录列表、导出记录详情）
  - 报告导出统计（导出统计、导出趋势分析）
- ✅ **报告管理**
  - 报告编辑（报告编辑、报告内容修改、报告格式调整）
  - 报告删除（报告删除、删除确认、删除记录）
  - 报告分享（报告分享、分享链接、分享权限）
  - 报告审批（报告审批、审批流程、审批状态）
  - 报告归档（报告归档、归档时间、归档位置）

---

### 16. 诉讼管理
- **状态**：⏳ 计划中
- **完成度**：0%
- **说明**：全面管理企业的诉讼案件，包括案件登记、诉讼流程跟踪、诉讼文档管理、诉讼费用管理、人员管理、时间管理等。实现诉讼案件的全生命周期管理，从案件登记、立案、庭审、判决到执行的完整流程。支持案件分类、时间节点提醒、费用统计、结果分析等功能，帮助企业规范化管理诉讼案件，提高诉讼管理效率，降低诉讼风险。

**诉讼管理价值**：
```
┌─────────────────────────────────────────────────────────────┐
│              诉讼管理价值体系                                  │
├─────────────────────────────────────────────────────────────┤
│ 1. 规范化管理                                                │
│    ├── 案件登记：统一登记案件信息，建立案件档案               │
│    ├── 流程跟踪：跟踪诉讼流程，及时掌握案件进展               │
│    └── 文档管理：统一管理诉讼文档，确保文档完整               │
│                                                             │
│ 2. 效率提升                                                  │
│    ├── 时间管理：管理时间节点，及时提醒重要事项               │
│    ├── 费用管理：管理诉讼费用，控制诉讼成本                   │
│    └── 人员管理：管理律师、法官等人员信息，便于沟通           │
│                                                             │
│ 3. 风险控制                                                  │
│    ├── 案件分析：分析案件情况，评估诉讼风险                   │
│    ├── 结果统计：统计诉讼结果，总结经验教训                   │
│    └── 费用控制：控制诉讼费用，降低诉讼成本                   │
│                                                             │
│ 4. 决策支持                                                  │
│    ├── 案件统计：统计案件数据，支持管理决策                   │
│    ├── 费用分析：分析费用情况，优化费用结构                   │
│    └── 结果分析：分析诉讼结果，改进诉讼策略                   │
└─────────────────────────────────────────────────────────────┘
```

**诉讼管理全生命周期**：
```
┌─────────────────────────────────────────────────────────────┐
│              诉讼管理全生命周期流程                            │
├─────────────────────────────────────────────────────────────┤
│ 1. 案件登记                                                  │
│    ├── 案件基本信息登记                                       │
│    ├── 案件分类和标签                                         │
│    └── 案件关联信息（项目、客户、合同等）                     │
│                                                             │
│ 2. 立案管理                                                  │
│    ├── 立案申请                                               │
│    ├── 立案材料准备                                           │
│    └── 立案时间节点跟踪                                       │
│                                                             │
│ 3. 庭审管理                                                  │
│    ├── 庭审安排                                               │
│    ├── 庭审记录                                               │
│    └── 庭审结果跟踪                                           │
│                                                             │
│ 4. 保全续封管理（⚠️ 极高优先级）                             │
│    ├── 保全信息登记                                           │
│    ├── 保全续封提醒（多方式通知，避免遗漏）                   │
│    ├── 保全续封申请                                           │
│    └── 保全续封跟踪                                           │
│                                                             │
│ 5. 判决管理                                                  │
│    ├── 判决书管理                                             │
│    ├── 判决结果分析                                           │
│    └── 判决执行跟踪                                           │
│                                                             │
│ 6. 执行管理                                                  │
│    ├── 执行申请                                               │
│    ├── 执行进度跟踪                                           │
│    └── 执行结果确认                                           │
│                                                             │
│ 7. 期限管理（⚠️ 重要）                                       │
│    ├── 上诉期限提醒（多方式通知）                             │
│    ├── 举证期限提醒（多方式通知）                             │
│    └── 答辩期限提醒（多方式通知）                             │
└─────────────────────────────────────────────────────────────┘
```

**案件类型**：
- **合同纠纷**：合同履行纠纷、合同变更纠纷、合同解除纠纷、合同违约纠纷等
- **劳动争议**：劳动合同纠纷、工资纠纷、工伤纠纷、社保纠纷等
- **知识产权**：专利纠纷、商标纠纷、著作权纠纷、商业秘密纠纷等
- **侵权纠纷**：人身损害赔偿、财产损害赔偿、名誉权纠纷等
- **其他纠纷**：建设工程纠纷、房地产纠纷、金融纠纷、其他纠纷等

#### 16.1 案件管理
**功能说明**：管理诉讼案件的基本信息，包括案件登记、案件信息管理、案件分类等。

**功能列表**：
- ✅ **案件登记**
  - 案件登记表创建（案件基本信息录入）
  - 案件编号自动生成（LAW-{YYYYMMDD}-{序列号}）
  - 案件名称录入（必填）
  - 案件类型选择（合同纠纷、劳动争议、知识产权、侵权纠纷、其他纠纷）
  - 案件性质选择（原告、被告、第三人、其他）
  - 案件描述录入（案件详细描述、案件背景、案件原因）
  - 案件关联项目选择（关联项目、项目编号、项目名称）
  - 案件关联客户选择（关联客户、客户名称、客户编号）
  - 案件关联合同选择（关联合同、合同编号、合同名称）
  - 案件金额设置（诉讼标的额、争议金额）
  - 案件状态设置（待立案、已立案、审理中、已判决、执行中、已结案、已撤诉、已和解）
  - 案件优先级设置（低、中、高、紧急）
  - 案件登记时间记录（自动记录）
  - 案件登记人记录（自动记录）
  - 案件登记部门记录（自动记录）
- ✅ **案件信息管理**
  - 案件列表展示（分页）
  - 案件类型筛选（合同纠纷、劳动争议、知识产权、侵权纠纷、其他纠纷）
  - 案件性质筛选（原告、被告、第三人、其他）
  - 案件状态筛选（待立案、已立案、审理中、已判决、执行中、已结案、已撤诉、已和解）
  - 案件优先级筛选（低、中、高、紧急）
  - 案件搜索（案件名称、案件编号、关联项目、关联客户、关联合同）
  - 案件排序（按登记时间、按案件状态、按优先级排序）
  - 案件统计卡片（案件总数、各类型案件数、各状态案件数、各性质案件数）
  - 案件信息编辑（案件基本信息编辑、案件状态更新、案件优先级调整）
  - 案件详情查看（案件基本信息、案件描述、案件关联信息、案件流程信息、案件文档信息、案件费用信息）
- ✅ **案件分类**
  - 案件类型分类（合同纠纷、劳动争议、知识产权、侵权纠纷、其他纠纷）
  - 案件性质分类（原告、被告、第三人、其他）
  - 案件标签管理（标签创建、标签编辑、标签删除、标签关联）
  - 案件分类统计（各类型案件数量、各性质案件数量、各标签案件数量）

#### 16.2 诉讼流程管理
**功能说明**：管理诉讼流程，包括立案管理、庭审管理、判决管理、执行管理等，跟踪诉讼全流程。

**功能列表**：
- ✅ **立案管理**
  - 立案申请创建（立案申请、立案材料准备、立案时间设置）
  - 立案材料管理（材料列表、材料上传、材料下载、材料审核）
  - 立案时间节点跟踪（立案时间、立案状态、立案进度）
  - 立案法院信息（法院名称、法院地址、法院联系方式、法官信息）
  - 立案号管理（立案号录入、立案号查询）
  - 立案状态更新（立案状态、立案时间、立案人）
  - 立案记录列表（立案记录列表、立案记录详情）
- ✅ **庭审管理**
  - 庭审安排创建（庭审时间、庭审地点、庭审人员、庭审事由）
  - 庭审通知管理（通知发送、通知对象、通知时间、通知方式）
    - ⚠️ **必须多方式通知**：系统通知 + 邮件通知 + 短信通知同时发送
    - ⚠️ **多时间点提醒**：提前7天、提前3天、提前1天、开庭当天（共4次提醒）
    - ⚠️ **确认机制**：要求相关人员确认收到通知，未确认的自动升级通知
  - 庭审记录管理（庭审记录录入、庭审记录查看、庭审记录编辑）
  - 庭审材料管理（材料准备、材料上传、材料下载）
  - 庭审结果记录（庭审结果、庭审意见、庭审决定）
  - 庭审时间节点跟踪（庭审时间、庭审状态、庭审进度）
  - 庭审记录列表（庭审记录列表、庭审记录详情）
  - 庭审统计（庭审次数统计、庭审时间统计、庭审结果统计）
- ✅ **保全续封管理**（⚠️ 极高优先级，必须严格管理）
  - 保全信息登记（保全类型、保全金额、保全期限、保全法院、保全案号）
  - 保全续封时间设置（续封到期时间、续封申请时间）
  - 保全续封提醒管理（⚠️ 必须多方式通知）
    - ⚠️ **必须多方式通知**：系统通知 + 邮件通知 + 短信通知同时发送
    - ⚠️ **多时间点提醒**：到期前30天、15天、7天、3天、1天、到期当天（共6次提醒）
    - ⚠️ **确认机制**：必须确认收到，未确认的立即电话通知
    - ⚠️ **风险提示**：明确标注"如未及时续封将导致保全失效，造成重大损失"
  - 保全续封申请管理（续封申请创建、续封材料准备、续封申请提交）
  - 保全续封状态跟踪（续封申请状态、续封结果、续封期限）
  - 保全续封记录列表（保全续封记录列表、保全续封记录详情）
  - 保全续封统计（保全数量统计、续封次数统计、续封成功率统计）
- ✅ **判决管理**
  - 判决书管理（判决书上传、判决书查看、判决书下载）
  - 判决结果录入（判决结果、判决内容、判决时间、判决法院）
  - 判决金额管理（判决金额、执行金额、利息金额、其他费用）
  - 判决执行期限设置（执行期限、执行时间、执行方式）
  - 判决结果分析（结果分析、结果评估、结果影响）
  - 判决时间节点跟踪（判决时间、判决状态、判决进度）
  - 判决记录列表（判决记录列表、判决记录详情）
- ✅ **执行管理**
  - 执行申请创建（执行申请、执行材料准备、执行时间设置）
  - 执行材料管理（材料列表、材料上传、材料下载、材料审核）
  - 执行进度跟踪（执行进度、执行状态、执行时间）
  - 执行结果记录（执行结果、执行金额、执行时间、执行方式）
  - 执行时间节点跟踪（执行时间、执行状态、执行进度）
  - 执行记录列表（执行记录列表、执行记录详情）
  - 执行统计（执行次数统计、执行时间统计、执行结果统计）

#### 16.3 诉讼文档管理
**功能说明**：管理诉讼相关的文档，包括诉讼文档、证据材料、法律文书等。

**功能列表**：
- ✅ **文档管理**
  - 文档列表展示（文档列表、文档分类、文档搜索）
  - 文档上传（文档上传、批量上传、文档格式支持）
  - 文档分类管理（分类创建、分类编辑、分类删除）
  - 文档类型设置（起诉状、答辩状、证据材料、法律文书、其他文档）
  - 文档关联案件（关联案件、案件编号、案件名称）
  - 文档预览（在线预览、支持多种格式）
  - 文档下载（文档下载、下载权限控制、下载记录）
  - 文档编辑（文档信息编辑、文档删除、文档移动）
  - 文档版本管理（版本号、版本历史、版本对比）
- ✅ **证据管理**
  - 证据列表展示（证据列表、证据分类、证据搜索）
  - 证据登记（证据名称、证据类型、证据来源、证据时间、证据描述）
  - 证据类型设置（书证、物证、证人证言、鉴定意见、勘验笔录、视听资料、电子数据、其他）
  - 证据上传（证据上传、证据扫描、证据拍照）
  - 证据关联案件（关联案件、案件编号、案件名称）
  - 证据预览（在线预览、支持多种格式）
  - 证据下载（证据下载、下载权限控制、下载记录）
  - 证据有效性管理（有效性评估、有效性确认、有效性记录）
  - 证据统计（证据数量统计、证据类型统计、证据有效性统计）
- ✅ **文书管理**
  - 文书列表展示（文书列表、文书分类、文书搜索）
  - 文书类型设置（起诉状、答辩状、代理词、辩护词、申请书、其他文书）
  - 文书模板管理（模板创建、模板编辑、模板删除、模板应用）
  - 文书创建（文书创建、文书编辑、文书保存）
  - 文书关联案件（关联案件、案件编号、案件名称）
  - 文书预览（在线预览、文书格式预览）
  - 文书下载（文书下载、下载权限控制、下载记录）
  - 文书打印（文书打印、打印设置、打印记录）
  - 文书统计（文书数量统计、文书类型统计、文书使用统计）

#### 16.4 费用管理
**功能说明**：管理诉讼相关的费用，包括诉讼费、律师费、鉴定费、差旅费等。

**功能列表**：
- ✅ **费用登记**
  - 费用登记创建（费用名称、费用类型、费用金额、费用时间、费用说明）
  - 费用类型设置（诉讼费、律师费、鉴定费、差旅费、其他费用）
  - 费用关联案件（关联案件、案件编号、案件名称）
  - 费用关联项目（关联项目、项目编号、项目名称）
  - 费用支付方式设置（现金、转账、支票、其他）
  - 费用支付状态设置（待支付、已支付、已报销、已核销）
  - 费用发票管理（发票上传、发票查看、发票下载）
  - 费用登记时间记录（自动记录）
  - 费用登记人记录（自动记录）
- ✅ **费用统计**
  - 费用列表展示（费用列表、费用分类、费用搜索）
  - 费用类型统计（各类型费用统计、费用占比、费用趋势）
  - 费用案件统计（各案件费用统计、案件费用排名、案件费用趋势）
  - 费用时间统计（各时间段费用统计、费用月度统计、费用年度统计）
  - 费用支付统计（支付状态统计、支付方式统计、支付时间统计）
  - 费用预算管理（预算设置、预算执行、预算分析）
  - 费用报表生成（费用报表、报表导出、报表打印）
- ✅ **费用报销**
  - 费用报销申请创建（报销申请、报销金额、报销事由、报销时间）
  - 费用报销材料管理（材料上传、材料审核、材料确认）
  - 费用报销审批流程（审批流程、审批人、审批状态）
  - 费用报销记录列表（报销记录列表、报销记录详情）
  - 费用报销统计（报销次数统计、报销金额统计、报销趋势分析）

#### 16.5 人员管理
**功能说明**：管理诉讼相关的人员，包括律师、法官、当事人等。

**功能列表**：
- ✅ **律师管理**
  - 律师列表展示（律师列表、律师搜索、律师筛选）
  - 律师信息录入（律师姓名、律师事务所、律师执业证号、律师联系方式、律师专业领域）
  - 律师关联案件（关联案件、案件编号、案件名称、代理角色）
  - 律师费用管理（费用记录、费用统计、费用结算）
  - 律师评价管理（评价记录、评价统计、评价分析）
  - 律师信息编辑（信息编辑、信息更新、信息删除）
  - 律师统计（律师数量统计、律师案件统计、律师费用统计）
- ✅ **法官管理**
  - 法官列表展示（法官列表、法官搜索、法官筛选）
  - 法官信息录入（法官姓名、法院名称、法官职务、法官联系方式）
  - 法官关联案件（关联案件、案件编号、案件名称、审理角色）
  - 法官信息编辑（信息编辑、信息更新、信息删除）
  - 法官统计（法官数量统计、法官案件统计、法官审理统计）
- ✅ **当事人管理**
  - 当事人列表展示（当事人列表、当事人搜索、当事人筛选）
  - 当事人信息录入（当事人姓名、当事人类型、当事人联系方式、当事人地址）
  - 当事人类型设置（自然人、法人、其他组织）
  - 当事人关联案件（关联案件、案件编号、案件名称、当事人角色）
  - 当事人信息编辑（信息编辑、信息更新、信息删除）
  - 当事人统计（当事人数量统计、当事人案件统计、当事人类型统计）

#### 16.6 时间管理
**功能说明**：管理诉讼相关的时间节点，包括立案时间、庭审时间、判决时间、执行时间等，支持时间提醒和日历视图。

**功能列表**：
- ✅ **时间节点管理**
  - 时间节点创建（节点名称、节点时间、节点类型、节点说明）
  - 时间节点类型设置（立案时间、庭审时间、判决时间、执行时间、保全续封时间、上诉期限、举证期限、答辩期限、其他时间）
  - 时间节点关联案件（关联案件、案件编号、案件名称）
  - 时间节点状态设置（待处理、处理中、已完成、已延期、已取消）
  - 时间节点提醒设置（提醒时间、提醒方式、提醒对象）
  - 时间节点编辑（节点编辑、节点更新、节点删除）
  - 时间节点列表展示（节点列表、节点搜索、节点筛选）
  - 时间节点统计（节点数量统计、节点完成率统计、节点延期统计）
- ✅ **提醒设置**
  - 提醒规则创建（规则名称、规则条件、提醒时间、提醒方式、提醒对象）
  - 提醒方式设置（系统通知、邮件通知、短信通知、其他通知）
  - 提醒对象设置（案件负责人、律师、部门负责人、其他人员）
  - 提醒规则启用/停用（规则状态、启用时间、停用原因）
  - 提醒记录列表（提醒记录列表、提醒记录详情）
  - 提醒统计（提醒次数统计、提醒方式统计、提醒效果统计）
- ✅ **日历视图**
  - 日历视图展示（日历展示、时间节点标记、时间节点详情）
  - 日历视图筛选（按案件、按类型、按状态筛选）
  - 日历视图操作（节点查看、节点编辑、节点添加）
  - 日历视图导出（日历导出、日历打印）

#### 16.7 案件统计（集成在案件列表页面中）
**功能说明**：提供案件统计功能，包括案件统计、费用统计、结果统计等，支持多维度统计分析。

**功能列表**：
- ✅ **案件统计**
  - 案件数量统计（总案件数、各类型案件数、各状态案件数、各性质案件数）
  - 案件增长统计（案件增长趋势、增长速率、增长预测）
  - 案件类型统计（各类型案件数量、类型占比、类型趋势）
  - 案件状态统计（各状态案件数量、状态分布、状态变化趋势）
  - 案件性质统计（各性质案件数量、性质占比、性质趋势）
  - 案件金额统计（案件总金额、各类型案件金额、案件金额趋势）
  - 案件周期统计（案件平均周期、各类型案件周期、案件周期趋势）
- ✅ **费用统计**
  - 费用总额统计（总费用、各类型费用、费用趋势）
  - 费用案件统计（各案件费用、案件费用排名、案件费用占比）
  - 费用类型统计（各类型费用、类型占比、类型趋势）
  - 费用时间统计（各时间段费用、费用月度统计、费用年度统计）
  - 费用预算统计（预算执行情况、预算偏差分析、预算趋势）
  - 费用效率统计（费用效率、费用效果、费用优化建议）
- ✅ **结果统计**
  - 案件结果统计（胜诉案件数、败诉案件数、和解案件数、撤诉案件数）
  - 案件结果分析（结果占比、结果趋势、结果原因分析）
  - 案件金额统计（胜诉金额、败诉金额、和解金额、撤诉金额）
  - 案件周期统计（胜诉周期、败诉周期、和解周期、撤诉周期）
  - 案件效果评估（效果评估、效果评分、效果反馈）
  - 案件经验总结（经验总结、经验分享、经验应用）

#### 16.8 案件状态流转
**功能说明**：诉讼案件的状态流转规则和权限控制。

**状态定义**：
- **待立案**：案件已登记，尚未提交立案申请
- **已立案**：立案申请已通过，案件已正式立案
- **审理中**：案件正在审理过程中
- **已判决**：案件已作出判决
- **执行中**：判决已生效，正在执行过程中
- **已结案**：案件已完全结束
- **已撤诉**：案件已撤诉
- **已和解**：案件已和解

**状态流转规则**：
```
待立案 → 已立案 → 审理中 → 已判决 → 执行中 → 已结案
  ↓         ↓         ↓         ↓         ↓
已撤诉    已撤诉    已撤诉    已撤诉    已撤诉
  ↓         ↓         ↓         ↓
已和解    已和解    已和解    已和解
```

**状态流转权限矩阵**：
| 状态流转 | 操作人 | 权限要求 | 是否需要审批 |
|---------|--------|---------|-------------|
| 待立案 → 已立案 | 案件负责人 | 案件管理权限 | 是（立案审批） |
| 已立案 → 审理中 | 系统自动 | 系统自动 | 否（自动触发） |
| 审理中 → 已判决 | 案件负责人 | 案件管理权限 | 否 |
| 已判决 → 执行中 | 案件负责人 | 案件管理权限 | 是（执行审批） |
| 执行中 → 已结案 | 案件负责人 | 案件管理权限 | 否 |
| 任意状态 → 已撤诉 | 案件负责人 | 案件管理权限 | 是（撤诉审批） |
| 任意状态 → 已和解 | 案件负责人 | 案件管理权限 | 是（和解审批） |

**状态流转条件**：
- **待立案 → 已立案**：立案材料已准备完成，立案申请已提交并通过审批
- **已立案 → 审理中**：立案成功后自动进入审理中状态
- **审理中 → 已判决**：判决书已录入系统
- **已判决 → 执行中**：执行申请已提交并通过审批
- **执行中 → 已结案**：执行结果已确认，执行完成
- **任意状态 → 已撤诉**：撤诉申请已提交并通过审批
- **任意状态 → 已和解**：和解协议已签署并通过审批

#### 16.9 审批流程集成
**功能说明**：诉讼管理模块与审批流程引擎集成，支持案件审批、费用审批等审批流程。

**审批节点**：
- **案件登记审批**：重大案件（金额超过阈值或特定类型）需要审批
- **立案申请审批**：立案申请需要审批
- **费用报销审批**：诉讼费用报销需要审批
- **和解协议审批**：和解协议需要审批
- **撤诉申请审批**：撤诉申请需要审批
- **执行申请审批**：执行申请需要审批

**审批流程配置**：
- 审批流程在系统管理模块（19.1.7）中配置，由系统管理员统一管理
- 支持根据案件金额、案件类型自动选择审批流程
- 支持多级审批、条件审批、并行审批
- 审批节点可以与产值阶段/里程碑关联（如需要）

**审批流程示例**：
```
案件登记审批流程：
  案件负责人提交 → 法务经理审批 → 总经理审批（金额>50万）→ 通过

立案申请审批流程：
  案件负责人提交 → 法务经理审批 → 通过

费用报销审批流程：
  案件负责人提交 → 法务经理审批 → 财务经理审批 → 通过

和解协议审批流程：
  案件负责人提交 → 法务经理审批 → 总经理审批 → 通过
```

**审批流程与产值关联**（可选）：
- 如果诉讼管理需要产值计算，审批节点可以与产值阶段/里程碑关联
- 审批通过后自动触发产值计算（在产值管理模块中配置）

#### 16.10 权限管理
**功能说明**：诉讼管理模块的权限控制设计。

**权限代码**：
- `litigation_management.view` - 查看诉讼案件
- `litigation_management.case.view` - 查看案件列表
- `litigation_management.case.view_all` - 查看所有案件（不受限制）
- `litigation_management.case.create` - 创建案件
- `litigation_management.case.edit` - 编辑案件
- `litigation_management.case.delete` - 删除案件
- `litigation_management.case.approve` - 审批案件
- `litigation_management.process.manage` - 管理诉讼流程
- `litigation_management.document.view` - 查看文档
- `litigation_management.document.manage` - 管理文档
- `litigation_management.expense.view` - 查看费用
- `litigation_management.expense.manage` - 管理费用
- `litigation_management.person.manage` - 管理人员信息
- `litigation_management.timeline.manage` - 管理时间节点
- `litigation_management.statistics.view` - 查看统计

**权限矩阵**：
| 功能 | 普通用户 | 案件负责人 | 法务经理 | 总经理 |
|------|---------|-----------|---------|--------|
| 查看案件 | ✅（自己的） | ✅（自己的） | ✅ | ✅ |
| 查看所有案件 | ❌ | ❌ | ✅ | ✅ |
| 创建案件 | ❌ | ✅ | ✅ | ✅ |
| 编辑案件 | ❌ | ✅（自己的） | ✅ | ✅ |
| 删除案件 | ❌ | ❌ | ✅ | ✅ |
| 审批案件 | ❌ | ❌ | ✅ | ✅ |
| 管理诉讼流程 | ❌ | ✅（自己的案件） | ✅ | ✅ |
| 管理文档 | ❌ | ✅（自己的案件） | ✅ | ✅ |
| 管理费用 | ❌ | ✅（自己的案件） | ✅ | ✅ |
| 管理人员信息 | ❌ | ✅（自己的案件） | ✅ | ✅ |
| 管理时间节点 | ❌ | ✅（自己的案件） | ✅ | ✅ |
| 查看统计 | ❌ | ❌ | ✅ | ✅ |

**权限说明**：
- **普通用户**：只能查看自己负责的案件
- **案件负责人**：可以管理自己负责的案件，但不能查看所有案件
- **法务经理**：可以查看和管理所有案件，可以审批案件
- **总经理**：拥有所有权限

#### 16.11 模块集成
**功能说明**：诉讼管理模块与其他模块的集成设计。

**集成关系**：

1. **与项目管理的集成**
   - 项目详情页可以查看关联的诉讼案件数量和列表
   - 项目结算时检查是否有未结案的诉讼案件（提示风险）
   - 诉讼案件可以关联到具体项目，便于追溯

2. **与客户管理的集成**
   - 客户详情页显示该客户的诉讼案件数量（原告/被告）
   - 客户风险信息中包含诉讼案件信息（从启信宝API获取的司法案件数量）
   - 诉讼案件可以关联到客户，便于客户风险分析

3. **与合同管理的集成**
   - 合同详情页可以查看关联的诉讼案件
   - 合同纠纷自动关联到诉讼管理（合同状态为"争议"时）
   - 诉讼案件可以关联到具体合同，便于合同风险分析

4. **与财务管理的集成**
   - 诉讼费用可以关联到财务凭证
   - 费用报销审批流程与财务管理模块集成
   - 诉讼费用统计可以纳入财务分析

5. **与风险管理的集成**
   - 诉讼案件可以作为风险事件记录
   - 重大诉讼案件可以自动创建风险预警
   - 诉讼结果可以用于风险评估

6. **与档案管理的集成**
   - 诉讼文档可以归档到档案管理模块
   - 已结案的诉讼案件可以自动归档
   - 诉讼文档可以纳入档案检索范围

**集成接口**：
- 提供API接口供其他模块调用
- 支持从其他模块跳转到诉讼管理
- 支持数据关联和同步

#### 16.12 数据模型设计
**功能说明**：诉讼管理模块的数据模型设计。

**主要模型**：

1. **LitigationCase（诉讼案件）**
   - 基本信息：案件编号、案件名称、案件类型、案件性质、案件描述
   - 关联信息：关联项目、关联客户、关联合同
   - 金额信息：诉讼标的额、争议金额
   - 状态信息：案件状态、优先级、登记时间、登记人
   - 统计信息：案件周期、案件结果

2. **LitigationProcess（诉讼流程）**
   - 流程类型：立案、庭审、判决、执行
   - 流程信息：流程时间、流程状态、流程结果
   - 关联案件：关联案件ID
   - 流程记录：流程记录列表、流程详情

3. **LitigationDocument（诉讼文档）**
   - 文档信息：文档名称、文档类型、文档分类
   - 文档内容：文档文件、文档预览
   - 关联信息：关联案件、关联流程
   - 版本管理：版本号、版本历史

4. **LitigationExpense（诉讼费用）**
   - 费用信息：费用名称、费用类型、费用金额、费用时间
   - 关联信息：关联案件、关联项目
   - 支付信息：支付方式、支付状态、发票信息
   - 报销信息：报销申请、报销状态、报销审批

5. **LitigationPerson（诉讼人员）**
   - 人员类型：律师、法官、当事人
   - 人员信息：姓名、联系方式、专业领域
   - 关联信息：关联案件、关联角色
   - 评价信息：评价记录、评价统计

6. **LitigationTimeline（时间节点）**
   - 节点信息：节点名称、节点时间、节点类型
   - 关联信息：关联案件
   - 状态信息：节点状态、提醒设置
   - 提醒信息：提醒时间、提醒方式、提醒对象

**模型关系**：
- LitigationCase（1）→（N）LitigationProcess（一对多）
- LitigationCase（1）→（N）LitigationDocument（一对多）
- LitigationCase（1）→（N）LitigationExpense（一对多）
- LitigationCase（1）→（N）LitigationPerson（一对多，通过中间表）
- LitigationCase（1）→（N）LitigationTimeline（一对多）

#### 16.13 API接口设计
**功能说明**：诉讼管理模块的RESTful API接口设计。

**主要接口**：

1. **案件管理接口**
   - `GET /api/litigation/cases/` - 获取案件列表（支持筛选、搜索、分页）
   - `POST /api/litigation/cases/` - 创建案件
   - `GET /api/litigation/cases/{id}/` - 获取案件详情
   - `PUT /api/litigation/cases/{id}/` - 更新案件
   - `DELETE /api/litigation/cases/{id}/` - 删除案件
   - `POST /api/litigation/cases/{id}/submit/` - 提交案件审批
   - `POST /api/litigation/cases/{id}/transition/` - 案件状态流转

2. **诉讼流程接口**
   - `GET /api/litigation/cases/{case_id}/processes/` - 获取案件流程列表
   - `POST /api/litigation/cases/{case_id}/processes/` - 创建流程记录
   - `GET /api/litigation/processes/{id}/` - 获取流程详情
   - `PUT /api/litigation/processes/{id}/` - 更新流程记录

3. **文档管理接口**
   - `GET /api/litigation/cases/{case_id}/documents/` - 获取案件文档列表
   - `POST /api/litigation/cases/{case_id}/documents/` - 上传文档
   - `GET /api/litigation/documents/{id}/` - 获取文档详情
   - `GET /api/litigation/documents/{id}/download/` - 下载文档
   - `DELETE /api/litigation/documents/{id}/` - 删除文档

4. **费用管理接口**
   - `GET /api/litigation/cases/{case_id}/expenses/` - 获取案件费用列表
   - `POST /api/litigation/cases/{case_id}/expenses/` - 创建费用记录
   - `GET /api/litigation/expenses/{id}/` - 获取费用详情
   - `PUT /api/litigation/expenses/{id}/` - 更新费用记录
   - `POST /api/litigation/expenses/{id}/reimburse/` - 提交费用报销

5. **人员管理接口**
   - `GET /api/litigation/persons/` - 获取人员列表
   - `POST /api/litigation/persons/` - 创建人员信息
   - `GET /api/litigation/persons/{id}/` - 获取人员详情
   - `PUT /api/litigation/persons/{id}/` - 更新人员信息

6. **时间节点接口**
   - `GET /api/litigation/cases/{case_id}/timelines/` - 获取案件时间节点列表
   - `POST /api/litigation/cases/{case_id}/timelines/` - 创建时间节点
   - `GET /api/litigation/timelines/{id}/` - 获取时间节点详情
   - `PUT /api/litigation/timelines/{id}/` - 更新时间节点

7. **统计接口**
   - `GET /api/litigation/statistics/` - 获取统计数据
   - `GET /api/litigation/statistics/cases/` - 获取案件统计
   - `GET /api/litigation/statistics/expenses/` - 获取费用统计
   - `GET /api/litigation/statistics/results/` - 获取结果统计

**接口规范**：
- 所有接口需要身份认证（JWT Token）
- 支持权限控制（根据用户权限返回不同数据）
- 支持筛选、搜索、排序、分页
- 返回标准JSON格式
- 错误处理统一格式

#### 16.14 数据导出功能
**功能说明**：诉讼管理模块的数据导出功能。

**导出功能**：
- **案件列表导出**：Excel格式，支持筛选条件，包含案件基本信息、状态、金额等
- **费用明细导出**：Excel格式，包含费用类型、金额、时间、支付状态等
- **统计报表导出**：Excel、PDF格式，包含案件统计、费用统计、结果统计等
- **文档批量下载**：ZIP压缩包格式，支持批量下载案件相关文档
- **时间节点日历导出**：iCal格式，支持导入到日历系统（Google Calendar、Outlook等）
- **诉讼报告导出**：Word、PDF格式，包含案件详情、流程记录、费用明细等

**导出设置**：
- 支持自定义导出字段
- 支持导出格式选择（Excel、PDF、Word、CSV等）
- 支持导出范围选择（全部、当前筛选结果）
- 支持导出权限控制

#### 16.15 搜索和筛选功能
**功能说明**：诉讼管理模块的搜索和筛选功能。

**基础搜索**：
- 案件名称搜索
- 案件编号搜索
- 关联项目搜索
- 关联客户搜索
- 关联合同搜索

**高级搜索**：
- 全文检索（案件名称、案件描述、文档内容）
- 多条件组合搜索（案件类型、案件性质、案件状态、时间范围、金额范围）
- 时间范围搜索（登记时间、立案时间、判决时间、结案时间）
- 金额范围搜索（诉讼标的额、争议金额）
- 保存搜索条件（常用搜索，快速访问）

**筛选功能**：
- 案件类型筛选（合同纠纷、劳动争议、知识产权、侵权纠纷、其他纠纷）
- 案件性质筛选（原告、被告、第三人、其他）
- 案件状态筛选（待立案、已立案、审理中、已判决、执行中、已结案、已撤诉、已和解）
- 优先级筛选（低、中、高、紧急）
- 时间筛选（按登记时间、立案时间、判决时间、结案时间）
- 金额筛选（按诉讼标的额、争议金额）

#### 16.16 通知和提醒功能
**功能说明**：诉讼管理模块的通知和提醒功能。**特别强调**：涉及法院的关键节点（开庭、保全续封、上诉期限、举证期限等）必须通过系统通知、邮件通知、短信通知等多种方式同时通知相关人员，避免遗忘造成法律风险。

**通知类型**：

1. **法院关键节点提醒通知**（⚠️ 必须多方式通知，不可遗漏）
   - **开庭时间提醒**
     - 通知方式：**系统通知 + 邮件通知 + 短信通知**（三种方式必须同时发送）
     - 提醒时间：提前7天、提前3天、提前1天、开庭当天（共4次提醒）
     - 提醒对象：案件负责人、代理律师、法务经理、部门负责人
     - 通知内容：案件名称、案件编号、开庭时间、开庭地点、法院名称、法官信息、注意事项
     - 确认机制：要求相关人员确认收到通知，未确认的自动升级通知
   
   - **保全续封时间提醒**（⚠️ 极高优先级）
     - 通知方式：**系统通知 + 邮件通知 + 短信通知**（三种方式必须同时发送）
     - 提醒时间：保全到期前30天、到期前15天、到期前7天、到期前3天、到期前1天、到期当天（共6次提醒）
     - 提醒对象：案件负责人、代理律师、法务经理、总经理
     - 通知内容：案件名称、案件编号、保全类型、保全金额、到期时间、续封所需材料、紧急程度
     - 确认机制：必须确认收到，未确认的立即电话通知
     - 风险提示：明确标注"如未及时续封将导致保全失效，造成重大损失"
   
   - **上诉期限提醒**
     - 通知方式：**系统通知 + 邮件通知 + 短信通知**（三种方式必须同时发送）
     - 提醒时间：判决后立即、上诉期限前7天、上诉期限前3天、上诉期限前1天（共4次提醒）
     - 提醒对象：案件负责人、代理律师、法务经理
     - 通知内容：案件名称、案件编号、判决时间、上诉期限、上诉法院、上诉所需材料
     - 确认机制：要求确认是否上诉，未确认的自动提醒
   
   - **举证期限提醒**
     - 通知方式：**系统通知 + 邮件通知 + 短信通知**（三种方式必须同时发送）
     - 提醒时间：举证期限前7天、举证期限前3天、举证期限前1天、举证期限当天（共4次提醒）
     - 提醒对象：案件负责人、代理律师、法务经理
     - 通知内容：案件名称、案件编号、举证期限、举证要求、证据清单
     - 确认机制：要求确认证据准备情况
   
   - **答辩期限提醒**
     - 通知方式：**系统通知 + 邮件通知 + 短信通知**（三种方式必须同时发送）
     - 提醒时间：答辩期限前7天、答辩期限前3天、答辩期限前1天、答辩期限当天（共4次提醒）
     - 提醒对象：案件负责人、代理律师、法务经理
     - 通知内容：案件名称、案件编号、答辩期限、答辩要求、答辩状模板
     - 确认机制：要求确认答辩状准备情况

2. **其他时间节点提醒通知**
   - **立案时间提醒**：系统通知 + 邮件通知（提前3天、提前1天）
   - **判决时间提醒**：系统通知 + 邮件通知（提前3天、提前1天）
   - **执行时间提醒**：系统通知 + 邮件通知（提前7天、提前3天、提前1天）
   - **其他重要时间节点提醒**：根据节点重要性选择通知方式

3. **案件状态变更通知**
   - 案件状态发生变化时通知相关人员
   - 通知方式：系统通知 + 邮件通知
   - 通知对象：案件负责人、法务经理

4. **费用审批通知**
   - 费用报销审批结果通知
   - 通知方式：系统通知 + 邮件通知
   - 通知对象：申请人、审批人

5. **文档上传通知**
   - 重要文档上传时通知相关人员
   - 通知方式：系统通知
   - 通知对象：案件相关人员

6. **庭审安排通知**
   - 庭审安排确定后通知相关人员
   - 通知方式：系统通知 + 邮件通知 + 短信通知
   - 通知对象：案件负责人、代理律师、法务经理

**提醒设置**：

1. **提醒时间设置**
   - 法院关键节点：多时间点提醒（7天、3天、1天、当天）
   - 一般节点：提前3天、提前1天
   - 紧急节点：提前1天、提前6小时、提前1小时

2. **提醒方式设置**（法院关键节点必须全部启用）
   - **系统通知**：站内消息通知，实时推送
   - **邮件通知**：发送到注册邮箱，包含详细信息
   - **短信通知**：发送到注册手机，包含关键信息
   - **电话通知**：紧急情况下的电话提醒（保全续封到期前未确认时）

3. **提醒对象设置**
   - 案件负责人（必须）
   - 代理律师（必须）
   - 法务经理（必须）
   - 部门负责人（重要案件）
   - 总经理（重大案件或保全续封）

4. **提醒规则启用/停用**
   - 默认规则：法院关键节点必须启用，不可停用
   - 自定义规则：其他节点可根据需要启用/停用
   - 规则优先级：法院关键节点规则优先级最高

**通知确认机制**：

1. **通知确认要求**
   - 法院关键节点通知必须确认收到
   - 确认方式：系统点击确认、邮件回复确认、短信回复确认
   - 确认时限：收到通知后2小时内必须确认

2. **未确认处理机制**
   - 未确认提醒：2小时后未确认，自动发送二次提醒
   - 升级通知：4小时后仍未确认，通知上级领导
   - 电话通知：6小时后仍未确认，系统自动电话通知（保全续封等紧急节点）
   - 记录追踪：记录未确认情况，用于责任追溯

3. **确认状态管理**
   - 已确认：显示确认时间和确认人
   - 未确认：显示未确认时长，自动升级通知
   - 已读未确认：已读但未确认，继续提醒

**紧急通知机制**：

1. **紧急节点识别**
   - 保全续封到期前3天：自动标记为紧急
   - 开庭前1天：自动标记为紧急
   - 上诉期限、举证期限、答辩期限到期前1天：自动标记为紧急

2. **紧急通知流程**
   - 立即发送：系统通知 + 邮件通知 + 短信通知
   - 电话确认：1小时内未确认，自动电话通知
   - 上级通知：2小时内未确认，通知上级领导
   - 风险提示：明确标注紧急程度和风险后果

**通知记录和统计**：

1. **通知记录**
   - 通知记录列表（所有通知记录）
   - 通知记录详情（通知内容、发送时间、发送方式、接收人、确认状态、确认时间）
   - 通知失败记录（发送失败的通知，自动重试）

2. **通知统计**
   - 通知次数统计（按案件、按时间、按类型）
   - 通知方式统计（系统通知、邮件通知、短信通知的发送次数和成功率）
   - 通知效果统计（确认率、及时确认率、未确认率）
   - 通知趋势分析（通知发送趋势、确认趋势）

3. **通知质量监控**
   - 通知送达率监控（确保通知成功发送）
   - 通知确认率监控（确保相关人员及时确认）
   - 未确认预警（未确认率过高时预警）

**通知模板管理**：

1. **通知模板**
   - 开庭通知模板（包含案件信息、时间、地点、注意事项）
   - 保全续封通知模板（包含保全信息、到期时间、续封要求、风险提示）
   - 上诉期限通知模板（包含判决信息、上诉期限、上诉要求）
   - 举证期限通知模板（包含举证期限、举证要求、证据清单）
   - 答辩期限通知模板（包含答辩期限、答辩要求、答辩状模板）

2. **模板自定义**
   - 支持自定义通知模板
   - 支持模板变量（案件名称、案件编号、时间、地点等）
   - 支持模板预览和测试

**通知配置管理**：

1. **全局通知配置**
   - 法院关键节点通知配置（必须启用，不可关闭）
   - 通知方式配置（系统通知、邮件通知、短信通知的启用状态）
   - 通知时间配置（提前提醒时间设置）

2. **个人通知配置**
   - 个人通知偏好设置（通知方式选择）
   - 个人通知时间设置（免打扰时间段）
   - 个人通知频率设置（避免通知过多）

**重要说明**：

⚠️ **法院关键节点通知是诉讼管理的核心功能，必须确保：**
1. **多方式通知**：系统通知、邮件通知、短信通知必须同时发送，不可遗漏
2. **多时间点提醒**：提前7天、3天、1天、当天多次提醒，确保不会遗忘
3. **确认机制**：必须要求相关人员确认收到通知，未确认的自动升级通知
4. **紧急处理**：紧急节点未确认时，自动电话通知和上级通知
5. **记录追踪**：所有通知记录完整保存，用于责任追溯和问题分析

**风险控制**：
- 保全续封、开庭、上诉期限等关键节点遗漏将造成重大法律风险和经济损失
- 系统必须确保这些关键节点的通知100%送达，相关人员100%确认
- 建议设置专门的法务管理员监控通知确认情况，及时处理未确认情况

#### 16.17 移动端支持
**功能说明**：诉讼管理模块的移动端支持。

**移动端功能**：
- **案件管理**：案件列表查看、案件详情查看、案件创建（简化版）
- **时间节点**：时间节点查看、时间节点提醒
- **文档管理**：文档查看、文档下载（支持离线查看）
- **费用管理**：费用列表查看、费用登记（简化版）
- **通知提醒**：通知列表、通知详情、通知处理

**移动端特性**：
- 响应式设计，适配手机和平板
- 离线数据缓存（重要数据）
- 推送通知支持
- 快速操作（常用功能快捷入口）

---

### 17. 报表管理
- **状态**：⏳ 计划中
- **完成度**：0%
- **说明**：集中管理各个功能模块的报表，提供统一的报表分类、创建、配置、查看、导出、收藏、分享、分析等功能。实现报表的统一管理、个性化配置、多格式导出、数据分析和趋势预测，支持管理决策和业务分析。

**⚠️ 重要说明：报表功能统一管理原则**
- **统一管理原则**：系统中所有功能模块的报表功能，全部统一纳入到"报表管理"模块进行集中管理
- **报表入口统一**：各功能模块不再单独提供报表入口，所有报表统一从"报表管理"模块访问
- **报表分类管理**：报表按功能模块分类（客户管理、商机管理、生产管理等），在报表管理模块中按分类查看
- **报表权限控制**：报表查看权限在报表管理模块统一控制，各功能模块的权限设置自动同步到报表管理模块
- **报表数据源**：报表数据来源于各功能模块，但报表的创建、配置、查看、导出等操作统一在报表管理模块完成
- **报表模板管理**：所有报表模板统一在报表管理模块管理，支持模板复用和标准化
- **报表统计分析**：所有报表的使用统计、数据分析、趋势分析统一在报表管理模块进行

**模块定位**：
报表管理模块是系统的数据分析和决策支持中心，集中管理所有业务模块的报表，提供统一的报表查看、分析、导出功能。通过统一管理，实现报表的标准化、规范化、高效化，提升数据利用效率和决策支持能力。

**业务价值**：
1. **统一管理**：集中管理所有报表，避免报表分散在各模块，提升管理效率
2. **标准化**：建立统一的报表模板和规范，确保报表质量和一致性
3. **高效访问**：统一入口，快速访问所需报表，无需切换模块
4. **数据分析**：集中进行数据分析，发现跨模块的数据关联和趋势
5. **知识沉淀**：报表模板和经验沉淀，形成组织知识资产

**报表管理价值**：
```
┌─────────────────────────────────────────────────────────────┐
│              报表管理价值体系                                  │
├─────────────────────────────────────────────────────────────┤
│ 1. 数据整合                                                  │
│    ├── 集中管理：统一管理各功能模块的报表                     │
│    ├── 数据整合：整合各模块数据，形成综合分析报表             │
│    └── 数据关联：关联不同模块数据，发现数据关联关系           │
│                                                             │
│ 2. 决策支持                                                  │
│    ├── 数据可视化：图表展示，直观呈现数据趋势                 │
│    ├── 数据分析：数据对比分析、趋势分析、关联分析             │
│    └── 预测分析：基于历史数据，预测未来趋势                   │
│                                                             │
│ 3. 效率提升                                                  │
│    ├── 快速查看：快速查看报表，无需切换模块                   │
│    ├── 批量导出：批量导出报表，提高工作效率                   │
│    └── 报表收藏：收藏常用报表，快速访问                       │
│                                                             │
│ 4. 知识沉淀                                                  │
│    ├── 报表模板：建立报表模板库，沉淀报表经验                 │
│    ├── 报表配置：配置报表参数，形成标准化报表                 │
│    └── 报表分享：分享报表，促进知识共享                       │
└─────────────────────────────────────────────────────────────┘
```

**报表类型**：
- **统计报表**：数据统计报表、汇总报表、明细报表等
- **分析报表**：数据分析报表、对比分析报表、趋势分析报表等
- **预测报表**：趋势预测报表、预测分析报表等
- **图表报表**：柱状图、折线图、饼图、散点图、仪表盘等
- **综合报表**：多模块数据综合报表、综合分析报表等

**报表访问入口设计**：
- **主入口**：系统左侧导航菜单 > 报表管理（首页=报表列表）
- **快捷入口**：
  - 工作台 > 数据统计卡片 > 点击"查看报表"跳转到报表管理模块
  - 各功能模块页面 > 统计卡片 > 点击"查看详细报表"跳转到报表管理模块对应模块报表
  - 报表管理模块 > 报表收藏 > 快速访问收藏的常用报表
- **模块报表入口**：报表管理模块 > 模块报表 > 选择功能模块 > 查看该模块的所有报表
- **报表搜索入口**：报表管理模块 > 报表列表 > 搜索框（支持按报表名称、编号、关键词搜索）
- **报表分类入口**：报表管理模块 > 报表分类 > 选择分类 > 查看该分类下的所有报表

**报表权限控制**：
- **查看权限**：根据用户角色和权限码控制报表查看范围
  - 员工角色：仅能查看自己相关数据的报表
  - 部门经理：可查看部门相关数据的报表
  - 高管：可查看公司所有报表
- **导出权限**：报表导出权限独立控制，需单独授权
- **管理权限**：报表创建、配置、更新等管理操作需管理员权限
- **权限同步**：各功能模块的权限设置自动同步到报表管理模块，确保权限一致性

#### 17.1 报表分类管理
**功能说明**：管理报表的分类体系，包括报表分类的创建、编辑、删除等，支持多级分类和按功能模块分类。

**功能列表**：
- ✅ **报表分类列表**
  - 分类列表展示（树形结构、支持展开/折叠）
  - 按功能模块分类（客户管理、商机管理（含立项）、生产管理、收发管理、结算管理、回款管理、人事管理、行政管理、财务管理、产值管理、计划管理、档案管理、资源管理、风险管理、标准管理）
  - 分类搜索（分类名称、分类代码）
  - 分类层级展示（显示分类层级、分类路径）
  - 分类统计（每个分类下的报表数量）
- ✅ **报表分类创建**
  - 分类名称录入（必填）
  - 分类代码录入（必填，唯一性检查）
  - 分类代码自动生成（CAT-{序列号}）
  - 关联功能模块选择（选择关联的功能模块）
  - 上级分类选择（选择上级分类，支持多级分类）
  - 分类描述录入（分类说明、分类用途）
  - 分类排序设置（分类显示顺序）
  - 分类图标设置（分类图标选择）
  - 分类创建人记录（自动记录）
  - 分类创建时间记录（自动记录）
- ✅ **报表分类编辑**
  - 分类信息编辑（分类名称、分类代码、分类描述）
  - 分类层级调整（调整分类层级、移动分类）
  - 分类排序调整（调整分类显示顺序）
  - 关联功能模块调整（调整关联的功能模块）
- ✅ **报表分类删除**
  - 分类删除（需检查关联报表，有关联报表时不允许删除）
  - 删除确认（删除确认提示）
  - 批量删除（批量删除分类，需检查关联报表）
- ✅ **分类规则管理**
  - 分类规则设置（分类规则、分类条件、分类规则表达式）
  - 自动分类规则（自动分类规则设置、规则优先级）
  - 分类规则测试（分类规则测试、规则验证）
  - 分类规则导入导出（分类规则导入、分类规则导出）

#### 17.2 报表管理
**功能说明**：管理报表的创建、配置、更新等，实现报表的全生命周期管理。

**功能列表**：
- ✅ **报表列表展示**
  - 报表列表展示（分页）
  - 按功能模块筛选（客户管理、商机管理、生产管理等）
  - 按报表分类筛选（按分类树筛选）
  - 报表类型筛选（统计报表、分析报表、预测报表、图表报表、综合报表）
  - 报表状态筛选（草稿、启用、停用、已删除）
  - 报表搜索（报表名称、报表编号、报表描述、报表关键词）
  - 创建时间筛选（按创建时间范围筛选）
  - 报表排序（按创建时间、更新时间、使用次数排序）
  - 报表统计卡片（报表总数、启用报表数、使用次数、导出次数）
- ✅ **报表创建**
  - 报表名称录入（必填）
  - 报表编号录入（必填，唯一性检查）
  - 报表编号自动生成（RPT-{YYYYMMDD}-{序列号}）
  - 报表类型选择（统计报表、分析报表、预测报表、图表报表、综合报表）
  - 报表分类选择（必填，从分类树选择）
  - 关联功能模块选择（选择关联的功能模块，可多选）
  - 报表描述录入（报表说明、报表用途、报表说明）
  - 报表模板选择（选择报表模板，或自定义创建）
  - 报表数据源配置（数据源选择、数据源配置、数据源关联）
  - 报表字段配置（字段选择、字段排序、字段显示名称）
  - 报表参数配置（参数设置、参数类型、参数默认值、参数必填设置）
  - 报表图表配置（图表类型选择、图表配置、图表样式设置）
  - 报表权限设置（查看权限、导出权限、编辑权限、管理权限）
  - 报表状态设置（草稿、启用、停用）
  - 报表创建人记录（自动记录）
  - 报表创建时间记录（自动记录）
- ✅ **报表配置**
  - 报表基本信息编辑（报表名称、报表编号、报表类型、报表分类）
  - 报表数据源配置（数据源调整、数据源重新配置）
  - 报表字段配置（字段调整、字段排序、字段显示名称调整）
  - 报表参数配置（参数调整、参数类型调整、参数默认值调整）
  - 报表图表配置（图表类型调整、图表配置调整、图表样式调整）
  - 报表权限调整（权限调整、权限审批）
  - 报表状态调整（状态调整、停用原因录入）
  - 报表配置保存（配置保存、配置版本管理）
  - 报表配置预览（配置预览、配置验证）
- ✅ **报表更新**
  - 报表更新操作（报表更新、更新内容说明）
  - 报表版本管理（版本号、版本说明、版本历史）
  - 报表版本对比（版本对比、版本差异展示）
  - 报表版本回退（版本回退操作、回退确认）
  - 报表更新通知（更新通知、通知发送）
- ✅ **报表详情查看**
  - 报表基本信息展示（报表名称、报表编号、报表类型、报表分类、关联功能模块）
  - 报表分类信息（分类信息、分类路径）
  - 关联功能模块信息（关联模块列表、模块详情）
  - 报表参数说明（参数列表、参数说明、参数类型、参数默认值）
  - 报表预览（报表在线预览、报表数据预览）
  - 报表使用统计（查看次数、导出次数、最后使用时间、使用用户数）
  - 报表配置信息（数据源配置、字段配置、图表配置）
  - 报表版本信息（版本号、版本历史、版本说明）
- ✅ **报表启用/停用**
  - 报表状态切换（启用、停用）
  - 停用原因录入（停用原因、停用说明）
  - 状态变更记录（状态变更记录、变更时间、变更人）
  - 状态变更通知（状态变更通知、通知发送）

#### 17.3 报表查看
**功能说明**：提供报表的在线查看功能，包括报表预览、参数设置、数据刷新、图表展示等。

**功能列表**：
- ✅ **报表预览**
  - 报表在线预览（报表数据预览、报表格式预览）
  - 报表加载进度（加载进度提示、加载状态显示）
  - 报表错误处理（错误提示、错误处理、错误重试）
  - 报表刷新（数据刷新、刷新时间记录）
- ✅ **参数设置**
  - 报表参数设置（日期范围、筛选条件、分组条件、排序条件等）
  - 参数类型支持（日期、文本、数字、下拉选择、多选等）
  - 参数默认值设置（默认值设置、默认值应用）
  - 参数必填设置（必填参数检查、必填提示）
  - 参数联动设置（参数联动、参数依赖关系）
  - 参数保存（参数保存、参数模板保存）
  - 参数重置（参数重置、参数清空）
- ✅ **数据刷新**
  - 数据刷新操作（手动刷新、自动刷新）
  - 刷新频率设置（刷新频率、刷新间隔）
  - 刷新时间记录（刷新时间、刷新人）
  - 刷新状态显示（刷新状态、刷新进度）
- ✅ **图表展示**
  - 图表类型支持（柱状图、折线图、饼图、散点图、仪表盘、地图等）
  - 图表配置（图表样式、图表颜色、图表标题、图表图例）
  - 图表交互（图表缩放、图表筛选、图表钻取）
  - 图表导出（图表导出、图表保存）
  - 图表切换（图表类型切换、图表配置切换）
- ✅ **数据表格展示**
  - 数据表格展示（表格展示、表格排序、表格筛选）
  - 表格分页（分页设置、分页显示）
  - 表格导出（表格导出、表格打印）
  - 表格搜索（表格搜索、表格高亮）
  - 表格列设置（列显示设置、列排序、列宽度调整）
- ✅ **报表打印**
  - 报表打印预览（打印预览、打印格式预览）
  - 打印设置（页面设置、打印范围、打印方向、打印边距）
  - 打印样式设置（打印样式、打印字体、打印颜色）
  - 报表打印（打印操作、打印记录）
  - 打印历史记录（打印历史、打印记录查询）

#### 17.4 报表导出
**功能说明**：提供报表的多格式导出功能，支持Excel、PDF、Word等格式导出。

**功能列表**：
- ✅ **Excel导出**
  - 支持导出Excel格式（.xlsx）
  - 导出参数设置（导出范围、导出字段、导出格式）
  - 导出样式设置（表头样式、数据样式、边框样式）
  - 导出公式支持（公式导出、公式计算）
  - 导出图表支持（图表导出、图表嵌入）
  - 导出进度提示（导出进度、导出状态）
  - 导出文件下载（文件下载、下载记录）
- ✅ **PDF导出**
  - 支持导出PDF格式（.pdf）
  - 导出参数设置（导出范围、导出页面、导出格式）
  - 导出样式设置（页面样式、字体样式、颜色样式）
  - 导出水印设置（水印添加、水印样式）
  - 导出页眉页脚设置（页眉页脚、页眉页脚样式）
  - 导出进度提示（导出进度、导出状态）
  - 导出文件下载（文件下载、下载记录）
- ✅ **Word导出**
  - 支持导出Word格式（.docx）
  - 导出参数设置（导出范围、导出格式、导出样式）
  - 导出样式设置（文档样式、段落样式、表格样式）
  - 导出模板支持（模板选择、模板应用）
  - 导出进度提示（导出进度、导出状态）
  - 导出文件下载（文件下载、下载记录）
- ✅ **导出管理**
  - 导出历史记录（导出历史列表、导出记录详情）
  - 导出记录查询（按报表、按用户、按时间查询）
  - 导出记录统计（导出次数统计、导出格式统计、导出趋势分析）
  - 批量导出（批量导出操作、批量导出设置）
  - 导出任务管理（导出任务列表、导出任务状态、导出任务取消）

#### 17.5 报表收藏
**功能说明**：提供报表收藏功能，方便用户快速访问常用报表。

**功能列表**：
- ✅ **报表收藏**
  - 报表收藏功能（收藏操作、取消收藏）
  - 收藏报表列表（收藏报表列表、收藏报表详情）
  - 收藏报表快速访问（快速访问、访问记录）
  - 收藏报表分类管理（收藏分类、分类管理）
  - 收藏报表排序（排序设置、排序调整）
  - 收藏时间记录（收藏时间、收藏人）
- ✅ **常用报表**
  - 常用报表列表（基于使用频率自动生成）
  - 常用报表快速访问（快速访问、访问记录）
  - 常用报表自定义设置（自定义设置、设置保存）
  - 常用报表统计（使用频率统计、使用趋势分析）
  - 常用报表推荐（推荐算法、推荐报表列表）

#### 17.6 报表分享
**功能说明**：提供报表分享功能，支持报表的分享和权限控制。

**功能列表**：
- ✅ **报表分享**
  - 报表分享功能（分享操作、分享设置）
  - 分享方式选择（链接分享、邮件分享、二维码分享）
  - 分享链接生成（链接生成、链接有效期设置）
  - 分享权限设置（查看权限、导出权限、编辑权限）
  - 分享密码设置（密码设置、密码验证）
  - 分享范围设置（分享范围、分享对象选择）
  - 分享有效期设置（有效期设置、过期提醒）
- ✅ **分享管理**
  - 分享记录列表（分享记录列表、分享记录详情）
  - 分享记录查询（按报表、按用户、按时间查询）
  - 分享记录统计（分享次数统计、分享趋势分析）
  - 分享链接管理（链接管理、链接失效、链接删除）
  - 分享权限管理（权限调整、权限撤销）
- ✅ **分享记录查看**
  - 分享记录查看（分享记录详情、分享时间、分享人）
  - 分享访问记录（访问记录、访问时间、访问IP）
  - 分享访问统计（访问次数统计、访问趋势分析）
  - 分享效果评估（分享效果评估、效果反馈）

#### 17.7 报表分析（集成在报表列表页面中）
**功能说明**：提供报表分析功能，包括使用统计、数据分析、趋势分析等，支持多维度统计分析。

**功能列表**：
- ✅ **使用统计**
  - 报表使用次数统计（总使用次数、各类型报表使用次数、各分类报表使用次数）
  - 报表查看次数统计（查看次数、查看频率、查看趋势）
  - 报表导出次数统计（导出次数、导出频率、导出趋势）
  - 报表使用用户统计（使用用户数、用户使用情况、用户使用排名）
  - 报表使用时间统计（使用时间分布、使用时间段分析）
  - 报表使用排名（使用排名、热门报表分析）
  - 按功能模块统计（各模块报表使用情况、模块使用排名）
- ✅ **数据分析**
  - 数据对比分析（数据对比、对比维度、对比结果）
  - 数据趋势分析（趋势分析、趋势预测、趋势图表）
  - 数据关联分析（关联分析、关联关系、关联图表）
  - 数据分布分析（分布分析、分布图表、分布统计）
  - 数据异常分析（异常检测、异常分析、异常预警）
  - 数据分析报告（分析报告生成、分析报告导出）
- ✅ **趋势分析**
  - 报表使用趋势（使用趋势、使用趋势预测）
  - 报表导出趋势（导出趋势、导出趋势预测）
  - 报表数据趋势（数据趋势、数据趋势预测）
  - 报表价值趋势（价值趋势、价值趋势预测）
  - 报表类型分布（各类型报表分布、分布变化趋势）
  - 报表分类分布（各分类报表分布、分布变化趋势）

#### 17.8 各功能模块报表集成
**功能说明**：集中管理各功能模块的报表，各功能模块的报表统一在此模块中查看和管理。支持报表的统一分类、统一查看、统一导出、统一分析。

**⚠️ 重要说明**：
- **统一管理原则**：所有功能模块的报表功能，全部统一纳入到"报表管理"模块进行集中管理
- **报表入口**：各功能模块不再单独提供报表入口，所有报表统一从"报表管理"模块访问
- **报表分类**：报表按功能模块分类，在报表管理模块中通过"模块报表"菜单快速访问
- **数据源**：报表数据来源于各功能模块，但报表的创建、配置、查看、导出等操作统一在报表管理模块完成
- **权限同步**：各功能模块的报表权限设置自动同步到报表管理模块，确保权限一致性
- **报表模板**：所有报表模板统一在报表管理模块管理，支持模板复用和标准化

**集成报表列表**：
- ✅ **客户管理报表**
  - 客户统计报表（客户总数、活跃客户、VIP客户）
  - 客户线索转化报表（线索转化率、转化漏斗、转化趋势）
  - 客户关系报表（客户关系维护情况、客户满意度、客户流失率）
  - 客户拜访报表（拜访次数、拜访频率、拜访效果）
  - 客户分布报表（客户地域分布、客户行业分布、客户规模分布）
  - 客户价值报表（客户价值分析、客户贡献度、客户价值排名）
- ✅ **商机管理报表**
  - 商机统计报表（商机总数、各状态商机数、商机金额统计）
  - 销售漏斗报表（销售漏斗、各阶段转化率、漏斗分析）
  - 销售预测报表（销售预测、预测准确率、预测趋势）
  - 商机分析报表（商机分析、商机趋势、商机分布）
  - 商机成功率报表（成功率统计、成功率趋势、成功率分析）
  - 商机金额报表（商机金额统计、金额趋势、金额分布）
- ✅ **生产管理报表**
  - 项目进度报表（项目进度统计、进度趋势、进度分析）
  - 意见统计报表（意见数量统计、意见类型分布、意见处理情况）
  - 节省金额报表（节省金额统计、节省金额趋势、节省金额排名）
  - 团队工作量报表（工作量统计、工作量分布、工作量趋势）
  - 质量统计报表（质量统计、质量趋势、质量分析）
  - 项目效率报表（项目效率统计、效率趋势、效率分析）
  - 多轮审查报表（审查轮次统计、审查效率、审查质量）
- ✅ **收发管理报表**
  - 交付统计报表（交付总数、交付及时率、交付质量）
  - 交付及时率报表（及时率统计、及时率趋势、及时率分析）
  - 交付质量报表（质量统计、质量趋势、质量分析）
  - 交付方式报表（交付方式分布、交付方式效果）
  - 客户满意度报表（满意度统计、满意度趋势、满意度分析）
- ✅ **结算管理报表**
  - 结算统计报表（结算总数、结算金额、结算状态分布）
  - 结算趋势报表（结算趋势、结算金额趋势、结算周期趋势）
  - 结算状态分布报表（状态分布、状态变化趋势）
  - 结算效率报表（结算效率、结算周期、结算及时率）
  - 争议解决报表（争议数量、争议类型、争议解决率）
- ✅ **回款管理报表**
  - 回款统计报表（回款总数、回款金额、回款率）
  - 回款完成率报表（完成率统计、完成率趋势、完成率分析）
  - 逾期回款报表（逾期数量、逾期金额、逾期率）
  - 回款预测报表（回款预测、预测准确率、预测趋势）
  - 风险预警报表（风险数量、风险等级、风险处理情况）
  - 发票管理报表（发票开具统计、发票使用情况、发票作废情况）
- ✅ **产值管理报表**
  - 产值统计报表（产值总数、产值金额、产值分布）
  - 产值分析报表（产值分析、产值趋势、产值对比）
  - 产值排名报表（个人产值排名、部门产值排名、项目产值排名）
  - 产值完成率报表（完成率统计、完成率趋势、完成率分析）
  - 产值分配报表（产值分配情况、分配比例、分配效果）
- ✅ **人事管理报表**
  - 员工统计报表（员工总数、员工分布、员工结构）
  - 考勤统计报表（考勤统计、考勤率、考勤趋势）
  - 薪资统计报表（薪资统计、薪资分布、薪资趋势）
  - 绩效统计报表（绩效统计、绩效分布、绩效趋势）
  - 培训统计报表（培训统计、培训效果、培训趋势）
- ✅ **行政管理报表**
  - 行政事务报表（事务统计、事务处理情况、事务效率）
  - 办公用品报表（用品统计、用品使用情况、用品成本）
  - 会议统计报表（会议统计、会议效率、会议效果）
  - 车辆管理报表（车辆使用统计、车辆成本、车辆效率）
  - 固定资产报表（资产统计、资产分布、资产价值）
- ✅ **财务管理报表**
  - 财务核算报表（核算统计、核算准确性、核算效率）
  - 资金管理报表（资金统计、资金流动、资金预测）
  - 预算管理报表（预算统计、预算执行、预算分析）
  - 成本管理报表（成本统计、成本分析、成本控制）
  - 财务报表（资产负债表、利润表、现金流量表）
- ✅ **计划管理报表**
  - 计划统计报表（计划总数、计划完成率、计划执行情况）
  - 计划完成率报表（完成率统计、完成率趋势、完成率分析）
  - 目标达成报表（目标达成率、目标达成情况、目标分析）
  - 计划效率报表（计划效率、计划周期、计划质量）
- ✅ **档案管理报表**
  - 档案统计报表（档案总数、档案分布、档案增长趋势）
  - 档案利用报表（利用统计、利用趋势、利用效果）
  - 档案保管报表（保管统计、保管质量、保管效率）
  - 档案数字化报表（数字化统计、数字化进度、数字化效果）
- ✅ **资源管理报表**
  - 资源统计报表（资源总数、资源分布、资源增长趋势）
  - 资源使用报表（使用统计、使用趋势、使用效果）
  - 资源价值报表（价值统计、价值分析、价值评估）
  - 资源贡献报表（贡献统计、贡献分析、贡献排名）
- ✅ **风险管理报表**
  - 风险统计报表（风险总数、风险分布、风险等级分布）
  - 风险识别报表（识别统计、识别趋势、识别效果）
  - 风险评估报表（评估统计、评估趋势、评估准确性）
  - 风险处理报表（处理统计、处理效率、处理效果）
- ✅ **综合报表**
  - 业务综合报表（业务数据综合、业务趋势综合、业务分析综合）
  - 管理综合报表（管理数据综合、管理趋势综合、管理分析综合）
  - 财务综合报表（财务数据综合、财务趋势综合、财务分析综合）
  - 运营综合报表（运营数据综合、运营趋势综合、运营分析综合）

#### 17.9 报表管理技术实现方案
**功能说明**：报表管理模块的技术实现方案，包括数据源配置、报表引擎、报表模板、报表渲染等。

**技术架构**：
- ✅ **数据源管理**
  - 数据源类型：数据库查询、API接口、文件导入、数据计算
  - 数据源配置：连接配置、查询配置、参数配置
  - 数据源缓存：数据缓存策略、缓存更新机制
  - 数据源权限：数据源访问权限控制
- ✅ **报表引擎**
  - 报表模板引擎：支持HTML模板、Excel模板、PDF模板
  - 报表计算引擎：支持数据聚合、数据计算、数据转换
  - 报表渲染引擎：支持Web渲染、PDF渲染、Excel渲染
  - 报表缓存机制：报表结果缓存、缓存失效策略
- ✅ **报表模板管理**
  - 模板类型：统计报表模板、分析报表模板、图表报表模板
  - 模板设计器：可视化模板设计工具
  - 模板库：标准模板库、自定义模板库
  - 模板版本管理：模板版本控制、版本回退
- ✅ **报表权限控制**
  - 权限模型：基于角色和权限码的权限控制
  - 数据权限：根据用户角色过滤数据范围
  - 操作权限：查看权限、导出权限、管理权限
  - 权限继承：从功能模块继承权限设置

**API接口设计**：
- ✅ **报表管理接口**
  - `GET /api/reports/` - 获取报表列表（支持筛选、搜索、分页）
  - `POST /api/reports/` - 创建报表
  - `GET /api/reports/{id}/` - 获取报表详情
  - `PUT /api/reports/{id}/` - 更新报表配置
  - `DELETE /api/reports/{id}/` - 删除报表
  - `POST /api/reports/{id}/enable/` - 启用报表
  - `POST /api/reports/{id}/disable/` - 停用报表
- ✅ **报表查看接口**
  - `GET /api/reports/{id}/preview/` - 预览报表（支持参数设置）
  - `GET /api/reports/{id}/data/` - 获取报表数据（JSON格式）
  - `POST /api/reports/{id}/refresh/` - 刷新报表数据
- ✅ **报表导出接口**
  - `GET /api/reports/{id}/export/excel/` - 导出Excel格式
  - `GET /api/reports/{id}/export/pdf/` - 导出PDF格式
  - `GET /api/reports/{id}/export/word/` - 导出Word格式
- ✅ **报表收藏接口**
  - `POST /api/reports/{id}/favorite/` - 收藏报表
  - `DELETE /api/reports/{id}/favorite/` - 取消收藏
  - `GET /api/reports/favorites/` - 获取收藏报表列表
- ✅ **报表分享接口**
  - `POST /api/reports/{id}/share/` - 分享报表
  - `GET /api/reports/{id}/share-links/` - 获取分享链接列表
  - `DELETE /api/reports/{id}/share-links/{link_id}/` - 删除分享链接
- ✅ **报表统计接口**
  - `GET /api/reports/statistics/` - 获取报表使用统计
  - `GET /api/reports/{id}/statistics/` - 获取单个报表使用统计

**代码文件位置**（待实现）：
- 模型定义：`backend/apps/report_management/models.py`
- 页面视图：`backend/apps/report_management/views_pages.py`
- REST API视图：`backend/apps/report_management/views.py`
- URL路由：`backend/apps/report_management/urls.py`
- 页面模板：`backend/templates/report_management/`
- 报表引擎：`backend/apps/report_management/engines/`
- 报表模板：`backend/apps/report_management/templates/`

#### 17.10 报表管理入口配置
**功能说明**：配置报表管理在工作台左侧菜单和各功能模块顶部菜单中的入口，确保用户可以从任何位置快速访问报表管理模块。

**入口配置方式**：

##### 17.10.1 工作台左侧菜单入口配置（✅ 已配置）
- **配置位置**：`backend/core/views.py` 中的 `HOME_NAV_STRUCTURE` 列表
- **配置状态**：✅ 已配置（2025-01-30）
- **配置代码**：
  ```python
  HOME_NAV_STRUCTURE = [
      # ... 其他菜单项 ...
      {'label': '报表管理', 'icon': '📊', 'url_name': 'report_pages:report_list', 'permission': 'report_management.view'},
      # ... 其他菜单项 ...
  ]
  ```
- **配置说明**：
  - `label`：菜单显示名称（"报表管理"）
  - `icon`：菜单图标（📊）
  - `url_name`：URL反向解析名称（`report_pages:report_list`，需在报表管理模块的urls.py中定义）
  - `permission`：权限码（`report_management.view`，控制菜单可见性）
- **菜单位置**：位于"计划管理"之后，系统模块分类中
- **权限控制**：只有拥有 `report_management.view` 权限的用户才能看到报表管理入口
- **自动同步**：配置后会自动同步到工作台左侧菜单和各功能模块顶部菜单

##### 17.10.2 各功能模块顶部菜单入口配置（✅ 自动生成）
- **实现方式**：各功能模块的顶部菜单通过 `_build_full_top_nav()` 函数自动从 `HOME_NAV_STRUCTURE` 生成
- **配置状态**：✅ 已自动配置（通过HOME_NAV_STRUCTURE自动同步）
- **自动同步机制**：
  - 在 `HOME_NAV_STRUCTURE` 中添加报表管理菜单项后，会自动同步到所有功能模块的顶部导航菜单
  - 各功能模块的 `_build_full_top_nav()` 函数会遍历 `HOME_NAV_STRUCTURE` 生成顶部菜单
  - 已实现此功能的功能模块包括：
    - 客户管理模块（`customer_success/views_pages.py`）
    - 生产管理模块（`production_management/views_pages.py`）
    - 收发管理模块（`delivery_customer/views_pages.py`）
    - 其他所有使用 `_build_full_top_nav()` 函数的模块
- **模板使用**：各功能模块的base.html模板通过 `{% include "shared/_top_nav.html" %}` 引入顶部导航菜单
- **显示位置**：顶部导航菜单的"报表管理"入口位于所有功能模块入口之后
- **权限控制**：顶部菜单中的报表管理入口同样受权限控制，只有有权限的用户才能看到
- **验证方法**：
  - 登录系统后，进入任意功能模块（如客户管理、生产管理等）
  - 查看页面顶部导航菜单，应能看到"📊 报表管理"入口
  - 点击"报表管理"入口，应跳转到报表管理模块的报表列表页面

##### 17.10.3 工作台数据统计卡片快捷入口（⏳ 待实现）
- **功能说明**：在工作台的数据统计卡片中添加"查看报表"按钮，点击后跳转到报表管理模块的对应报表
- **实现位置**：`backend/core/views.py` 的 `home()` 函数中构建统计卡片时添加
- **实现方式**：
  - 在统计卡片数据中添加 `report_url` 字段
  - 在模板中为统计卡片添加"查看报表"按钮
  - 点击按钮跳转到报表管理模块的对应模块报表页面
- **示例配置**：
  ```python
  stats_cards.append({
      'label': '项目总数',
      'value': project_total,
      'trend': f'进行中 {project_in_progress} · 已完成 {project_completed}',
      'variant': 'default',
      'icon': '🏗️',
      'url': reverse('production_pages:project_list'),
      'report_url': reverse('report_pages:module_reports', kwargs={'module': 'production'}),  # 新增报表链接
  })
  ```

##### 17.10.4 各功能模块页面快捷入口（⏳ 待实现）
- **功能说明**：在各功能模块的列表页面或详情页面添加"查看报表"快捷按钮
- **实现位置**：各功能模块的列表页面模板（如 `customer_list.html`、`project_list.html` 等）
- **实现方式**：
  - 在页面顶部操作栏添加"查看报表"按钮
  - 按钮链接到报表管理模块的对应模块报表页面
  - 支持传递当前筛选条件，报表页面自动应用筛选
- **示例代码**：
  ```html
  <a href="{% url 'report_pages:module_reports' module='customer' %}" class="btn btn-outline-primary">
      📊 查看报表
  </a>
  ```

**入口优先级**：
1. **主入口1**：工作台左侧菜单 > 报表管理（✅ 已配置，最常用，始终可见）
2. **主入口2**：各功能模块顶部菜单 > 报表管理（✅ 已自动配置，方便从各模块快速访问）
3. **快捷按钮**：工作台统计卡片 > 查看报表（⏳ 待实现，快速查看相关报表）
4. **页面入口**：各功能模块页面 > 查看报表按钮（⏳ 待实现，页面内快捷访问）

**权限控制说明**：
- 所有报表管理入口都受权限控制
- 权限码：`report_management.view`（查看报表权限）
- 权限继承：各功能模块的权限设置自动同步到报表管理模块
- 数据权限：根据用户角色过滤报表数据范围（员工/部门经理/高管）

**配置验证方法**：
1. **验证工作台左侧菜单**：
   - 登录系统，进入工作台
   - 查看左侧导航菜单，应能看到"📊 报表管理"菜单项
   - 点击"报表管理"，应跳转到报表管理模块（如模块未实现，会显示404或功能开发中提示）
2. **验证各模块顶部菜单**：
   - 进入任意功能模块（如客户管理、生产管理等）
   - 查看页面顶部导航菜单，应能看到"📊 报表管理"入口
   - 点击"报表管理"，应跳转到报表管理模块
3. **验证权限控制**：
   - 使用没有 `report_management.view` 权限的用户登录
   - 验证工作台左侧菜单和顶部菜单中都不显示"报表管理"入口
   - 使用有权限的用户登录，验证入口正常显示

**注意事项**：
- ⚠️ 报表管理模块的URL路由（`report_pages:report_list`）需要在报表管理模块实现后才能正常跳转
- ⚠️ 权限码（`report_management.view`）需要在系统管理模块中配置后才能生效
- ⚠️ 如果报表管理模块尚未实现，菜单项会显示但点击后会跳转到404页面或显示"功能开发中"提示

---

### 18. 标准管理
- **状态**：⏳ 计划中
- **完成度**：0%
- **说明**：集中管理精细化审图服务类型中的审图标准，包括标准文件上传、管理、应用等。生产管理模块在创建精细化审图项目时，可调用此模块中的审图标准。

#### 18.1 审图标准管理
**功能说明**：审图标准管理用于管理精细化审图服务类型中的审图标准，包括标准文件上传、管理、应用等。审图标准是精细化审图的审查基准，用于指导审图意见的编制和审图质量的评估。生产管理模块在创建精细化审图项目时，可调用此模块中的审图标准。

**详细功能**：

##### 18.1.1 标准文件上传
- ⏳ **标准文件类型**
  - 甲方标准文件上传（字段：专业名称、部位名称、审查要点、问题类别）
  - 我方标准文件上传（字段：专业名称、部位名称、审查要点、问题类别）
  - 支持Excel格式导入（.xlsx）
  - 支持手动录入标准条目
- ⏳ **标准文件字段**
  - 专业名称（必填，下拉选择：建筑、结构、给排水、电气、暖通等）
  - 部位名称（必填，如：地下室、首层、标准层、屋面等）
  - 审查要点（必填，说明审查的具体内容）
  - 问题类别（必填，下拉选择：强制性条文、一般性条文、设计优化建议等）
  - 标准说明（可选，说明标准的来源、适用范围等）
- ⏳ **标准文件设定**
  - 标准文件设定为项目审查基准（关联到具体项目）
  - 项目信息自动带入（项目编号、项目名称等）
  - 服务类型自动判断为"精细化审图"
  - 标准文件生效时间设置

##### 18.1.2 标准文件管理
- ⏳ **标准文件列表**
  - 标准文件列表展示（分页，每页默认20条）
  - 显示字段：标准文件名称、标准类型（甲方标准/我方标准）、专业、标准条目数、创建时间、最后更新时间
  - 按标准类型筛选（甲方标准、我方标准）
  - 按专业筛选
  - 按项目筛选
  - 按创建时间筛选
- ⏳ **标准文件查看**
  - 标准文件基本信息（标准文件名称、标准类型、创建人、创建时间等）
  - 标准条目列表（专业、部位、审查要点、问题类别）
  - 标准条目详情查看
  - 标准文件导出（Excel格式）
- ⏳ **标准文件编辑**
  - 支持编辑标准文件（需权限控制）
  - 支持添加标准条目
  - 支持修改标准条目
  - 支持删除标准条目（软删除）
  - 编辑历史自动保存
- ⏳ **标准文件删除**
  - 支持删除标准文件（需权限控制，软删除）
  - 删除前检查使用情况（若有关联的项目使用此标准，需先解除关联）
  - 删除原因录入
  - 删除记录（记录删除人、删除时间、删除原因）

---

## 🔧 系统模块

### 19. 系统管理
- **状态**：✅ 已完成
- **完成度**：90%
- **说明**：系统管理模块分为两部分：系统设置（后台管理，仅系统管理员可见）和个人设置（所有用户可见）。系统设置包括用户管理、角色管理、权限管理、部门管理、岗位管理、系统配置、审批流程引擎配置等后台管理功能。

#### 19.1 系统设置（后台管理）
**功能说明**：系统设置是后台管理功能，仅系统管理员可见。包括用户管理、角色管理、权限管理、部门管理、岗位管理、系统配置、审批流程引擎配置等所有后台管理功能。

##### 19.1.1 用户管理（人员信息管理）
**功能说明**：管理公司的人员信息，包括用户的基本信息、部门、岗位、角色等，支持人员信息的全生命周期管理。

**功能列表**：
- ✅ **用户列表**
  - 用户列表展示（分页）
  - 用户搜索（用户名、姓名、工号、邮箱、手机）
  - 部门筛选（按部门筛选用户）
  - 岗位筛选（按岗位筛选用户）
  - 角色筛选（按角色筛选用户）
  - 状态筛选（启用、禁用、离职）
  - 用户统计卡片（用户总数、各部门用户数、各岗位用户数、各角色用户数）
- ✅ **用户创建**
  - 用户名录入（必填，唯一性检查）
  - 密码设置（必填，密码强度验证）
  - 姓名录入（必填）
  - 工号录入（必填，唯一性检查）
  - 工号自动生成（EMP-{YYYYMMDD}-{序列号}）
  - 邮箱录入（邮箱格式验证）
  - 手机录入（手机号格式验证）
  - 部门选择（必填，从部门列表选择）
  - 岗位选择（必填，从岗位列表选择）
  - 角色分配（角色选择，可多选）
  - 职位录入（职位名称、职位级别）
  - 入职时间设置（入职时间、入职日期）
  - 员工类型选择（正式员工、试用期员工、实习生、其他）
  - 用户状态设置（启用、禁用）
  - 用户创建时间记录（自动记录）
  - 用户创建人记录（自动记录）
- ✅ **用户编辑**
  - 基本信息编辑（姓名、工号、邮箱、手机、职位）
  - 联系方式编辑（邮箱、手机、办公电话、其他联系方式）
  - 部门调整（调整所属部门）
  - 岗位调整（调整所属岗位）
  - 角色调整（调整用户角色）
  - 职位调整（调整职位信息）
  - 员工类型调整（调整员工类型）
  - 用户状态调整（启用、禁用、离职）
- ✅ **用户详情查看**
  - 基本信息查看（用户名、姓名、工号、邮箱、手机、职位）
  - 部门信息查看（所属部门、部门层级、部门负责人）
  - 岗位信息查看（所属岗位、岗位类型、岗位级别）
  - 角色信息查看（用户角色、角色权限）
  - 入职信息查看（入职时间、员工类型、工作年限）
  - 关联信息查看（关联项目、关联任务、关联审批等）
- ✅ **用户删除**
  - 用户删除（需检查关联关系，有关联数据时不允许删除）
  - 删除确认（删除确认提示）
  - 批量删除（批量删除用户，需检查关联关系）
- ✅ **用户启用/禁用**
  - 用户状态切换（启用、禁用、离职）
  - 禁用原因录入（禁用原因、禁用说明）
  - 状态变更记录（状态变更记录、变更时间、变更人）
- ✅ **用户导入导出**
  - 用户信息导入（Excel导入、批量导入、导入模板下载）
  - 用户信息导出（Excel导出、批量导出、导出字段选择）
  - 导入导出记录（导入导出历史、导入导出统计）
- ✅ **用户统计**
  - 用户数量统计（用户总数、各部门用户数、各岗位用户数、各角色用户数）
  - 用户状态统计（启用用户数、禁用用户数、离职用户数）
  - 用户类型统计（各类型用户数、类型占比、类型趋势）
  - 用户增长统计（用户增长趋势、增长速率、增长预测）
- ✅ **用户注册审核**
  - 注册申请列表（注册申请列表、申请状态筛选）
  - 注册申请详情查看（申请人信息、申请时间、申请IP、申请理由）
  - 注册审核操作（审核通过、审核拒绝、审核意见录入）
  - 审核意见录入（审核意见、审核说明、审核时间）
  - 审核结果通知（审核结果通知、通知发送、通知记录）
  - 注册审核统计（审核数量统计、审核通过率、审核趋势分析）

##### 19.1.2 角色管理
**功能列表**：
- ✅ **角色列表**
  - 角色列表展示
  - 角色搜索
  - 角色代码筛选
- ✅ **角色创建**
  - 角色名称录入
  - 角色代码录入
  - 角色描述录入
  - 权限分配
- ✅ **角色编辑**
  - 角色信息编辑
  - 权限调整
- ✅ **角色删除**
  - 角色删除（需检查关联关系）
- ✅ **角色权限配置**
  - 权限矩阵展示
  - 权限分配
  - 自定义权限设置

##### 19.1.3 权限管理
**功能列表**：
- ✅ **权限矩阵**
  - 权限矩阵展示（角色 × 权限）
  - 权限分配操作
  - 权限查询
- ✅ **权限分配**
  - 角色权限分配
  - 用户权限分配
  - 权限继承设置
- ✅ **权限查询**
  - 用户权限查询
  - 角色权限查询
  - 权限使用情况查询

##### 19.1.4 部门管理
**功能说明**：管理公司的组织架构，包括部门的创建、编辑、删除等，支持多级部门结构。

**功能列表**：
- ✅ **部门列表**
  - 部门列表展示（树形结构、支持展开/折叠）
  - 部门搜索（部门名称、部门代码）
  - 部门层级展示（显示部门层级、部门路径）
  - 部门状态筛选（启用、停用）
  - 部门统计（每个部门下的员工数量、岗位数量）
- ✅ **部门创建**
  - 部门名称录入（必填）
  - 部门代码录入（必填，唯一性检查）
  - 部门代码自动生成（DEPT-{序列号}）
  - 上级部门选择（选择上级部门，支持多级部门）
  - 部门负责人选择（选择部门负责人，从用户列表选择）
  - 部门描述录入（部门说明、部门职责）
  - 部门排序设置（部门显示顺序）
  - 部门状态设置（启用、停用）
  - 部门创建时间记录（自动记录）
  - 部门创建人记录（自动记录）
- ✅ **部门编辑**
  - 部门信息编辑（部门名称、部门代码、部门描述）
  - 部门层级调整（调整部门层级、移动部门）
  - 部门负责人调整（调整部门负责人）
  - 部门排序调整（调整部门显示顺序）
  - 部门状态调整（启用、停用）
- ✅ **部门删除**
  - 部门删除（需检查关联关系，有员工或岗位时不允许删除）
  - 删除确认（删除确认提示）
  - 批量删除（批量删除部门，需检查关联关系）
- ✅ **部门统计**
  - 部门人员统计（各部门人员数量、人员分布）
  - 部门岗位统计（各部门岗位数量、岗位分布）
  - 部门层级统计（各部门层级分布、层级深度统计）

##### 19.1.5 岗位管理
**功能说明**：管理公司的岗位信息，包括岗位的创建、编辑、删除等，支持岗位与部门、人员的关联。

**功能列表**：
- ✅ **岗位列表**
  - 岗位列表展示（分页）
  - 岗位搜索（岗位名称、岗位代码）
  - 岗位类型筛选（管理岗、技术岗、业务岗、其他）
  - 部门筛选（按部门筛选岗位）
  - 岗位状态筛选（启用、停用）
  - 岗位统计（岗位总数、各类型岗位数、各部门岗位数）
- ✅ **岗位创建**
  - 岗位名称录入（必填）
  - 岗位代码录入（必填，唯一性检查）
  - 岗位代码自动生成（POST-{序列号}）
  - 岗位类型选择（管理岗、技术岗、业务岗、其他）
  - 所属部门选择（必填，从部门列表选择）
  - 岗位级别设置（岗位级别、级别说明）
  - 岗位职责录入（岗位职责、岗位要求）
  - 岗位描述录入（岗位说明、岗位特点）
  - 岗位排序设置（岗位显示顺序）
  - 岗位状态设置（启用、停用）
  - 岗位创建时间记录（自动记录）
  - 岗位创建人记录（自动记录）
- ✅ **岗位编辑**
  - 岗位信息编辑（岗位名称、岗位代码、岗位类型、岗位职责、岗位描述）
  - 所属部门调整（调整所属部门）
  - 岗位级别调整（调整岗位级别）
  - 岗位排序调整（调整岗位显示顺序）
  - 岗位状态调整（启用、停用）
- ✅ **岗位删除**
  - 岗位删除（需检查关联关系，有人员时不允许删除）
  - 删除确认（删除确认提示）
  - 批量删除（批量删除岗位，需检查关联关系）
- ✅ **岗位人员关联**
  - 岗位人员列表（岗位下的人员列表）
  - 人员分配（将人员分配到岗位）
  - 人员移除（从岗位移除人员）
  - 岗位人员统计（各岗位人员数量、人员分布）
- ✅ **岗位统计**
  - 岗位数量统计（岗位总数、各类型岗位数、各部门岗位数）
  - 岗位人员统计（各岗位人员数量、人员分布）
  - 岗位空缺统计（岗位空缺数量、空缺岗位列表）

##### 19.1.6 系统配置
**功能说明**：管理系统的基础配置，包括系统参数、数据字典、操作日志等。

**功能列表**：
- ✅ **系统参数配置**
  - 系统参数列表（分页）
  - 参数分类（系统参数、业务参数、安全参数、其他参数）
  - 参数搜索（参数名称、参数代码）
  - 参数值设置（参数值录入、参数值验证、参数值保存）
  - 参数说明（参数说明、参数用途、参数示例）
  - 参数类型设置（文本、数字、布尔值、日期、JSON等）
  - 参数默认值设置（默认值、默认值说明）
  - 参数生效范围设置（全局、模块、用户）
  - 参数编辑（参数信息编辑、参数值修改）
  - 参数删除（参数删除、删除确认）
- ✅ **数据字典管理**
  - 字典列表展示（分页）
  - 字典分类（系统字典、业务字典、其他字典）
  - 字典搜索（字典名称、字典代码）
  - 字典创建（字典名称、字典代码、字典描述、字典类型）
  - 字典编辑（字典信息编辑、字典描述修改）
  - 字典删除（字典删除、删除确认）
  - 字典项管理（字典项列表、字典项创建、字典项编辑、字典项删除）
  - 字典值设置（字典值录入、字典值排序、字典值状态）
  - 字典项导入导出（Excel导入、Excel导出）
- ✅ **操作日志查看**
  - 日志列表展示（分页）
  - 日志搜索（操作人、操作内容、操作IP）
  - 日志筛选（用户、操作类型、时间范围、操作模块）
  - 操作类型筛选（创建、编辑、删除、查看、登录、登出、审批、其他）
  - 日志详情查看（操作人、操作时间、操作IP、操作内容、操作结果、操作前后数据对比）
  - 日志导出（Excel导出、日志报表生成）
  - 日志统计（操作统计、操作趋势、操作分布）
  - 日志清理（日志清理规则、日志清理执行、日志清理记录）

##### 19.1.7 审批流程引擎配置
**功能说明**：审批流程引擎配置是系统设置的核心功能，由系统管理员根据业务节点与权限等进行集中配置。**每个业务节点都必须配置审批流程**，因为审批节点将与产值形成关联。前端不提供审批流程管理入口，审批操作在各业务模块中完成。

**配置位置说明**：
- **配置位置**：审批流程引擎配置在系统管理模块（19.1.7）中完成，由系统管理员统一管理
- **关联模块**：虽然配置在系统管理模块，但与产值管理模块（11）紧密关联
- **关联关系**：审批节点必须与产值阶段/里程碑关联，审批通过后自动触发产值计算
- **配置前提**：配置审批流程前，需先在产值管理模块（11.1）中配置产值阶段和里程碑
- **产值管理说明**：产值管理模块（11）中已说明审批流程配置的关联关系，详细配置操作在本模块完成

**审批节点与产值关联说明**：
```
┌─────────────────────────────────────────────────────────────┐
│              审批节点与产值关联体系                            │
├─────────────────────────────────────────────────────────────┤
│ 1. 审批节点定义                                              │
│    ├── 每个业务节点必须配置审批流程                           │
│    ├── 审批节点与产值阶段关联                                 │
│    └── 审批节点与产值里程碑关联                               │
│                                                             │
│ 2. 产值触发机制（统一机制）                                  │
│    ├── 业务事件发生（如项目创建、图纸审批、意见审批等）      │
│    ├── 业务事件进入审批流程（审批流程在系统管理模块19.1.7中配置）
│    ├── 审批节点通过 → 触发产值计算                           │
│    ├── 审批节点完成 → 产值节点完成                             │
│    └── 审批时间 → 产值计算时间                                 │
│    └── 说明：产值计算统一基于审批节点通过触发，不是直接基于业务事件触发
│                                                             │
│ 3. 产值分配机制                                              │
│    ├── 审批人 → 产值分配对象                                   │
│    ├── 审批角色 → 产值分配角色                                 │
│    └── 审批部门 → 产值分配部门                                 │
│                                                             │
│ 4. 产值计算规则                                              │
│    ├── 审批节点产值比例配置                                   │
│    ├── 审批节点产值基数设置                                   │
│    └── 审批节点产值计算公式                                   │
└─────────────────────────────────────────────────────────────┘
```

**功能列表**：
- ✅ **流程模板列表**
  - 模板列表展示（分页）
  - 模板搜索（模板名称、模板类型、模板代码）
  - 模板类型筛选（客户审批、合同审批、项目审批、结算审批、回款审批、产值审批、其他审批）
  - 模板状态筛选（启用、停用）
  - 模板使用情况统计（使用次数、使用模块、使用节点）
  - 模板统计卡片（模板总数、启用模板数、停用模板数）
- ✅ **流程模板创建**
  - 模板名称录入（必填）
  - 模板代码录入（必填，唯一性检查）
  - 模板代码自动生成（FLOW-{类型代码}-{序列号}）
  - 模板类型选择（客户审批、合同审批、项目审批、结算审批、回款审批、产值审批、其他审批）
  - 模板描述录入（模板说明、模板用途）
  - 关联业务模块选择（关联模块、模块节点）
  - 审批节点配置（节点创建、节点顺序、节点关联）
  - 条件分支配置（分支条件、分支目标节点）
  - 产值关联配置（产值阶段关联、产值里程碑关联、产值比例设置）
  - 模板状态设置（启用、停用）
  - 模板创建时间记录（自动记录）
  - 模板创建人记录（自动记录）
- ✅ **流程模板编辑**
  - 模板信息编辑（模板名称、模板代码、模板类型、模板描述）
  - 节点配置编辑（节点添加、节点删除、节点顺序调整）
  - 条件分支编辑（分支条件调整、分支目标节点调整）
  - 产值关联调整（产值阶段调整、产值里程碑调整、产值比例调整）
  - 模板状态调整（启用、停用）
- ✅ **流程模板删除**
  - 模板删除（需检查使用情况，有使用记录时不允许删除）
  - 删除确认（删除确认提示）
  - 批量删除（批量删除模板，需检查使用情况）
- ✅ **模板启用/停用**
  - 模板状态切换（启用、停用）
  - 停用原因录入（停用原因、停用说明）
  - 状态变更记录（状态变更记录、变更时间、变更人）

- ✅ **审批节点配置**
  - **节点创建**
    - 节点名称录入（必填）
    - 节点代码录入（必填，唯一性检查）
    - 节点代码自动生成（NODE-{序列号}）
    - 节点类型选择（审批节点、会签节点、或签节点、条件节点、结束节点）
    - 节点顺序设置（节点顺序、节点位置）
    - 审批人配置（指定用户、指定角色、指定部门、指定岗位、动态指定）
    - 审批人选择方式（单选、多选、会签、或签）
    - 审批条件设置（条件表达式、条件规则、条件优先级）
    - 审批超时设置（超时时间、超时处理方式）
    - 审批提醒设置（提醒时间、提醒方式、提醒对象）
    - 产值关联设置（关联产值阶段、关联产值里程碑、产值比例、产值基数）
    - 节点状态设置（启用、停用）
  - **节点编辑**
    - 节点信息编辑（节点名称、节点代码、节点类型、节点顺序）
    - 审批人调整（审批人添加、审批人删除、审批人顺序调整）
    - 审批条件调整（条件表达式调整、条件规则调整）
    - 审批超时调整（超时时间调整、超时处理方式调整）
    - 产值关联调整（产值阶段调整、产值里程碑调整、产值比例调整）
    - 节点状态调整（启用、停用）
  - **节点删除**
    - 节点删除（需检查使用情况，有使用记录时不允许删除）
    - 删除确认（删除确认提示）
  - **节点审批人配置**
    - 审批人添加（从用户列表、角色列表、部门列表、岗位列表选择）
    - 审批人删除（删除审批人、删除确认）
    - 审批人顺序设置（调整审批人顺序、顺序保存）
    - 审批人类型设置（用户、角色、部门、岗位、动态）
    - 审批人条件设置（审批人选择条件、条件表达式）
  - **节点产值关联配置**
    - 产值阶段关联（选择产值阶段、阶段产值比例设置）
    - 产值里程碑关联（选择产值里程碑、里程碑产值比例设置）
    - 产值比例设置（节点产值比例、比例计算规则）
    - 产值基数设置（产值基数类型、基数来源、基数计算规则）
    - 产值分配规则（分配对象、分配比例、分配方式）
    - 产值触发条件（触发条件、触发时机、触发规则）
  - **条件分支配置**
    - 分支条件设置（条件表达式、条件规则、条件值）
    - 分支目标节点设置（目标节点选择、节点跳转规则）
    - 分支优先级设置（优先级设置、优先级排序）
    - 分支条件测试（条件测试、测试结果、测试验证）

- ✅ **业务节点审批流程配置**
  - **客户管理节点审批流程**
    - 客户创建审批（审批节点配置、审批人配置、产值关联配置）
    - 客户变更审批（审批节点配置、审批人配置、产值关联配置）
    - 客户公海审批（审批节点配置、审批人配置、产值关联配置）
  - **商机管理节点审批流程**
    - 商机创建审批（审批节点配置、审批人配置、产值关联配置）
    - 报价审批（审批节点配置、审批人配置、产值关联配置）
    - 合同审批（审批节点配置、审批人配置、产值关联配置）
  - **商机管理节点审批流程（立项审批）**
    - 立项创建审批（审批节点配置、审批人配置、产值关联配置）
    - 立项变更审批（审批节点配置、审批人配置、产值关联配置）
  - **生产管理节点审批流程**
    - 项目创建审批（审批节点配置、审批人配置、产值关联配置）
    - 图纸审批（审批节点配置、审批人配置、产值关联配置）
    - 意见审批（审批节点配置、审批人配置、产值关联配置）
    - 成果确认审批（审批节点配置、审批人配置、产值关联配置）
    - 产值审批（审批节点配置、审批人配置、产值关联配置）
  - **结算管理节点审批流程**
    - 结算创建审批（审批节点配置、审批人配置、产值关联配置）
    - 结算初审审批（审批节点配置、审批人配置、产值关联配置）
    - 结算定案审批（审批节点配置、审批人配置、产值关联配置）
  - **回款管理节点审批流程**
    - 回款计划审批（审批节点配置、审批人配置、产值关联配置）
    - 发票开具审批（审批节点配置、审批人配置、产值关联配置）
  - **产值管理节点审批流程**
    - 产值计算审批（审批节点配置、审批人配置、产值关联配置）
    - 产值分配审批（审批节点配置、审批人配置、产值关联配置）
    - 产值确认审批（审批节点配置、审批人配置、产值关联配置）
  - **其他模块节点审批流程**
    - 人事管理节点审批流程（入职审批、离职审批、调岗审批等）
    - 行政管理节点审批流程（用印审批、用车审批、差旅审批等）
    - 财务管理节点审批流程（费用审批、报销审批、预算审批等）
    - 计划管理节点审批流程（计划审批、目标审批等）
    - 档案管理节点审批流程（归档审批、借阅审批、销毁审批等）
    - 资源管理节点审批流程（资源审批、使用审批等）
    - 风险管理节点审批流程（风险审批、应对审批等）
    - 诉讼管理节点审批流程（案件审批、立案审批、费用审批、和解审批、撤诉审批、执行审批等）

- ✅ **审批流程配置说明**
  - **配置位置**：
    - 审批流程引擎配置在系统管理模块（19.1.7）中完成，由系统管理员统一管理
    - 产值阶段/里程碑配置在产值管理模块（11.1）中完成
    - 产值计算和分配在产值管理模块（11.2、11.5）中完成
  - **配置流程**：
    ```
    第一步：在产值管理模块（11.1）配置产值阶段和里程碑
         ↓
    第二步：在系统管理模块（19.1.7）配置审批流程模板
         ↓
    第三步：在系统管理模块（19.1.7）配置审批节点
         ↓
    第四步：在系统管理模块（19.1.7）将审批节点与产值阶段/里程碑关联
         ↓
    第五步：业务事件发生 → 进入审批流程 → 审批节点通过 → 系统自动触发产值管理模块（11.2）的产值计算
         ↓
    第六步：在产值管理模块（11.5）完成产值分配
    ```
  - **配置原则**：
    - 每个业务节点都必须配置审批流程（统一触发机制）
    - **产值计算触发机制**：业务事件发生 → 进入审批流程 → 审批节点通过 → 自动触发产值计算
    - 审批节点必须与产值阶段或产值里程碑关联（必须先配置产值阶段/里程碑）
    - 审批通过后自动触发产值计算（在产值管理模块11.2中执行）
    - 审批人可作为产值分配对象（根据审批节点配置的产值比例进行分配）
    - **重要说明**：产值计算统一基于审批节点通过触发，不是直接基于业务事件触发。虽然产值事件中配置了"关联业务事件"，但这些业务事件需要通过审批流程，审批通过后才触发产值计算。
  - **配置内容**：
    - 流程模板：模板名称、模板类型、模板描述
    - 审批节点：节点名称、节点类型、节点顺序、审批人、审批条件
    - 产值关联：产值阶段、产值里程碑、产值比例、产值基数、产值分配规则（需从产值管理模块11.1中选择已配置的阶段/里程碑）
    - 条件分支：分支条件、分支目标节点、分支优先级
  - **配置权限**：仅系统管理员可进行配置，在系统设置模块中完成
  - **前端使用**：各业务模块通过调用审批流程引擎完成审批操作，前端不提供审批流程管理入口
  - **审批操作**：审批实例管理、审批操作、审批通知、审批历史等功能在各业务模块中完成，不在系统设置中提供
  - **产值关联机制（统一触发机制）**：
    - **触发流程**：业务事件发生 → 进入审批流程 → 审批节点通过 → 触发产值计算
    - 审批节点与产值阶段关联：审批通过后，对应的产值阶段自动完成，触发产值管理模块（11.2）的产值计算
    - 审批节点与产值里程碑关联：审批通过后，对应的产值里程碑自动完成，触发产值管理模块（11.2）的产值计算
    - 审批人产值分配：审批人可作为产值分配对象，根据审批节点配置的产值比例进行产值分配（在产值管理模块11.5中完成）
    - 审批时间产值计算：审批通过时间作为产值计算时间，用于产值管理模块（11.2）的产值计算和分配
    - **重要说明**：产值计算统一基于审批节点通过触发，不是直接基于业务事件触发。虽然产值事件中配置了"关联业务事件"（如项目创建、图纸审批等），但这些业务事件需要通过审批流程，审批通过后才触发产值计算。
  - **关联模块说明**：
    - 产值管理模块（11）中已说明审批流程配置的关联关系和使用方式
    - 详细配置操作在系统管理模块（19.1.7）中完成
    - 产值计算和分配在产值管理模块（11）中完成

#### 19.2 个人设置
**功能说明**：个人设置是面向所有用户的功能，包括个人资料管理、账号设置、密码修改等。每个用户都可以管理自己的个人信息和账号设置。

**功能列表**：
- ✅ **个人资料管理**
  - 个人资料查看（姓名、工号、邮箱、手机、职位、部门、岗位、角色）
  - 个人资料编辑（姓名、邮箱、手机、职位、其他联系方式）
  - 头像上传（头像上传、头像裁剪、头像预览）
  - 个人简介录入（个人简介、个人特长、个人经历）
  - 个人资料保存（资料保存、保存确认）
- ✅ **账号设置**
  - 账号信息设置（用户名、邮箱、手机、其他联系方式）
  - 通知设置（系统通知、邮件通知、短信通知、其他通知）
  - 通知偏好设置（通知类型、通知频率、通知时间）
  - 安全设置（登录密码修改、安全问题设置、二次验证设置）
  - 隐私设置（个人信息可见性、数据分享设置）
  - 语言设置（系统语言、日期格式、时间格式）
  - 主题设置（主题颜色、界面风格）
- ✅ **密码修改**
  - 当前密码验证（当前密码输入、密码验证）
  - 新密码设置（新密码输入、密码强度验证、密码确认）
  - 密码修改（密码修改、修改确认）
  - 密码修改记录（修改时间、修改IP、修改记录）
- ✅ **登录记录**
  - 登录记录查看（登录时间、登录IP、登录地点、登录设备）
  - 登录记录筛选（按时间、按IP、按设备筛选）
  - 异常登录提醒（异常登录检测、异常登录提醒）
  - 登录记录导出（登录记录导出、记录报表生成）

---

## 📊 功能完成度统计

| 模块 | 状态 | 完成度 | 说明 |
|------|------|--------|------|
| 客户管理 | ✅ 已完成 | 80% | 核心功能已完成，客户联系人管理待完善 |
| 商机管理 | ✅ 已完成 | 75% | 核心功能完成，基础管理页面已实现（列表、详情、创建、编辑、删除），状态流转和跟进记录管理已实现，商机预测页面已实现，图纸评估、投标报价、技术沟通会已实现占位页面（功能开发中），快速报价工具、销售漏斗分析、销售预测、过程指标仪表盘、销售绩效报表和输单分析已实现 |
| 生产管理 | ✅ 已完成 | 85% | 核心功能完整，部分辅助功能待完善 |
| 收发管理 | ✅ 已完成 | 90% | 功能完整 |
| 结算管理 | ✅ 已完成 | 70% | 基础功能完成，统计功能待完善 |
| 回款管理 | ✅ 已完成 | 60% | 基础功能完成，统计界面待开发 |
| 人事管理 | ⏳ 计划中 | 0% | 待开发 |
| 行政管理 | ⏳ 计划中 | 0% | 待开发 |
| 财务管理 | ⏳ 计划中 | 0% | 待开发 |
| 产值管理 | ✅ 已完成 | 60% | 数据模型和API完成，界面待开发 |
| 计划管理 | ⏳ 计划中 | 0% | 待开发 |
| 档案管理 | ✅ 已完成 | 60% | 基础功能完成，高级功能待开发 |
| 资源管理 | ⏳ 计划中 | 0% | 待开发 |
| 风险管理 | ⏳ 计划中 | 0% | 待开发 |
| 诉讼管理 | ⏳ 计划中 | 0% | 待开发 |
| 报表管理 | ⏳ 计划中 | 0% | 待开发 |
| 标准管理 | ⏳ 计划中 | 0% | 待开发 |
| 系统管理 | ✅ 已完成 | 90% | 功能完整，包含系统设置（后台管理）和个人设置。系统设置包括用户管理、角色管理、权限管理、部门管理、岗位管理、系统配置、审批流程引擎配置等 |

**总体完成度**：约 50%

---

## 🎯 功能优先级

### 🔴 高优先级（核心业务）
1. **客户管理** - 客户信息、客户线索、客户关系
2. **商机管理** - 商机跟踪、报价管理、销售分析
3. **生产管理** - 项目执行、任务管理、进度跟踪
5. **收发管理** - 成果文件交付、交付跟踪
6. **结算管理** - 项目结算、结算审核
7. **回款管理** - 回款计划、回款跟踪

### 🟡 中优先级（重要功能）
1. **档案管理** - 项目档案、文档归档
2. **产值管理** - 产值配置、产值计算
3. **计划管理** - 工作计划、计划执行
4. **人事管理** - 员工信息、考勤管理
5. **诉讼管理** - 诉讼案件管理、诉讼流程跟踪、诉讼费用管理
6. **报表管理** - 集中管理各个功能模块的报表

### 🟢 低优先级（可选功能）
1. **行政管理** - 行政事务、办公用品
2. **财务管理** - 财务核算、财务报表
3. **资源管理** - 资源标准、资源库、综合单价库
4. **风险管理** - 风险识别、风险评估

---

## 📝 说明

本文档详细列出了各模块的功能清单，✅ 表示已完成，⏳ 表示计划中或占位功能。

---

## 📊 系统总体说明

### 系统模块统计
- **功能模块总数**：19个
  - 业务模块：6个（客户管理、商机管理（含立项）、生产管理、收发管理、结算管理、回款管理）
  - 管理模块：9个（人事管理、行政管理、财务管理、产值管理、计划管理、档案管理、资源管理、风险管理、诉讼管理）
  - 系统模块：3个（报表管理、标准管理、系统管理）

### 系统核心特性

#### 1. 全流程业务闭环
- **客户线索 → 商机跟踪（含立项） → 生产管理 → 收发管理 → 结算管理 → 回款管理**
- 每个环节都有完整的数据记录和状态跟踪
- 支持业务流程的自动流转和手动干预

#### 2. 审批流程与产值关联
- **每个业务节点都必须配置审批流程**
- 审批节点与产值阶段/里程碑关联
- 审批通过后自动触发产值计算
- 审批人可作为产值分配对象
- 审批时间作为产值计算时间

#### 3. 数据驱动决策
- 各模块提供丰富的统计和分析功能
- 工作台根据角色展示不同的数据统计
- 支持多维度数据分析和趋势预测
- 提供数据报表和可视化展示

#### 4. 知识沉淀与复用
- 生产知识库管理（经验总结、最佳实践）
- 资源管理（技术标准、设计规范、图纸模板、计算工具、综合单价库）
- 标准管理（审图标准）
- 档案管理（项目档案、行政档案）

#### 5. 风险控制与预警
- 风险管理（风险识别、风险评估、风险应对、风险预警）
- 生产预警（进度预警、质量预警、成本预警、资源预警）
- 回款风险预警（逾期回款、坏账风险）

### 关键数据流转

#### 1. 项目数据流转
```
客户线索 → 商机管理（含立项） → 生产管理 → 收发管理 → 结算管理 → 回款管理 → 档案管理
```

#### 2. 产值数据流转
```
审批流程 → 产值阶段/里程碑 → 产值计算 → 产值分配 → 产值统计
```

#### 3. 交付数据流转
```
生产管理（成果文件） → 收发管理（交付准备、执行、跟踪、确认） → 档案管理（自动归档）
```

#### 4. 结算数据流转
```
生产管理（项目完成） → 结算管理（结算创建、初审、对账、定案） → 回款管理（回款计划、回款跟踪）
```

### 审批流程配置原则

**配置位置说明**：
- **配置位置**：审批流程引擎配置在系统管理模块（19.1.7）中完成，由系统管理员统一管理
- **关联模块**：虽然配置在系统管理模块，但与产值管理模块（11）紧密关联
- **配置前提**：配置审批流程前，需先在产值管理模块（11.1）中配置产值阶段和里程碑
- **关联关系**：审批节点必须与产值阶段/里程碑关联，审批通过后自动触发产值计算

1. **每个业务节点都必须配置审批流程**
   - 客户管理：客户创建审批、客户变更审批
   - 商机管理：商机创建审批、报价审批、合同审批
   - 商机管理（立项）：立项创建审批、立项变更审批
   - 生产管理：项目创建审批、图纸审批、意见审批、成果确认审批、产值审批
   - 结算管理：结算创建审批、结算初审审批、结算定案审批
   - 回款管理：回款计划审批、发票开具审批
   - 产值管理：产值计算审批、产值分配审批、产值确认审批
   - 其他模块：人事、行政、财务、计划、档案、资源、风险等模块的审批流程

2. **审批节点与产值关联（统一触发机制）**
   - **触发机制**：审批节点通过 → 自动触发产值计算（统一机制）
   - **触发流程**：业务事件发生 → 进入审批流程 → 审批节点通过 → 触发产值计算
   - 审批节点必须与产值阶段或产值里程碑关联（在系统管理模块19.1.7中配置）
   - 审批通过后自动触发产值计算（在产值管理模块11.2中执行）
   - 审批人可作为产值分配对象（根据审批节点配置的产值比例进行分配）
   - 审批时间作为产值计算时间（用于产值计算和分配）
   - **重要说明**：产值计算统一基于审批节点通过触发，不是直接基于业务事件触发。虽然产值事件中配置了"关联业务事件"，但这些业务事件需要通过审批流程，审批通过后才触发产值计算。

3. **审批流程配置权限**
   - 仅系统管理员可进行审批流程配置（在系统管理模块19.1.7中完成）
   - 前端不提供审批流程管理入口
   - 审批操作在各业务模块中完成
   - 产值计算和分配在产值管理模块（11）中完成

### 工作台角色区分

#### 员工角色
- **数据可见范围**：仅可见个人相关数据（本人参与的项目、分配给本人的任务、本人的产值、本人的客户、本人的商机等）
- **关注内容**：
  - 个人工作：我的项目、我的任务、我的产值、我的考勤
  - 个人业务统计：我的客户、我的商机、我的跟进记录
  - 个人待办事项：待审批、待处理、待回复、待接收
- **数据计算规则**：直接统计个人相关数据，不包含其他员工数据
- **权限说明**：无法查看其他员工的数据、部门整体数据、公司整体数据

#### 部门经理角色
- **数据可见范围**：可见本部门所有员工的数据 + 个人数据（部门内所有项目、部门内所有任务、部门内所有产值、部门内所有客户、部门内所有商机等）
- **关注内容**：
  - 部门工作：部门项目、部门任务、部门产值、部门人员
  - 部门业务统计：部门客户、部门商机、部门销售
  - 部门管理功能：人员排名、效率统计、风险预警
- **数据计算规则**：汇总本部门所有员工的数据（部门项目统计、部门任务统计、部门产值统计、部门人员统计等）
- **权限说明**：可以查看本部门所有员工的数据，无法查看其他部门的数据、公司整体数据（除非有特殊权限）

#### 高管角色
- **数据可见范围**：可见公司所有数据（公司所有项目、公司所有任务、公司所有产值、公司所有客户、公司所有商机、公司所有财务数据、公司所有风险数据、公司所有战略数据等）
- **关注内容**：
  - 公司整体：总产值、总销售、总回款、总利润
  - 业务分析：客户分析、商机分析、项目分析、生产分析
  - 财务分析：收入统计、成本统计、利润分析
  - 战略目标：年度目标、目标达成率、目标趋势
- **数据计算规则**：汇总公司所有部门的所有数据（公司项目统计、公司任务统计、公司产值统计、公司销售统计、公司回款统计、公司收入统计、公司成本统计、公司利润统计等）
- **权限说明**：拥有最高数据权限，可以查看系统所有数据，包括公司所有财务数据、风险数据、战略数据

### 系统集成说明

#### 1. 审批流程引擎
- 作为系统设置功能，由系统管理员在系统设置模块中集中配置
- 各业务模块通过调用审批流程引擎完成审批操作
- 审批实例管理、审批操作、审批通知、审批历史等功能在各业务模块中完成

#### 2. 产值管理集成
- 产值阶段配置与审批流程关联
- 产值里程碑配置与审批流程关联
- 产值计算自动触发（审批通过后）
- 产值分配基于审批人配置

#### 3. 档案管理集成
- 接收收发管理模块推送的成果文件
- 自动归档处理（交付状态为"已确认"或"已反馈"）
- 与收发管理模块形成完整工作闭环

#### 4. 报表管理集成
- 集中管理各功能模块的报表
- 支持报表的统一分类、统一查看、统一导出、统一分析
- 各功能模块的报表统一在报表管理模块中查看和管理

#### 5. 第三方系统集成
- **企业信息查询**：启信宝API集成（自动填充企业信息、企业工商信息查询）
- **快递物流查询**：快递API集成（快递100、菜鸟等，用于交付跟踪）
- **短信服务**：第三方短信服务集成（可选，用于重要通知）
- **邮件服务**：SMTP邮件服务（用于邮件通知、邮件交付）
- **文件存储服务**：对象存储服务（OSS/S3，用于文件存储）
- **支付服务**：第三方支付服务集成（可选，用于在线支付）

#### 6. 数据同步与共享
- **模块间数据同步**：各模块间数据自动同步（项目信息、客户信息、合同信息等）
- **数据共享机制**：支持模块间数据共享和引用（避免数据冗余）
- **数据一致性**：确保跨模块数据的一致性（数据更新、数据删除联动）
- **数据权限继承**：模块间数据权限继承（项目数据权限、客户数据权限等）

### 系统技术架构

#### 1. 核心技术栈
- **后端框架**：Django
- **前端技术**：Django模板渲染 + RESTful API
- **数据存储**：关系型数据库（PostgreSQL/MySQL）
- **文件存储**：对象存储（OSS/S3）
- **缓存系统**：Redis（用于缓存、会话存储、消息队列）
- **异步任务**：Celery（用于定时任务、异步处理）
- **消息队列**：Redis/Celery（用于任务队列、消息通知）

#### 2. 核心系统功能
- **审批引擎**：工作流引擎（支持多级审批、会签、或签、条件分支）
- **产值计算**：基于配置规则的自动计算引擎
- **消息通知系统**：
  - 系统内通知（站内消息、通知中心）
  - 邮件通知（SMTP邮件发送）
  - 短信通知（可选，第三方短信服务）
  - 通知模板管理（支持自定义通知模板）
- **文件处理系统**：
  - 文件上传（支持大文件分片上传、断点续传）
  - 文件下载（支持批量下载、权限控制）
  - 文件预览（支持PDF、图片、Office文档预览）
  - 文件转换（支持格式转换、OCR识别）
  - 文件存储（对象存储、本地存储、备份存储）
- **安全认证系统**：
  - 用户认证（用户名密码、Token认证）
  - 权限控制（基于角色的权限控制RBAC）
  - 数据加密（敏感数据加密存储）
  - 操作日志（操作审计、安全审计）
  - 登录安全（登录记录、异常登录检测、二次验证）
- **数据备份与恢复**：
  - 自动备份（数据库自动备份、文件自动备份）
  - 备份策略（每日备份、每周备份、每月备份）
  - 数据恢复（备份恢复、数据还原）
  - 数据归档（历史数据归档、数据清理）
- **日志系统**：
  - 操作日志（用户操作记录、系统操作记录）
  - 错误日志（错误记录、异常追踪）
  - 访问日志（访问记录、性能监控）
  - 日志查询（日志搜索、日志分析、日志导出）
- **定时任务系统**：
  - 定时任务配置（Celery定时任务）
  - 任务调度（任务执行、任务监控）
  - 任务管理（任务列表、任务状态、任务日志）
  - 常用定时任务：
    - 逾期交付检测（每小时）
    - 自动归档检查（每天）
    - 回款确认提醒（每月25日）
    - 数据备份（每天）
    - 日志清理（每周）
    - 统计报表生成（每天/每周/每月）

### 系统扩展性

1. **模块化设计**：各功能模块相对独立，支持单独开发和部署
2. **接口标准化**：RESTful API标准化，支持第三方系统集成
3. **配置化管理**：审批流程、产值规则、统计报表等支持配置化管理
4. **插件化架构**：支持功能插件扩展，便于功能扩展和定制

---

**文档版本**：v6.1（系统管理优化版）  
**最后更新**：2025-01-XX  
**维护者**：维海科技开发团队

#### 5. 第三方系统集成
- **企业信息查询**：启信宝API集成（自动填充企业信息、企业工商信息查询）
- **快递物流查询**：快递API集成（快递100、菜鸟等，用于交付跟踪）
- **短信服务**：第三方短信服务集成（可选，用于重要通知）
- **邮件服务**：SMTP邮件服务（用于邮件通知、邮件交付）
- **文件存储服务**：对象存储服务（OSS/S3，用于文件存储）
- **支付服务**：第三方支付服务集成（可选，用于在线支付）

#### 6. 数据同步与共享
- **模块间数据同步**：各模块间数据自动同步（项目信息、客户信息、合同信息等）
- **数据共享机制**：支持模块间数据共享和引用（避免数据冗余）
- **数据一致性**：确保跨模块数据的一致性（数据更新、数据删除联动）
- **数据权限继承**：模块间数据权限继承（项目数据权限、客户数据权限等）

### 系统技术架构

#### 1. 核心技术栈
- **后端框架**：Django
- **前端技术**：Django模板渲染 + RESTful API
- **数据存储**：关系型数据库（PostgreSQL/MySQL）
- **文件存储**：对象存储（OSS/S3）
- **缓存系统**：Redis（用于缓存、会话存储、消息队列）
- **异步任务**：Celery（用于定时任务、异步处理）
- **消息队列**：Redis/Celery（用于任务队列、消息通知）

#### 2. 核心系统功能
- **审批引擎**：工作流引擎（支持多级审批、会签、或签、条件分支）
- **产值计算**：基于配置规则的自动计算引擎
- **消息通知系统**：
  - 系统内通知（站内消息、通知中心）
  - 邮件通知（SMTP邮件发送）
  - 短信通知（可选，第三方短信服务）
  - 通知模板管理（支持自定义通知模板）
- **文件处理系统**：
  - 文件上传（支持大文件分片上传、断点续传）
  - 文件下载（支持批量下载、权限控制）
  - 文件预览（支持PDF、图片、Office文档预览）
  - 文件转换（支持格式转换、OCR识别）
  - 文件存储（对象存储、本地存储、备份存储）
- **安全认证系统**：
  - 用户认证（用户名密码、Token认证）
  - 权限控制（基于角色的权限控制RBAC）
  - 数据加密（敏感数据加密存储）
  - 操作日志（操作审计、安全审计）
  - 登录安全（登录记录、异常登录检测、二次验证）
- **数据备份与恢复**：
  - 自动备份（数据库自动备份、文件自动备份）
  - 备份策略（每日备份、每周备份、每月备份）
  - 数据恢复（备份恢复、数据还原）
  - 数据归档（历史数据归档、数据清理）
- **日志系统**：
  - 操作日志（用户操作记录、系统操作记录）
  - 错误日志（错误记录、异常追踪）
  - 访问日志（访问记录、性能监控）
  - 日志查询（日志搜索、日志分析、日志导出）
- **定时任务系统**：
  - 定时任务配置（Celery定时任务）
  - 任务调度（任务执行、任务监控）
  - 任务管理（任务列表、任务状态、任务日志）
  - 常用定时任务：
    - 逾期交付检测（每小时）
    - 自动归档检查（每天）
    - 回款确认提醒（每月25日）
    - 数据备份（每天）
    - 日志清理（每周）
    - 统计报表生成（每天/每周/每月）

### 系统扩展性

1. **模块化设计**：各功能模块相对独立，支持单独开发和部署
2. **接口标准化**：RESTful API标准化，支持第三方系统集成
3. **配置化管理**：审批流程、产值规则、统计报表等支持配置化管理
4. **插件化架构**：支持功能插件扩展，便于功能扩展和定制

---

**文档版本**：v6.1（系统管理优化版）  
**最后更新**：2025-01-XX  
**维护者**：维海科技开发团队
